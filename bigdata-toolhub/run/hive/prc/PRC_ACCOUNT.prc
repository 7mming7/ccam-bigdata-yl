INCLUDE INCLUDE_HEAD.sql

CREATE OR REPLACE PROCEDURE PRC_ACCOUNT(IN ETL_DATE STRING, OUT RESULT STRING)
BEGIN

    DECLARE     v_sql          string;
    DECLARE     v_sql2         string;
    DECLARE     v_sql3         string;
    DECLARE     v_sql4         string;
    DECLARE     v_sql5         string;
    DECLARE     v_sql6         string;
    DECLARE     v_sql7         string;
    DECLARE     v_sql8         string;
    DECLARE     v_sql9         string;
    DECLARE     v_sql10        string;
    DECLARE     v_sql11        string;
    DECLARE     v_sql12        string;
    DECLARE     v_sql13        string;
    DECLARE     v_sql14        string;
    DECLARE     v_sql15        string;
    DECLARE     v_sql16        string;
    DECLARE     v_sql17        string;
    DECLARE     v_sql18        string;
    DECLARE     v_sql19        string;
    DECLARE     v_sql20        string;
    DECLARE     v_sql21        string;
    DECLARE     v_sql22        string;
    DECLARE     v_sql23        string;
    DECLARE     v_sql24        string;
    DECLARE     v_sql25        string;
    DECLARE     v_sql26        string;
    DECLARE     v_sql27        string;
    DECLARE     v_sql28        string;
    DECLARE     v_sql29        string;
    DECLARE     v_sql30        string;
    DECLARE     v_sql31        string;
    DECLARE     v_sql32        string;
    DECLARE     v_ETL_DATE     string;

    DBMS_OUTPUT.PUT_LINE ('PRC_ACCOUNT_INIT START');
    DBMS_OUTPUT.PUT_LINE ('ETL_DATE ==' || ETL_DATE);

      IF ETL_DATE <> ' '
       THEN
          select todate(ETL_DATE,'yyyymmdd') into v_ETL_DATE from dual;
          DBMS_OUTPUT.PUT_LINE ('v_ETL_DATE2==' || v_ETL_DATE);
       ELSE
          DBMS_OUTPUT.PUT_LINE ('V_ETL_DATE 为空');

          SELECT SYSDATE() INTO v_ETL_DATE FROM DUAL;
       END IF;

       DBMS_OUTPUT.PUT_LINE ('v_ETL_DATE3 ==' || v_ETL_DATE);

       EXECUTE IMMEDIATE ('truncate table temp_event_counts');

       DBMS_OUTPUT.PUT_LINE('before:=========' || v_sql);

    v_sql := 'INSERT INTO temp_event_counts ';
    v_sql := v_sql||' SELECT event.ACCTNBR AS ACCTNBR, COUNT (1) AS eventcounts ';
    v_sql := v_sql||'   FROM FDM_S24_EVENT event ';
    v_sql := v_sql||'  WHERE todate(event.CREATE_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -6) ';
    v_sql := v_sql||'    AND todate(event.CREATE_DATE,''yyyy-mm-dd'') <= SYSDATE() ';
    v_sql := v_sql||'    AND (   event.trans_type BETWEEN 1000 AND 2999 ';
    v_sql := v_sql||'         OR event.trans_type BETWEEN 7000 AND 7999) ';
    v_sql := v_sql||'    AND ( coal(event.rev_ind,'' '') <> ''1'' or (event.rev_ind + 0) is null ) ';
    v_sql := v_sql||'  GROUP BY event.ACCTNBR ';

        DBMS_OUTPUT.PUT_LINE('after:==========' || v_sql);

        execute immediate v_sql;

        EXECUTE IMMEDIATE ('truncate table  temp_event_income');

        DBMS_OUTPUT.PUT_LINE('before:=========' || v_sql2);

    v_sql2 := 'INSERT INTO temp_event_income ';
    v_sql2 := v_sql2||' SELECT E.ACCTNBR AS ACCTNBR, ';
    v_sql2 := v_sql2||'       SUM ( ';
    v_sql2 := v_sql2||'          CASE ';
    v_sql2 := v_sql2||'             WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql2 := v_sql2||'             ELSE E.BILL_AMT ';
    v_sql2 := v_sql2||'          END) ';
    v_sql2 := v_sql2||'          AS INCOME, ';
    v_sql2 := v_sql2||'                         SUM ( ';
    v_sql2 := v_sql2||'         CASE ';
    v_sql2 := v_sql2||'            WHEN E.TRANS_TYPE IN ( ';
    v_sql2 := v_sql2||'            ''3250'',''3251'',''3252'' ';
    v_sql2 := v_sql2||'            ) ';
    v_sql2 := v_sql2||'            THEN ';
    v_sql2 := v_sql2||'               CASE ';
    v_sql2 := v_sql2||'                  WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql2 := v_sql2||'                  ELSE E.BILL_AMT ';
    v_sql2 := v_sql2||'               END ';
    v_sql2 := v_sql2||'            ELSE ';
    v_sql2 := v_sql2||'               0 ';
    v_sql2 := v_sql2||'         END) ';
    v_sql2 := v_sql2||'         AS GOODINCOME ';
    v_sql2 := v_sql2||'  FROM FDM_S24_EVENT E ';
    v_sql2 := v_sql2||' WHERE     (   (E.TRANS_TYPE >= ''3000'' AND E.TRANS_TYPE <= ''4999'') ';
    v_sql2 := v_sql2||'            OR E.TRANS_TYPE IN (''8022'', ';
    v_sql2 := v_sql2||'                                ''5000'', ';
    v_sql2 := v_sql2||'                                ''5001'', ';
    v_sql2 := v_sql2||'                                ''5050'', ';
    v_sql2 := v_sql2||'                                ''5500'', ';
    v_sql2 := v_sql2||'                                ''8028'', ';
    v_sql2 := v_sql2||'                                ''8029'')) ';
    v_sql2 := v_sql2||'           AND todate(E.CREATE_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -6) ';
    v_sql2 := v_sql2||'           AND todate(E.CREATE_DATE,''yyyy-mm-dd'') <= SYSDATE() ';
    v_sql2 := v_sql2||'  GROUP BY E.ACCTNBR ';

        DBMS_OUTPUT.PUT_LINE('after:==========' || v_sql2);

        execute immediate v_sql2;


        DBMS_OUTPUT.PUT_LINE('PRC_ACCOUNT_INIT over:==========success!');

    	EXECUTE IMMEDIATE ('truncate table  temp_event_pur');

       DBMS_OUTPUT.PUT_LINE('before:=========' || v_sql3);

    v_sql3 := ' INSERT INTO temp_event_pur ';
    v_sql3 := v_sql3||' SELECT E.ACCTNBR AS XACCOUNT, ';
    v_sql3 := v_sql3||'        SUM ( ';
    v_sql3 := v_sql3||'           CASE ';
    v_sql3 := v_sql3||'              WHEN ( ';
    v_sql3 := v_sql3||'                   E.MER_CAT_CD IN (''1520'', ';
    v_sql3 := v_sql3||'                                    ''7013'', ';
    v_sql3 := v_sql3||'                                    ''5271'', ';
    v_sql3 := v_sql3||'                                    ''5511'', ';
    v_sql3 := v_sql3||'                                    ''5521'', ';
    v_sql3 := v_sql3||'                                    ''5551'', ';
    v_sql3 := v_sql3||'                                    ''5561'', ';
    v_sql3 := v_sql3||'                                    ''5571'', ';
    v_sql3 := v_sql3||'                                    ''5592'', ';
    v_sql3 := v_sql3||'                                    ''5598'', ';
    v_sql3 := v_sql3||'                                    ''5599'', ';
    v_sql3 := v_sql3||'                                    ''5933'', ';
    v_sql3 := v_sql3||'                                    ''8062'', ';
    v_sql3 := v_sql3||'                                    ''8211'', ';
    v_sql3 := v_sql3||'                                    ''8220'', ';
    v_sql3 := v_sql3||'                                    ''8398'', ';
    v_sql3 := v_sql3||'                                    ''5021'', ';
    v_sql3 := v_sql3||'                                    ''5039'', ';
    v_sql3 := v_sql3||'                                    ''5044'', ';
    v_sql3 := v_sql3||'                                    ''5045'', ';
    v_sql3 := v_sql3||'                                    ''5046'', ';
    v_sql3 := v_sql3||'                                    ''5047'', ';
    v_sql3 := v_sql3||'                                    ''5051'', ';
    v_sql3 := v_sql3||'                                    ''5065'', ';
    v_sql3 := v_sql3||'                                    ''5072'', ';
    v_sql3 := v_sql3||'                                    ''5074'', ';
    v_sql3 := v_sql3||'                                    ''5111'', ';
    v_sql3 := v_sql3||'                                    ''5122'', ';
    v_sql3 := v_sql3||'                                    ''5131'', ';
    v_sql3 := v_sql3||'                                    ''5137'', ';
    v_sql3 := v_sql3||'                                    ''5139'', ';
    v_sql3 := v_sql3||'                                    ''5172'', ';
    v_sql3 := v_sql3||'                                    ''5192'', ';
    v_sql3 := v_sql3||'                                    ''5193'', ';
    v_sql3 := v_sql3||'                                    ''5198'', ';
    v_sql3 := v_sql3||'                                    ''5998'', ';
    v_sql3 := v_sql3||'                                    ''5013'', ';
    v_sql3 := v_sql3||'                                    ''5398'', ';
    v_sql3 := v_sql3||'                                    ''4458'', ';
    v_sql3 := v_sql3||'                                    ''9498'', ';
    v_sql3 := v_sql3||'                                    ''9703'', ';
    v_sql3 := v_sql3||'                                    ''9704'', ';
    v_sql3 := v_sql3||'                                    ''9705'', ';
    v_sql3 := v_sql3||'                                    ''9706'', ';
    v_sql3 := v_sql3||'                                    ''9707'', ';
    v_sql3 := v_sql3||'                                    ''9708'', ';
    v_sql3 := v_sql3||'                                    ''5200'', ';
    v_sql3 := v_sql3||'                                    ''5300'') ';
    v_sql3 := v_sql3||'                                    OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'') ';
    v_sql3 := v_sql3||'                                    ) ';
    v_sql3 := v_sql3||'                                    AND E.bill_amt > 3500 ';
    v_sql3 := v_sql3||'                                    AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql3 := v_sql3||'              THEN ';
    v_sql3 := v_sql3||'                 CASE ';
    v_sql3 := v_sql3||'                    WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql3 := v_sql3||'                    ELSE E.BILL_AMT ';
    v_sql3 := v_sql3||'                 END ';
    v_sql3 := v_sql3||'              ELSE ';
    v_sql3 := v_sql3||'                 0 ';
    v_sql3 := v_sql3||'           END) ';
    v_sql3 := v_sql3||'           AS BADPUR, ';
    v_sql3 := v_sql3||'                          MAX ( ';
    v_sql3 := v_sql3||'           CASE ';
    v_sql3 := v_sql3||'              WHEN ( ';
    v_sql3 := v_sql3||'                   E.MER_CAT_CD IN (''1520'', ';
    v_sql3 := v_sql3||'                                    ''7013'', ';
    v_sql3 := v_sql3||'                                    ''5271'', ';
    v_sql3 := v_sql3||'                                    ''5511'', ';
    v_sql3 := v_sql3||'                                    ''5521'', ';
    v_sql3 := v_sql3||'                                    ''5551'', ';
    v_sql3 := v_sql3||'                                    ''5561'', ';
    v_sql3 := v_sql3||'                                    ''5571'', ';
    v_sql3 := v_sql3||'                                    ''5592'', ';
    v_sql3 := v_sql3||'                                    ''5598'', ';
    v_sql3 := v_sql3||'                                    ''5599'', ';
    v_sql3 := v_sql3||'                                    ''5933'', ';
    v_sql3 := v_sql3||'                                    ''8062'', ';
    v_sql3 := v_sql3||'                                    ''8211'', ';
    v_sql3 := v_sql3||'                                    ''8220'', ';
    v_sql3 := v_sql3||'                                    ''8398'', ';
    v_sql3 := v_sql3||'                                    ''5021'', ';
    v_sql3 := v_sql3||'                                    ''5039'', ';
    v_sql3 := v_sql3||'                                    ''5044'', ';
    v_sql3 := v_sql3||'                                    ''5045'', ';
    v_sql3 := v_sql3||'                                    ''5046'', ';
    v_sql3 := v_sql3||'                                    ''5047'', ';
    v_sql3 := v_sql3||'                                    ''5051'', ';
    v_sql3 := v_sql3||'                                    ''5065'', ';
    v_sql3 := v_sql3||'                                    ''5072'', ';
    v_sql3 := v_sql3||'                                    ''5074'', ';
    v_sql3 := v_sql3||'                                    ''5111'', ';
    v_sql3 := v_sql3||'                                    ''5122'', ';
    v_sql3 := v_sql3||'                                    ''5131'', ';
    v_sql3 := v_sql3||'                                    ''5137'', ';
    v_sql3 := v_sql3||'                                    ''5139'', ';
    v_sql3 := v_sql3||'                                    ''5172'', ';
    v_sql3 := v_sql3||'                                    ''5192'', ';
    v_sql3 := v_sql3||'                                    ''5193'', ';
    v_sql3 := v_sql3||'                                    ''5198'', ';
    v_sql3 := v_sql3||'                                    ''5998'', ';
    v_sql3 := v_sql3||'                                    ''5013'', ';
    v_sql3 := v_sql3||'                                    ''5398'', ';
    v_sql3 := v_sql3||'                                    ''4458'', ';
    v_sql3 := v_sql3||'                                    ''9498'', ';
    v_sql3 := v_sql3||'                                    ''9703'', ';
    v_sql3 := v_sql3||'                                    ''9704'', ';
    v_sql3 := v_sql3||'                                    ''9705'', ';
    v_sql3 := v_sql3||'                                    ''9706'', ';
    v_sql3 := v_sql3||'                                    ''9707'', ';
    v_sql3 := v_sql3||'                                    ''9708'', ';
    v_sql3 := v_sql3||'                                    ''5200'', ';
    v_sql3 := v_sql3||'                                    ''5300'') ';
    v_sql3 := v_sql3||'                                    OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'') ';
    v_sql3 := v_sql3||'                                    ) ';
    v_sql3 := v_sql3||'                                    AND E.bill_amt > 3500 ';
    v_sql3 := v_sql3||'                                    AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql3 := v_sql3||'                                    AND E.BILL_AMTFLAG = ''+'' ';
    v_sql3 := v_sql3||'              THEN ';
    v_sql3 := v_sql3||'                      E.BILL_AMT + 0 ';
    v_sql3 := v_sql3||'              ELSE ';
    v_sql3 := v_sql3||'                 0 ';
    v_sql3 := v_sql3||'           END) ';
    v_sql3 := v_sql3||'           AS BADMAXPUR, ';
    v_sql3 := v_sql3||'        SUM ( ';
    v_sql3 := v_sql3||'           CASE ';
    v_sql3 := v_sql3||'              WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql3 := v_sql3||'              ELSE E.BILL_AMT ';
    v_sql3 := v_sql3||'           END) ';
    v_sql3 := v_sql3||'           AS PUR, ';
    v_sql3 := v_sql3||'        SUM ( ';
    v_sql3 := v_sql3||'           CASE ';
    v_sql3 := v_sql3||'              WHEN E.MER_CAT_CD IN (''5541'', ';
    v_sql3 := v_sql3||'                                    ''5542'' ';
    v_sql3 := v_sql3||'                                    ) ';
    v_sql3 := v_sql3||'                                    AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql3 := v_sql3||'              THEN ';
    v_sql3 := v_sql3||'                 CASE ';
    v_sql3 := v_sql3||'                    WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql3 := v_sql3||'                    ELSE E.BILL_AMT ';
    v_sql3 := v_sql3||'                 END ';
    v_sql3 := v_sql3||'              ELSE ';
    v_sql3 := v_sql3||'                 0 ';
    v_sql3 := v_sql3||'           END) ';
    v_sql3 := v_sql3||'         AS GAS_PUR, ';
    v_sql3 := v_sql3||'        COUNT ( ';
    v_sql3 := v_sql3||'           CASE ';
    v_sql3 := v_sql3||'              WHEN E.MER_CAT_CD IN (''5541'', ';
    v_sql3 := v_sql3||'                                    ''5542'' ';
    v_sql3 := v_sql3||'                                    ) ';
    v_sql3 := v_sql3||'                                    AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql3 := v_sql3||'              THEN ';
    v_sql3 := v_sql3||'                 1 ';
    v_sql3 := v_sql3||'              ELSE ';
    v_sql3 := v_sql3||'                NULL ';
    v_sql3 := v_sql3||'           END)  AS GAS_CNT, ';
    v_sql3 := v_sql3||'           SUM ( ';
    v_sql3 := v_sql3||'           CASE ';
    v_sql3 := v_sql3||'              WHEN E.MER_CAT_CD IN (''6300'', ';
    v_sql3 := v_sql3||'                                    ''5960'' ';
    v_sql3 := v_sql3||'                                    ) ';
    v_sql3 := v_sql3||'                                    AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql3 := v_sql3||'              THEN ';
    v_sql3 := v_sql3||'                 CASE ';
    v_sql3 := v_sql3||'                    WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql3 := v_sql3||'                    ELSE E.BILL_AMT ';
    v_sql3 := v_sql3||'                 END ';
    v_sql3 := v_sql3||'              ELSE ';
    v_sql3 := v_sql3||'                 0 ';
    v_sql3 := v_sql3||'           END) ';
    v_sql3 := v_sql3||'         AS BX_PUR, ';
    v_sql3 := v_sql3||'        COUNT ( ';
    v_sql3 := v_sql3||'           CASE ';
    v_sql3 := v_sql3||'              WHEN E.MER_CAT_CD IN (''6300'', ';
    v_sql3 := v_sql3||'                                    ''5960'' ';
    v_sql3 := v_sql3||'                                    ) ';
    v_sql3 := v_sql3||'                                    AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql3 := v_sql3||'              THEN ';
    v_sql3 := v_sql3||'                 1 ';
    v_sql3 := v_sql3||'              ELSE ';
    v_sql3 := v_sql3||'                NULL ';
    v_sql3 := v_sql3||'           END)  AS BX_CNT, ';
    v_sql3 := v_sql3||'           COUNT ( ';
    v_sql3 := v_sql3||'           CASE ';
    v_sql3 := v_sql3||'              WHEN ((E.MER_CAT_CD  IN ';
    v_sql3 := v_sql3||'                (''7011'', ';
    v_sql3 := v_sql3||'                 ''7012'', ';
    v_sql3 := v_sql3||'                 ''5811'', ';
    v_sql3 := v_sql3||'                 ''5812'', ';
    v_sql3 := v_sql3||'                 ''5813'', ';
    v_sql3 := v_sql3||'                 ''5094'', ';
    v_sql3 := v_sql3||'                 ''5937'', ';
    v_sql3 := v_sql3||'                 ''5950'', ';
    v_sql3 := v_sql3||'                 ''5970'', ';
    v_sql3 := v_sql3||'                 ''5971'', ';
    v_sql3 := v_sql3||'                 ''7297'', ';
    v_sql3 := v_sql3||'                 ''7298'', ';
    v_sql3 := v_sql3||'                 ''7829'', ';
    v_sql3 := v_sql3||'                 ''7911'', ';
    v_sql3 := v_sql3||'                 ''7922'', ';
    v_sql3 := v_sql3||'                 ''7929'', ';
    v_sql3 := v_sql3||'                 ''7932'', ';
    v_sql3 := v_sql3||'                 ''7933'', ';
    v_sql3 := v_sql3||'                 ''7941'', ';
    v_sql3 := v_sql3||'                 ''7992'', ';
    v_sql3 := v_sql3||'                 ''7994'', ';
    v_sql3 := v_sql3||'                 ''7996'', ';
    v_sql3 := v_sql3||'                 ''7997'', ';
    v_sql3 := v_sql3||'                 ''7998'', ';
    v_sql3 := v_sql3||'                 ''7032'', ';
    v_sql3 := v_sql3||'                 ''7033'', ';
    v_sql3 := v_sql3||'                 ''5944'', ';
    v_sql3 := v_sql3||'                 ''5932'', ';
    v_sql3 := v_sql3||'                 ''7631'', ';
    v_sql3 := v_sql3||'                 ''7999'', ';
    v_sql3 := v_sql3||'                 ''5541'', ';
    v_sql3 := v_sql3||'                 ''5542'', ';
    v_sql3 := v_sql3||'                 ''5411'', ';
    v_sql3 := v_sql3||'                 ''5722'', ';
    v_sql3 := v_sql3||'                 ''4511'', ';
    v_sql3 := v_sql3||'                 ''4111'', ';
    v_sql3 := v_sql3||'                 ''4121'', ';
    v_sql3 := v_sql3||'                 ''4131'', ';
    v_sql3 := v_sql3||'                 ''4784'', ';
    v_sql3 := v_sql3||'                 ''3998'', ';
    v_sql3 := v_sql3||'                 ''4112'', ';
    v_sql3 := v_sql3||'                 ''4900'', ';
    v_sql3 := v_sql3||'                 ''4814'', ';
    v_sql3 := v_sql3||'                 ''4899'', ';
    v_sql3 := v_sql3||'                 ''6300'', ';
    v_sql3 := v_sql3||'                 ''5960'', ';
    v_sql3 := v_sql3||'                 ''8651'', ';
    v_sql3 := v_sql3||'                 ''9211'', ';
    v_sql3 := v_sql3||'                 ''9222'', ';
    v_sql3 := v_sql3||'                 ''9223'', ';
    v_sql3 := v_sql3||'                 ''9311'', ';
    v_sql3 := v_sql3||'                 ''9399'', ';
    v_sql3 := v_sql3||'                 ''9400'', ';
    v_sql3 := v_sql3||'                 ''5994'', ';
    v_sql3 := v_sql3||'                 ''7523'', ';
    v_sql3 := v_sql3||'                 ''9402'', ';
    v_sql3 := v_sql3||'                 ''742'',  ';
    v_sql3 := v_sql3||'                 ''763'',  ';
    v_sql3 := v_sql3||'                 ''780'',  ';
    v_sql3 := v_sql3||'                 ''4011'', ';
    v_sql3 := v_sql3||'                 ''4119'', ';
    v_sql3 := v_sql3||'                 ''4214'', ';
    v_sql3 := v_sql3||'                 ''4215'', ';
    v_sql3 := v_sql3||'                 ''4225'', ';
    v_sql3 := v_sql3||'                 ''4411'', ';
    v_sql3 := v_sql3||'                 ''4457'', ';
    v_sql3 := v_sql3||'                 ''4468'', ';
    v_sql3 := v_sql3||'                 ''4582'', ';
    v_sql3 := v_sql3||'                 ''4722'', ';
    v_sql3 := v_sql3||'                 ''4733'', ';
    v_sql3 := v_sql3||'                 ''4789'', ';
    v_sql3 := v_sql3||'                 ''4812'', ';
    v_sql3 := v_sql3||'                 ''4816'', ';
    v_sql3 := v_sql3||'                 ''4821'', ';
    v_sql3 := v_sql3||'                 ''5211'', ';
    v_sql3 := v_sql3||'                 ''5231'', ';
    v_sql3 := v_sql3||'                 ''5251'', ';
    v_sql3 := v_sql3||'                 ''5261'', ';
    v_sql3 := v_sql3||'                 ''5309'', ';
    v_sql3 := v_sql3||'                 ''5310'', ';
    v_sql3 := v_sql3||'                 ''5311'', ';
    v_sql3 := v_sql3||'                 ''5331'', ';
    v_sql3 := v_sql3||'                 ''5399'', ';
    v_sql3 := v_sql3||'                 ''5422'', ';
    v_sql3 := v_sql3||'                 ''5441'', ';
    v_sql3 := v_sql3||'                 ''5451'', ';
    v_sql3 := v_sql3||'                 ''5462'', ';
    v_sql3 := v_sql3||'                 ''5499'', ';
    v_sql3 := v_sql3||'                 ''5532'', ';
    v_sql3 := v_sql3||'                 ''5533'', ';
    v_sql3 := v_sql3||'                 ''5611'', ';
    v_sql3 := v_sql3||'                 ''5621'', ';
    v_sql3 := v_sql3||'                 ''5631'', ';
    v_sql3 := v_sql3||'                 ''5641'', ';
    v_sql3 := v_sql3||'                 ''5651'', ';
    v_sql3 := v_sql3||'                 ''5655'', ';
    v_sql3 := v_sql3||'                 ''5661'', ';
    v_sql3 := v_sql3||'                 ''5681'', ';
    v_sql3 := v_sql3||'                 ''5691'', ';
    v_sql3 := v_sql3||'                 ''5697'', ';
    v_sql3 := v_sql3||'                 ''5698'', ';
    v_sql3 := v_sql3||'                 ''5699'', ';
    v_sql3 := v_sql3||'                 ''5712'', ';
    v_sql3 := v_sql3||'                 ''5713'', ';
    v_sql3 := v_sql3||'                 ''5714'', ';
    v_sql3 := v_sql3||'                 ''5718'', ';
    v_sql3 := v_sql3||'                 ''5719'', ';
    v_sql3 := v_sql3||'                 ''5732'', ';
    v_sql3 := v_sql3||'                 ''5733'', ';
    v_sql3 := v_sql3||'                 ''5734'', ';
    v_sql3 := v_sql3||'                 ''5735'', ';
    v_sql3 := v_sql3||'                 ''5814'', ';
    v_sql3 := v_sql3||'                 ''5912'', ';
    v_sql3 := v_sql3||'                 ''5921'', ';
    v_sql3 := v_sql3||'                 ''5931'', ';
    v_sql3 := v_sql3||'                 ''5935'', ';
    v_sql3 := v_sql3||'                 ''5940'', ';
    v_sql3 := v_sql3||'                 ''5941'', ';
    v_sql3 := v_sql3||'                 ''5942'', ';
    v_sql3 := v_sql3||'                 ''5943'', ';
    v_sql3 := v_sql3||'                 ''5945'', ';
    v_sql3 := v_sql3||'                 ''5946'', ';
    v_sql3 := v_sql3||'                 ''5947'', ';
    v_sql3 := v_sql3||'                 ''5948'', ';
    v_sql3 := v_sql3||'                 ''5949'', ';
    v_sql3 := v_sql3||'                 ''5962'', ';
    v_sql3 := v_sql3||'                 ''5963'', ';
    v_sql3 := v_sql3||'                 ''5964'', ';
    v_sql3 := v_sql3||'                 ''5965'', ';
    v_sql3 := v_sql3||'                 ''5966'', ';
    v_sql3 := v_sql3||'                 ''5967'', ';
    v_sql3 := v_sql3||'                 ''5968'', ';
    v_sql3 := v_sql3||'                 ''5969'', ';
    v_sql3 := v_sql3||'                 ''5972'', ';
    v_sql3 := v_sql3||'                 ''5973'', ';
    v_sql3 := v_sql3||'                 ''5975'', ';
    v_sql3 := v_sql3||'                 ''5976'', ';
    v_sql3 := v_sql3||'                 ''5977'', ';
    v_sql3 := v_sql3||'                 ''5978'', ';
    v_sql3 := v_sql3||'                 ''5983'', ';
    v_sql3 := v_sql3||'                 ''5992'', ';
    v_sql3 := v_sql3||'                 ''5993'', ';
    v_sql3 := v_sql3||'                 ''5995'', ';
    v_sql3 := v_sql3||'                 ''5996'', ';
    v_sql3 := v_sql3||'                 ''5997'', ';
    v_sql3 := v_sql3||'                 ''5999'', ';
    v_sql3 := v_sql3||'                 ''6010'', ';
    v_sql3 := v_sql3||'                 ''6011'', ';
    v_sql3 := v_sql3||'                 ''6012'', ';
    v_sql3 := v_sql3||'                 ''6051'', ';
    v_sql3 := v_sql3||'                 ''6211'', ';
    v_sql3 := v_sql3||'                 ''6513'', ';
    v_sql3 := v_sql3||'                 ''7210'', ';
    v_sql3 := v_sql3||'                 ''7211'', ';
    v_sql3 := v_sql3||'                 ''7216'', ';
    v_sql3 := v_sql3||'                 ''7217'', ';
    v_sql3 := v_sql3||'                 ''7221'', ';
    v_sql3 := v_sql3||'                 ''7230'', ';
    v_sql3 := v_sql3||'                 ''7251'', ';
    v_sql3 := v_sql3||'                 ''7261'', ';
    v_sql3 := v_sql3||'                 ''7273'', ';
    v_sql3 := v_sql3||'                 ''7276'', ';
    v_sql3 := v_sql3||'                 ''7277'', ';
    v_sql3 := v_sql3||'                 ''7278'', ';
    v_sql3 := v_sql3||'                 ''7295'', ';
    v_sql3 := v_sql3||'                 ''7296'', ';
    v_sql3 := v_sql3||'                 ''7299'', ';
    v_sql3 := v_sql3||'                 ''7311'', ';
    v_sql3 := v_sql3||'                 ''7321'', ';
    v_sql3 := v_sql3||'                 ''7333'', ';
    v_sql3 := v_sql3||'                 ''7338'', ';
    v_sql3 := v_sql3||'                 ''7339'', ';
    v_sql3 := v_sql3||'                 ''7342'', ';
    v_sql3 := v_sql3||'                 ''7349'', ';
    v_sql3 := v_sql3||'                 ''7361'', ';
    v_sql3 := v_sql3||'                 ''7372'', ';
    v_sql3 := v_sql3||'                 ''7375'', ';
    v_sql3 := v_sql3||'                 ''7379'', ';
    v_sql3 := v_sql3||'                 ''7392'', ';
    v_sql3 := v_sql3||'                 ''7393'', ';
    v_sql3 := v_sql3||'                 ''7394'', ';
    v_sql3 := v_sql3||'                 ''7395'', ';
    v_sql3 := v_sql3||'                 ''7399'', ';
    v_sql3 := v_sql3||'                 ''7512'', ';
    v_sql3 := v_sql3||'                 ''7513'', ';
    v_sql3 := v_sql3||'                 ''7519'', ';
    v_sql3 := v_sql3||'                 ''7531'', ';
    v_sql3 := v_sql3||'                 ''7534'', ';
    v_sql3 := v_sql3||'                 ''7535'', ';
    v_sql3 := v_sql3||'                 ''7538'', ';
    v_sql3 := v_sql3||'                 ''7542'', ';
    v_sql3 := v_sql3||'                 ''7549'', ';
    v_sql3 := v_sql3||'                 ''7622'', ';
    v_sql3 := v_sql3||'                 ''7623'', ';
    v_sql3 := v_sql3||'                 ''7629'', ';
    v_sql3 := v_sql3||'                 ''7641'', ';
    v_sql3 := v_sql3||'                 ''7692'', ';
    v_sql3 := v_sql3||'                 ''7699'', ';
    v_sql3 := v_sql3||'                 ''7832'', ';
    v_sql3 := v_sql3||'                 ''7841'', ';
    v_sql3 := v_sql3||'                 ''7991'', ';
    v_sql3 := v_sql3||'                 ''7993'', ';
    v_sql3 := v_sql3||'                 ''7995'', ';
    v_sql3 := v_sql3||'                 ''8011'', ';
    v_sql3 := v_sql3||'                 ''8021'', ';
    v_sql3 := v_sql3||'                 ''8031'', ';
    v_sql3 := v_sql3||'                 ''8041'', ';
    v_sql3 := v_sql3||'                 ''8042'', ';
    v_sql3 := v_sql3||'                 ''8043'', ';
    v_sql3 := v_sql3||'                 ''8049'', ';
    v_sql3 := v_sql3||'                 ''8050'', ';
    v_sql3 := v_sql3||'                 ''8071'', ';
    v_sql3 := v_sql3||'                 ''8099'', ';
    v_sql3 := v_sql3||'                 ''8111'', ';
    v_sql3 := v_sql3||'                 ''8241'', ';
    v_sql3 := v_sql3||'                 ''8244'', ';
    v_sql3 := v_sql3||'                 ''8249'', ';
    v_sql3 := v_sql3||'                 ''8299'', ';
    v_sql3 := v_sql3||'                 ''8351'', ';
    v_sql3 := v_sql3||'                 ''8641'', ';
    v_sql3 := v_sql3||'                 ''8661'', ';
    v_sql3 := v_sql3||'                 ''8675'', ';
    v_sql3 := v_sql3||'                 ''8699'', ';
    v_sql3 := v_sql3||'                 ''8911'', ';
    v_sql3 := v_sql3||'                 ''8912'', ';
    v_sql3 := v_sql3||'                 ''8931'', ';
    v_sql3 := v_sql3||'                 ''8999'', ';
    v_sql3 := v_sql3||'                 ''1001'', ';
    v_sql3 := v_sql3||'                 ''6013'') ';
    v_sql3 := v_sql3||'                                    AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql3 := v_sql3||'                                    AND (substr(E.merch_seq,-4,3) + 0) is not null ';
    v_sql3 := v_sql3||'                                    AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ) ';
    v_sql3 := v_sql3||'                                    OR coal(E.MERCH_STAT,'' '') <> ''156''  ) ';
    v_sql3 := v_sql3||'              THEN ';
    v_sql3 := v_sql3||'                 1 ';
    v_sql3 := v_sql3||'              ELSE ';
    v_sql3 := v_sql3||'                 NULL ';
    v_sql3 := v_sql3||'           END) ';
    v_sql3 := v_sql3||'           AS GOODCNT, ';
    v_sql3 := v_sql3||'           SUM(CASE ';
    v_sql3 := v_sql3||'                WHEN ';
    v_sql3 := v_sql3||'                mer_cat_cd in ';
    v_sql3 := v_sql3||'                ( ';
    v_sql3 := v_sql3||'                ''7011'', ';
    v_sql3 := v_sql3||'                ''7012'', ';
    v_sql3 := v_sql3||'                ''5811'', ';
    v_sql3 := v_sql3||'                ''5812'', ';
    v_sql3 := v_sql3||'                ''5813'', ';
    v_sql3 := v_sql3||'                ''5094'', ';
    v_sql3 := v_sql3||'                ''5937'', ';
    v_sql3 := v_sql3||'                ''5950'', ';
    v_sql3 := v_sql3||'                ''5970'', ';
    v_sql3 := v_sql3||'                ''5971'', ';
    v_sql3 := v_sql3||'                ''7297'', ';
    v_sql3 := v_sql3||'                ''7298'', ';
    v_sql3 := v_sql3||'                ''7829'', ';
    v_sql3 := v_sql3||'                ''7911'', ';
    v_sql3 := v_sql3||'                ''7922'', ';
    v_sql3 := v_sql3||'                ''7929'', ';
    v_sql3 := v_sql3||'                ''7932'', ';
    v_sql3 := v_sql3||'                ''7933'', ';
    v_sql3 := v_sql3||'                ''7941'', ';
    v_sql3 := v_sql3||'                ''7992'', ';
    v_sql3 := v_sql3||'                ''7994'', ';
    v_sql3 := v_sql3||'                ''7996'', ';
    v_sql3 := v_sql3||'                ''7997'', ';
    v_sql3 := v_sql3||'                ''7998'', ';
    v_sql3 := v_sql3||'                ''7032'', ';
    v_sql3 := v_sql3||'                ''7033'', ';
    v_sql3 := v_sql3||'                ''5944'', ';
    v_sql3 := v_sql3||'                ''5932'', ';
    v_sql3 := v_sql3||'                ''7631'', ';
    v_sql3 := v_sql3||'                ''7999''  ';
    v_sql3 := v_sql3||'                ) ';
    v_sql3 := v_sql3||'                AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql3 := v_sql3||'                AND (TRANS_TYPE + 0) is not null ';
    v_sql3 := v_sql3||'                AND coal(E.src_ind,'' '') <> ''I'' ';
    v_sql3 := v_sql3||'                AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql3 := v_sql3||'                AND (substr(E.merch_seq,-4,3) + 0) is not null ';
    v_sql3 := v_sql3||'                AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql3 := v_sql3||'                THEN ';
    v_sql3 := v_sql3||'                 CASE ';
    v_sql3 := v_sql3||'                    WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql3 := v_sql3||'                    ELSE E.BILL_AMT ';
    v_sql3 := v_sql3||'                 END ';
    v_sql3 := v_sql3||'              ELSE ';
    v_sql3 := v_sql3||'                 0 ';
    v_sql3 := v_sql3||'              END ';
    v_sql3 := v_sql3||'           ) AS MCC90SUM, ';
    v_sql3 := v_sql3||'                        SUM(CASE ';
    v_sql3 := v_sql3||'                WHEN ';
    v_sql3 := v_sql3||'                mer_cat_cd in ';
    v_sql3 := v_sql3||'                ( ';
    v_sql3 := v_sql3||'                ''7011'', ';
    v_sql3 := v_sql3||'                ''7012'', ';
    v_sql3 := v_sql3||'                ''5811'', ';
    v_sql3 := v_sql3||'                ''5812'', ';
    v_sql3 := v_sql3||'                ''5813'', ';
    v_sql3 := v_sql3||'                ''5094'', ';
    v_sql3 := v_sql3||'                ''5937'', ';
    v_sql3 := v_sql3||'                ''5950'', ';
    v_sql3 := v_sql3||'                ''5970'', ';
    v_sql3 := v_sql3||'                ''5971'', ';
    v_sql3 := v_sql3||'                ''7297'', ';
    v_sql3 := v_sql3||'                ''7298'', ';
    v_sql3 := v_sql3||'                ''7829'', ';
    v_sql3 := v_sql3||'                ''7911'', ';
    v_sql3 := v_sql3||'                ''7922'', ';
    v_sql3 := v_sql3||'                ''7929'', ';
    v_sql3 := v_sql3||'                ''7932'', ';
    v_sql3 := v_sql3||'                ''7933'', ';
    v_sql3 := v_sql3||'                ''7941'', ';
    v_sql3 := v_sql3||'                ''7992'', ';
    v_sql3 := v_sql3||'                ''7994'', ';
    v_sql3 := v_sql3||'                ''7996'', ';
    v_sql3 := v_sql3||'                ''7997'', ';
    v_sql3 := v_sql3||'                ''7998'', ';
    v_sql3 := v_sql3||'                ''7032'', ';
    v_sql3 := v_sql3||'                ''7033'', ';
    v_sql3 := v_sql3||'                ''5944'', ';
    v_sql3 := v_sql3||'                ''5932'', ';
    v_sql3 := v_sql3||'                ''7631'', ';
    v_sql3 := v_sql3||'                ''7999''  ';
    v_sql3 := v_sql3||'                ) ';
    v_sql3 := v_sql3||'                AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql3 := v_sql3||'                OR E.src_ind = ''I'' ) ';
    v_sql3 := v_sql3||'                AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql3 := v_sql3||'                AND (substr(E.merch_seq,-4,3) + 0) is not null ';
    v_sql3 := v_sql3||'                AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql3 := v_sql3||'                THEN ';
    v_sql3 := v_sql3||'                 CASE ';
    v_sql3 := v_sql3||'                    WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql3 := v_sql3||'                    ELSE E.BILL_AMT ';
    v_sql3 := v_sql3||'                 END ';
    v_sql3 := v_sql3||'              ELSE ';
    v_sql3 := v_sql3||'                 0 ';
    v_sql3 := v_sql3||'              END ';
    v_sql3 := v_sql3||'           ) AS MCC90NETSUM, ';
    v_sql3 := v_sql3||'          SUM(CASE ';
    v_sql3 := v_sql3||'                WHEN ';
    v_sql3 := v_sql3||'                mer_cat_cd in ';
    v_sql3 := v_sql3||'                ( ';
    v_sql3 := v_sql3||'                 ''742'', ';
    v_sql3 := v_sql3||'                 ''763'', ';
    v_sql3 := v_sql3||'                 ''780'', ';
    v_sql3 := v_sql3||'                 ''4011'', ';
    v_sql3 := v_sql3||'                 ''4119'', ';
    v_sql3 := v_sql3||'                 ''4214'', ';
    v_sql3 := v_sql3||'                 ''4215'', ';
    v_sql3 := v_sql3||'                 ''4225'', ';
    v_sql3 := v_sql3||'                 ''4411'', ';
    v_sql3 := v_sql3||'                 ''4457'', ';
    v_sql3 := v_sql3||'                 ''4468'', ';
    v_sql3 := v_sql3||'                 ''4582'', ';
    v_sql3 := v_sql3||'                 ''4722'', ';
    v_sql3 := v_sql3||'                 ''4733'', ';
    v_sql3 := v_sql3||'                 ''4789'', ';
    v_sql3 := v_sql3||'                 ''4812'', ';
    v_sql3 := v_sql3||'                 ''4816'', ';
    v_sql3 := v_sql3||'                 ''4821'', ';
    v_sql3 := v_sql3||'                 ''5211'', ';
    v_sql3 := v_sql3||'                 ''5231'', ';
    v_sql3 := v_sql3||'                 ''5251'', ';
    v_sql3 := v_sql3||'                 ''5261'', ';
    v_sql3 := v_sql3||'                 ''5309'', ';
    v_sql3 := v_sql3||'                 ''5310'', ';
    v_sql3 := v_sql3||'                 ''5311'', ';
    v_sql3 := v_sql3||'                 ''5331'', ';
    v_sql3 := v_sql3||'                 ''5399'', ';
    v_sql3 := v_sql3||'                 ''5422'', ';
    v_sql3 := v_sql3||'                 ''5441'', ';
    v_sql3 := v_sql3||'                 ''5451'', ';
    v_sql3 := v_sql3||'                 ''5462'', ';
    v_sql3 := v_sql3||'                 ''5499'', ';
    v_sql3 := v_sql3||'                 ''5532'', ';
    v_sql3 := v_sql3||'                 ''5533'', ';
    v_sql3 := v_sql3||'                 ''5611'', ';
    v_sql3 := v_sql3||'                 ''5621'', ';
    v_sql3 := v_sql3||'                 ''5631'', ';
    v_sql3 := v_sql3||'                 ''5641'', ';
    v_sql3 := v_sql3||'                 ''5651'', ';
    v_sql3 := v_sql3||'                 ''5655'', ';
    v_sql3 := v_sql3||'                 ''5661'', ';
    v_sql3 := v_sql3||'                 ''5681'', ';
    v_sql3 := v_sql3||'                 ''5691'', ';
    v_sql3 := v_sql3||'                 ''5697'', ';
    v_sql3 := v_sql3||'                 ''5698'', ';
    v_sql3 := v_sql3||'                 ''5699'', ';
    v_sql3 := v_sql3||'                 ''5712'', ';
    v_sql3 := v_sql3||'                 ''5713'', ';
    v_sql3 := v_sql3||'                 ''5714'', ';
    v_sql3 := v_sql3||'                 ''5718'', ';
    v_sql3 := v_sql3||'                 ''5719'', ';
    v_sql3 := v_sql3||'                 ''5732'', ';
    v_sql3 := v_sql3||'                 ''5733'', ';
    v_sql3 := v_sql3||'                 ''5734'', ';
    v_sql3 := v_sql3||'                 ''5735'', ';
    v_sql3 := v_sql3||'                 ''5814'', ';
    v_sql3 := v_sql3||'                 ''5912'', ';
    v_sql3 := v_sql3||'                 ''5921'', ';
    v_sql3 := v_sql3||'                 ''5931'', ';
    v_sql3 := v_sql3||'                 ''5935'', ';
    v_sql3 := v_sql3||'                 ''5940'', ';
    v_sql3 := v_sql3||'                 ''5941'', ';
    v_sql3 := v_sql3||'                 ''5942'', ';
    v_sql3 := v_sql3||'                 ''5943'', ';
    v_sql3 := v_sql3||'                 ''5945'', ';
    v_sql3 := v_sql3||'                 ''5946'', ';
    v_sql3 := v_sql3||'                 ''5947'', ';
    v_sql3 := v_sql3||'                 ''5948'', ';
    v_sql3 := v_sql3||'                 ''5949'', ';
    v_sql3 := v_sql3||'                 ''5962'', ';
    v_sql3 := v_sql3||'                 ''5963'', ';
    v_sql3 := v_sql3||'                 ''5964'', ';
    v_sql3 := v_sql3||'                 ''5965'', ';
    v_sql3 := v_sql3||'                 ''5966'', ';
    v_sql3 := v_sql3||'                 ''5967'', ';
    v_sql3 := v_sql3||'                 ''5968'', ';
    v_sql3 := v_sql3||'                 ''5969'', ';
    v_sql3 := v_sql3||'                 ''5972'', ';
    v_sql3 := v_sql3||'                 ''5973'', ';
    v_sql3 := v_sql3||'                 ''5975'', ';
    v_sql3 := v_sql3||'                 ''5976'', ';
    v_sql3 := v_sql3||'                 ''5977'', ';
    v_sql3 := v_sql3||'                 ''5978'', ';
    v_sql3 := v_sql3||'                 ''5983'', ';
    v_sql3 := v_sql3||'                 ''5992'', ';
    v_sql3 := v_sql3||'                 ''5993'', ';
    v_sql3 := v_sql3||'                 ''5995'', ';
    v_sql3 := v_sql3||'                 ''5996'', ';
    v_sql3 := v_sql3||'                 ''5997'', ';
    v_sql3 := v_sql3||'                 ''5999'', ';
    v_sql3 := v_sql3||'                 ''6010'', ';
    v_sql3 := v_sql3||'                 ''6011'', ';
    v_sql3 := v_sql3||'                 ''6012'', ';
    v_sql3 := v_sql3||'                 ''6051'', ';
    v_sql3 := v_sql3||'                 ''6211'', ';
    v_sql3 := v_sql3||'                 ''6513'', ';
    v_sql3 := v_sql3||'                 ''7210'', ';
    v_sql3 := v_sql3||'                 ''7211'', ';
    v_sql3 := v_sql3||'                 ''7216'', ';
    v_sql3 := v_sql3||'                 ''7217'', ';
    v_sql3 := v_sql3||'                 ''7221'', ';
    v_sql3 := v_sql3||'                 ''7230'', ';
    v_sql3 := v_sql3||'                 ''7251'', ';
    v_sql3 := v_sql3||'                 ''7261'', ';
    v_sql3 := v_sql3||'                 ''7273'', ';
    v_sql3 := v_sql3||'                 ''7276'', ';
    v_sql3 := v_sql3||'                 ''7277'', ';
    v_sql3 := v_sql3||'                 ''7278'', ';
    v_sql3 := v_sql3||'                 ''7295'', ';
    v_sql3 := v_sql3||'                 ''7296'', ';
    v_sql3 := v_sql3||'                 ''7299'', ';
    v_sql3 := v_sql3||'                 ''7311'', ';
    v_sql3 := v_sql3||'                 ''7321'', ';
    v_sql3 := v_sql3||'                 ''7333'', ';
    v_sql3 := v_sql3||'                 ''7338'', ';
    v_sql3 := v_sql3||'                 ''7339'', ';
    v_sql3 := v_sql3||'                 ''7342'', ';
    v_sql3 := v_sql3||'                 ''7349'', ';
    v_sql3 := v_sql3||'                 ''7361'', ';
    v_sql3 := v_sql3||'                 ''7372'', ';
    v_sql3 := v_sql3||'                 ''7375'', ';
    v_sql3 := v_sql3||'                 ''7379'', ';
    v_sql3 := v_sql3||'                 ''7392'', ';
    v_sql3 := v_sql3||'                 ''7393'', ';
    v_sql3 := v_sql3||'                 ''7394'', ';
    v_sql3 := v_sql3||'                 ''7395'', ';
    v_sql3 := v_sql3||'                 ''7399'', ';
    v_sql3 := v_sql3||'                 ''7512'', ';
    v_sql3 := v_sql3||'                 ''7513'', ';
    v_sql3 := v_sql3||'                 ''7519'', ';
    v_sql3 := v_sql3||'                 ''7531'', ';
    v_sql3 := v_sql3||'                 ''7534'', ';
    v_sql3 := v_sql3||'                 ''7535'', ';
    v_sql3 := v_sql3||'                 ''7538'', ';
    v_sql3 := v_sql3||'                 ''7542'', ';
    v_sql3 := v_sql3||'                 ''7549'', ';
    v_sql3 := v_sql3||'                 ''7622'', ';
    v_sql3 := v_sql3||'                 ''7623'', ';
    v_sql3 := v_sql3||'                 ''7629'', ';
    v_sql3 := v_sql3||'                 ''7641'', ';
    v_sql3 := v_sql3||'                 ''7692'', ';
    v_sql3 := v_sql3||'                 ''7699'', ';
    v_sql3 := v_sql3||'                 ''7832'', ';
    v_sql3 := v_sql3||'                 ''7841'', ';
    v_sql3 := v_sql3||'                 ''7991'', ';
    v_sql3 := v_sql3||'                 ''7993'', ';
    v_sql3 := v_sql3||'                 ''7995'', ';
    v_sql3 := v_sql3||'                 ''8011'', ';
    v_sql3 := v_sql3||'                 ''8021'', ';
    v_sql3 := v_sql3||'                 ''8031'', ';
    v_sql3 := v_sql3||'                 ''8041'', ';
    v_sql3 := v_sql3||'                 ''8042'', ';
    v_sql3 := v_sql3||'                 ''8043'', ';
    v_sql3 := v_sql3||'                 ''8049'', ';
    v_sql3 := v_sql3||'                 ''8050'', ';
    v_sql3 := v_sql3||'                 ''8071'', ';
    v_sql3 := v_sql3||'                 ''8099'', ';
    v_sql3 := v_sql3||'                 ''8111'', ';
    v_sql3 := v_sql3||'                 ''8241'', ';
    v_sql3 := v_sql3||'                 ''8244'', ';
    v_sql3 := v_sql3||'                 ''8249'', ';
    v_sql3 := v_sql3||'                 ''8299'', ';
    v_sql3 := v_sql3||'                 ''8351'', ';
    v_sql3 := v_sql3||'                 ''8641'', ';
    v_sql3 := v_sql3||'                 ''8661'', ';
    v_sql3 := v_sql3||'                 ''8675'', ';
    v_sql3 := v_sql3||'                 ''8699'', ';
    v_sql3 := v_sql3||'                 ''8911'', ';
    v_sql3 := v_sql3||'                 ''8912'', ';
    v_sql3 := v_sql3||'                 ''8931'', ';
    v_sql3 := v_sql3||'                 ''8999'', ';
    v_sql3 := v_sql3||'                 ''1001'', ';
    v_sql3 := v_sql3||'                 ''6013''  ';
    v_sql3 := v_sql3||'                ) ';
    v_sql3 := v_sql3||'                AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql3 := v_sql3||'                AND (TRANS_TYPE + 0) is not null ';
    v_sql3 := v_sql3||'                AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql3 := v_sql3||'                AND (substr(E.merch_seq,-4,3) + 0) is not null ';
    v_sql3 := v_sql3||'                AND coal(E.src_ind,'' '') <> ''I'' ';
    v_sql3 := v_sql3||'                AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql3 := v_sql3||'                THEN ';
    v_sql3 := v_sql3||'                 CASE ';
    v_sql3 := v_sql3||'                    WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql3 := v_sql3||'                    ELSE E.BILL_AMT ';
    v_sql3 := v_sql3||'                 END ';
    v_sql3 := v_sql3||'              ELSE ';
    v_sql3 := v_sql3||'                 0 ';
    v_sql3 := v_sql3||'              END ';
    v_sql3 := v_sql3||'           ) AS MCC55SUM, ';
    v_sql3 := v_sql3||'            SUM(CASE ';
    v_sql3 := v_sql3||'                WHEN ';
    v_sql3 := v_sql3||'                mer_cat_cd in ';
    v_sql3 := v_sql3||'                ( ';
    v_sql3 := v_sql3||'                 ''742'',  ';
    v_sql3 := v_sql3||'                 ''763'',  ';
    v_sql3 := v_sql3||'                 ''780'',  ';
    v_sql3 := v_sql3||'                 ''4011'', ';
    v_sql3 := v_sql3||'                 ''4119'', ';
    v_sql3 := v_sql3||'                 ''4214'', ';
    v_sql3 := v_sql3||'                 ''4215'', ';
    v_sql3 := v_sql3||'                 ''4225'', ';
    v_sql3 := v_sql3||'                 ''4411'', ';
    v_sql3 := v_sql3||'                 ''4457'', ';
    v_sql3 := v_sql3||'                 ''4468'', ';
    v_sql3 := v_sql3||'                 ''4582'', ';
    v_sql3 := v_sql3||'                 ''4722'', ';
    v_sql3 := v_sql3||'                 ''4733'', ';
    v_sql3 := v_sql3||'                 ''4789'', ';
    v_sql3 := v_sql3||'                 ''4812'', ';
    v_sql3 := v_sql3||'                 ''4816'', ';
    v_sql3 := v_sql3||'                 ''4821'', ';
    v_sql3 := v_sql3||'                 ''5211'', ';
    v_sql3 := v_sql3||'                 ''5231'', ';
    v_sql3 := v_sql3||'                 ''5251'', ';
    v_sql3 := v_sql3||'                 ''5261'', ';
    v_sql3 := v_sql3||'                 ''5309'', ';
    v_sql3 := v_sql3||'                 ''5310'', ';
    v_sql3 := v_sql3||'                 ''5311'', ';
    v_sql3 := v_sql3||'                 ''5331'', ';
    v_sql3 := v_sql3||'                 ''5399'', ';
    v_sql3 := v_sql3||'                 ''5422'', ';
    v_sql3 := v_sql3||'                 ''5441'', ';
    v_sql3 := v_sql3||'                 ''5451'', ';
    v_sql3 := v_sql3||'                 ''5462'', ';
    v_sql3 := v_sql3||'                 ''5499'', ';
    v_sql3 := v_sql3||'                 ''5532'', ';
    v_sql3 := v_sql3||'                 ''5533'', ';
    v_sql3 := v_sql3||'                 ''5611'', ';
    v_sql3 := v_sql3||'                 ''5621'', ';
    v_sql3 := v_sql3||'                 ''5631'', ';
    v_sql3 := v_sql3||'                 ''5641'', ';
    v_sql3 := v_sql3||'                 ''5651'', ';
    v_sql3 := v_sql3||'                 ''5655'', ';
    v_sql3 := v_sql3||'                 ''5661'', ';
    v_sql3 := v_sql3||'                 ''5681'', ';
    v_sql3 := v_sql3||'                 ''5691'', ';
    v_sql3 := v_sql3||'                 ''5697'', ';
    v_sql3 := v_sql3||'                 ''5698'', ';
    v_sql3 := v_sql3||'                 ''5699'', ';
    v_sql3 := v_sql3||'                 ''5712'', ';
    v_sql3 := v_sql3||'                 ''5713'', ';
    v_sql3 := v_sql3||'                 ''5714'', ';
    v_sql3 := v_sql3||'                 ''5718'', ';
    v_sql3 := v_sql3||'                 ''5719'', ';
    v_sql3 := v_sql3||'                 ''5732'', ';
    v_sql3 := v_sql3||'                 ''5733'', ';
    v_sql3 := v_sql3||'                 ''5734'', ';
    v_sql3 := v_sql3||'                 ''5735'', ';
    v_sql3 := v_sql3||'                 ''5814'', ';
    v_sql3 := v_sql3||'                 ''5912'', ';
    v_sql3 := v_sql3||'                 ''5921'', ';
    v_sql3 := v_sql3||'                 ''5931'', ';
    v_sql3 := v_sql3||'                 ''5935'', ';
    v_sql3 := v_sql3||'                 ''5940'', ';
    v_sql3 := v_sql3||'                 ''5941'', ';
    v_sql3 := v_sql3||'                 ''5942'', ';
    v_sql3 := v_sql3||'                 ''5943'', ';
    v_sql3 := v_sql3||'                 ''5945'', ';
    v_sql3 := v_sql3||'                 ''5946'', ';
    v_sql3 := v_sql3||'                 ''5947'', ';
    v_sql3 := v_sql3||'                 ''5948'', ';
    v_sql3 := v_sql3||'                 ''5949'', ';
    v_sql3 := v_sql3||'                 ''5962'', ';
    v_sql3 := v_sql3||'                 ''5963'', ';
    v_sql3 := v_sql3||'                 ''5964'', ';
    v_sql3 := v_sql3||'                 ''5965'', ';
    v_sql3 := v_sql3||'                 ''5966'', ';
    v_sql3 := v_sql3||'                 ''5967'', ';
    v_sql3 := v_sql3||'                 ''5968'', ';
    v_sql3 := v_sql3||'                 ''5969'', ';
    v_sql3 := v_sql3||'                 ''5972'', ';
    v_sql3 := v_sql3||'                 ''5973'', ';
    v_sql3 := v_sql3||'                 ''5975'', ';
    v_sql3 := v_sql3||'                 ''5976'', ';
    v_sql3 := v_sql3||'                 ''5977'', ';
    v_sql3 := v_sql3||'                 ''5978'', ';
    v_sql3 := v_sql3||'                 ''5983'', ';
    v_sql3 := v_sql3||'                 ''5992'', ';
    v_sql3 := v_sql3||'                 ''5993'', ';
    v_sql3 := v_sql3||'                 ''5995'', ';
    v_sql3 := v_sql3||'                 ''5996'', ';
    v_sql3 := v_sql3||'                 ''5997'', ';
    v_sql3 := v_sql3||'                 ''5999'', ';
    v_sql3 := v_sql3||'                 ''6010'', ';
    v_sql3 := v_sql3||'                 ''6011'', ';
    v_sql3 := v_sql3||'                 ''6012'', ';
    v_sql3 := v_sql3||'                 ''6051'', ';
    v_sql3 := v_sql3||'                 ''6211'', ';
    v_sql3 := v_sql3||'                 ''6513'', ';
    v_sql3 := v_sql3||'                 ''7210'', ';
    v_sql3 := v_sql3||'                 ''7211'', ';
    v_sql3 := v_sql3||'                 ''7216'', ';
    v_sql3 := v_sql3||'                 ''7217'', ';
    v_sql3 := v_sql3||'                 ''7221'', ';
    v_sql3 := v_sql3||'                 ''7230'', ';
    v_sql3 := v_sql3||'                 ''7251'', ';
    v_sql3 := v_sql3||'                 ''7261'', ';
    v_sql3 := v_sql3||'                 ''7273'', ';
    v_sql3 := v_sql3||'                 ''7276'', ';
    v_sql3 := v_sql3||'                 ''7277'', ';
    v_sql3 := v_sql3||'                 ''7278'', ';
    v_sql3 := v_sql3||'                 ''7295'', ';
    v_sql3 := v_sql3||'                 ''7296'', ';
    v_sql3 := v_sql3||'                 ''7299'', ';
    v_sql3 := v_sql3||'                 ''7311'', ';
    v_sql3 := v_sql3||'                 ''7321'', ';
    v_sql3 := v_sql3||'                 ''7333'', ';
    v_sql3 := v_sql3||'                 ''7338'', ';
    v_sql3 := v_sql3||'                 ''7339'', ';
    v_sql3 := v_sql3||'                 ''7342'', ';
    v_sql3 := v_sql3||'                 ''7349'', ';
    v_sql3 := v_sql3||'                 ''7361'', ';
    v_sql3 := v_sql3||'                 ''7372'', ';
    v_sql3 := v_sql3||'                 ''7375'', ';
    v_sql3 := v_sql3||'                 ''7379'', ';
    v_sql3 := v_sql3||'                 ''7392'', ';
    v_sql3 := v_sql3||'                 ''7393'', ';
    v_sql3 := v_sql3||'                 ''7394'', ';
    v_sql3 := v_sql3||'                 ''7395'', ';
    v_sql3 := v_sql3||'                 ''7399'', ';
    v_sql3 := v_sql3||'                 ''7512'', ';
    v_sql3 := v_sql3||'                 ''7513'', ';
    v_sql3 := v_sql3||'                 ''7519'', ';
    v_sql3 := v_sql3||'                 ''7531'', ';
    v_sql3 := v_sql3||'                 ''7534'', ';
    v_sql3 := v_sql3||'                 ''7535'', ';
    v_sql3 := v_sql3||'                 ''7538'', ';
    v_sql3 := v_sql3||'                 ''7542'', ';
    v_sql3 := v_sql3||'                 ''7549'', ';
    v_sql3 := v_sql3||'                 ''7622'', ';
    v_sql3 := v_sql3||'                 ''7623'', ';
    v_sql3 := v_sql3||'                 ''7629'', ';
    v_sql3 := v_sql3||'                 ''7641'', ';
    v_sql3 := v_sql3||'                 ''7692'', ';
    v_sql3 := v_sql3||'                 ''7699'', ';
    v_sql3 := v_sql3||'                 ''7832'', ';
    v_sql3 := v_sql3||'                 ''7841'', ';
    v_sql3 := v_sql3||'                 ''7991'', ';
    v_sql3 := v_sql3||'                 ''7993'', ';
    v_sql3 := v_sql3||'                 ''7995'', ';
    v_sql3 := v_sql3||'                 ''8011'', ';
    v_sql3 := v_sql3||'                 ''8021'', ';
    v_sql3 := v_sql3||'                 ''8031'', ';
    v_sql3 := v_sql3||'                 ''8041'', ';
    v_sql3 := v_sql3||'                 ''8042'', ';
    v_sql3 := v_sql3||'                 ''8043'', ';
    v_sql3 := v_sql3||'                 ''8049'', ';
    v_sql3 := v_sql3||'                 ''8050'', ';
    v_sql3 := v_sql3||'                 ''8071'', ';
    v_sql3 := v_sql3||'                 ''8099'', ';
    v_sql3 := v_sql3||'                 ''8111'', ';
    v_sql3 := v_sql3||'                 ''8241'', ';
    v_sql3 := v_sql3||'                 ''8244'', ';
    v_sql3 := v_sql3||'                 ''8249'', ';
    v_sql3 := v_sql3||'                 ''8299'', ';
    v_sql3 := v_sql3||'                 ''8351'', ';
    v_sql3 := v_sql3||'                 ''8641'', ';
    v_sql3 := v_sql3||'                 ''8661'', ';
    v_sql3 := v_sql3||'                 ''8675'', ';
    v_sql3 := v_sql3||'                 ''8699'', ';
    v_sql3 := v_sql3||'                 ''8911'', ';
    v_sql3 := v_sql3||'                 ''8912'', ';
    v_sql3 := v_sql3||'                 ''8931'', ';
    v_sql3 := v_sql3||'                 ''8999'', ';
    v_sql3 := v_sql3||'                 ''1001'', ';
    v_sql3 := v_sql3||'                 ''6013''  ';
    v_sql3 := v_sql3||'                ) ';
    v_sql3 := v_sql3||'                AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql3 := v_sql3||'                OR E.src_ind = ''I'' ) ';
    v_sql3 := v_sql3||'                AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql3 := v_sql3||'                AND (substr(E.merch_seq,-4,3) + 0) is not null ';
    v_sql3 := v_sql3||'                AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql3 := v_sql3||'                THEN ';
    v_sql3 := v_sql3||'                 CASE ';
    v_sql3 := v_sql3||'                    WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql3 := v_sql3||'                    ELSE E.BILL_AMT ';
    v_sql3 := v_sql3||'                 END ';
    v_sql3 := v_sql3||'              ELSE ';
    v_sql3 := v_sql3||'                 0 ';
    v_sql3 := v_sql3||'              END ';
    v_sql3 := v_sql3||'           ) AS MCC55NETSUM, ';
    v_sql3 := v_sql3||'         SUM(CASE ';
    v_sql3 := v_sql3||'                WHEN ';
    v_sql3 := v_sql3||'                mer_cat_cd in ';
    v_sql3 := v_sql3||'                ( ';
    v_sql3 := v_sql3||'                 ''5541'', ';
    v_sql3 := v_sql3||'                 ''5542'', ';
    v_sql3 := v_sql3||'                 ''5411'', ';
    v_sql3 := v_sql3||'                 ''5722'', ';
    v_sql3 := v_sql3||'                 ''4511'', ';
    v_sql3 := v_sql3||'                 ''4111'', ';
    v_sql3 := v_sql3||'                 ''4121'', ';
    v_sql3 := v_sql3||'                 ''4131'', ';
    v_sql3 := v_sql3||'                 ''4784'', ';
    v_sql3 := v_sql3||'                 ''3998'', ';
    v_sql3 := v_sql3||'                 ''4112'', ';
    v_sql3 := v_sql3||'                 ''4900'', ';
    v_sql3 := v_sql3||'                 ''4814'', ';
    v_sql3 := v_sql3||'                 ''4899'', ';
    v_sql3 := v_sql3||'                 ''6300'', ';
    v_sql3 := v_sql3||'                 ''5960'', ';
    v_sql3 := v_sql3||'                 ''8651'', ';
    v_sql3 := v_sql3||'                 ''9211'', ';
    v_sql3 := v_sql3||'                 ''9222'', ';
    v_sql3 := v_sql3||'                 ''9223'', ';
    v_sql3 := v_sql3||'                 ''9311'', ';
    v_sql3 := v_sql3||'                 ''9399'', ';
    v_sql3 := v_sql3||'                 ''9400'', ';
    v_sql3 := v_sql3||'                 ''5994'', ';
    v_sql3 := v_sql3||'                 ''7523'', ';
    v_sql3 := v_sql3||'                 ''9402''  ';
    v_sql3 := v_sql3||'                ) ';
    v_sql3 := v_sql3||'                AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql3 := v_sql3||'                AND (TRANS_TYPE + 0) is not null ';
    v_sql3 := v_sql3||'                AND coal(E.src_ind,'' '') <> ''I'' ';
    v_sql3 := v_sql3||'                AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql3 := v_sql3||'                AND (substr(E.merch_seq,-4,3) + 0) is not null ';
    v_sql3 := v_sql3||'                AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql3 := v_sql3||'                THEN ';
    v_sql3 := v_sql3||'                 CASE ';
    v_sql3 := v_sql3||'                    WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql3 := v_sql3||'                    ELSE E.BILL_AMT ';
    v_sql3 := v_sql3||'                 END ';
    v_sql3 := v_sql3||'              ELSE ';
    v_sql3 := v_sql3||'                 0 ';
    v_sql3 := v_sql3||'              END ';
    v_sql3 := v_sql3||'           ) AS MCC26SUM, ';
    v_sql3 := v_sql3||'                  SUM(CASE ';
    v_sql3 := v_sql3||'                WHEN ';
    v_sql3 := v_sql3||'                mer_cat_cd in ';
    v_sql3 := v_sql3||'                ( ';
    v_sql3 := v_sql3||'                 ''5541'', ';
    v_sql3 := v_sql3||'                 ''5542'', ';
    v_sql3 := v_sql3||'                 ''5411'', ';
    v_sql3 := v_sql3||'                 ''5722'', ';
    v_sql3 := v_sql3||'                 ''4511'', ';
    v_sql3 := v_sql3||'                 ''4111'', ';
    v_sql3 := v_sql3||'                 ''4121'', ';
    v_sql3 := v_sql3||'                 ''4131'', ';
    v_sql3 := v_sql3||'                 ''4784'', ';
    v_sql3 := v_sql3||'                 ''3998'', ';
    v_sql3 := v_sql3||'                 ''4112'', ';
    v_sql3 := v_sql3||'                 ''4900'', ';
    v_sql3 := v_sql3||'                 ''4814'', ';
    v_sql3 := v_sql3||'                 ''4899'', ';
    v_sql3 := v_sql3||'                 ''6300'', ';
    v_sql3 := v_sql3||'                 ''5960'', ';
    v_sql3 := v_sql3||'                 ''8651'', ';
    v_sql3 := v_sql3||'                 ''9211'', ';
    v_sql3 := v_sql3||'                 ''9222'', ';
    v_sql3 := v_sql3||'                 ''9223'', ';
    v_sql3 := v_sql3||'                 ''9311'', ';
    v_sql3 := v_sql3||'                 ''9399'', ';
    v_sql3 := v_sql3||'                 ''9400'', ';
    v_sql3 := v_sql3||'                 ''5994'', ';
    v_sql3 := v_sql3||'                 ''7523'', ';
    v_sql3 := v_sql3||'                 ''9402''  ';
    v_sql3 := v_sql3||'                ) ';
    v_sql3 := v_sql3||'                AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql3 := v_sql3||'                OR E.src_ind = ''I'' ) ';
    v_sql3 := v_sql3||'                AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql3 := v_sql3||'                AND (substr(E.merch_seq,-4,3) + 0) is not null ';
    v_sql3 := v_sql3||'                AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql3 := v_sql3||'                THEN ';
    v_sql3 := v_sql3||'                 CASE ';
    v_sql3 := v_sql3||'                    WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql3 := v_sql3||'                    ELSE E.BILL_AMT ';
    v_sql3 := v_sql3||'                 END ';
    v_sql3 := v_sql3||'              ELSE ';
    v_sql3 := v_sql3||'                 0 ';
    v_sql3 := v_sql3||'              END ';
    v_sql3 := v_sql3||'           ) AS MCC26NETSUM, ';
    v_sql3 := v_sql3||'                           SUM(CASE ';
    v_sql3 := v_sql3||'                WHEN ';
    v_sql3 := v_sql3||'                     TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql3 := v_sql3||'                AND coal(E.Src_Ind,'' '') <> ''I'' ';
    v_sql3 := v_sql3||'                AND ( coal(E.MERCH_STAT,'' '') <> ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql3 := v_sql3||'                THEN ';
    v_sql3 := v_sql3||'                 CASE ';
    v_sql3 := v_sql3||'                    WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql3 := v_sql3||'                    ELSE E.BILL_AMT ';
    v_sql3 := v_sql3||'                 END ';
    v_sql3 := v_sql3||'              ELSE ';
    v_sql3 := v_sql3||'                 0 ';
    v_sql3 := v_sql3||'              END ';
    v_sql3 := v_sql3||'           ) AS JW120SUM, ';
    v_sql3 := v_sql3||'                  SUM(CASE ';
    v_sql3 := v_sql3||'                WHEN ';
    v_sql3 := v_sql3||'               TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql3 := v_sql3||'                AND E.Src_Ind = ''I'' ';
    v_sql3 := v_sql3||'                AND ( coal(E.MERCH_STAT,'' '') <> ''156'' and (E.MERCH_STAT + 0) is not null ) ';
    v_sql3 := v_sql3||'                THEN ';
    v_sql3 := v_sql3||'                 CASE ';
    v_sql3 := v_sql3||'                    WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql3 := v_sql3||'                    ELSE E.BILL_AMT ';
    v_sql3 := v_sql3||'                 END ';
    v_sql3 := v_sql3||'              ELSE ';
    v_sql3 := v_sql3||'                 0 ';
    v_sql3 := v_sql3||'              END ';
    v_sql3 := v_sql3||'           ) AS JW120NETSUM, ';
    v_sql3 := v_sql3||'          SUM(CASE ';
    v_sql3 := v_sql3||'                WHEN ';
    v_sql3 := v_sql3||'                  (E.MER_CAT_CD IN (''1520'', ';
    v_sql3 := v_sql3||'                                    ''7013'', ';
    v_sql3 := v_sql3||'                                    ''5271'', ';
    v_sql3 := v_sql3||'                                    ''5511'', ';
    v_sql3 := v_sql3||'                                    ''5521'', ';
    v_sql3 := v_sql3||'                                    ''5551'', ';
    v_sql3 := v_sql3||'                                    ''5561'', ';
    v_sql3 := v_sql3||'                                    ''5571'', ';
    v_sql3 := v_sql3||'                                    ''5592'', ';
    v_sql3 := v_sql3||'                                    ''5598'', ';
    v_sql3 := v_sql3||'                                    ''5599'', ';
    v_sql3 := v_sql3||'                                    ''5933'', ';
    v_sql3 := v_sql3||'                                    ''8062'', ';
    v_sql3 := v_sql3||'                                    ''8211'', ';
    v_sql3 := v_sql3||'                                    ''8220'', ';
    v_sql3 := v_sql3||'                                    ''8398'', ';
    v_sql3 := v_sql3||'                                    ''5021'', ';
    v_sql3 := v_sql3||'                                    ''5039'', ';
    v_sql3 := v_sql3||'                                    ''5044'', ';
    v_sql3 := v_sql3||'                                    ''5045'', ';
    v_sql3 := v_sql3||'                                    ''5046'', ';
    v_sql3 := v_sql3||'                                    ''5047'', ';
    v_sql3 := v_sql3||'                                    ''5051'', ';
    v_sql3 := v_sql3||'                                    ''5065'', ';
    v_sql3 := v_sql3||'                                    ''5072'', ';
    v_sql3 := v_sql3||'                                    ''5074'', ';
    v_sql3 := v_sql3||'                                    ''5111'', ';
    v_sql3 := v_sql3||'                                    ''5122'', ';
    v_sql3 := v_sql3||'                                    ''5131'', ';
    v_sql3 := v_sql3||'                                    ''5137'', ';
    v_sql3 := v_sql3||'                                    ''5139'', ';
    v_sql3 := v_sql3||'                                    ''5172'', ';
    v_sql3 := v_sql3||'                                    ''5192'', ';
    v_sql3 := v_sql3||'                                    ''5193'', ';
    v_sql3 := v_sql3||'                                    ''5198'', ';
    v_sql3 := v_sql3||'                                    ''5998'', ';
    v_sql3 := v_sql3||'                                    ''5013'', ';
    v_sql3 := v_sql3||'                                    ''5398'', ';
    v_sql3 := v_sql3||'                                    ''4458'', ';
    v_sql3 := v_sql3||'                                    ''9498'', ';
    v_sql3 := v_sql3||'                                    ''9703'', ';
    v_sql3 := v_sql3||'                                    ''9704'', ';
    v_sql3 := v_sql3||'                                    ''9705'', ';
    v_sql3 := v_sql3||'                                    ''9706'', ';
    v_sql3 := v_sql3||'                                    ''9707'', ';
    v_sql3 := v_sql3||'                                    ''9708'', ';
    v_sql3 := v_sql3||'                                    ''5200'', ';
    v_sql3 := v_sql3||'                                    ''5300'') ';
    v_sql3 := v_sql3||'                                    OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql3 := v_sql3||'                AND E.TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql3 := v_sql3||'                AND (E.TRANS_TYPE + 0) is not null ';
    v_sql3 := v_sql3||'                AND coal(E.src_ind,'' '') <> ''I'' ';
    v_sql3 := v_sql3||'                AND BILL_AMT <= 3500 ';
    v_sql3 := v_sql3||'                AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql3 := v_sql3||'                THEN ';
    v_sql3 := v_sql3||'                 CASE ';
    v_sql3 := v_sql3||'                    WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql3 := v_sql3||'                    ELSE E.BILL_AMT ';
    v_sql3 := v_sql3||'                 END ';
    v_sql3 := v_sql3||'              ELSE ';
    v_sql3 := v_sql3||'                 0 ';
    v_sql3 := v_sql3||'              END ';
    v_sql3 := v_sql3||'           ) AS DLSUM, ';
    v_sql3 := v_sql3||'            SUM(CASE ';
    v_sql3 := v_sql3||'                WHEN ';
    v_sql3 := v_sql3||'                  (E.MER_CAT_CD IN (''1520'', ';
    v_sql3 := v_sql3||'                                    ''7013'', ';
    v_sql3 := v_sql3||'                                    ''5271'', ';
    v_sql3 := v_sql3||'                                    ''5511'', ';
    v_sql3 := v_sql3||'                                    ''5521'', ';
    v_sql3 := v_sql3||'                                    ''5551'', ';
    v_sql3 := v_sql3||'                                    ''5561'', ';
    v_sql3 := v_sql3||'                                    ''5571'', ';
    v_sql3 := v_sql3||'                                    ''5592'', ';
    v_sql3 := v_sql3||'                                    ''5598'', ';
    v_sql3 := v_sql3||'                                    ''5599'', ';
    v_sql3 := v_sql3||'                                    ''5933'', ';
    v_sql3 := v_sql3||'                                    ''8062'', ';
    v_sql3 := v_sql3||'                                    ''8211'', ';
    v_sql3 := v_sql3||'                                    ''8220'', ';
    v_sql3 := v_sql3||'                                    ''8398'', ';
    v_sql3 := v_sql3||'                                    ''5021'', ';
    v_sql3 := v_sql3||'                                    ''5039'', ';
    v_sql3 := v_sql3||'                                    ''5044'', ';
    v_sql3 := v_sql3||'                                    ''5045'', ';
    v_sql3 := v_sql3||'                                    ''5046'', ';
    v_sql3 := v_sql3||'                                    ''5047'', ';
    v_sql3 := v_sql3||'                                    ''5051'', ';
    v_sql3 := v_sql3||'                                    ''5065'', ';
    v_sql3 := v_sql3||'                                    ''5072'', ';
    v_sql3 := v_sql3||'                                    ''5074'', ';
    v_sql3 := v_sql3||'                                    ''5111'', ';
    v_sql3 := v_sql3||'                                    ''5122'', ';
    v_sql3 := v_sql3||'                                    ''5131'', ';
    v_sql3 := v_sql3||'                                    ''5137'', ';
    v_sql3 := v_sql3||'                                    ''5139'', ';
    v_sql3 := v_sql3||'                                    ''5172'', ';
    v_sql3 := v_sql3||'                                    ''5192'', ';
    v_sql3 := v_sql3||'                                    ''5193'', ';
    v_sql3 := v_sql3||'                                    ''5198'', ';
    v_sql3 := v_sql3||'                                    ''5998'', ';
    v_sql3 := v_sql3||'                                    ''5013'', ';
    v_sql3 := v_sql3||'                                    ''5398'', ';
    v_sql3 := v_sql3||'                                    ''4458'', ';
    v_sql3 := v_sql3||'                                    ''9498'', ';
    v_sql3 := v_sql3||'                                    ''9703'', ';
    v_sql3 := v_sql3||'                                    ''9704'', ';
    v_sql3 := v_sql3||'                                    ''9705'', ';
    v_sql3 := v_sql3||'                                    ''9706'', ';
    v_sql3 := v_sql3||'                                    ''9707'', ';
    v_sql3 := v_sql3||'                                    ''9708'', ';
    v_sql3 := v_sql3||'                                    ''5200'', ';
    v_sql3 := v_sql3||'                                    ''5300'') ';
    v_sql3 := v_sql3||'                                    OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql3 := v_sql3||'                AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql3 := v_sql3||'                OR E.src_ind = ''I'' ) ';
    v_sql3 := v_sql3||'                AND BILL_AMT <= 3500 ';
    v_sql3 := v_sql3||'                AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql3 := v_sql3||'                THEN ';
    v_sql3 := v_sql3||'                 CASE ';
    v_sql3 := v_sql3||'                    WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql3 := v_sql3||'                    ELSE E.BILL_AMT ';
    v_sql3 := v_sql3||'                 END ';
    v_sql3 := v_sql3||'              ELSE ';
    v_sql3 := v_sql3||'                 0 ';
    v_sql3 := v_sql3||'              END ';
    v_sql3 := v_sql3||'           ) AS DLNETSUM, ';
    v_sql3 := v_sql3||'                             COUNT(CASE ';
    v_sql3 := v_sql3||'                WHEN ';
    v_sql3 := v_sql3||'                mer_cat_cd in ';
    v_sql3 := v_sql3||'                ( ';
    v_sql3 := v_sql3||'                ''7011'', ';
    v_sql3 := v_sql3||'                ''7012'', ';
    v_sql3 := v_sql3||'                ''5811'', ';
    v_sql3 := v_sql3||'                ''5812'', ';
    v_sql3 := v_sql3||'                ''5813'', ';
    v_sql3 := v_sql3||'                ''5094'', ';
    v_sql3 := v_sql3||'                ''5937'', ';
    v_sql3 := v_sql3||'                ''5950'', ';
    v_sql3 := v_sql3||'                ''5970'', ';
    v_sql3 := v_sql3||'                ''5971'', ';
    v_sql3 := v_sql3||'                ''7297'', ';
    v_sql3 := v_sql3||'                ''7298'', ';
    v_sql3 := v_sql3||'                ''7829'', ';
    v_sql3 := v_sql3||'                ''7911'', ';
    v_sql3 := v_sql3||'                ''7922'', ';
    v_sql3 := v_sql3||'                ''7929'', ';
    v_sql3 := v_sql3||'                ''7932'', ';
    v_sql3 := v_sql3||'                ''7933'', ';
    v_sql3 := v_sql3||'                ''7941'', ';
    v_sql3 := v_sql3||'                ''7992'', ';
    v_sql3 := v_sql3||'                ''7994'', ';
    v_sql3 := v_sql3||'                ''7996'', ';
    v_sql3 := v_sql3||'                ''7997'', ';
    v_sql3 := v_sql3||'                ''7998'', ';
    v_sql3 := v_sql3||'                ''7032'', ';
    v_sql3 := v_sql3||'                ''7033'', ';
    v_sql3 := v_sql3||'                ''5944'', ';
    v_sql3 := v_sql3||'                ''5932'', ';
    v_sql3 := v_sql3||'                ''7631'', ';
    v_sql3 := v_sql3||'                ''7999''  ';
    v_sql3 := v_sql3||'                ) ';
    v_sql3 := v_sql3||'                AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql3 := v_sql3||'                AND (TRANS_TYPE + 0) is not null ';
    v_sql3 := v_sql3||'                AND coal(E.src_ind,'' '') <> ''I'' ';
    v_sql3 := v_sql3||'                AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql3 := v_sql3||'                AND (substr(E.merch_seq,-4,3) + 0) is not null ';
    v_sql3 := v_sql3||'                AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql3 := v_sql3||'                THEN ';
    v_sql3 := v_sql3||'                 1 ';
    v_sql3 := v_sql3||'              ELSE ';
    v_sql3 := v_sql3||'                 NULL ';
    v_sql3 := v_sql3||'              END ';
    v_sql3 := v_sql3||'           ) AS MCC90COUNT, ';
    v_sql3 := v_sql3||'                        COUNT(CASE ';
    v_sql3 := v_sql3||'                WHEN ';
    v_sql3 := v_sql3||'                mer_cat_cd in ';
    v_sql3 := v_sql3||'                ( ';
    v_sql3 := v_sql3||'                ''7011'', ';
    v_sql3 := v_sql3||'                ''7012'', ';
    v_sql3 := v_sql3||'                ''5811'', ';
    v_sql3 := v_sql3||'                ''5812'', ';
    v_sql3 := v_sql3||'                ''5813'', ';
    v_sql3 := v_sql3||'                ''5094'', ';
    v_sql3 := v_sql3||'                ''5937'', ';
    v_sql3 := v_sql3||'                ''5950'', ';
    v_sql3 := v_sql3||'                ''5970'', ';
    v_sql3 := v_sql3||'                ''5971'', ';
    v_sql3 := v_sql3||'                ''7297'', ';
    v_sql3 := v_sql3||'                ''7298'', ';
    v_sql3 := v_sql3||'                ''7829'', ';
    v_sql3 := v_sql3||'                ''7911'', ';
    v_sql3 := v_sql3||'                ''7922'', ';
    v_sql3 := v_sql3||'                ''7929'', ';
    v_sql3 := v_sql3||'                ''7932'', ';
    v_sql3 := v_sql3||'                ''7933'', ';
    v_sql3 := v_sql3||'                ''7941'', ';
    v_sql3 := v_sql3||'                ''7992'', ';
    v_sql3 := v_sql3||'                ''7994'', ';
    v_sql3 := v_sql3||'                ''7996'', ';
    v_sql3 := v_sql3||'                ''7997'', ';
    v_sql3 := v_sql3||'                ''7998'', ';
    v_sql3 := v_sql3||'                ''7032'', ';
    v_sql3 := v_sql3||'                ''7033'', ';
    v_sql3 := v_sql3||'                ''5944'', ';
    v_sql3 := v_sql3||'                ''5932'', ';
    v_sql3 := v_sql3||'                ''7631'', ';
    v_sql3 := v_sql3||'                ''7999''  ';
    v_sql3 := v_sql3||'                ) ';
    v_sql3 := v_sql3||'                AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql3 := v_sql3||'                OR E.src_ind = ''I'' ) ';
    v_sql3 := v_sql3||'                AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql3 := v_sql3||'                AND (substr(E.merch_seq,-4,3) + 0) is not null ';
    v_sql3 := v_sql3||'                AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql3 := v_sql3||'                THEN ';
    v_sql3 := v_sql3||'                 1 ';
    v_sql3 := v_sql3||'              ELSE ';
    v_sql3 := v_sql3||'                 NULL ';
    v_sql3 := v_sql3||'              END ';
    v_sql3 := v_sql3||'           ) AS MCC90NETCOUNT, ';
    v_sql3 := v_sql3||'          COUNT(CASE ';
    v_sql3 := v_sql3||'                WHEN ';
    v_sql3 := v_sql3||'                mer_cat_cd in ';
    v_sql3 := v_sql3||'                ( ';
    v_sql3 := v_sql3||'                 ''742'', ';
    v_sql3 := v_sql3||'                 ''763'', ';
    v_sql3 := v_sql3||'                 ''780'', ';
    v_sql3 := v_sql3||'                 ''4011'', ';
    v_sql3 := v_sql3||'                 ''4119'', ';
    v_sql3 := v_sql3||'                 ''4214'', ';
    v_sql3 := v_sql3||'                 ''4215'', ';
    v_sql3 := v_sql3||'                 ''4225'', ';
    v_sql3 := v_sql3||'                 ''4411'', ';
    v_sql3 := v_sql3||'                 ''4457'', ';
    v_sql3 := v_sql3||'                 ''4468'', ';
    v_sql3 := v_sql3||'                 ''4582'', ';
    v_sql3 := v_sql3||'                 ''4722'', ';
    v_sql3 := v_sql3||'                 ''4733'', ';
    v_sql3 := v_sql3||'                 ''4789'', ';
    v_sql3 := v_sql3||'                 ''4812'', ';
    v_sql3 := v_sql3||'                 ''4816'', ';
    v_sql3 := v_sql3||'                 ''4821'', ';
    v_sql3 := v_sql3||'                 ''5211'', ';
    v_sql3 := v_sql3||'                 ''5231'', ';
    v_sql3 := v_sql3||'                 ''5251'', ';
    v_sql3 := v_sql3||'                 ''5261'', ';
    v_sql3 := v_sql3||'                 ''5309'', ';
    v_sql3 := v_sql3||'                 ''5310'', ';
    v_sql3 := v_sql3||'                 ''5311'', ';
    v_sql3 := v_sql3||'                 ''5331'', ';
    v_sql3 := v_sql3||'                 ''5399'', ';
    v_sql3 := v_sql3||'                 ''5422'', ';
    v_sql3 := v_sql3||'                 ''5441'', ';
    v_sql3 := v_sql3||'                 ''5451'', ';
    v_sql3 := v_sql3||'                 ''5462'', ';
    v_sql3 := v_sql3||'                 ''5499'', ';
    v_sql3 := v_sql3||'                 ''5532'', ';
    v_sql3 := v_sql3||'                 ''5533'', ';
    v_sql3 := v_sql3||'                 ''5611'', ';
    v_sql3 := v_sql3||'                 ''5621'', ';
    v_sql3 := v_sql3||'                 ''5631'', ';
    v_sql3 := v_sql3||'                 ''5641'', ';
    v_sql3 := v_sql3||'                 ''5651'', ';
    v_sql3 := v_sql3||'                 ''5655'', ';
    v_sql3 := v_sql3||'                 ''5661'', ';
    v_sql3 := v_sql3||'                 ''5681'', ';
    v_sql3 := v_sql3||'                 ''5691'', ';
    v_sql3 := v_sql3||'                 ''5697'', ';
    v_sql3 := v_sql3||'                 ''5698'', ';
    v_sql3 := v_sql3||'                 ''5699'', ';
    v_sql3 := v_sql3||'                 ''5712'', ';
    v_sql3 := v_sql3||'                 ''5713'', ';
    v_sql3 := v_sql3||'                 ''5714'', ';
    v_sql3 := v_sql3||'                 ''5718'', ';
    v_sql3 := v_sql3||'                 ''5719'', ';
    v_sql3 := v_sql3||'                 ''5732'', ';
    v_sql3 := v_sql3||'                 ''5733'', ';
    v_sql3 := v_sql3||'                 ''5734'', ';
    v_sql3 := v_sql3||'                 ''5735'', ';
    v_sql3 := v_sql3||'                 ''5814'', ';
    v_sql3 := v_sql3||'                 ''5912'', ';
    v_sql3 := v_sql3||'                 ''5921'', ';
    v_sql3 := v_sql3||'                 ''5931'', ';
    v_sql3 := v_sql3||'                 ''5935'', ';
    v_sql3 := v_sql3||'                 ''5940'', ';
    v_sql3 := v_sql3||'                 ''5941'', ';
    v_sql3 := v_sql3||'                 ''5942'', ';
    v_sql3 := v_sql3||'                 ''5943'', ';
    v_sql3 := v_sql3||'                 ''5945'', ';
    v_sql3 := v_sql3||'                 ''5946'', ';
    v_sql3 := v_sql3||'                 ''5947'', ';
    v_sql3 := v_sql3||'                 ''5948'', ';
    v_sql3 := v_sql3||'                 ''5949'', ';
    v_sql3 := v_sql3||'                 ''5962'', ';
    v_sql3 := v_sql3||'                 ''5963'', ';
    v_sql3 := v_sql3||'                 ''5964'', ';
    v_sql3 := v_sql3||'                 ''5965'', ';
    v_sql3 := v_sql3||'                 ''5966'', ';
    v_sql3 := v_sql3||'                 ''5967'', ';
    v_sql3 := v_sql3||'                 ''5968'', ';
    v_sql3 := v_sql3||'                 ''5969'', ';
    v_sql3 := v_sql3||'                 ''5972'', ';
    v_sql3 := v_sql3||'                 ''5973'', ';
    v_sql3 := v_sql3||'                 ''5975'', ';
    v_sql3 := v_sql3||'                 ''5976'', ';
    v_sql3 := v_sql3||'                 ''5977'', ';
    v_sql3 := v_sql3||'                 ''5978'', ';
    v_sql3 := v_sql3||'                 ''5983'', ';
    v_sql3 := v_sql3||'                 ''5992'', ';
    v_sql3 := v_sql3||'                 ''5993'', ';
    v_sql3 := v_sql3||'                 ''5995'', ';
    v_sql3 := v_sql3||'                 ''5996'', ';
    v_sql3 := v_sql3||'                 ''5997'', ';
    v_sql3 := v_sql3||'                 ''5999'', ';
    v_sql3 := v_sql3||'                 ''6010'', ';
    v_sql3 := v_sql3||'                 ''6011'', ';
    v_sql3 := v_sql3||'                 ''6012'', ';
    v_sql3 := v_sql3||'                 ''6051'', ';
    v_sql3 := v_sql3||'                 ''6211'', ';
    v_sql3 := v_sql3||'                 ''6513'', ';
    v_sql3 := v_sql3||'                 ''7210'', ';
    v_sql3 := v_sql3||'                 ''7211'', ';
    v_sql3 := v_sql3||'                 ''7216'', ';
    v_sql3 := v_sql3||'                 ''7217'', ';
    v_sql3 := v_sql3||'                 ''7221'', ';
    v_sql3 := v_sql3||'                 ''7230'', ';
    v_sql3 := v_sql3||'                 ''7251'', ';
    v_sql3 := v_sql3||'                 ''7261'', ';
    v_sql3 := v_sql3||'                 ''7273'', ';
    v_sql3 := v_sql3||'                 ''7276'', ';
    v_sql3 := v_sql3||'                 ''7277'', ';
    v_sql3 := v_sql3||'                 ''7278'', ';
    v_sql3 := v_sql3||'                 ''7295'', ';
    v_sql3 := v_sql3||'                 ''7296'', ';
    v_sql3 := v_sql3||'                 ''7299'', ';
    v_sql3 := v_sql3||'                 ''7311'', ';
    v_sql3 := v_sql3||'                 ''7321'', ';
    v_sql3 := v_sql3||'                 ''7333'', ';
    v_sql3 := v_sql3||'                 ''7338'', ';
    v_sql3 := v_sql3||'                 ''7339'', ';
    v_sql3 := v_sql3||'                 ''7342'', ';
    v_sql3 := v_sql3||'                 ''7349'', ';
    v_sql3 := v_sql3||'                 ''7361'', ';
    v_sql3 := v_sql3||'                 ''7372'', ';
    v_sql3 := v_sql3||'                 ''7375'', ';
    v_sql3 := v_sql3||'                 ''7379'', ';
    v_sql3 := v_sql3||'                 ''7392'', ';
    v_sql3 := v_sql3||'                 ''7393'', ';
    v_sql3 := v_sql3||'                 ''7394'', ';
    v_sql3 := v_sql3||'                 ''7395'', ';
    v_sql3 := v_sql3||'                 ''7399'', ';
    v_sql3 := v_sql3||'                 ''7512'', ';
    v_sql3 := v_sql3||'                 ''7513'', ';
    v_sql3 := v_sql3||'                 ''7519'', ';
    v_sql3 := v_sql3||'                 ''7531'', ';
    v_sql3 := v_sql3||'                 ''7534'', ';
    v_sql3 := v_sql3||'                 ''7535'', ';
    v_sql3 := v_sql3||'                 ''7538'', ';
    v_sql3 := v_sql3||'                 ''7542'', ';
    v_sql3 := v_sql3||'                 ''7549'', ';
    v_sql3 := v_sql3||'                 ''7622'', ';
    v_sql3 := v_sql3||'                 ''7623'', ';
    v_sql3 := v_sql3||'                 ''7629'', ';
    v_sql3 := v_sql3||'                 ''7641'', ';
    v_sql3 := v_sql3||'                 ''7692'', ';
    v_sql3 := v_sql3||'                 ''7699'', ';
    v_sql3 := v_sql3||'                 ''7832'', ';
    v_sql3 := v_sql3||'                 ''7841'', ';
    v_sql3 := v_sql3||'                 ''7991'', ';
    v_sql3 := v_sql3||'                 ''7993'', ';
    v_sql3 := v_sql3||'                 ''7995'', ';
    v_sql3 := v_sql3||'                 ''8011'', ';
    v_sql3 := v_sql3||'                 ''8021'', ';
    v_sql3 := v_sql3||'                 ''8031'', ';
    v_sql3 := v_sql3||'                 ''8041'', ';
    v_sql3 := v_sql3||'                 ''8042'', ';
    v_sql3 := v_sql3||'                 ''8043'', ';
    v_sql3 := v_sql3||'                 ''8049'', ';
    v_sql3 := v_sql3||'                 ''8050'', ';
    v_sql3 := v_sql3||'                 ''8071'', ';
    v_sql3 := v_sql3||'                 ''8099'', ';
    v_sql3 := v_sql3||'                 ''8111'', ';
    v_sql3 := v_sql3||'                 ''8241'', ';
    v_sql3 := v_sql3||'                 ''8244'', ';
    v_sql3 := v_sql3||'                 ''8249'', ';
    v_sql3 := v_sql3||'                 ''8299'', ';
    v_sql3 := v_sql3||'                 ''8351'', ';
    v_sql3 := v_sql3||'                 ''8641'', ';
    v_sql3 := v_sql3||'                 ''8661'', ';
    v_sql3 := v_sql3||'                 ''8675'', ';
    v_sql3 := v_sql3||'                 ''8699'', ';
    v_sql3 := v_sql3||'                 ''8911'', ';
    v_sql3 := v_sql3||'                 ''8912'', ';
    v_sql3 := v_sql3||'                 ''8931'', ';
    v_sql3 := v_sql3||'                 ''8999'', ';
    v_sql3 := v_sql3||'                 ''1001'', ';
    v_sql3 := v_sql3||'                 ''6013''  ';
    v_sql3 := v_sql3||'                ) ';
    v_sql3 := v_sql3||'                AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql3 := v_sql3||'                AND (TRANS_TYPE + 0) is not null ';
    v_sql3 := v_sql3||'                AND coal(E.src_ind,'' '') <> ''I'' ';
    v_sql3 := v_sql3||'                AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql3 := v_sql3||'                AND (substr(E.merch_seq,-4,3) + 0) is not null ';
    v_sql3 := v_sql3||'                AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql3 := v_sql3||'                THEN ';
    v_sql3 := v_sql3||'                 1 ';
    v_sql3 := v_sql3||'              ELSE ';
    v_sql3 := v_sql3||'                 NULL ';
    v_sql3 := v_sql3||'              END ';
    v_sql3 := v_sql3||'           ) AS MCC55COUNT, ';
    v_sql3 := v_sql3||'            COUNT(CASE ';
    v_sql3 := v_sql3||'                WHEN ';
    v_sql3 := v_sql3||'                mer_cat_cd in ';
    v_sql3 := v_sql3||'                ( ';
    v_sql3 := v_sql3||'                 ''742'', ';
    v_sql3 := v_sql3||'                 ''763'', ';
    v_sql3 := v_sql3||'                 ''780'', ';
    v_sql3 := v_sql3||'                 ''4011'', ';
    v_sql3 := v_sql3||'                 ''4119'', ';
    v_sql3 := v_sql3||'                 ''4214'', ';
    v_sql3 := v_sql3||'                 ''4215'', ';
    v_sql3 := v_sql3||'                 ''4225'', ';
    v_sql3 := v_sql3||'                 ''4411'', ';
    v_sql3 := v_sql3||'                 ''4457'', ';
    v_sql3 := v_sql3||'                 ''4468'', ';
    v_sql3 := v_sql3||'                 ''4582'', ';
    v_sql3 := v_sql3||'                 ''4722'', ';
    v_sql3 := v_sql3||'                 ''4733'', ';
    v_sql3 := v_sql3||'                 ''4789'', ';
    v_sql3 := v_sql3||'                 ''4812'', ';
    v_sql3 := v_sql3||'                 ''4816'', ';
    v_sql3 := v_sql3||'                 ''4821'', ';
    v_sql3 := v_sql3||'                 ''5211'', ';
    v_sql3 := v_sql3||'                 ''5231'', ';
    v_sql3 := v_sql3||'                 ''5251'', ';
    v_sql3 := v_sql3||'                 ''5261'', ';
    v_sql3 := v_sql3||'                 ''5309'', ';
    v_sql3 := v_sql3||'                 ''5310'', ';
    v_sql3 := v_sql3||'                 ''5311'', ';
    v_sql3 := v_sql3||'                 ''5331'', ';
    v_sql3 := v_sql3||'                 ''5399'', ';
    v_sql3 := v_sql3||'                 ''5422'', ';
    v_sql3 := v_sql3||'                 ''5441'', ';
    v_sql3 := v_sql3||'                 ''5451'', ';
    v_sql3 := v_sql3||'                 ''5462'', ';
    v_sql3 := v_sql3||'                 ''5499'', ';
    v_sql3 := v_sql3||'                 ''5532'', ';
    v_sql3 := v_sql3||'                 ''5533'', ';
    v_sql3 := v_sql3||'                 ''5611'', ';
    v_sql3 := v_sql3||'                 ''5621'', ';
    v_sql3 := v_sql3||'                 ''5631'', ';
    v_sql3 := v_sql3||'                 ''5641'', ';
    v_sql3 := v_sql3||'                 ''5651'', ';
    v_sql3 := v_sql3||'                 ''5655'', ';
    v_sql3 := v_sql3||'                 ''5661'', ';
    v_sql3 := v_sql3||'                 ''5681'', ';
    v_sql3 := v_sql3||'                 ''5691'', ';
    v_sql3 := v_sql3||'                 ''5697'', ';
    v_sql3 := v_sql3||'                 ''5698'', ';
    v_sql3 := v_sql3||'                 ''5699'', ';
    v_sql3 := v_sql3||'                 ''5712'', ';
    v_sql3 := v_sql3||'                 ''5713'', ';
    v_sql3 := v_sql3||'                 ''5714'', ';
    v_sql3 := v_sql3||'                 ''5718'', ';
    v_sql3 := v_sql3||'                 ''5719'', ';
    v_sql3 := v_sql3||'                 ''5732'', ';
    v_sql3 := v_sql3||'                 ''5733'', ';
    v_sql3 := v_sql3||'                 ''5734'', ';
    v_sql3 := v_sql3||'                 ''5735'', ';
    v_sql3 := v_sql3||'                 ''5814'', ';
    v_sql3 := v_sql3||'                 ''5912'', ';
    v_sql3 := v_sql3||'                 ''5921'', ';
    v_sql3 := v_sql3||'                 ''5931'', ';
    v_sql3 := v_sql3||'                 ''5935'', ';
    v_sql3 := v_sql3||'                 ''5940'', ';
    v_sql3 := v_sql3||'                 ''5941'', ';
    v_sql3 := v_sql3||'                 ''5942'', ';
    v_sql3 := v_sql3||'                 ''5943'', ';
    v_sql3 := v_sql3||'                 ''5945'', ';
    v_sql3 := v_sql3||'                 ''5946'', ';
    v_sql3 := v_sql3||'                 ''5947'', ';
    v_sql3 := v_sql3||'                 ''5948'', ';
    v_sql3 := v_sql3||'                 ''5949'', ';
    v_sql3 := v_sql3||'                 ''5962'', ';
    v_sql3 := v_sql3||'                 ''5963'', ';
    v_sql3 := v_sql3||'                 ''5964'', ';
    v_sql3 := v_sql3||'                 ''5965'', ';
    v_sql3 := v_sql3||'                 ''5966'', ';
    v_sql3 := v_sql3||'                 ''5967'', ';
    v_sql3 := v_sql3||'                 ''5968'', ';
    v_sql3 := v_sql3||'                 ''5969'', ';
    v_sql3 := v_sql3||'                 ''5972'', ';
    v_sql3 := v_sql3||'                 ''5973'', ';
    v_sql3 := v_sql3||'                 ''5975'', ';
    v_sql3 := v_sql3||'                 ''5976'', ';
    v_sql3 := v_sql3||'                 ''5977'', ';
    v_sql3 := v_sql3||'                 ''5978'', ';
    v_sql3 := v_sql3||'                 ''5983'', ';
    v_sql3 := v_sql3||'                 ''5992'', ';
    v_sql3 := v_sql3||'                 ''5993'', ';
    v_sql3 := v_sql3||'                 ''5995'', ';
    v_sql3 := v_sql3||'                 ''5996'', ';
    v_sql3 := v_sql3||'                 ''5997'', ';
    v_sql3 := v_sql3||'                 ''5999'', ';
    v_sql3 := v_sql3||'                 ''6010'', ';
    v_sql3 := v_sql3||'                 ''6011'', ';
    v_sql3 := v_sql3||'                 ''6012'', ';
    v_sql3 := v_sql3||'                 ''6051'', ';
    v_sql3 := v_sql3||'                 ''6211'', ';
    v_sql3 := v_sql3||'                 ''6513'', ';
    v_sql3 := v_sql3||'                 ''7210'', ';
    v_sql3 := v_sql3||'                 ''7211'', ';
    v_sql3 := v_sql3||'                 ''7216'', ';
    v_sql3 := v_sql3||'                 ''7217'', ';
    v_sql3 := v_sql3||'                 ''7221'', ';
    v_sql3 := v_sql3||'                 ''7230'', ';
    v_sql3 := v_sql3||'                 ''7251'', ';
    v_sql3 := v_sql3||'                 ''7261'', ';
    v_sql3 := v_sql3||'                 ''7273'', ';
    v_sql3 := v_sql3||'                 ''7276'', ';
    v_sql3 := v_sql3||'                 ''7277'', ';
    v_sql3 := v_sql3||'                 ''7278'', ';
    v_sql3 := v_sql3||'                 ''7295'', ';
    v_sql3 := v_sql3||'                 ''7296'', ';
    v_sql3 := v_sql3||'                 ''7299'', ';
    v_sql3 := v_sql3||'                 ''7311'', ';
    v_sql3 := v_sql3||'                 ''7321'', ';
    v_sql3 := v_sql3||'                 ''7333'', ';
    v_sql3 := v_sql3||'                 ''7338'', ';
    v_sql3 := v_sql3||'                 ''7339'', ';
    v_sql3 := v_sql3||'                 ''7342'', ';
    v_sql3 := v_sql3||'                 ''7349'', ';
    v_sql3 := v_sql3||'                 ''7361'', ';
    v_sql3 := v_sql3||'                 ''7372'', ';
    v_sql3 := v_sql3||'                 ''7375'', ';
    v_sql3 := v_sql3||'                 ''7379'', ';
    v_sql3 := v_sql3||'                 ''7392'', ';
    v_sql3 := v_sql3||'                 ''7393'', ';
    v_sql3 := v_sql3||'                 ''7394'', ';
    v_sql3 := v_sql3||'                 ''7395'', ';
    v_sql3 := v_sql3||'                 ''7399'', ';
    v_sql3 := v_sql3||'                 ''7512'', ';
    v_sql3 := v_sql3||'                 ''7513'', ';
    v_sql3 := v_sql3||'                 ''7519'', ';
    v_sql3 := v_sql3||'                 ''7531'', ';
    v_sql3 := v_sql3||'                 ''7534'', ';
    v_sql3 := v_sql3||'                 ''7535'', ';
    v_sql3 := v_sql3||'                 ''7538'', ';
    v_sql3 := v_sql3||'                 ''7542'', ';
    v_sql3 := v_sql3||'                 ''7549'', ';
    v_sql3 := v_sql3||'                 ''7622'', ';
    v_sql3 := v_sql3||'                 ''7623'', ';
    v_sql3 := v_sql3||'                 ''7629'', ';
    v_sql3 := v_sql3||'                 ''7641'', ';
    v_sql3 := v_sql3||'                 ''7692'', ';
    v_sql3 := v_sql3||'                 ''7699'', ';
    v_sql3 := v_sql3||'                 ''7832'', ';
    v_sql3 := v_sql3||'                 ''7841'', ';
    v_sql3 := v_sql3||'                 ''7991'', ';
    v_sql3 := v_sql3||'                 ''7993'', ';
    v_sql3 := v_sql3||'                 ''7995'', ';
    v_sql3 := v_sql3||'                 ''8011'', ';
    v_sql3 := v_sql3||'                 ''8021'', ';
    v_sql3 := v_sql3||'                 ''8031'', ';
    v_sql3 := v_sql3||'                 ''8041'', ';
    v_sql3 := v_sql3||'                 ''8042'', ';
    v_sql3 := v_sql3||'                 ''8043'', ';
    v_sql3 := v_sql3||'                 ''8049'', ';
    v_sql3 := v_sql3||'                 ''8050'', ';
    v_sql3 := v_sql3||'                 ''8071'', ';
    v_sql3 := v_sql3||'                 ''8099'', ';
    v_sql3 := v_sql3||'                 ''8111'', ';
    v_sql3 := v_sql3||'                 ''8241'', ';
    v_sql3 := v_sql3||'                 ''8244'', ';
    v_sql3 := v_sql3||'                 ''8249'', ';
    v_sql3 := v_sql3||'                 ''8299'', ';
    v_sql3 := v_sql3||'                 ''8351'', ';
    v_sql3 := v_sql3||'                 ''8641'', ';
    v_sql3 := v_sql3||'                 ''8661'', ';
    v_sql3 := v_sql3||'                 ''8675'', ';
    v_sql3 := v_sql3||'                 ''8699'', ';
    v_sql3 := v_sql3||'                 ''8911'', ';
    v_sql3 := v_sql3||'                 ''8912'', ';
    v_sql3 := v_sql3||'                 ''8931'', ';
    v_sql3 := v_sql3||'                 ''8999'', ';
    v_sql3 := v_sql3||'                 ''1001'', ';
    v_sql3 := v_sql3||'                 ''6013''  ';
    v_sql3 := v_sql3||'                ) ';
    v_sql3 := v_sql3||'                AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql3 := v_sql3||'                OR E.src_ind = ''I'' ) ';
    v_sql3 := v_sql3||'                AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql3 := v_sql3||'                AND (substr(E.merch_seq,-4,3) + 0) is not null ';
    v_sql3 := v_sql3||'                AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql3 := v_sql3||'                THEN ';
    v_sql3 := v_sql3||'                 1 ';
    v_sql3 := v_sql3||'              ELSE ';
    v_sql3 := v_sql3||'                 NULL ';
    v_sql3 := v_sql3||'              END ';
    v_sql3 := v_sql3||'           ) AS MCC55NETCOUNT, ';
    v_sql3 := v_sql3||'         COUNT(CASE ';
    v_sql3 := v_sql3||'                WHEN ';
    v_sql3 := v_sql3||'                mer_cat_cd in ';
    v_sql3 := v_sql3||'                ( ';
    v_sql3 := v_sql3||'                 ''5541'', ';
    v_sql3 := v_sql3||'                 ''5542'', ';
    v_sql3 := v_sql3||'                 ''5411'', ';
    v_sql3 := v_sql3||'                 ''5722'', ';
    v_sql3 := v_sql3||'                 ''4511'', ';
    v_sql3 := v_sql3||'                 ''4111'', ';
    v_sql3 := v_sql3||'                 ''4121'', ';
    v_sql3 := v_sql3||'                 ''4131'', ';
    v_sql3 := v_sql3||'                 ''4784'', ';
    v_sql3 := v_sql3||'                 ''3998'', ';
    v_sql3 := v_sql3||'                 ''4112'', ';
    v_sql3 := v_sql3||'                 ''4900'', ';
    v_sql3 := v_sql3||'                 ''4814'', ';
    v_sql3 := v_sql3||'                 ''4899'', ';
    v_sql3 := v_sql3||'                 ''6300'', ';
    v_sql3 := v_sql3||'                 ''5960'', ';
    v_sql3 := v_sql3||'                 ''8651'', ';
    v_sql3 := v_sql3||'                 ''9211'', ';
    v_sql3 := v_sql3||'                 ''9222'', ';
    v_sql3 := v_sql3||'                 ''9223'', ';
    v_sql3 := v_sql3||'                 ''9311'', ';
    v_sql3 := v_sql3||'                 ''9399'', ';
    v_sql3 := v_sql3||'                 ''9400'', ';
    v_sql3 := v_sql3||'                 ''5994'', ';
    v_sql3 := v_sql3||'                 ''7523'', ';
    v_sql3 := v_sql3||'                 ''9402''  ';
    v_sql3 := v_sql3||'                ) ';
    v_sql3 := v_sql3||'                AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql3 := v_sql3||'                AND (TRANS_TYPE + 0) is not null ';
    v_sql3 := v_sql3||'                AND coal(E.src_ind,'' '') <> ''I'' ';
    v_sql3 := v_sql3||'                AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql3 := v_sql3||'                AND (substr(E.merch_seq,-4,3) + 0) is not null ';
    v_sql3 := v_sql3||'                AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql3 := v_sql3||'                THEN ';
    v_sql3 := v_sql3||'                 1 ';
    v_sql3 := v_sql3||'              ELSE ';
    v_sql3 := v_sql3||'                 NULL ';
    v_sql3 := v_sql3||'              END ';
    v_sql3 := v_sql3||'           ) AS MCC26COUNT, ';
    v_sql3 := v_sql3||'                  COUNT(CASE ';
    v_sql3 := v_sql3||'                WHEN ';
    v_sql3 := v_sql3||'                mer_cat_cd in ';
    v_sql3 := v_sql3||'                ( ';
    v_sql3 := v_sql3||'                 ''5541'', ';
    v_sql3 := v_sql3||'                 ''5542'', ';
    v_sql3 := v_sql3||'                 ''5411'', ';
    v_sql3 := v_sql3||'                 ''5722'', ';
    v_sql3 := v_sql3||'                 ''4511'', ';
    v_sql3 := v_sql3||'                 ''4111'', ';
    v_sql3 := v_sql3||'                 ''4121'', ';
    v_sql3 := v_sql3||'                 ''4131'', ';
    v_sql3 := v_sql3||'                 ''4784'', ';
    v_sql3 := v_sql3||'                 ''3998'', ';
    v_sql3 := v_sql3||'                 ''4112'', ';
    v_sql3 := v_sql3||'                 ''4900'', ';
    v_sql3 := v_sql3||'                 ''4814'', ';
    v_sql3 := v_sql3||'                 ''4899'', ';
    v_sql3 := v_sql3||'                 ''6300'', ';
    v_sql3 := v_sql3||'                 ''5960'', ';
    v_sql3 := v_sql3||'                 ''8651'', ';
    v_sql3 := v_sql3||'                 ''9211'', ';
    v_sql3 := v_sql3||'                 ''9222'', ';
    v_sql3 := v_sql3||'                 ''9223'', ';
    v_sql3 := v_sql3||'                 ''9311'', ';
    v_sql3 := v_sql3||'                 ''9399'', ';
    v_sql3 := v_sql3||'                 ''9400'', ';
    v_sql3 := v_sql3||'                 ''5994'', ';
    v_sql3 := v_sql3||'                 ''7523'', ';
    v_sql3 := v_sql3||'                 ''9402''  ';
    v_sql3 := v_sql3||'                ) ';
    v_sql3 := v_sql3||'                AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql3 := v_sql3||'                OR E.src_ind = ''I'' ) ';
    v_sql3 := v_sql3||'                AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql3 := v_sql3||'                AND (substr(E.merch_seq,-4,3) + 0) is not null ';
    v_sql3 := v_sql3||'                AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql3 := v_sql3||'                THEN ';
    v_sql3 := v_sql3||'                 1 ';
    v_sql3 := v_sql3||'              ELSE ';
    v_sql3 := v_sql3||'                 NULL ';
    v_sql3 := v_sql3||'              END ';
    v_sql3 := v_sql3||'           ) AS MCC26NETCOUNT, ';
    v_sql3 := v_sql3||'                           COUNT(CASE ';
    v_sql3 := v_sql3||'                WHEN ';
    v_sql3 := v_sql3||'                     TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql3 := v_sql3||'                AND coal(E.Src_Ind,'' '') <> ''I'' ';
    v_sql3 := v_sql3||'                AND ( E.MERCH_STAT <> ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql3 := v_sql3||'                THEN ';
    v_sql3 := v_sql3||'                 1 ';
    v_sql3 := v_sql3||'              ELSE ';
    v_sql3 := v_sql3||'                 NULL ';
    v_sql3 := v_sql3||'              END ';
    v_sql3 := v_sql3||'           ) AS JW120COUNT, ';
    v_sql3 := v_sql3||'                  COUNT(CASE ';
    v_sql3 := v_sql3||'                WHEN ';
    v_sql3 := v_sql3||'               TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql3 := v_sql3||'                AND E.Src_Ind = ''I'' ';
    v_sql3 := v_sql3||'                AND ( E.MERCH_STAT <> ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql3 := v_sql3||'                THEN ';
    v_sql3 := v_sql3||'                 1 ';
    v_sql3 := v_sql3||'              ELSE ';
    v_sql3 := v_sql3||'                 NULL ';
    v_sql3 := v_sql3||'              END ';
    v_sql3 := v_sql3||'           ) AS JW120NETCOUNT, ';
    v_sql3 := v_sql3||'          COUNT(CASE ';
    v_sql3 := v_sql3||'                WHEN ';
    v_sql3 := v_sql3||'                  (E.MER_CAT_CD IN (''1520'', ';
    v_sql3 := v_sql3||'                                    ''7013'', ';
    v_sql3 := v_sql3||'                                    ''5271'', ';
    v_sql3 := v_sql3||'                                    ''5511'', ';
    v_sql3 := v_sql3||'                                    ''5521'', ';
    v_sql3 := v_sql3||'                                    ''5551'', ';
    v_sql3 := v_sql3||'                                    ''5561'', ';
    v_sql3 := v_sql3||'                                    ''5571'', ';
    v_sql3 := v_sql3||'                                    ''5592'', ';
    v_sql3 := v_sql3||'                                    ''5598'', ';
    v_sql3 := v_sql3||'                                    ''5599'', ';
    v_sql3 := v_sql3||'                                    ''5933'', ';
    v_sql3 := v_sql3||'                                    ''8062'', ';
    v_sql3 := v_sql3||'                                    ''8211'', ';
    v_sql3 := v_sql3||'                                    ''8220'', ';
    v_sql3 := v_sql3||'                                    ''8398'', ';
    v_sql3 := v_sql3||'                                    ''5021'', ';
    v_sql3 := v_sql3||'                                    ''5039'', ';
    v_sql3 := v_sql3||'                                    ''5044'', ';
    v_sql3 := v_sql3||'                                    ''5045'', ';
    v_sql3 := v_sql3||'                                    ''5046'', ';
    v_sql3 := v_sql3||'                                    ''5047'', ';
    v_sql3 := v_sql3||'                                    ''5051'', ';
    v_sql3 := v_sql3||'                                    ''5065'', ';
    v_sql3 := v_sql3||'                                    ''5072'', ';
    v_sql3 := v_sql3||'                                    ''5074'', ';
    v_sql3 := v_sql3||'                                    ''5111'', ';
    v_sql3 := v_sql3||'                                    ''5122'', ';
    v_sql3 := v_sql3||'                                    ''5131'', ';
    v_sql3 := v_sql3||'                                    ''5137'', ';
    v_sql3 := v_sql3||'                                    ''5139'', ';
    v_sql3 := v_sql3||'                                    ''5172'', ';
    v_sql3 := v_sql3||'                                    ''5192'', ';
    v_sql3 := v_sql3||'                                    ''5193'', ';
    v_sql3 := v_sql3||'                                    ''5198'', ';
    v_sql3 := v_sql3||'                                    ''5998'', ';
    v_sql3 := v_sql3||'                                    ''5013'', ';
    v_sql3 := v_sql3||'                                    ''5398'', ';
    v_sql3 := v_sql3||'                                    ''4458'', ';
    v_sql3 := v_sql3||'                                    ''9498'', ';
    v_sql3 := v_sql3||'                                    ''9703'', ';
    v_sql3 := v_sql3||'                                    ''9704'', ';
    v_sql3 := v_sql3||'                                    ''9705'', ';
    v_sql3 := v_sql3||'                                    ''9706'', ';
    v_sql3 := v_sql3||'                                    ''9707'', ';
    v_sql3 := v_sql3||'                                    ''9708'', ';
    v_sql3 := v_sql3||'                                    ''5200'', ';
    v_sql3 := v_sql3||'                                    ''5300'') ';
    v_sql3 := v_sql3||'                                    OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql3 := v_sql3||'                AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql3 := v_sql3||'                AND (TRANS_TYPE + 0) is not null ';
    v_sql3 := v_sql3||'                AND coal(E.src_ind,'' '') <> ''I'' ';
    v_sql3 := v_sql3||'                AND BILL_AMT <= 3500 ';
    v_sql3 := v_sql3||'                AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql3 := v_sql3||'                THEN ';
    v_sql3 := v_sql3||'                 1 ';
    v_sql3 := v_sql3||'              ELSE ';
    v_sql3 := v_sql3||'                 NULL ';
    v_sql3 := v_sql3||'              END ';
    v_sql3 := v_sql3||'           ) AS DLCOUNT, ';
    v_sql3 := v_sql3||'            COUNT(CASE ';
    v_sql3 := v_sql3||'                WHEN ';
    v_sql3 := v_sql3||'                  (E.MER_CAT_CD IN (''1520'', ';
    v_sql3 := v_sql3||'                                    ''7013'', ';
    v_sql3 := v_sql3||'                                    ''5271'', ';
    v_sql3 := v_sql3||'                                    ''5511'', ';
    v_sql3 := v_sql3||'                                    ''5521'', ';
    v_sql3 := v_sql3||'                                    ''5551'', ';
    v_sql3 := v_sql3||'                                    ''5561'', ';
    v_sql3 := v_sql3||'                                    ''5571'', ';
    v_sql3 := v_sql3||'                                    ''5592'', ';
    v_sql3 := v_sql3||'                                    ''5598'', ';
    v_sql3 := v_sql3||'                                    ''5599'', ';
    v_sql3 := v_sql3||'                                    ''5933'', ';
    v_sql3 := v_sql3||'                                    ''8062'', ';
    v_sql3 := v_sql3||'                                    ''8211'', ';
    v_sql3 := v_sql3||'                                    ''8220'', ';
    v_sql3 := v_sql3||'                                    ''8398'', ';
    v_sql3 := v_sql3||'                                    ''5021'', ';
    v_sql3 := v_sql3||'                                    ''5039'', ';
    v_sql3 := v_sql3||'                                    ''5044'', ';
    v_sql3 := v_sql3||'                                    ''5045'', ';
    v_sql3 := v_sql3||'                                    ''5046'', ';
    v_sql3 := v_sql3||'                                    ''5047'', ';
    v_sql3 := v_sql3||'                                    ''5051'', ';
    v_sql3 := v_sql3||'                                    ''5065'', ';
    v_sql3 := v_sql3||'                                    ''5072'', ';
    v_sql3 := v_sql3||'                                    ''5074'', ';
    v_sql3 := v_sql3||'                                    ''5111'', ';
    v_sql3 := v_sql3||'                                    ''5122'', ';
    v_sql3 := v_sql3||'                                    ''5131'', ';
    v_sql3 := v_sql3||'                                    ''5137'', ';
    v_sql3 := v_sql3||'                                    ''5139'', ';
    v_sql3 := v_sql3||'                                    ''5172'', ';
    v_sql3 := v_sql3||'                                    ''5192'', ';
    v_sql3 := v_sql3||'                                    ''5193'', ';
    v_sql3 := v_sql3||'                                    ''5198'', ';
    v_sql3 := v_sql3||'                                    ''5998'', ';
    v_sql3 := v_sql3||'                                    ''5013'', ';
    v_sql3 := v_sql3||'                                    ''5398'', ';
    v_sql3 := v_sql3||'                                    ''4458'', ';
    v_sql3 := v_sql3||'                                    ''9498'', ';
    v_sql3 := v_sql3||'                                    ''9703'', ';
    v_sql3 := v_sql3||'                                    ''9704'', ';
    v_sql3 := v_sql3||'                                    ''9705'', ';
    v_sql3 := v_sql3||'                                    ''9706'', ';
    v_sql3 := v_sql3||'                                    ''9707'', ';
    v_sql3 := v_sql3||'                                    ''9708'', ';
    v_sql3 := v_sql3||'                                    ''5200'', ';
    v_sql3 := v_sql3||'                                    ''5300'') ';
    v_sql3 := v_sql3||'                                    OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql3 := v_sql3||'                AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql3 := v_sql3||'                OR E.src_ind = ''I'' ) ';
    v_sql3 := v_sql3||'                AND BILL_AMT <= 3500 ';
    v_sql3 := v_sql3||'                AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql3 := v_sql3||'                THEN ';
    v_sql3 := v_sql3||'                 1 ';
    v_sql3 := v_sql3||'              ELSE ';
    v_sql3 := v_sql3||'                 NULL ';
    v_sql3 := v_sql3||'              END ';
    v_sql3 := v_sql3||'           ) AS DLNETCOUNT, ';
    v_sql3 := v_sql3||'            MIN(CASE ';
    v_sql3 := v_sql3||'                WHEN ';
    v_sql3 := v_sql3||'                     TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql3 := v_sql3||'                     AND coal(E.src_ind,'' '') <> ''I'' ';
    v_sql3 := v_sql3||'                AND ( coal(E.MERCH_STAT,'' '') <> ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql3 := v_sql3||'                THEN ';
    v_sql3 := v_sql3||'                 CEIL(date_diff(SYSDATE(),todate(CREATE_DATE,''yyyy-mm-dd''))) ';
    v_sql3 := v_sql3||'              ELSE ';
    v_sql3 := v_sql3||'                 9999 ';
    v_sql3 := v_sql3||'              END ';
    v_sql3 := v_sql3||'           ) AS JWRECENCY, ';
    v_sql3 := v_sql3||'          COUNT(CASE ';
    v_sql3 := v_sql3||'                WHEN ';
    v_sql3 := v_sql3||'                  (E.MER_CAT_CD IN (''1520'', ';
    v_sql3 := v_sql3||'                                    ''7013'', ';
    v_sql3 := v_sql3||'                                    ''5271'', ';
    v_sql3 := v_sql3||'                                    ''5511'', ';
    v_sql3 := v_sql3||'                                    ''5521'', ';
    v_sql3 := v_sql3||'                                    ''5551'', ';
    v_sql3 := v_sql3||'                                    ''5561'', ';
    v_sql3 := v_sql3||'                                    ''5571'', ';
    v_sql3 := v_sql3||'                                    ''5592'', ';
    v_sql3 := v_sql3||'                                    ''5598'', ';
    v_sql3 := v_sql3||'                                    ''5599'', ';
    v_sql3 := v_sql3||'                                    ''5933'', ';
    v_sql3 := v_sql3||'                                    ''8062'', ';
    v_sql3 := v_sql3||'                                    ''8211'', ';
    v_sql3 := v_sql3||'                                    ''8220'', ';
    v_sql3 := v_sql3||'                                    ''8398'', ';
    v_sql3 := v_sql3||'                                    ''5021'', ';
    v_sql3 := v_sql3||'                                    ''5039'', ';
    v_sql3 := v_sql3||'                                    ''5044'', ';
    v_sql3 := v_sql3||'                                    ''5045'', ';
    v_sql3 := v_sql3||'                                    ''5046'', ';
    v_sql3 := v_sql3||'                                    ''5047'', ';
    v_sql3 := v_sql3||'                                    ''5051'', ';
    v_sql3 := v_sql3||'                                    ''5065'', ';
    v_sql3 := v_sql3||'                                    ''5072'', ';
    v_sql3 := v_sql3||'                                    ''5074'', ';
    v_sql3 := v_sql3||'                                    ''5111'', ';
    v_sql3 := v_sql3||'                                    ''5122'', ';
    v_sql3 := v_sql3||'                                    ''5131'', ';
    v_sql3 := v_sql3||'                                    ''5137'', ';
    v_sql3 := v_sql3||'                                    ''5139'', ';
    v_sql3 := v_sql3||'                                    ''5172'', ';
    v_sql3 := v_sql3||'                                    ''5192'', ';
    v_sql3 := v_sql3||'                                    ''5193'', ';
    v_sql3 := v_sql3||'                                    ''5198'', ';
    v_sql3 := v_sql3||'                                    ''5998'', ';
    v_sql3 := v_sql3||'                                    ''5013'', ';
    v_sql3 := v_sql3||'                                    ''5398'', ';
    v_sql3 := v_sql3||'                                    ''4458'', ';
    v_sql3 := v_sql3||'                                    ''9498'', ';
    v_sql3 := v_sql3||'                                    ''9703'', ';
    v_sql3 := v_sql3||'                                    ''9704'', ';
    v_sql3 := v_sql3||'                                    ''9705'', ';
    v_sql3 := v_sql3||'                                    ''9706'', ';
    v_sql3 := v_sql3||'                                    ''9707'', ';
    v_sql3 := v_sql3||'                                    ''9708'', ';
    v_sql3 := v_sql3||'                                    ''5200'', ';
    v_sql3 := v_sql3||'                                    ''5300'') ';
    v_sql3 := v_sql3||'                                    OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql3 := v_sql3||'                AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql3 := v_sql3||'                AND (TRANS_TYPE + 0) is not null ';
    v_sql3 := v_sql3||'                AND BILL_AMT > 3500 ';
    v_sql3 := v_sql3||'                AND coal(E.src_ind,'' '') <> ''I'' ';
    v_sql3 := v_sql3||'                AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql3 := v_sql3||'                THEN ';
    v_sql3 := v_sql3||'                 1 ';
    v_sql3 := v_sql3||'              ELSE ';
    v_sql3 := v_sql3||'                 NULL ';
    v_sql3 := v_sql3||'              END ';
    v_sql3 := v_sql3||'           ) AS DLCOUNT_2, ';
    v_sql3 := v_sql3||'                              COUNT(CASE ';
    v_sql3 := v_sql3||'                WHEN ';
    v_sql3 := v_sql3||'                  (E.MER_CAT_CD IN (''1520'', ';
    v_sql3 := v_sql3||'                                    ''7013'', ';
    v_sql3 := v_sql3||'                                    ''5271'', ';
    v_sql3 := v_sql3||'                                    ''5511'', ';
    v_sql3 := v_sql3||'                                    ''5521'', ';
    v_sql3 := v_sql3||'                                    ''5551'', ';
    v_sql3 := v_sql3||'                                    ''5561'', ';
    v_sql3 := v_sql3||'                                    ''5571'', ';
    v_sql3 := v_sql3||'                                    ''5592'', ';
    v_sql3 := v_sql3||'                                    ''5598'', ';
    v_sql3 := v_sql3||'                                    ''5599'', ';
    v_sql3 := v_sql3||'                                    ''5933'', ';
    v_sql3 := v_sql3||'                                    ''8062'', ';
    v_sql3 := v_sql3||'                                    ''8211'', ';
    v_sql3 := v_sql3||'                                    ''8220'', ';
    v_sql3 := v_sql3||'                                    ''8398'', ';
    v_sql3 := v_sql3||'                                    ''5021'', ';
    v_sql3 := v_sql3||'                                    ''5039'', ';
    v_sql3 := v_sql3||'                                    ''5044'', ';
    v_sql3 := v_sql3||'                                    ''5045'', ';
    v_sql3 := v_sql3||'                                    ''5046'', ';
    v_sql3 := v_sql3||'                                    ''5047'', ';
    v_sql3 := v_sql3||'                                    ''5051'', ';
    v_sql3 := v_sql3||'                                    ''5065'', ';
    v_sql3 := v_sql3||'                                    ''5072'', ';
    v_sql3 := v_sql3||'                                    ''5074'', ';
    v_sql3 := v_sql3||'                                    ''5111'', ';
    v_sql3 := v_sql3||'                                    ''5122'', ';
    v_sql3 := v_sql3||'                                    ''5131'', ';
    v_sql3 := v_sql3||'                                    ''5137'', ';
    v_sql3 := v_sql3||'                                    ''5139'', ';
    v_sql3 := v_sql3||'                                    ''5172'', ';
    v_sql3 := v_sql3||'                                    ''5192'', ';
    v_sql3 := v_sql3||'                                    ''5193'', ';
    v_sql3 := v_sql3||'                                    ''5198'', ';
    v_sql3 := v_sql3||'                                    ''5998'', ';
    v_sql3 := v_sql3||'                                    ''5013'', ';
    v_sql3 := v_sql3||'                                    ''5398'', ';
    v_sql3 := v_sql3||'                                    ''4458'', ';
    v_sql3 := v_sql3||'                                    ''9498'', ';
    v_sql3 := v_sql3||'                                    ''9703'', ';
    v_sql3 := v_sql3||'                                    ''9704'', ';
    v_sql3 := v_sql3||'                                    ''9705'', ';
    v_sql3 := v_sql3||'                                    ''9706'', ';
    v_sql3 := v_sql3||'                                    ''9707'', ';
    v_sql3 := v_sql3||'                                    ''9708'', ';
    v_sql3 := v_sql3||'                                    ''5200'', ';
    v_sql3 := v_sql3||'                                    ''5300'') ';
    v_sql3 := v_sql3||'                                    OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql3 := v_sql3||'                AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql3 := v_sql3||'                OR E.src_ind = ''I'' ) ';
    v_sql3 := v_sql3||'                AND BILL_AMT > 3500 ';
    v_sql3 := v_sql3||'                AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql3 := v_sql3||'                THEN ';
    v_sql3 := v_sql3||'                 1 ';
    v_sql3 := v_sql3||'              ELSE ';
    v_sql3 := v_sql3||'                 NULL ';
    v_sql3 := v_sql3||'              END ';
    v_sql3 := v_sql3||'           ) AS DLNETCOUNT_2 ';
    v_sql3 := v_sql3||'   FROM FDM_S24_EVENT E ';
    v_sql3 := v_sql3||'  WHERE     E.trans_type BETWEEN 1000 AND 1999 ';
    v_sql3 := v_sql3||'        AND E.trans_type NOT IN (''1050'', ''1051'') ';
    v_sql3 := v_sql3||'        AND (E.trans_type + 0) is not null ';
    v_sql3 := v_sql3||'        AND todate(E.CREATE_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -6) ';
    v_sql3 := v_sql3||'        AND todate(E.CREATE_DATE,''yyyy-mm-dd'') <= SYSDATE() ';
    v_sql3 := v_sql3||'        AND (coal(E.rev_ind,'' '') <> ''1'' or (E.rev_ind + 0) is null) ';
    v_sql3 := v_sql3||' GROUP BY E.ACCTNBR ';

        DBMS_OUTPUT.PUT_LINE('after:==========' || v_sql3);

        execute immediate v_sql3;

        DBMS_OUTPUT.PUT_LINE('PRC_ACCOUNT_INIT_TEMP_EVENT_PUR over:==========success!');

    	   --删除变动的数据
       EXECUTE IMMEDIATE ('truncate table temp_event_pur_6m');

       DBMS_OUTPUT.PUT_LINE('temp_event_pur_6m before:=========' || v_sql4);

    v_sql4 := v_sql4||' INSERT INTO temp_event_pur_6m     ';
    v_sql4 := v_sql4||'         SELECT E.ACCTNBR AS XACCOUNT, ';
    v_sql4 := v_sql4||'                SUM ( ';
    v_sql4 := v_sql4||'                   CASE ';
    v_sql4 := v_sql4||'                      WHEN (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR  substr(E.merch_seq,-4,3) in (''041'',''011'',''030''))  ';
    v_sql4 := v_sql4||'                                             AND E.bill_amt > 3500 AND ';
    v_sql4 := v_sql4||'                                              (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR ';
    v_sql4 := v_sql4||'                                            AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                      THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                   END) ';
    v_sql4 := v_sql4||'                   AS BADPUR_1, ';
    v_sql4 := v_sql4||'                SUM (  CASE ';
    v_sql4 := v_sql4||'                       WHEN             (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR ';
    v_sql4 := v_sql4||'                            THEN ';
    v_sql4 := v_sql4||'                                     CASE ';
    v_sql4 := v_sql4||'                                       WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                                         ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                             END ';
    v_sql4 := v_sql4||'                        ELSE ';
    v_sql4 := v_sql4||'                            0 ';
    v_sql4 := v_sql4||'                        END) ';
    v_sql4 := v_sql4||'                   AS PUR_1, ';
    v_sql4 := v_sql4||'                  COUNT ( CASE ';
    v_sql4 := v_sql4||'                       WHEN             (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR ';
    v_sql4 := v_sql4||'                            THEN ';
    v_sql4 := v_sql4||'                                     1 ';
    v_sql4 := v_sql4||'                            ELSE ';
    v_sql4 := v_sql4||'                            NULL ';
    v_sql4 := v_sql4||'                        END ';
    v_sql4 := v_sql4||'                  ) AS PUR_CNT_1, ';
    v_sql4 := v_sql4||'                  COUNT ( CASE ';
    v_sql4 := v_sql4||'                       WHEN             (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR ';
    v_sql4 := v_sql4||'                                     AND E.Src_Ind = ''I'' ';
    v_sql4 := v_sql4||'                                     AND E.Bill_Amt >= 500 ';
    v_sql4 := v_sql4||'                            THEN ';
    v_sql4 := v_sql4||'                                     1 ';
    v_sql4 := v_sql4||'                            ELSE ';
    v_sql4 := v_sql4||'                            NULL ';
    v_sql4 := v_sql4||'                        END ';
    v_sql4 := v_sql4||'                  ) AS PUR_CNT_NET_1, ';
    v_sql4 := v_sql4||'                SUM ( ';
    v_sql4 := v_sql4||'                   CASE ';
    v_sql4 := v_sql4||'                      WHEN (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR  substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                                             AND E.bill_amt > 3500 AND ';
    v_sql4 := v_sql4||'                                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 1 ';
    v_sql4 := v_sql4||'                                            AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                      THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                   END) ';
    v_sql4 := v_sql4||'                   AS BADPUR_2, ';
    v_sql4 := v_sql4||'                SUM (  CASE ';
    v_sql4 := v_sql4||'                       WHEN              (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 1 ';
    v_sql4 := v_sql4||'                            THEN ';
    v_sql4 := v_sql4||'                                     CASE ';
    v_sql4 := v_sql4||'                                       WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                                         ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                             END ';
    v_sql4 := v_sql4||'                        ELSE ';
    v_sql4 := v_sql4||'                            0 ';
    v_sql4 := v_sql4||'                        END) ';
    v_sql4 := v_sql4||'                   AS PUR_2, ';
    v_sql4 := v_sql4||'                  COUNT ( CASE ';
    v_sql4 := v_sql4||'                       WHEN                (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 1 ';
    v_sql4 := v_sql4||'                            THEN ';
    v_sql4 := v_sql4||'                                     1 ';
    v_sql4 := v_sql4||'                            ELSE ';
    v_sql4 := v_sql4||'                            NULL ';
    v_sql4 := v_sql4||'                        END ';
    v_sql4 := v_sql4||'                  ) AS PUR_CNT_2, ';
    v_sql4 := v_sql4||'                  COUNT ( CASE ';
    v_sql4 := v_sql4||'                       WHEN            (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 1 ';
    v_sql4 := v_sql4||'                                     AND E.Src_Ind = ''I'' ';
    v_sql4 := v_sql4||'                                     AND E.Bill_Amt >= 500 ';
    v_sql4 := v_sql4||'                            THEN ';
    v_sql4 := v_sql4||'                                     1 ';
    v_sql4 := v_sql4||'                            ELSE ';
    v_sql4 := v_sql4||'                            NULL ';
    v_sql4 := v_sql4||'                        END ';
    v_sql4 := v_sql4||'                  ) AS PUR_CNT_NET_2, ';
    v_sql4 := v_sql4||'                SUM ( ';
    v_sql4 := v_sql4||'                   CASE ';
    v_sql4 := v_sql4||'                                           WHEN (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR  substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) AND E.bill_amt > 3500 AND  ';
    v_sql4 := v_sql4||'                                            (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 2 ';
    v_sql4 := v_sql4||'                                            AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                      THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                   END) ';
    v_sql4 := v_sql4||'                   AS BADPUR_3, ';
    v_sql4 := v_sql4||'                SUM (  CASE ';
    v_sql4 := v_sql4||'                       WHEN                 (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 2 ';
    v_sql4 := v_sql4||'                            THEN ';
    v_sql4 := v_sql4||'                                     CASE ';
    v_sql4 := v_sql4||'                                       WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                                         ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                             END ';
    v_sql4 := v_sql4||'                        ELSE ';
    v_sql4 := v_sql4||'                            0 ';
    v_sql4 := v_sql4||'                        END) ';
    v_sql4 := v_sql4||'                   AS PUR_3, ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                  COUNT ( CASE ';
    v_sql4 := v_sql4||'                       WHEN                (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 2 ';
    v_sql4 := v_sql4||'                            THEN ';
    v_sql4 := v_sql4||'                                     1 ';
    v_sql4 := v_sql4||'                            ELSE ';
    v_sql4 := v_sql4||'                            NULL ';
    v_sql4 := v_sql4||'                        END ';
    v_sql4 := v_sql4||'                  ) AS PUR_CNT_3, ';
    v_sql4 := v_sql4||'                                   COUNT ( CASE ';
    v_sql4 := v_sql4||'                       WHEN             (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 2 ';
    v_sql4 := v_sql4||'                                     AND E.Src_Ind = ''I'' ';
    v_sql4 := v_sql4||'                                     AND E.Bill_Amt >= 500 ';
    v_sql4 := v_sql4||'                            THEN ';
    v_sql4 := v_sql4||'                                     1 ';
    v_sql4 := v_sql4||'                            ELSE ';
    v_sql4 := v_sql4||'                            NULL ';
    v_sql4 := v_sql4||'                        END ';
    v_sql4 := v_sql4||'                  ) AS PUR_CNT_NET_3, ';
    v_sql4 := v_sql4||'                SUM ( ';
    v_sql4 := v_sql4||'                   CASE ';
    v_sql4 := v_sql4||'                                           WHEN (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR  substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) AND E.bill_amt > 3500 AND ';
    v_sql4 := v_sql4||'                                            (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 3 ';
    v_sql4 := v_sql4||'                                            AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                      THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                   END) ';
    v_sql4 := v_sql4||'                   AS BADPUR_4, ';
    v_sql4 := v_sql4||'                SUM (  CASE ';
    v_sql4 := v_sql4||'                       WHEN             (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 3 ';
    v_sql4 := v_sql4||'                            THEN ';
    v_sql4 := v_sql4||'                                     CASE ';
    v_sql4 := v_sql4||'                                       WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                                         ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                             END ';
    v_sql4 := v_sql4||'                        ELSE ';
    v_sql4 := v_sql4||'                            0 ';
    v_sql4 := v_sql4||'                        END) ';
    v_sql4 := v_sql4||'                   AS PUR_4, ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                  COUNT ( CASE ';
    v_sql4 := v_sql4||'                       WHEN           (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 3 ';
    v_sql4 := v_sql4||'                            THEN ';
    v_sql4 := v_sql4||'                                     1 ';
    v_sql4 := v_sql4||'                            ELSE ';
    v_sql4 := v_sql4||'                            NULL ';
    v_sql4 := v_sql4||'                        END ';
    v_sql4 := v_sql4||'                  ) AS PUR_CNT_4, ';
    v_sql4 := v_sql4||'                                   COUNT ( CASE ';
    v_sql4 := v_sql4||'                       WHEN            (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 3 ';
    v_sql4 := v_sql4||'                                     AND E.Src_Ind = ''I'' ';
    v_sql4 := v_sql4||'                                     AND E.Bill_Amt >= 500 ';
    v_sql4 := v_sql4||'                            THEN ';
    v_sql4 := v_sql4||'                                     1 ';
    v_sql4 := v_sql4||'                            ELSE ';
    v_sql4 := v_sql4||'                            NULL ';
    v_sql4 := v_sql4||'                        END ';
    v_sql4 := v_sql4||'                  ) AS PUR_CNT_NET_4, ';
    v_sql4 := v_sql4||'                SUM ( ';
    v_sql4 := v_sql4||'                   CASE ';
    v_sql4 := v_sql4||'                                           WHEN (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR  substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) AND E.bill_amt > 3500 AND ';
    v_sql4 := v_sql4||'                                            (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 4 ';
    v_sql4 := v_sql4||'                                            AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                      THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                   END) ';
    v_sql4 := v_sql4||'                   AS BADPUR_5, ';
    v_sql4 := v_sql4||'                SUM (  CASE ';
    v_sql4 := v_sql4||'                       WHEN             (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 4 ';
    v_sql4 := v_sql4||'                            THEN ';
    v_sql4 := v_sql4||'                                     CASE ';
    v_sql4 := v_sql4||'                                       WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                                         ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                             END ';
    v_sql4 := v_sql4||'                        ELSE ';
    v_sql4 := v_sql4||'                            0 ';
    v_sql4 := v_sql4||'                        END) ';
    v_sql4 := v_sql4||'                   AS PUR_5, ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                  COUNT ( CASE ';
    v_sql4 := v_sql4||'                       WHEN             (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 4 ';
    v_sql4 := v_sql4||'                            THEN ';
    v_sql4 := v_sql4||'                                     1 ';
    v_sql4 := v_sql4||'                            ELSE ';
    v_sql4 := v_sql4||'                            NULL ';
    v_sql4 := v_sql4||'                        END ';
    v_sql4 := v_sql4||'                  ) AS PUR_CNT_5, ';
    v_sql4 := v_sql4||'                                   COUNT ( CASE ';
    v_sql4 := v_sql4||'                       WHEN             (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 4 ';
    v_sql4 := v_sql4||'                                     AND E.Src_Ind = ''I'' ';
    v_sql4 := v_sql4||'                                     AND E.Bill_Amt >= 500 ';
    v_sql4 := v_sql4||'                            THEN ';
    v_sql4 := v_sql4||'                                     1 ';
    v_sql4 := v_sql4||'                            ELSE ';
    v_sql4 := v_sql4||'                            NULL ';
    v_sql4 := v_sql4||'                        END ';
    v_sql4 := v_sql4||'                  ) AS PUR_CNT_NET_5, ';
    v_sql4 := v_sql4||'                SUM ( ';
    v_sql4 := v_sql4||'                   CASE ';
    v_sql4 := v_sql4||'                                           WHEN (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR  substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) AND E.bill_amt > 3500 AND ';
    v_sql4 := v_sql4||'                                            (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 5 ';
    v_sql4 := v_sql4||'                                            AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                      THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                   END) ';
    v_sql4 := v_sql4||'                   AS BADPUR_6, ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                SUM (  CASE ';
    v_sql4 := v_sql4||'                       WHEN             (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 5 ';
    v_sql4 := v_sql4||'                            THEN ';
    v_sql4 := v_sql4||'                                     CASE ';
    v_sql4 := v_sql4||'                                       WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                                         ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                             END ';
    v_sql4 := v_sql4||'                        ELSE ';
    v_sql4 := v_sql4||'                            0 ';
    v_sql4 := v_sql4||'                        END) ';
    v_sql4 := v_sql4||'                   AS PUR_6, ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                  COUNT ( CASE ';
    v_sql4 := v_sql4||'                       WHEN            (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 5 ';
    v_sql4 := v_sql4||'                            THEN ';
    v_sql4 := v_sql4||'                                     1 ';
    v_sql4 := v_sql4||'                            ELSE ';
    v_sql4 := v_sql4||'                            NULL ';
    v_sql4 := v_sql4||'                        END ';
    v_sql4 := v_sql4||'                  ) AS PUR_CNT_6, ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                                   COUNT ( CASE ';
    v_sql4 := v_sql4||'                       WHEN                 (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 5 ';
    v_sql4 := v_sql4||'                                     AND E.Src_Ind = ''I'' ';
    v_sql4 := v_sql4||'                                     AND E.Bill_Amt >= 500 ';
    v_sql4 := v_sql4||'                            THEN ';
    v_sql4 := v_sql4||'                                     1 ';
    v_sql4 := v_sql4||'                            ELSE ';
    v_sql4 := v_sql4||'                            NULL ';
    v_sql4 := v_sql4||'                        END ';
    v_sql4 := v_sql4||'                  ) AS PUR_CNT_NET_6, ';
    v_sql4 := v_sql4||'                                    SUM ( ';
    v_sql4 := v_sql4||'                   CASE ';
    v_sql4 := v_sql4||'                      WHEN E.MER_CAT_CD IN (''6300'', ';
    v_sql4 := v_sql4||'                                            ''5960'', ';
    v_sql4 := v_sql4||'                                            ''5541'', ';
    v_sql4 := v_sql4||'                                            ''5542'' ';
    v_sql4 := v_sql4||'                                            )  ';
    v_sql4 := v_sql4||'                                            AND (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR ';
    v_sql4 := v_sql4||'                                            AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                      THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                   END) ';
    v_sql4 := v_sql4||'                 AS BXJY_PUR_1, ';
    v_sql4 := v_sql4||'                                    SUM ( ';
    v_sql4 := v_sql4||'                   CASE ';
    v_sql4 := v_sql4||'                      WHEN E.MER_CAT_CD IN (''6300'', ';
    v_sql4 := v_sql4||'                                            ''5960'', ';
    v_sql4 := v_sql4||'                                            ''5541'', ';
    v_sql4 := v_sql4||'                                            ''5542'' ';
    v_sql4 := v_sql4||'                                            )  ';
    v_sql4 := v_sql4||'                                            AND (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 1 ';
    v_sql4 := v_sql4||'                                            AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                      THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                   END) ';
    v_sql4 := v_sql4||'                 AS BXJY_PUR_2, ';
    v_sql4 := v_sql4||'                                    SUM ( ';
    v_sql4 := v_sql4||'                   CASE ';
    v_sql4 := v_sql4||'                      WHEN E.MER_CAT_CD IN (''6300'', ';
    v_sql4 := v_sql4||'                                            ''5960'', ';
    v_sql4 := v_sql4||'                                            ''5541'', ';
    v_sql4 := v_sql4||'                                            ''5542'' ';
    v_sql4 := v_sql4||'                                            )  ';
    v_sql4 := v_sql4||'                                            AND (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 2 ';
    v_sql4 := v_sql4||'                                            AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                      THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                   END) ';
    v_sql4 := v_sql4||'                 AS BXJY_PUR_3, ';
    v_sql4 := v_sql4||'                                    SUM ( ';
    v_sql4 := v_sql4||'                   CASE ';
    v_sql4 := v_sql4||'                      WHEN E.MER_CAT_CD IN (''6300'', ';
    v_sql4 := v_sql4||'                                            ''5960'', ';
    v_sql4 := v_sql4||'                                            ''5541'', ';
    v_sql4 := v_sql4||'                                            ''5542'' ';
    v_sql4 := v_sql4||'                                            )  ';
    v_sql4 := v_sql4||'                                            AND (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 3 ';
    v_sql4 := v_sql4||'                                            AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                      THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                   END) ';
    v_sql4 := v_sql4||'                 AS BXJY_PUR_4, ';
    v_sql4 := v_sql4||'                                    SUM ( ';
    v_sql4 := v_sql4||'                   CASE ';
    v_sql4 := v_sql4||'                      WHEN E.MER_CAT_CD IN (''6300'', ';
    v_sql4 := v_sql4||'                                            ''5960'', ';
    v_sql4 := v_sql4||'                                            ''5541'', ';
    v_sql4 := v_sql4||'                                            ''5542'' ';
    v_sql4 := v_sql4||'                                            ) ';
    v_sql4 := v_sql4||'                                            AND (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 4 ';
    v_sql4 := v_sql4||'                                            AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                      THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                   END) ';
    v_sql4 := v_sql4||'                 AS BXJY_PUR_5, ';
    v_sql4 := v_sql4||'                                    SUM ( ';
    v_sql4 := v_sql4||'                   CASE ';
    v_sql4 := v_sql4||'                      WHEN E.MER_CAT_CD IN (''6300'', ';
    v_sql4 := v_sql4||'                                            ''5960'', ';
    v_sql4 := v_sql4||'                                            ''5541'', ';
    v_sql4 := v_sql4||'                                            ''5542'' ';
    v_sql4 := v_sql4||'                                            )  ';
    v_sql4 := v_sql4||'                                            AND (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 5 ';
    v_sql4 := v_sql4||'                                            AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                      THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                   END) ';
    v_sql4 := v_sql4||'                 AS BXJY_PUR_6, ';
    v_sql4 := v_sql4||'                                    SUM ( ';
    v_sql4 := v_sql4||'                   CASE ';
    v_sql4 := v_sql4||'                      WHEN E.MER_CAT_CD IN (''6300'', ';
    v_sql4 := v_sql4||'                                            ''5960'', ';
    v_sql4 := v_sql4||'                                            ''5541'', ';
    v_sql4 := v_sql4||'                                            ''5542'' ';
    v_sql4 := v_sql4||'                                            )  ';
    v_sql4 := v_sql4||'                                            AND (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR + 1 ';
    v_sql4 := v_sql4||'                                            AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                      THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                   END) ';
    v_sql4 := v_sql4||'                 AS BXJY_PUR_0, ';
    v_sql4 := v_sql4||'                 SUM ( ';
    v_sql4 := v_sql4||'                   CASE ';
    v_sql4 := v_sql4||'                      WHEN (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR  substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                                             AND E.bill_amt > 3500 AND ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                                              (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR + 1 ';
    v_sql4 := v_sql4||'                                              AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                      THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                   END) ';
    v_sql4 := v_sql4||'                   AS BADPUR_0, ';
    v_sql4 := v_sql4||'                SUM (  CASE ';
    v_sql4 := v_sql4||'                       WHEN ';
    v_sql4 := v_sql4||'                                              (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR + 1 ';
    v_sql4 := v_sql4||'                            THEN ';
    v_sql4 := v_sql4||'                                     CASE ';
    v_sql4 := v_sql4||'                                       WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                                         ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                             END ';
    v_sql4 := v_sql4||'                        ELSE ';
    v_sql4 := v_sql4||'                            0 ';
    v_sql4 := v_sql4||'                        END) ';
    v_sql4 := v_sql4||'                   AS PUR_0, ';
    v_sql4 := v_sql4||'                  COUNT ( CASE ';
    v_sql4 := v_sql4||'                       WHEN ';
    v_sql4 := v_sql4||'                                              (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR + 1 ';
    v_sql4 := v_sql4||'                            THEN ';
    v_sql4 := v_sql4||'                                     1 ';
    v_sql4 := v_sql4||'                            ELSE ';
    v_sql4 := v_sql4||'                            NULL ';
    v_sql4 := v_sql4||'                        END ';
    v_sql4 := v_sql4||'                  ) AS PUR_CNT_0, ';
    v_sql4 := v_sql4||'                  COUNT ( CASE ';
    v_sql4 := v_sql4||'                       WHEN ';
    v_sql4 := v_sql4||'                                              (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR + 1 ';
    v_sql4 := v_sql4||'                                     AND E.Src_Ind = ''I'' ';
    v_sql4 := v_sql4||'                                     AND E.Bill_Amt >= 500 ';
    v_sql4 := v_sql4||'                            THEN ';
    v_sql4 := v_sql4||'                                     1 ';
    v_sql4 := v_sql4||'                            ELSE ';
    v_sql4 := v_sql4||'                            NULL ';
    v_sql4 := v_sql4||'                        END ';
    v_sql4 := v_sql4||'                  ) AS PUR_CNT_NET_0,                                   COUNT ( ';
    v_sql4 := v_sql4||'                   CASE ';
    v_sql4 := v_sql4||'                      WHEN   (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR ';
    v_sql4 := v_sql4||'                        AND  coal(E.Src_Ind,'' '') <> ''I'' ';
    v_sql4 := v_sql4||'                        AND (((E.MER_CAT_CD  IN ';
    v_sql4 := v_sql4||' (''7011'', ';
    v_sql4 := v_sql4||' ''7012'', ';
    v_sql4 := v_sql4||' ''5811'', ';
    v_sql4 := v_sql4||' ''5812'', ';
    v_sql4 := v_sql4||' ''5813'', ';
    v_sql4 := v_sql4||' ''5094'', ';
    v_sql4 := v_sql4||' ''5937'', ';
    v_sql4 := v_sql4||' ''5950'', ';
    v_sql4 := v_sql4||' ''5970'', ';
    v_sql4 := v_sql4||' ''5971'', ';
    v_sql4 := v_sql4||' ''7297'', ';
    v_sql4 := v_sql4||' ''7298'', ';
    v_sql4 := v_sql4||' ''7829'', ';
    v_sql4 := v_sql4||' ''7911'', ';
    v_sql4 := v_sql4||' ''7922'', ';
    v_sql4 := v_sql4||' ''7929'', ';
    v_sql4 := v_sql4||' ''7932'', ';
    v_sql4 := v_sql4||' ''7933'', ';
    v_sql4 := v_sql4||' ''7941'', ';
    v_sql4 := v_sql4||' ''7992'', ';
    v_sql4 := v_sql4||' ''7994'', ';
    v_sql4 := v_sql4||' ''7996'', ';
    v_sql4 := v_sql4||' ''7997'', ';
    v_sql4 := v_sql4||' ''7998'', ';
    v_sql4 := v_sql4||' ''7032'', ';
    v_sql4 := v_sql4||' ''7033'', ';
    v_sql4 := v_sql4||' ''5944'', ';
    v_sql4 := v_sql4||' ''5932'', ';
    v_sql4 := v_sql4||' ''7631'', ';
    v_sql4 := v_sql4||' ''7999'', ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'', ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'') OR (E.MER_CAT_CD IN  (''1520'',''7013'',''5271'',''5511'',''5521'',''5551'',''5561'',''5571'',''5592'',''5598'',''5599'',''5933'',''8062'',''8211'',''8220'',''8398'',''5021'',''5039'',''5044'',''5045'',''5046'',''5047'',''5051'',''5065'',''5072'',''5074'',''5111'',''5122'',''5131'',''5137'',''5139'',''5172'',''5192'',''5193'',''5198'',''5998'',''5013'',''5398'',''4458'',''9498'',''9703'',''9704'',''9705'',''9706'',''9707'',''9708'',''5200'',''5300'') AND E.Bill_Amt <= 3500 )) ';
    v_sql4 := v_sql4||'                                            AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') AND (substr(E.merch_seq,-4,3)+0) is not null ';
    v_sql4 := v_sql4||'                                            AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ) ';
    v_sql4 := v_sql4||'                                            OR coal(E.MERCH_STAT,'' '') <> ''156''  ) ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                      THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                   END) ';
    v_sql4 := v_sql4||'                   AS GOODCNT_1, ';
    v_sql4 := v_sql4||'                   COUNT ( ';
    v_sql4 := v_sql4||'                   CASE ';
    v_sql4 := v_sql4||'                      WHEN   (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 1 ';
    v_sql4 := v_sql4||'                        AND  coal(E.Src_Ind,'' '') <> ''I'' ';
    v_sql4 := v_sql4||'                        AND (((E.MER_CAT_CD  IN ';
    v_sql4 := v_sql4||' (''7011'', ';
    v_sql4 := v_sql4||' ''7012'', ';
    v_sql4 := v_sql4||' ''5811'', ';
    v_sql4 := v_sql4||' ''5812'', ';
    v_sql4 := v_sql4||' ''5813'', ';
    v_sql4 := v_sql4||' ''5094'', ';
    v_sql4 := v_sql4||' ''5937'', ';
    v_sql4 := v_sql4||' ''5950'', ';
    v_sql4 := v_sql4||' ''5970'', ';
    v_sql4 := v_sql4||' ''5971'', ';
    v_sql4 := v_sql4||' ''7297'', ';
    v_sql4 := v_sql4||' ''7298'', ';
    v_sql4 := v_sql4||' ''7829'', ';
    v_sql4 := v_sql4||' ''7911'', ';
    v_sql4 := v_sql4||' ''7922'', ';
    v_sql4 := v_sql4||' ''7929'', ';
    v_sql4 := v_sql4||' ''7932'', ';
    v_sql4 := v_sql4||' ''7933'', ';
    v_sql4 := v_sql4||' ''7941'', ';
    v_sql4 := v_sql4||' ''7992'', ';
    v_sql4 := v_sql4||' ''7994'', ';
    v_sql4 := v_sql4||' ''7996'', ';
    v_sql4 := v_sql4||' ''7997'', ';
    v_sql4 := v_sql4||' ''7998'', ';
    v_sql4 := v_sql4||' ''7032'', ';
    v_sql4 := v_sql4||' ''7033'', ';
    v_sql4 := v_sql4||' ''5944'', ';
    v_sql4 := v_sql4||' ''5932'', ';
    v_sql4 := v_sql4||' ''7631'', ';
    v_sql4 := v_sql4||' ''7999'', ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'', ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'') OR (E.MER_CAT_CD IN (''1520'',''7013'',''5271'',''5511'',''5521'',''5551'',''5561'',''5571'',''5592'',''5598'',''5599'',''5933'',''8062'',''8211'',''8220'',''8398'',''5021'',''5039'',''5044'',''5045'',''5046'',''5047'',''5051'',''5065'',''5072'',''5074'',''5111'',''5122'',''5131'',''5137'',''5139'',''5172'',''5192'',''5193'',''5198'',''5998'',''5013'',''5398'',''4458'',''9498'',''9703'',''9704'',''9705'',''9706'',''9707'',''9708'',''5200'',''5300'')  AND E.Bill_Amt <= 3500 ))  ';
    v_sql4 := v_sql4||'                                            AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                                            AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ) ';
    v_sql4 := v_sql4||'                                            OR coal(E.MERCH_STAT,'' '') <> ''156''  ) ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                      THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                   END) ';
    v_sql4 := v_sql4||'                   AS GOODCNT_2, ';
    v_sql4 := v_sql4||'                   COUNT ( ';
    v_sql4 := v_sql4||'                   CASE ';
    v_sql4 := v_sql4||'                      WHEN   (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 2 ';
    v_sql4 := v_sql4||'                        AND  coal(E.Src_Ind,'' '') <> ''I'' ';
    v_sql4 := v_sql4||'                        AND (((E.MER_CAT_CD  IN ';
    v_sql4 := v_sql4||' (''7011'', ';
    v_sql4 := v_sql4||' ''7012'', ';
    v_sql4 := v_sql4||' ''5811'', ';
    v_sql4 := v_sql4||' ''5812'', ';
    v_sql4 := v_sql4||' ''5813'', ';
    v_sql4 := v_sql4||' ''5094'', ';
    v_sql4 := v_sql4||' ''5937'', ';
    v_sql4 := v_sql4||' ''5950'', ';
    v_sql4 := v_sql4||' ''5970'', ';
    v_sql4 := v_sql4||' ''5971'', ';
    v_sql4 := v_sql4||' ''7297'', ';
    v_sql4 := v_sql4||' ''7298'', ';
    v_sql4 := v_sql4||' ''7829'', ';
    v_sql4 := v_sql4||' ''7911'', ';
    v_sql4 := v_sql4||' ''7922'', ';
    v_sql4 := v_sql4||' ''7929'', ';
    v_sql4 := v_sql4||' ''7932'', ';
    v_sql4 := v_sql4||' ''7933'', ';
    v_sql4 := v_sql4||' ''7941'', ';
    v_sql4 := v_sql4||' ''7992'', ';
    v_sql4 := v_sql4||' ''7994'', ';
    v_sql4 := v_sql4||' ''7996'', ';
    v_sql4 := v_sql4||' ''7997'', ';
    v_sql4 := v_sql4||' ''7998'', ';
    v_sql4 := v_sql4||' ''7032'', ';
    v_sql4 := v_sql4||' ''7033'', ';
    v_sql4 := v_sql4||' ''5944'', ';
    v_sql4 := v_sql4||' ''5932'', ';
    v_sql4 := v_sql4||' ''7631'', ';
    v_sql4 := v_sql4||' ''7999'', ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'', ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'') OR (E.MER_CAT_CD IN (''1520'',''7013'',''5271'',''5511'',''5521'',''5551'',''5561'',''5571'',''5592'',''5598'',''5599'',''5933'',''8062'',''8211'',''8220'',''8398'',''5021'',''5039'',''5044'',''5045'',''5046'',''5047'',''5051'',''5065'',''5072'',''5074'',''5111'',''5122'',''5131'',''5137'',''5139'',''5172'',''5192'',''5193'',''5198'',''5998'',''5013'',''5398'',''4458'',''9498'',''9703'',''9704'',''9705'',''9706'',''9707'',''9708'',''5200'',''5300'') AND E.Bill_Amt <= 3500 ))  ';
    v_sql4 := v_sql4||'                                            AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                                            AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ) ';
    v_sql4 := v_sql4||'                                            OR coal(E.MERCH_STAT,'' '') <> ''156''  ) ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                      THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                   END) ';
    v_sql4 := v_sql4||'                   AS GOODCNT_3, ';
    v_sql4 := v_sql4||'                   COUNT ( ';
    v_sql4 := v_sql4||'                   CASE ';
    v_sql4 := v_sql4||'                      WHEN   (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 3 ';
    v_sql4 := v_sql4||'                        AND  coal(E.Src_Ind,'' '') <> ''I'' ';
    v_sql4 := v_sql4||'                        AND (((E.MER_CAT_CD  IN ';
    v_sql4 := v_sql4||' (''7011'', ';
    v_sql4 := v_sql4||' ''7012'', ';
    v_sql4 := v_sql4||' ''5811'', ';
    v_sql4 := v_sql4||' ''5812'', ';
    v_sql4 := v_sql4||' ''5813'', ';
    v_sql4 := v_sql4||' ''5094'', ';
    v_sql4 := v_sql4||' ''5937'', ';
    v_sql4 := v_sql4||' ''5950'', ';
    v_sql4 := v_sql4||' ''5970'', ';
    v_sql4 := v_sql4||' ''5971'', ';
    v_sql4 := v_sql4||' ''7297'', ';
    v_sql4 := v_sql4||' ''7298'', ';
    v_sql4 := v_sql4||' ''7829'', ';
    v_sql4 := v_sql4||' ''7911'', ';
    v_sql4 := v_sql4||' ''7922'', ';
    v_sql4 := v_sql4||' ''7929'', ';
    v_sql4 := v_sql4||' ''7932'', ';
    v_sql4 := v_sql4||' ''7933'', ';
    v_sql4 := v_sql4||' ''7941'', ';
    v_sql4 := v_sql4||' ''7992'', ';
    v_sql4 := v_sql4||' ''7994'', ';
    v_sql4 := v_sql4||' ''7996'', ';
    v_sql4 := v_sql4||' ''7997'', ';
    v_sql4 := v_sql4||' ''7998'', ';
    v_sql4 := v_sql4||' ''7032'', ';
    v_sql4 := v_sql4||' ''7033'', ';
    v_sql4 := v_sql4||' ''5944'', ';
    v_sql4 := v_sql4||' ''5932'', ';
    v_sql4 := v_sql4||' ''7631'', ';
    v_sql4 := v_sql4||' ''7999'', ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'', ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'') OR (E.MER_CAT_CD IN (''1520'',''7013'',''5271'',''5511'',''5521'',''5551'',''5561'',''5571'',''5592'',''5598'',''5599'',''5933'',''8062'',''8211'',''8220'',''8398'',''5021'',''5039'',''5044'',''5045'',''5046'',''5047'',''5051'',''5065'',''5072'',''5074'',''5111'',''5122'',''5131'',''5137'',''5139'',''5172'',''5192'',''5193'',''5198'',''5998'',''5013'',''5398'',''4458'',''9498'',''9703'',''9704'',''9705'',''9706'',''9707'',''9708'',''5200'',''5300'') AND E.Bill_Amt <= 3500 ))  ';
    v_sql4 := v_sql4||'                                            AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                                            AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ) ';
    v_sql4 := v_sql4||'                                            OR coal(E.MERCH_STAT,'' '') <> ''156''  ) ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                      THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                   END) ';
    v_sql4 := v_sql4||'                   AS GOODCNT_4, ';
    v_sql4 := v_sql4||'                   COUNT ( ';
    v_sql4 := v_sql4||'                   CASE ';
    v_sql4 := v_sql4||'                      WHEN   (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 4 ';
    v_sql4 := v_sql4||'                        AND  coal(E.Src_Ind,'' '') <> ''I'' ';
    v_sql4 := v_sql4||'                        AND (((E.MER_CAT_CD  IN ';
    v_sql4 := v_sql4||' (''7011'', ';
    v_sql4 := v_sql4||' ''7012'', ';
    v_sql4 := v_sql4||' ''5811'', ';
    v_sql4 := v_sql4||' ''5812'', ';
    v_sql4 := v_sql4||' ''5813'', ';
    v_sql4 := v_sql4||' ''5094'', ';
    v_sql4 := v_sql4||' ''5937'', ';
    v_sql4 := v_sql4||' ''5950'', ';
    v_sql4 := v_sql4||' ''5970'', ';
    v_sql4 := v_sql4||' ''5971'', ';
    v_sql4 := v_sql4||' ''7297'', ';
    v_sql4 := v_sql4||' ''7298'', ';
    v_sql4 := v_sql4||' ''7829'', ';
    v_sql4 := v_sql4||' ''7911'', ';
    v_sql4 := v_sql4||' ''7922'', ';
    v_sql4 := v_sql4||' ''7929'', ';
    v_sql4 := v_sql4||' ''7932'', ';
    v_sql4 := v_sql4||' ''7933'', ';
    v_sql4 := v_sql4||' ''7941'', ';
    v_sql4 := v_sql4||' ''7992'', ';
    v_sql4 := v_sql4||' ''7994'', ';
    v_sql4 := v_sql4||' ''7996'', ';
    v_sql4 := v_sql4||' ''7997'', ';
    v_sql4 := v_sql4||' ''7998'', ';
    v_sql4 := v_sql4||' ''7032'', ';
    v_sql4 := v_sql4||' ''7033'', ';
    v_sql4 := v_sql4||' ''5944'', ';
    v_sql4 := v_sql4||' ''5932'', ';
    v_sql4 := v_sql4||' ''7631'', ';
    v_sql4 := v_sql4||' ''7999'', ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'', ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'') OR (E.MER_CAT_CD IN (''1520'',''7013'',''5271'',''5511'',''5521'',''5551'',''5561'',''5571'',''5592'',''5598'',''5599'',''5933'',''8062'',''8211'',''8220'',''8398'',''5021'',''5039'',''5044'',''5045'',''5046'',''5047'',''5051'',''5065'',''5072'',''5074'',''5111'',''5122'',''5131'',''5137'',''5139'',''5172'',''5192'',''5193'',''5198'',''5998'',''5013'',''5398'',''4458'',''9498'',''9703'',''9704'',''9705'',''9706'',''9707'',''9708'',''5200'',''5300'')  AND E.Bill_Amt <= 3500 )) ';
    v_sql4 := v_sql4||'                                            AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                                            AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ) ';
    v_sql4 := v_sql4||'                                            OR coal(E.MERCH_STAT,'' '') <> ''156''  ) ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                      THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                   END) ';
    v_sql4 := v_sql4||'                   AS GOODCNT_5, ';
    v_sql4 := v_sql4||'                   COUNT ( ';
    v_sql4 := v_sql4||'                   CASE ';
    v_sql4 := v_sql4||'                      WHEN   (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 5 ';
    v_sql4 := v_sql4||'                        AND  coal(E.Src_Ind,'' '') <> ''I'' ';
    v_sql4 := v_sql4||'                        AND (((E.MER_CAT_CD  IN ';
    v_sql4 := v_sql4||' (''7011'', ';
    v_sql4 := v_sql4||' ''7012'', ';
    v_sql4 := v_sql4||' ''5811'', ';
    v_sql4 := v_sql4||' ''5812'', ';
    v_sql4 := v_sql4||' ''5813'', ';
    v_sql4 := v_sql4||' ''5094'', ';
    v_sql4 := v_sql4||' ''5937'', ';
    v_sql4 := v_sql4||' ''5950'', ';
    v_sql4 := v_sql4||' ''5970'', ';
    v_sql4 := v_sql4||' ''5971'', ';
    v_sql4 := v_sql4||' ''7297'', ';
    v_sql4 := v_sql4||' ''7298'', ';
    v_sql4 := v_sql4||' ''7829'', ';
    v_sql4 := v_sql4||' ''7911'', ';
    v_sql4 := v_sql4||' ''7922'', ';
    v_sql4 := v_sql4||' ''7929'', ';
    v_sql4 := v_sql4||' ''7932'', ';
    v_sql4 := v_sql4||' ''7933'', ';
    v_sql4 := v_sql4||' ''7941'', ';
    v_sql4 := v_sql4||' ''7992'', ';
    v_sql4 := v_sql4||' ''7994'', ';
    v_sql4 := v_sql4||' ''7996'', ';
    v_sql4 := v_sql4||' ''7997'', ';
    v_sql4 := v_sql4||' ''7998'', ';
    v_sql4 := v_sql4||' ''7032'', ';
    v_sql4 := v_sql4||' ''7033'', ';
    v_sql4 := v_sql4||' ''5944'', ';
    v_sql4 := v_sql4||' ''5932'', ';
    v_sql4 := v_sql4||' ''7631'', ';
    v_sql4 := v_sql4||' ''7999'', ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'', ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'') OR (E.MER_CAT_CD IN (''1520'',''7013'',''5271'',''5511'',''5521'',''5551'',''5561'',''5571'',''5592'',''5598'',''5599'',''5933'',''8062'',''8211'',''8220'',''8398'',''5021'',''5039'',''5044'',''5045'',''5046'',''5047'',''5051'',''5065'',''5072'',''5074'',''5111'',''5122'',''5131'',''5137'',''5139'',''5172'',''5192'',''5193'',''5198'',''5998'',''5013'',''5398'',''4458'',''9498'',''9703'',''9704'',''9705'',''9706'',''9707'',''9708'',''5200'',''5300'') AND E.Bill_Amt <= 3500 ))';
    v_sql4 := v_sql4||'                                            AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'')';
    v_sql4 := v_sql4||'                                            AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) )';
    v_sql4 := v_sql4||'                                            OR coal(E.MERCH_STAT,'' '') <> ''156''  )';
    v_sql4 := v_sql4||' ';
    v_sql4 := v_sql4||'                      THEN';
    v_sql4 := v_sql4||'                         1';
    v_sql4 := v_sql4||'                      ELSE';
    v_sql4 := v_sql4||'                         NULL';
    v_sql4 := v_sql4||'                   END)';
    v_sql4 := v_sql4||'                   AS GOODCNT_6,';
    v_sql4 := v_sql4||'                   COUNT (';
    v_sql4 := v_sql4||'                   CASE';
    v_sql4 := v_sql4||'                      WHEN   (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR + 1';
    v_sql4 := v_sql4||'                        AND  coal(E.Src_Ind,'' '') <> ''I'' ';
    v_sql4 := v_sql4||'                        AND (((E.MER_CAT_CD  IN';
    v_sql4 := v_sql4||' (''7011'',';
    v_sql4 := v_sql4||' ''7012'',';
    v_sql4 := v_sql4||' ''5811'',';
    v_sql4 := v_sql4||' ''5812'',';
    v_sql4 := v_sql4||' ''5813'',';
    v_sql4 := v_sql4||' ''5094'',';
    v_sql4 := v_sql4||' ''5937'',';
    v_sql4 := v_sql4||' ''5950'',';
    v_sql4 := v_sql4||' ''5970'',';
    v_sql4 := v_sql4||' ''5971'',';
    v_sql4 := v_sql4||' ''7297'',';
    v_sql4 := v_sql4||' ''7298'',';
    v_sql4 := v_sql4||' ''7829'',';
    v_sql4 := v_sql4||' ''7911'',';
    v_sql4 := v_sql4||' ''7922'',';
    v_sql4 := v_sql4||' ''7929'',';
    v_sql4 := v_sql4||' ''7932'',';
    v_sql4 := v_sql4||' ''7933'',';
    v_sql4 := v_sql4||' ''7941'',';
    v_sql4 := v_sql4||' ''7992'',';
    v_sql4 := v_sql4||' ''7994'',';
    v_sql4 := v_sql4||' ''7996'',';
    v_sql4 := v_sql4||' ''7997'',';
    v_sql4 := v_sql4||' ''7998'',';
    v_sql4 := v_sql4||' ''7032'',';
    v_sql4 := v_sql4||' ''7033'',';
    v_sql4 := v_sql4||' ''5944'',';
    v_sql4 := v_sql4||' ''5932'',';
    v_sql4 := v_sql4||' ''7631'',';
    v_sql4 := v_sql4||' ''7999'',';
    v_sql4 := v_sql4||' ''5541'',';
    v_sql4 := v_sql4||' ''5542'',';
    v_sql4 := v_sql4||' ''5411'',';
    v_sql4 := v_sql4||' ''5722'',';
    v_sql4 := v_sql4||' ''4511'',';
    v_sql4 := v_sql4||' ''4111'',';
    v_sql4 := v_sql4||' ''4121'',';
    v_sql4 := v_sql4||' ''4131'',';
    v_sql4 := v_sql4||' ''4784'',';
    v_sql4 := v_sql4||' ''3998'',';
    v_sql4 := v_sql4||' ''4112'',';
    v_sql4 := v_sql4||' ''4900'',';
    v_sql4 := v_sql4||' ''4814'',';
    v_sql4 := v_sql4||' ''4899'',';
    v_sql4 := v_sql4||' ''6300'',';
    v_sql4 := v_sql4||' ''5960'',';
    v_sql4 := v_sql4||' ''8651'',';
    v_sql4 := v_sql4||' ''9211'',';
    v_sql4 := v_sql4||' ''9222'',';
    v_sql4 := v_sql4||' ''9223'',';
    v_sql4 := v_sql4||' ''9311'',';
    v_sql4 := v_sql4||' ''9399'',';
    v_sql4 := v_sql4||' ''9400'',';
    v_sql4 := v_sql4||' ''5994'',';
    v_sql4 := v_sql4||' ''7523'',';
    v_sql4 := v_sql4||' ''9402'',';
    v_sql4 := v_sql4||' ''742'',';
    v_sql4 := v_sql4||' ''763'',';
    v_sql4 := v_sql4||' ''780'',';
    v_sql4 := v_sql4||' ''4011'',';
    v_sql4 := v_sql4||' ''4119'',';
    v_sql4 := v_sql4||' ''4214'',';
    v_sql4 := v_sql4||' ''4215'',';
    v_sql4 := v_sql4||' ''4225'',';
    v_sql4 := v_sql4||' ''4411'',';
    v_sql4 := v_sql4||' ''4457'',';
    v_sql4 := v_sql4||' ''4468'',';
    v_sql4 := v_sql4||' ''4582'',';
    v_sql4 := v_sql4||' ''4722'',';
    v_sql4 := v_sql4||' ''4733'',';
    v_sql4 := v_sql4||' ''4789'',';
    v_sql4 := v_sql4||' ''4812'',';
    v_sql4 := v_sql4||' ''4816'',';
    v_sql4 := v_sql4||' ''4821'',';
    v_sql4 := v_sql4||' ''5211'',';
    v_sql4 := v_sql4||' ''5231'',';
    v_sql4 := v_sql4||' ''5251'',';
    v_sql4 := v_sql4||' ''5261'',';
    v_sql4 := v_sql4||' ''5309'',';
    v_sql4 := v_sql4||' ''5310'',';
    v_sql4 := v_sql4||' ''5311'',';
    v_sql4 := v_sql4||' ''5331'',';
    v_sql4 := v_sql4||' ''5399'',';
    v_sql4 := v_sql4||' ''5422'',';
    v_sql4 := v_sql4||' ''5441'',';
    v_sql4 := v_sql4||' ''5451'',';
    v_sql4 := v_sql4||' ''5462'',';
    v_sql4 := v_sql4||' ''5499'',';
    v_sql4 := v_sql4||' ''5532'',';
    v_sql4 := v_sql4||' ''5533'',';
    v_sql4 := v_sql4||' ''5611'',';
    v_sql4 := v_sql4||' ''5621'',';
    v_sql4 := v_sql4||' ''5631'',';
    v_sql4 := v_sql4||' ''5641'',';
    v_sql4 := v_sql4||' ''5651'',';
    v_sql4 := v_sql4||' ''5655'',';
    v_sql4 := v_sql4||' ''5661'',';
    v_sql4 := v_sql4||' ''5681'',';
    v_sql4 := v_sql4||' ''5691'',';
    v_sql4 := v_sql4||' ''5697'',';
    v_sql4 := v_sql4||' ''5698'',';
    v_sql4 := v_sql4||' ''5699'',';
    v_sql4 := v_sql4||' ''5712'',';
    v_sql4 := v_sql4||' ''5713'',';
    v_sql4 := v_sql4||' ''5714'',';
    v_sql4 := v_sql4||' ''5718'',';
    v_sql4 := v_sql4||' ''5719'',';
    v_sql4 := v_sql4||' ''5732'',';
    v_sql4 := v_sql4||' ''5733'',';
    v_sql4 := v_sql4||' ''5734'',';
    v_sql4 := v_sql4||' ''5735'',';
    v_sql4 := v_sql4||' ''5814'',';
    v_sql4 := v_sql4||' ''5912'',';
    v_sql4 := v_sql4||' ''5921'',';
    v_sql4 := v_sql4||' ''5931'',';
    v_sql4 := v_sql4||' ''5935'',';
    v_sql4 := v_sql4||' ''5940'',';
    v_sql4 := v_sql4||' ''5941'',';
    v_sql4 := v_sql4||' ''5942'',';
    v_sql4 := v_sql4||' ''5943'',';
    v_sql4 := v_sql4||' ''5945'',';
    v_sql4 := v_sql4||' ''5946'',';
    v_sql4 := v_sql4||' ''5947'',';
    v_sql4 := v_sql4||' ''5948'',';
    v_sql4 := v_sql4||' ''5949'',';
    v_sql4 := v_sql4||' ''5962'',';
    v_sql4 := v_sql4||' ''5963'',';
    v_sql4 := v_sql4||' ''5964'',';
    v_sql4 := v_sql4||' ''5965'',';
    v_sql4 := v_sql4||' ''5966'',';
    v_sql4 := v_sql4||' ''5967'',';
    v_sql4 := v_sql4||' ''5968'',';
    v_sql4 := v_sql4||' ''5969'',';
    v_sql4 := v_sql4||' ''5972'',';
    v_sql4 := v_sql4||' ''5973'',';
    v_sql4 := v_sql4||' ''5975'',';
    v_sql4 := v_sql4||' ''5976'',';
    v_sql4 := v_sql4||' ''5977'',';
    v_sql4 := v_sql4||' ''5978'',';
    v_sql4 := v_sql4||' ''5983'',';
    v_sql4 := v_sql4||' ''5992'',';
    v_sql4 := v_sql4||' ''5993'',';
    v_sql4 := v_sql4||' ''5995'',';
    v_sql4 := v_sql4||' ''5996'',';
    v_sql4 := v_sql4||' ''5997'',';
    v_sql4 := v_sql4||' ''5999'',';
    v_sql4 := v_sql4||' ''6010'',';
    v_sql4 := v_sql4||' ''6011'',';
    v_sql4 := v_sql4||' ''6012'',';
    v_sql4 := v_sql4||' ''6051'',';
    v_sql4 := v_sql4||' ''6211'',';
    v_sql4 := v_sql4||' ''6513'',';
    v_sql4 := v_sql4||' ''7210'',';
    v_sql4 := v_sql4||' ''7211'',';
    v_sql4 := v_sql4||' ''7216'',';
    v_sql4 := v_sql4||' ''7217'',';
    v_sql4 := v_sql4||' ''7221'',';
    v_sql4 := v_sql4||' ''7230'',';
    v_sql4 := v_sql4||' ''7251'',';
    v_sql4 := v_sql4||' ''7261'',';
    v_sql4 := v_sql4||' ''7273'',';
    v_sql4 := v_sql4||' ''7276'',';
    v_sql4 := v_sql4||' ''7277'',';
    v_sql4 := v_sql4||' ''7278'',';
    v_sql4 := v_sql4||' ''7295'',';
    v_sql4 := v_sql4||' ''7296'',';
    v_sql4 := v_sql4||' ''7299'',';
    v_sql4 := v_sql4||' ''7311'',';
    v_sql4 := v_sql4||' ''7321'',';
    v_sql4 := v_sql4||' ''7333'',';
    v_sql4 := v_sql4||' ''7338'',';
    v_sql4 := v_sql4||' ''7339'',';
    v_sql4 := v_sql4||' ''7342'',';
    v_sql4 := v_sql4||' ''7349'',';
    v_sql4 := v_sql4||' ''7361'',';
    v_sql4 := v_sql4||' ''7372'',';
    v_sql4 := v_sql4||' ''7375'',';
    v_sql4 := v_sql4||' ''7379'',';
    v_sql4 := v_sql4||' ''7392'',';
    v_sql4 := v_sql4||' ''7393'',';
    v_sql4 := v_sql4||' ''7394'',';
    v_sql4 := v_sql4||' ''7395'',';
    v_sql4 := v_sql4||' ''7399'',';
    v_sql4 := v_sql4||' ''7512'',';
    v_sql4 := v_sql4||' ''7513'',';
    v_sql4 := v_sql4||' ''7519'',';
    v_sql4 := v_sql4||' ''7531'',';
    v_sql4 := v_sql4||' ''7534'',';
    v_sql4 := v_sql4||' ''7535'',';
    v_sql4 := v_sql4||' ''7538'',';
    v_sql4 := v_sql4||' ''7542'',';
    v_sql4 := v_sql4||' ''7549'',';
    v_sql4 := v_sql4||' ''7622'',';
    v_sql4 := v_sql4||' ''7623'',';
    v_sql4 := v_sql4||' ''7629'',';
    v_sql4 := v_sql4||' ''7641'',';
    v_sql4 := v_sql4||' ''7692'',';
    v_sql4 := v_sql4||' ''7699'',';
    v_sql4 := v_sql4||' ''7832'',';
    v_sql4 := v_sql4||' ''7841'',';
    v_sql4 := v_sql4||' ''7991'',';
    v_sql4 := v_sql4||' ''7993'',';
    v_sql4 := v_sql4||' ''7995'',';
    v_sql4 := v_sql4||' ''8011'',';
    v_sql4 := v_sql4||' ''8021'',';
    v_sql4 := v_sql4||' ''8031'',';
    v_sql4 := v_sql4||' ''8041'',';
    v_sql4 := v_sql4||' ''8042'',';
    v_sql4 := v_sql4||' ''8043'',';
    v_sql4 := v_sql4||' ''8049'',';
    v_sql4 := v_sql4||' ''8050'',';
    v_sql4 := v_sql4||' ''8071'',';
    v_sql4 := v_sql4||' ''8099'',';
    v_sql4 := v_sql4||' ''8111'',';
    v_sql4 := v_sql4||' ''8241'',';
    v_sql4 := v_sql4||' ''8244'',';
    v_sql4 := v_sql4||' ''8249'',';
    v_sql4 := v_sql4||' ''8299'',';
    v_sql4 := v_sql4||' ''8351'',';
    v_sql4 := v_sql4||' ''8641'',';
    v_sql4 := v_sql4||' ''8661'',';
    v_sql4 := v_sql4||' ''8675'',';
    v_sql4 := v_sql4||' ''8699'',';
    v_sql4 := v_sql4||' ''8911'',';
    v_sql4 := v_sql4||' ''8912'',';
    v_sql4 := v_sql4||' ''8931'',';
    v_sql4 := v_sql4||' ''8999'',';
    v_sql4 := v_sql4||' ''1001'',';
    v_sql4 := v_sql4||' ''6013'') OR (E.MER_CAT_CD IN (''1520'',''7013'',''5271'',''5511'',''5521'',''5551'',''5561'',''5571'',''5592'',''5598'',''5599'',''5933'',''8062'',''8211'',''8220'',''8398'',''5021'',''5039'',''5044'',''5045'',''5046'',''5047'',''5051'',''5065'',''5072'',''5074'',''5111'',''5122'',''5131'',''5137'',''5139'',''5172'',''5192'',''5193'',''5198'',''5998'',''5013'',''5398'',''4458'',''9498'',''9703'',''9704'',''9705'',''9706'',''9707'',''9708'',''5200'',''5300'') AND E.Bill_Amt <= 3500 )) ';
    v_sql4 := v_sql4||'                                            AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                                            AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ) ';
    v_sql4 := v_sql4||'                                            OR coal(E.MERCH_STAT,'' '') <> ''156''  ) ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                      THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                   END) ';
    v_sql4 := v_sql4||'                   AS GOODCNT_0, ';
    v_sql4 := v_sql4||'                    SUM ( ';
    v_sql4 := v_sql4||'                   CASE ';
    v_sql4 := v_sql4||'                      WHEN   (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR ';
    v_sql4 := v_sql4||'                        AND  coal(E.Src_Ind,'' '') <> ''I'' ';
    v_sql4 := v_sql4||'                        AND (((E.MER_CAT_CD  IN ';
    v_sql4 := v_sql4||' (''7011'', ';
    v_sql4 := v_sql4||' ''7012'', ';
    v_sql4 := v_sql4||' ''5811'', ';
    v_sql4 := v_sql4||' ''5812'', ';
    v_sql4 := v_sql4||' ''5813'', ';
    v_sql4 := v_sql4||' ''5094'', ';
    v_sql4 := v_sql4||' ''5937'', ';
    v_sql4 := v_sql4||' ''5950'', ';
    v_sql4 := v_sql4||' ''5970'', ';
    v_sql4 := v_sql4||' ''5971'', ';
    v_sql4 := v_sql4||' ''7297'', ';
    v_sql4 := v_sql4||' ''7298'', ';
    v_sql4 := v_sql4||' ''7829'', ';
    v_sql4 := v_sql4||' ''7911'', ';
    v_sql4 := v_sql4||' ''7922'', ';
    v_sql4 := v_sql4||' ''7929'', ';
    v_sql4 := v_sql4||' ''7932'', ';
    v_sql4 := v_sql4||' ''7933'', ';
    v_sql4 := v_sql4||' ''7941'', ';
    v_sql4 := v_sql4||' ''7992'', ';
    v_sql4 := v_sql4||' ''7994'', ';
    v_sql4 := v_sql4||' ''7996'', ';
    v_sql4 := v_sql4||' ''7997'', ';
    v_sql4 := v_sql4||' ''7998'', ';
    v_sql4 := v_sql4||' ''7032'', ';
    v_sql4 := v_sql4||' ''7033'', ';
    v_sql4 := v_sql4||' ''5944'', ';
    v_sql4 := v_sql4||' ''5932'', ';
    v_sql4 := v_sql4||' ''7631'', ';
    v_sql4 := v_sql4||' ''7999'', ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'', ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'') OR (E.MER_CAT_CD IN (''1520'',''7013'',''5271'',''5511'',''5521'',''5551'',''5561'',''5571'',''5592'',''5598'',''5599'',''5933'',''8062'',''8211'',''8220'',''8398'',''5021'',''5039'',''5044'',''5045'',''5046'',''5047'',''5051'',''5065'',''5072'',''5074'',''5111'',''5122'',''5131'',''5137'',''5139'',''5172'',''5192'',''5193'',''5198'',''5998'',''5013'',''5398'',''4458'',''9498'',''9703'',''9704'',''9705'',''9706'',''9707'',''9708'',''5200'',''5300'') AND E.Bill_Amt <= 3500 )) ';
    v_sql4 := v_sql4||'                                            AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                                            AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ) ';
    v_sql4 := v_sql4||'                                            OR coal(E.MERCH_STAT,'' '') <> ''156''  ) ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                      THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                   END) ';
    v_sql4 := v_sql4||'                   AS GOODSUM_1, ';
    v_sql4 := v_sql4||'                    SUM ( ';
    v_sql4 := v_sql4||'                   CASE ';
    v_sql4 := v_sql4||'                      WHEN   (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 1 ';
    v_sql4 := v_sql4||'                        AND  coal(E.Src_Ind,'' '') <> ''I'' ';
    v_sql4 := v_sql4||'                        AND (((E.MER_CAT_CD  IN ';
    v_sql4 := v_sql4||' (''7011'', ';
    v_sql4 := v_sql4||' ''7012'', ';
    v_sql4 := v_sql4||' ''5811'', ';
    v_sql4 := v_sql4||' ''5812'', ';
    v_sql4 := v_sql4||' ''5813'', ';
    v_sql4 := v_sql4||' ''5094'', ';
    v_sql4 := v_sql4||' ''5937'', ';
    v_sql4 := v_sql4||' ''5950'', ';
    v_sql4 := v_sql4||' ''5970'', ';
    v_sql4 := v_sql4||' ''5971'', ';
    v_sql4 := v_sql4||' ''7297'', ';
    v_sql4 := v_sql4||' ''7298'', ';
    v_sql4 := v_sql4||' ''7829'', ';
    v_sql4 := v_sql4||' ''7911'', ';
    v_sql4 := v_sql4||' ''7922'', ';
    v_sql4 := v_sql4||' ''7929'', ';
    v_sql4 := v_sql4||' ''7932'', ';
    v_sql4 := v_sql4||' ''7933'', ';
    v_sql4 := v_sql4||' ''7941'', ';
    v_sql4 := v_sql4||' ''7992'', ';
    v_sql4 := v_sql4||' ''7994'', ';
    v_sql4 := v_sql4||' ''7996'', ';
    v_sql4 := v_sql4||' ''7997'', ';
    v_sql4 := v_sql4||' ''7998'', ';
    v_sql4 := v_sql4||' ''7032'', ';
    v_sql4 := v_sql4||' ''7033'', ';
    v_sql4 := v_sql4||' ''5944'', ';
    v_sql4 := v_sql4||' ''5932'', ';
    v_sql4 := v_sql4||' ''7631'', ';
    v_sql4 := v_sql4||' ''7999'', ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'', ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'') OR (E.MER_CAT_CD IN (''1520'',''7013'',''5271'',''5511'',''5521'',''5551'',''5561'',''5571'',''5592'',''5598'',''5599'',''5933'',''8062'',''8211'',''8220'',''8398'',''5021'',''5039'',''5044'',''5045'',''5046'',''5047'',''5051'',''5065'',''5072'',''5074'',''5111'',''5122'',''5131'',''5137'',''5139'',''5172'',''5192'',''5193'',''5198'',''5998'',''5013'',''5398'',''4458'',''9498'',''9703'',''9704'',''9705'',''9706'',''9707'',''9708'',''5200'',''5300'') AND E.Bill_Amt <= 3500 )) ';
    v_sql4 := v_sql4||'                                            AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                                            AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ) ';
    v_sql4 := v_sql4||'                                            OR coal(E.MERCH_STAT,'' '') <> ''156''  ) ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                      THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                   END) ';
    v_sql4 := v_sql4||'                   AS GOODSUM_2, ';
    v_sql4 := v_sql4||'                    SUM ( ';
    v_sql4 := v_sql4||'                   CASE ';
    v_sql4 := v_sql4||'                      WHEN   (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 2 ';
    v_sql4 := v_sql4||'                        AND  coal(E.Src_Ind,'' '') <> ''I'' ';
    v_sql4 := v_sql4||'                        AND (((E.MER_CAT_CD  IN ';
    v_sql4 := v_sql4||' (''7011'', ';
    v_sql4 := v_sql4||' ''7012'', ';
    v_sql4 := v_sql4||' ''5811'', ';
    v_sql4 := v_sql4||' ''5812'', ';
    v_sql4 := v_sql4||' ''5813'', ';
    v_sql4 := v_sql4||' ''5094'', ';
    v_sql4 := v_sql4||' ''5937'', ';
    v_sql4 := v_sql4||' ''5950'', ';
    v_sql4 := v_sql4||' ''5970'', ';
    v_sql4 := v_sql4||' ''5971'', ';
    v_sql4 := v_sql4||' ''7297'', ';
    v_sql4 := v_sql4||' ''7298'', ';
    v_sql4 := v_sql4||' ''7829'', ';
    v_sql4 := v_sql4||' ''7911'', ';
    v_sql4 := v_sql4||' ''7922'', ';
    v_sql4 := v_sql4||' ''7929'', ';
    v_sql4 := v_sql4||' ''7932'', ';
    v_sql4 := v_sql4||' ''7933'', ';
    v_sql4 := v_sql4||' ''7941'', ';
    v_sql4 := v_sql4||' ''7992'', ';
    v_sql4 := v_sql4||' ''7994'', ';
    v_sql4 := v_sql4||' ''7996'', ';
    v_sql4 := v_sql4||' ''7997'', ';
    v_sql4 := v_sql4||' ''7998'', ';
    v_sql4 := v_sql4||' ''7032'', ';
    v_sql4 := v_sql4||' ''7033'', ';
    v_sql4 := v_sql4||' ''5944'', ';
    v_sql4 := v_sql4||' ''5932'', ';
    v_sql4 := v_sql4||' ''7631'', ';
    v_sql4 := v_sql4||' ''7999'', ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'', ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'') OR (E.MER_CAT_CD IN (''1520'',''7013'',''5271'',''5511'',''5521'',''5551'',''5561'',''5571'',''5592'',''5598'',''5599'',''5933'',''8062'',''8211'',''8220'',''8398'',''5021'',''5039'',''5044'',''5045'',''5046'',''5047'',''5051'',''5065'',''5072'',''5074'',''5111'',''5122'',''5131'',''5137'',''5139'',''5172'',''5192'',''5193'',''5198'',''5998'',''5013'',''5398'',''4458'',''9498'',''9703'',''9704'',''9705'',''9706'',''9707'',''9708'',''5200'',''5300'') AND E.Bill_Amt <= 3500 )) ';
    v_sql4 := v_sql4||'                                            AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                                            AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ) ';
    v_sql4 := v_sql4||'                                            OR coal(E.MERCH_STAT,'' '') <> ''156''  ) ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                      THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                   END) ';
    v_sql4 := v_sql4||'                   AS GOODSUM_3, ';
    v_sql4 := v_sql4||'                    SUM ( ';
    v_sql4 := v_sql4||'                   CASE ';
    v_sql4 := v_sql4||'                      WHEN   (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 3 ';
    v_sql4 := v_sql4||'                        AND  coal(E.Src_Ind,'' '') <> ''I'' ';
    v_sql4 := v_sql4||'                        AND (((E.MER_CAT_CD  IN ';
    v_sql4 := v_sql4||' (''7011'', ';
    v_sql4 := v_sql4||' ''7012'', ';
    v_sql4 := v_sql4||' ''5811'', ';
    v_sql4 := v_sql4||' ''5812'', ';
    v_sql4 := v_sql4||' ''5813'', ';
    v_sql4 := v_sql4||' ''5094'', ';
    v_sql4 := v_sql4||' ''5937'', ';
    v_sql4 := v_sql4||' ''5950'', ';
    v_sql4 := v_sql4||' ''5970'', ';
    v_sql4 := v_sql4||' ''5971'', ';
    v_sql4 := v_sql4||' ''7297'', ';
    v_sql4 := v_sql4||' ''7298'', ';
    v_sql4 := v_sql4||' ''7829'', ';
    v_sql4 := v_sql4||' ''7911'', ';
    v_sql4 := v_sql4||' ''7922'', ';
    v_sql4 := v_sql4||' ''7929'', ';
    v_sql4 := v_sql4||' ''7932'', ';
    v_sql4 := v_sql4||' ''7933'', ';
    v_sql4 := v_sql4||' ''7941'', ';
    v_sql4 := v_sql4||' ''7992'', ';
    v_sql4 := v_sql4||' ''7994'', ';
    v_sql4 := v_sql4||' ''7996'', ';
    v_sql4 := v_sql4||' ''7997'', ';
    v_sql4 := v_sql4||' ''7998'', ';
    v_sql4 := v_sql4||' ''7032'', ';
    v_sql4 := v_sql4||' ''7033'', ';
    v_sql4 := v_sql4||' ''5944'', ';
    v_sql4 := v_sql4||' ''5932'', ';
    v_sql4 := v_sql4||' ''7631'', ';
    v_sql4 := v_sql4||' ''7999'', ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'', ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'') OR (E.MER_CAT_CD IN (''1520'',''7013'',''5271'',''5511'',''5521'',''5551'',''5561'',''5571'',''5592'',''5598'',''5599'',''5933'',''8062'',''8211'',''8220'',''8398'',''5021'',''5039'',''5044'',''5045'',''5046'',''5047'',''5051'',''5065'',''5072'',''5074'',''5111'',''5122'',''5131'',''5137'',''5139'',''5172'',''5192'',''5193'',''5198'',''5998'',''5013'',''5398'',''4458'',''9498'',''9703'',''9704'',''9705'',''9706'',''9707'',''9708'',''5200'',''5300'') AND E.Bill_Amt <= 3500 )) ';
    v_sql4 := v_sql4||'                                            AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                                            AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ) ';
    v_sql4 := v_sql4||'                                            OR coal(E.MERCH_STAT,'' '') <> ''156''  ) ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                      THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                   END) ';
    v_sql4 := v_sql4||'                   AS GOODSUM_4, ';
    v_sql4 := v_sql4||'                    SUM ( ';
    v_sql4 := v_sql4||'                   CASE ';
    v_sql4 := v_sql4||'                      WHEN   (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 4 ';
    v_sql4 := v_sql4||'                        AND  coal(E.Src_Ind,'' '') <> ''I'' ';
    v_sql4 := v_sql4||'                        AND (((E.MER_CAT_CD  IN ';
    v_sql4 := v_sql4||' (''7011'', ';
    v_sql4 := v_sql4||' ''7012'', ';
    v_sql4 := v_sql4||' ''5811'', ';
    v_sql4 := v_sql4||' ''5812'', ';
    v_sql4 := v_sql4||' ''5813'', ';
    v_sql4 := v_sql4||' ''5094'', ';
    v_sql4 := v_sql4||' ''5937'', ';
    v_sql4 := v_sql4||' ''5950'', ';
    v_sql4 := v_sql4||' ''5970'', ';
    v_sql4 := v_sql4||' ''5971'', ';
    v_sql4 := v_sql4||' ''7297'', ';
    v_sql4 := v_sql4||' ''7298'', ';
    v_sql4 := v_sql4||' ''7829'', ';
    v_sql4 := v_sql4||' ''7911'', ';
    v_sql4 := v_sql4||' ''7922'', ';
    v_sql4 := v_sql4||' ''7929'', ';
    v_sql4 := v_sql4||' ''7932'', ';
    v_sql4 := v_sql4||' ''7933'', ';
    v_sql4 := v_sql4||' ''7941'', ';
    v_sql4 := v_sql4||' ''7992'', ';
    v_sql4 := v_sql4||' ''7994'', ';
    v_sql4 := v_sql4||' ''7996'', ';
    v_sql4 := v_sql4||' ''7997'', ';
    v_sql4 := v_sql4||' ''7998'', ';
    v_sql4 := v_sql4||' ''7032'', ';
    v_sql4 := v_sql4||' ''7033'', ';
    v_sql4 := v_sql4||' ''5944'', ';
    v_sql4 := v_sql4||' ''5932'', ';
    v_sql4 := v_sql4||' ''7631'', ';
    v_sql4 := v_sql4||' ''7999'', ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'', ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'') OR (E.MER_CAT_CD IN (''1520'',''7013'',''5271'',''5511'',''5521'',''5551'',''5561'',''5571'',''5592'',''5598'',''5599'',''5933'',''8062'',''8211'',''8220'',''8398'',''5021'',''5039'',''5044'',''5045'',''5046'',''5047'',''5051'',''5065'',''5072'',''5074'',''5111'',''5122'',''5131'',''5137'',''5139'',''5172'',''5192'',''5193'',''5198'',''5998'',''5013'',''5398'',''4458'',''9498'',''9703'',''9704'',''9705'',''9706'',''9707'',''9708'',''5200'',''5300'')  AND E.Bill_Amt <= 3500 )) ';
    v_sql4 := v_sql4||'                                            AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                                            AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ) ';
    v_sql4 := v_sql4||'                                            OR coal(E.MERCH_STAT,'' '') <> ''156''  ) ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                      THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                   END) ';
    v_sql4 := v_sql4||'                   AS GOODSUM_5, ';
    v_sql4 := v_sql4||'                    SUM ( ';
    v_sql4 := v_sql4||'                   CASE ';
    v_sql4 := v_sql4||'                      WHEN   (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 5 ';
    v_sql4 := v_sql4||'                        AND  coal(E.Src_Ind,'' '') <> ''I'' ';
    v_sql4 := v_sql4||'                        AND (((E.MER_CAT_CD  IN ';
    v_sql4 := v_sql4||' (''7011'', ';
    v_sql4 := v_sql4||' ''7012'', ';
    v_sql4 := v_sql4||' ''5811'', ';
    v_sql4 := v_sql4||' ''5812'', ';
    v_sql4 := v_sql4||' ''5813'', ';
    v_sql4 := v_sql4||' ''5094'', ';
    v_sql4 := v_sql4||' ''5937'', ';
    v_sql4 := v_sql4||' ''5950'', ';
    v_sql4 := v_sql4||' ''5970'', ';
    v_sql4 := v_sql4||' ''5971'', ';
    v_sql4 := v_sql4||' ''7297'', ';
    v_sql4 := v_sql4||' ''7298'', ';
    v_sql4 := v_sql4||' ''7829'', ';
    v_sql4 := v_sql4||' ''7911'', ';
    v_sql4 := v_sql4||' ''7922'', ';
    v_sql4 := v_sql4||' ''7929'', ';
    v_sql4 := v_sql4||' ''7932'', ';
    v_sql4 := v_sql4||' ''7933'', ';
    v_sql4 := v_sql4||' ''7941'', ';
    v_sql4 := v_sql4||' ''7992'', ';
    v_sql4 := v_sql4||' ''7994'', ';
    v_sql4 := v_sql4||' ''7996'', ';
    v_sql4 := v_sql4||' ''7997'', ';
    v_sql4 := v_sql4||' ''7998'', ';
    v_sql4 := v_sql4||' ''7032'', ';
    v_sql4 := v_sql4||' ''7033'', ';
    v_sql4 := v_sql4||' ''5944'', ';
    v_sql4 := v_sql4||' ''5932'', ';
    v_sql4 := v_sql4||' ''7631'', ';
    v_sql4 := v_sql4||' ''7999'', ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'', ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'') OR (E.MER_CAT_CD IN (''1520'',''7013'',''5271'',''5511'',''5521'',''5551'',''5561'',''5571'',''5592'',''5598'',''5599'',''5933'',''8062'',''8211'',''8220'',''8398'',''5021'',''5039'',''5044'',''5045'',''5046'',''5047'',''5051'',''5065'',''5072'',''5074'',''5111'',''5122'',''5131'',''5137'',''5139'',''5172'',''5192'',''5193'',''5198'',''5998'',''5013'',''5398'',''4458'',''9498'',''9703'',''9704'',''9705'',''9706'',''9707'',''9708'',''5200'',''5300'') AND E.Bill_Amt <= 3500 )) ';
    v_sql4 := v_sql4||'                                            AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                                            AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ) ';
    v_sql4 := v_sql4||'                                            OR coal(E.MERCH_STAT,'' '') <> ''156''  ) ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                      THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                   END) ';
    v_sql4 := v_sql4||'                   AS GOODSUM_6, ';
    v_sql4 := v_sql4||'                    SUM ( ';
    v_sql4 := v_sql4||'                   CASE ';
    v_sql4 := v_sql4||'                      WHEN   (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR + 1 ';
    v_sql4 := v_sql4||'                        AND  coal(E.Src_Ind,'' '') <> ''I'' ';
    v_sql4 := v_sql4||'                        AND (((E.MER_CAT_CD  IN ';
    v_sql4 := v_sql4||' (''7011'', ';
    v_sql4 := v_sql4||' ''7012'', ';
    v_sql4 := v_sql4||' ''5811'', ';
    v_sql4 := v_sql4||' ''5812'', ';
    v_sql4 := v_sql4||' ''5813'', ';
    v_sql4 := v_sql4||' ''5094'', ';
    v_sql4 := v_sql4||' ''5937'', ';
    v_sql4 := v_sql4||' ''5950'', ';
    v_sql4 := v_sql4||' ''5970'', ';
    v_sql4 := v_sql4||' ''5971'', ';
    v_sql4 := v_sql4||' ''7297'', ';
    v_sql4 := v_sql4||' ''7298'', ';
    v_sql4 := v_sql4||' ''7829'', ';
    v_sql4 := v_sql4||' ''7911'', ';
    v_sql4 := v_sql4||' ''7922'', ';
    v_sql4 := v_sql4||' ''7929'', ';
    v_sql4 := v_sql4||' ''7932'', ';
    v_sql4 := v_sql4||' ''7933'', ';
    v_sql4 := v_sql4||' ''7941'', ';
    v_sql4 := v_sql4||' ''7992'', ';
    v_sql4 := v_sql4||' ''7994'', ';
    v_sql4 := v_sql4||' ''7996'', ';
    v_sql4 := v_sql4||' ''7997'', ';
    v_sql4 := v_sql4||' ''7998'', ';
    v_sql4 := v_sql4||' ''7032'', ';
    v_sql4 := v_sql4||' ''7033'', ';
    v_sql4 := v_sql4||' ''5944'', ';
    v_sql4 := v_sql4||' ''5932'', ';
    v_sql4 := v_sql4||' ''7631'', ';
    v_sql4 := v_sql4||' ''7999'', ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'', ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'') OR (E.MER_CAT_CD IN (''1520'',''7013'',''5271'',''5511'',''5521'',''5551'',''5561'',''5571'',''5592'',''5598'',''5599'',''5933'',''8062'',''8211'',''8220'',''8398'',''5021'',''5039'',''5044'',''5045'',''5046'',''5047'',''5051'',''5065'',''5072'',''5074'',''5111'',''5122'',''5131'',''5137'',''5139'',''5172'',''5192'',''5193'',''5198'',''5998'',''5013'',''5398'',''4458'',''9498'',''9703'',''9704'',''9705'',''9706'',''9707'',''9708'',''5200'',''5300'') AND E.Bill_Amt <= 3500 )) ';
    v_sql4 := v_sql4||'                                            AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                                            AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ) ';
    v_sql4 := v_sql4||'                                            OR coal(E.MERCH_STAT,'' '') <> ''156''  ) ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                      THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                   END) ';
    v_sql4 := v_sql4||'                   AS GOODSUM_0, ';
    v_sql4 := v_sql4||'                                     SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||'                        ''7011'', ';
    v_sql4 := v_sql4||'                        ''7012'', ';
    v_sql4 := v_sql4||'                        ''5811'', ';
    v_sql4 := v_sql4||'                        ''5812'', ';
    v_sql4 := v_sql4||'                        ''5813'', ';
    v_sql4 := v_sql4||'                        ''5094'', ';
    v_sql4 := v_sql4||'                        ''5937'', ';
    v_sql4 := v_sql4||'                        ''5950'', ';
    v_sql4 := v_sql4||'                        ''5970'', ';
    v_sql4 := v_sql4||'                        ''5971'', ';
    v_sql4 := v_sql4||'                        ''7297'', ';
    v_sql4 := v_sql4||'                        ''7298'', ';
    v_sql4 := v_sql4||'                        ''7829'', ';
    v_sql4 := v_sql4||'                        ''7911'', ';
    v_sql4 := v_sql4||'                        ''7922'', ';
    v_sql4 := v_sql4||'                        ''7929'', ';
    v_sql4 := v_sql4||'                        ''7932'', ';
    v_sql4 := v_sql4||'                        ''7933'', ';
    v_sql4 := v_sql4||'                        ''7941'', ';
    v_sql4 := v_sql4||'                        ''7992'', ';
    v_sql4 := v_sql4||'                        ''7994'', ';
    v_sql4 := v_sql4||'                        ''7996'', ';
    v_sql4 := v_sql4||'                        ''7997'', ';
    v_sql4 := v_sql4||'                        ''7998'', ';
    v_sql4 := v_sql4||'                        ''7032'', ';
    v_sql4 := v_sql4||'                        ''7033'', ';
    v_sql4 := v_sql4||'                        ''5944'', ';
    v_sql4 := v_sql4||'                        ''5932'', ';
    v_sql4 := v_sql4||'                        ''7631'', ';
    v_sql4 := v_sql4||'                        ''7999'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND coal(E.src_ind,'' '') <> ''I''     ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC90SUM_CM1, ';
    v_sql4 := v_sql4||'                                SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||'                        ''7011'', ';
    v_sql4 := v_sql4||'                        ''7012'', ';
    v_sql4 := v_sql4||'                        ''5811'', ';
    v_sql4 := v_sql4||'                        ''5812'', ';
    v_sql4 := v_sql4||'                        ''5813'', ';
    v_sql4 := v_sql4||'                        ''5094'', ';
    v_sql4 := v_sql4||'                        ''5937'', ';
    v_sql4 := v_sql4||'                        ''5950'', ';
    v_sql4 := v_sql4||'                        ''5970'', ';
    v_sql4 := v_sql4||'                        ''5971'', ';
    v_sql4 := v_sql4||'                        ''7297'', ';
    v_sql4 := v_sql4||'                        ''7298'', ';
    v_sql4 := v_sql4||'                        ''7829'', ';
    v_sql4 := v_sql4||'                        ''7911'', ';
    v_sql4 := v_sql4||'                        ''7922'', ';
    v_sql4 := v_sql4||'                        ''7929'', ';
    v_sql4 := v_sql4||'                        ''7932'', ';
    v_sql4 := v_sql4||'                        ''7933'', ';
    v_sql4 := v_sql4||'                        ''7941'', ';
    v_sql4 := v_sql4||'                        ''7992'', ';
    v_sql4 := v_sql4||'                        ''7994'', ';
    v_sql4 := v_sql4||'                        ''7996'', ';
    v_sql4 := v_sql4||'                        ''7997'', ';
    v_sql4 := v_sql4||'                        ''7998'', ';
    v_sql4 := v_sql4||'                        ''7032'', ';
    v_sql4 := v_sql4||'                        ''7033'', ';
    v_sql4 := v_sql4||'                        ''5944'', ';
    v_sql4 := v_sql4||'                        ''5932'', ';
    v_sql4 := v_sql4||'                        ''7631'', ';
    v_sql4 := v_sql4||'                        ''7999'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )   ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC90NETSUM_CM1, ';
    v_sql4 := v_sql4||'                  SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                        AND coal(E.src_ind,'' '') <> ''I''      ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC55SUM_CM1, ';
    v_sql4 := v_sql4||'                    SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )  ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC55NETSUM_CM1, ';
    v_sql4 := v_sql4||'                 SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND coal(E.src_ind,'' '') <> ''I''  ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC26SUM_CM1, ';
    v_sql4 := v_sql4||'                          SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )  ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC26NETSUM_CM1, ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                                   SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR AND ';
    v_sql4 := v_sql4||'                             TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND coal(E.Src_Ind,'' '') <> ''I'' ';
    v_sql4 := v_sql4||'                        AND ( coal(E.MERCH_STAT,'' '') <> ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS JW120SUM_CM1, ';
    v_sql4 := v_sql4||'                          SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                       TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND E.Src_Ind = ''I'' ';
    v_sql4 := v_sql4||'                        AND ( coal(E.MERCH_STAT,'' '') <> ''156'' and E.MERCH_STAT is not null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS JW120NETSUM_CM1, ';
    v_sql4 := v_sql4||'                  SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                        AND E.TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND coal(E.src_ind,'' '') <> ''I''    ';
    v_sql4 := v_sql4||'                        AND BILL_AMT <= 3500 ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS DLSUM_CM1, ';
    v_sql4 := v_sql4||'                    SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' ) ';
    v_sql4 := v_sql4||'                        AND BILL_AMT <= 3500 ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS DLNETSUM_CM1, ';
    v_sql4 := v_sql4||'                                     COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||'                        ''7011'', ';
    v_sql4 := v_sql4||'                        ''7012'', ';
    v_sql4 := v_sql4||'                        ''5811'', ';
    v_sql4 := v_sql4||'                        ''5812'', ';
    v_sql4 := v_sql4||'                        ''5813'', ';
    v_sql4 := v_sql4||'                        ''5094'', ';
    v_sql4 := v_sql4||'                        ''5937'', ';
    v_sql4 := v_sql4||'                        ''5950'', ';
    v_sql4 := v_sql4||'                        ''5970'', ';
    v_sql4 := v_sql4||'                        ''5971'', ';
    v_sql4 := v_sql4||'                        ''7297'', ';
    v_sql4 := v_sql4||'                        ''7298'', ';
    v_sql4 := v_sql4||'                        ''7829'', ';
    v_sql4 := v_sql4||'                        ''7911'', ';
    v_sql4 := v_sql4||'                        ''7922'', ';
    v_sql4 := v_sql4||'                        ''7929'', ';
    v_sql4 := v_sql4||'                        ''7932'', ';
    v_sql4 := v_sql4||'                        ''7933'', ';
    v_sql4 := v_sql4||'                        ''7941'', ';
    v_sql4 := v_sql4||'                        ''7992'', ';
    v_sql4 := v_sql4||'                        ''7994'', ';
    v_sql4 := v_sql4||'                        ''7996'', ';
    v_sql4 := v_sql4||'                        ''7997'', ';
    v_sql4 := v_sql4||'                        ''7998'', ';
    v_sql4 := v_sql4||'                        ''7032'', ';
    v_sql4 := v_sql4||'                        ''7033'', ';
    v_sql4 := v_sql4||'                        ''5944'', ';
    v_sql4 := v_sql4||'                        ''5932'', ';
    v_sql4 := v_sql4||'                        ''7631'', ';
    v_sql4 := v_sql4||'                        ''7999'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND coal(E.src_ind,'' '') <> ''I''       ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC90COUNT_CM1, ';
    v_sql4 := v_sql4||'                                COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||'                        ''7011'', ';
    v_sql4 := v_sql4||'                        ''7012'', ';
    v_sql4 := v_sql4||'                        ''5811'', ';
    v_sql4 := v_sql4||'                        ''5812'', ';
    v_sql4 := v_sql4||'                        ''5813'', ';
    v_sql4 := v_sql4||'                        ''5094'', ';
    v_sql4 := v_sql4||'                        ''5937'', ';
    v_sql4 := v_sql4||'                        ''5950'', ';
    v_sql4 := v_sql4||'                        ''5970'', ';
    v_sql4 := v_sql4||'                        ''5971'', ';
    v_sql4 := v_sql4||'                        ''7297'', ';
    v_sql4 := v_sql4||'                        ''7298'', ';
    v_sql4 := v_sql4||'                        ''7829'', ';
    v_sql4 := v_sql4||'                        ''7911'', ';
    v_sql4 := v_sql4||'                        ''7922'', ';
    v_sql4 := v_sql4||'                        ''7929'', ';
    v_sql4 := v_sql4||'                        ''7932'', ';
    v_sql4 := v_sql4||'                        ''7933'', ';
    v_sql4 := v_sql4||'                        ''7941'', ';
    v_sql4 := v_sql4||'                        ''7992'', ';
    v_sql4 := v_sql4||'                        ''7994'', ';
    v_sql4 := v_sql4||'                        ''7996'', ';
    v_sql4 := v_sql4||'                        ''7997'', ';
    v_sql4 := v_sql4||'                        ''7998'', ';
    v_sql4 := v_sql4||'                        ''7032'', ';
    v_sql4 := v_sql4||'                        ''7033'', ';
    v_sql4 := v_sql4||'                        ''5944'', ';
    v_sql4 := v_sql4||'                        ''5932'', ';
    v_sql4 := v_sql4||'                        ''7631'', ';
    v_sql4 := v_sql4||'                        ''7999'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )  ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC90NETCOUNT_CM1, ';
    v_sql4 := v_sql4||'                  COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND coal(E.src_ind,'' '') <> ''I''    ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC55COUNT_CM1, ';
    v_sql4 := v_sql4||'                    COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' ) ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC55NETCOUNT_CM1, ';
    v_sql4 := v_sql4||'                 COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''     ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC26COUNT_CM1, ';
    v_sql4 := v_sql4||'                          COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )   ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC26NETCOUNT_CM1, ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                                   COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR AND ';
    v_sql4 := v_sql4||'                             TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND coal(E.Src_Ind,'' '') <> ''I'' ';
    v_sql4 := v_sql4||'                        AND ( coal(E.MERCH_STAT,'' '') <> ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS JW120COUNT_CM1, ';
    v_sql4 := v_sql4||'                          COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                       TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND E.Src_Ind = ''I'' ';
    v_sql4 := v_sql4||'                        AND ( coal(E.MERCH_STAT,'' '') <> ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS JW120NETCOUNT_CM1, ';
    v_sql4 := v_sql4||'                  COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''      ';
    v_sql4 := v_sql4||'                        AND BILL_AMT <= 3500 ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS DLCOUNT_CM1, ';
    v_sql4 := v_sql4||'                    COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )  ';
    v_sql4 := v_sql4||'                        AND BILL_AMT <= 3500 ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS DLNETCOUNT_CM1, ';
    v_sql4 := v_sql4||'                    MIN(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR AND ';
    v_sql4 := v_sql4||'                             TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                             AND coal(E.src_ind,'' '') <> ''I''     ';
    v_sql4 := v_sql4||'                        AND ( coal(E.MERCH_STAT,'' '') <> ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CEIL(date_diff(SYSDATE(), toDate(CREATE_DATE,''yyyy-mm-dd''))) ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         9999 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS JWRECENCY_CM1, ';
    v_sql4 := v_sql4||'                  COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                           ''5571'', ';
    v_sql4 := v_sql4||'                                           ''5592'', ';
    v_sql4 := v_sql4||'                                           ''5598'', ';
    v_sql4 := v_sql4||'                                           ''5599'', ';
    v_sql4 := v_sql4||'                                           ''5933'', ';
    v_sql4 := v_sql4||'                                           ''8062'', ';
    v_sql4 := v_sql4||'                                           ''8211'', ';
    v_sql4 := v_sql4||'                                           ''8220'', ';
    v_sql4 := v_sql4||'                                           ''8398'', ';
    v_sql4 := v_sql4||'                                           ''5021'', ';
    v_sql4 := v_sql4||'                                           ''5039'', ';
    v_sql4 := v_sql4||'                                           ''5044'', ';
    v_sql4 := v_sql4||'                                           ''5045'', ';
    v_sql4 := v_sql4||'                                           ''5046'', ';
    v_sql4 := v_sql4||'                                           ''5047'', ';
    v_sql4 := v_sql4||'                                           ''5051'', ';
    v_sql4 := v_sql4||'                                           ''5065'', ';
    v_sql4 := v_sql4||'                                           ''5072'', ';
    v_sql4 := v_sql4||'                                           ''5074'', ';
    v_sql4 := v_sql4||'                                           ''5111'', ';
    v_sql4 := v_sql4||'                                           ''5122'', ';
    v_sql4 := v_sql4||'                                           ''5131'', ';
    v_sql4 := v_sql4||'                                           ''5137'', ';
    v_sql4 := v_sql4||'                                           ''5139'', ';
    v_sql4 := v_sql4||'                                           ''5172'', ';
    v_sql4 := v_sql4||'                                           ''5192'', ';
    v_sql4 := v_sql4||'                                           ''5193'', ';
    v_sql4 := v_sql4||'                                           ''5198'', ';
    v_sql4 := v_sql4||'                                           ''5998'', ';
    v_sql4 := v_sql4||'                                           ''5013'', ';
    v_sql4 := v_sql4||'                                           ''5398'', ';
    v_sql4 := v_sql4||'                                           ''4458'', ';
    v_sql4 := v_sql4||'                                           ''9498'', ';
    v_sql4 := v_sql4||'                                           ''9703'', ';
    v_sql4 := v_sql4||'                                           ''9704'', ';
    v_sql4 := v_sql4||'                                           ''9705'', ';
    v_sql4 := v_sql4||'                                           ''9706'', ';
    v_sql4 := v_sql4||'                                           ''9707'', ';
    v_sql4 := v_sql4||'                                           ''9708'', ';
    v_sql4 := v_sql4||'                                           ''5200'', ';
    v_sql4 := v_sql4||'                                           ''5300'') ';
    v_sql4 := v_sql4||'                                           OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                       AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                       AND TRANS_TYPE != '' '' AND BILL_AMT > 3500 ';
    v_sql4 := v_sql4||'                       AND coal(E.src_ind,'' '') <> ''I''      ';
    v_sql4 := v_sql4||'                       AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                       THEN ';
    v_sql4 := v_sql4||'                        1 ';
    v_sql4 := v_sql4||'                     ELSE ';
    v_sql4 := v_sql4||'                        NULL ';
    v_sql4 := v_sql4||'                     END ';
    v_sql4 := v_sql4||'                  ) AS DLCOUNT_2_CM1, ';
    v_sql4 := v_sql4||'                                     COUNT(CASE ';
    v_sql4 := v_sql4||'                       WHEN ';
    v_sql4 := v_sql4||'                       (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR AND ';
    v_sql4 := v_sql4||'                          (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                           ''7013'', ';
    v_sql4 := v_sql4||'                                           ''5271'', ';
    v_sql4 := v_sql4||'                                           ''5511'', ';
    v_sql4 := v_sql4||'                                           ''5521'', ';
    v_sql4 := v_sql4||'                                           ''5551'', ';
    v_sql4 := v_sql4||'                                           ''5561'', ';
    v_sql4 := v_sql4||'                                           ''5571'', ';
    v_sql4 := v_sql4||'                                           ''5592'', ';
    v_sql4 := v_sql4||'                                           ''5598'', ';
    v_sql4 := v_sql4||'                                           ''5599'', ';
    v_sql4 := v_sql4||'                                           ''5933'', ';
    v_sql4 := v_sql4||'                                           ''8062'', ';
    v_sql4 := v_sql4||'                                           ''8211'', ';
    v_sql4 := v_sql4||'                                           ''8220'', ';
    v_sql4 := v_sql4||'                                           ''8398'', ';
    v_sql4 := v_sql4||'                                           ''5021'', ';
    v_sql4 := v_sql4||'                                           ''5039'', ';
    v_sql4 := v_sql4||'                                           ''5044'', ';
    v_sql4 := v_sql4||'                                           ''5045'', ';
    v_sql4 := v_sql4||'                                           ''5046'', ';
    v_sql4 := v_sql4||'                                           ''5047'', ';
    v_sql4 := v_sql4||'                                           ''5051'', ';
    v_sql4 := v_sql4||'                                           ''5065'', ';
    v_sql4 := v_sql4||'                                           ''5072'', ';
    v_sql4 := v_sql4||'                                           ''5074'', ';
    v_sql4 := v_sql4||'                                           ''5111'', ';
    v_sql4 := v_sql4||'                                           ''5122'', ';
    v_sql4 := v_sql4||'                                           ''5131'', ';
    v_sql4 := v_sql4||'                                           ''5137'', ';
    v_sql4 := v_sql4||'                                           ''5139'', ';
    v_sql4 := v_sql4||'                                           ''5172'', ';
    v_sql4 := v_sql4||'                                           ''5192'', ';
    v_sql4 := v_sql4||'                                           ''5193'', ';
    v_sql4 := v_sql4||'                                           ''5198'', ';
    v_sql4 := v_sql4||'                                           ''5998'', ';
    v_sql4 := v_sql4||'                                           ''5013'', ';
    v_sql4 := v_sql4||'                                           ''5398'', ';
    v_sql4 := v_sql4||'                                           ''4458'', ';
    v_sql4 := v_sql4||'                                           ''9498'', ';
    v_sql4 := v_sql4||'                                           ''9703'', ';
    v_sql4 := v_sql4||'                                           ''9704'', ';
    v_sql4 := v_sql4||'                                           ''9705'', ';
    v_sql4 := v_sql4||'                                           ''9706'', ';
    v_sql4 := v_sql4||'                                           ''9707'', ';
    v_sql4 := v_sql4||'                                           ''9708'', ';
    v_sql4 := v_sql4||'                                           ''5200'', ';
    v_sql4 := v_sql4||'                                           ''5300'') ';
    v_sql4 := v_sql4||'                                           OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                       AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                       OR E.src_ind = ''I'' ) ';
    v_sql4 := v_sql4||'                       AND BILL_AMT > 3500 ';
    v_sql4 := v_sql4||'                       AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                       THEN ';
    v_sql4 := v_sql4||'                        1 ';
    v_sql4 := v_sql4||'                     ELSE ';
    v_sql4 := v_sql4||'                        NULL ';
    v_sql4 := v_sql4||'                     END ';
    v_sql4 := v_sql4||'                  ) AS DLNETCOUNT_2_CM1, ';
    v_sql4 := v_sql4||'                  SUM(CASE ';
    v_sql4 := v_sql4||'                       WHEN ';
    v_sql4 := v_sql4||'                       (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 1 AND ';
    v_sql4 := v_sql4||'                       mer_cat_cd in ';
    v_sql4 := v_sql4||'                       ( ';
    v_sql4 := v_sql4||'                       ''7011'', ';
    v_sql4 := v_sql4||'                       ''7012'', ';
    v_sql4 := v_sql4||'                       ''5811'', ';
    v_sql4 := v_sql4||'                       ''5812'', ';
    v_sql4 := v_sql4||'                       ''5813'', ';
    v_sql4 := v_sql4||'                       ''5094'', ';
    v_sql4 := v_sql4||'                       ''5937'', ';
    v_sql4 := v_sql4||'                       ''5950'', ';
    v_sql4 := v_sql4||'                       ''5970'', ';
    v_sql4 := v_sql4||'                       ''5971'', ';
    v_sql4 := v_sql4||'                       ''7297'', ';
    v_sql4 := v_sql4||'                       ''7298'', ';
    v_sql4 := v_sql4||'                       ''7829'', ';
    v_sql4 := v_sql4||'                       ''7911'', ';
    v_sql4 := v_sql4||'                       ''7922'', ';
    v_sql4 := v_sql4||'                       ''7929'', ';
    v_sql4 := v_sql4||'                       ''7932'', ';
    v_sql4 := v_sql4||'                       ''7933'', ';
    v_sql4 := v_sql4||'                       ''7941'', ';
    v_sql4 := v_sql4||'                       ''7992'', ';
    v_sql4 := v_sql4||'                       ''7994'', ';
    v_sql4 := v_sql4||'                       ''7996'', ';
    v_sql4 := v_sql4||'                       ''7997'', ';
    v_sql4 := v_sql4||'                       ''7998'', ';
    v_sql4 := v_sql4||'                       ''7032'', ';
    v_sql4 := v_sql4||'                       ''7033'', ';
    v_sql4 := v_sql4||'                       ''5944'', ';
    v_sql4 := v_sql4||'                       ''5932'', ';
    v_sql4 := v_sql4||'                       ''7631'', ';
    v_sql4 := v_sql4||'                       ''7999'' ';
    v_sql4 := v_sql4||'                       ) ';
    v_sql4 := v_sql4||'                       AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                       AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''       ';
    v_sql4 := v_sql4||'                       AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                       THEN ';
    v_sql4 := v_sql4||'                        CASE ';
    v_sql4 := v_sql4||'                           WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                           ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                        END ';
    v_sql4 := v_sql4||'                     ELSE ';
    v_sql4 := v_sql4||'                        0 ';
    v_sql4 := v_sql4||'                     END ';
    v_sql4 := v_sql4||'                  ) AS MCC90SUM_CM2, ';
    v_sql4 := v_sql4||'                               SUM(CASE ';
    v_sql4 := v_sql4||'                       WHEN ';
    v_sql4 := v_sql4||'                       (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 1 AND ';
    v_sql4 := v_sql4||'                       mer_cat_cd in ';
    v_sql4 := v_sql4||'                       ( ';
    v_sql4 := v_sql4||'                       ''7011'', ';
    v_sql4 := v_sql4||'                       ''7012'', ';
    v_sql4 := v_sql4||'                       ''5811'', ';
    v_sql4 := v_sql4||'                       ''5812'', ';
    v_sql4 := v_sql4||'                       ''5813'', ';
    v_sql4 := v_sql4||'                       ''5094'', ';
    v_sql4 := v_sql4||'                       ''5937'', ';
    v_sql4 := v_sql4||'                       ''5950'', ';
    v_sql4 := v_sql4||'                       ''5970'', ';
    v_sql4 := v_sql4||'                       ''5971'', ';
    v_sql4 := v_sql4||'                       ''7297'', ';
    v_sql4 := v_sql4||'                       ''7298'', ';
    v_sql4 := v_sql4||'                       ''7829'', ';
    v_sql4 := v_sql4||'                       ''7911'', ';
    v_sql4 := v_sql4||'                       ''7922'', ';
    v_sql4 := v_sql4||'                       ''7929'', ';
    v_sql4 := v_sql4||'                       ''7932'', ';
    v_sql4 := v_sql4||'                       ''7933'', ';
    v_sql4 := v_sql4||'                       ''7941'', ';
    v_sql4 := v_sql4||'                       ''7992'', ';
    v_sql4 := v_sql4||'                       ''7994'', ';
    v_sql4 := v_sql4||'                       ''7996'', ';
    v_sql4 := v_sql4||'                       ''7997'', ';
    v_sql4 := v_sql4||'                       ''7998'', ';
    v_sql4 := v_sql4||'                       ''7032'', ';
    v_sql4 := v_sql4||'                       ''7033'', ';
    v_sql4 := v_sql4||'                       ''5944'', ';
    v_sql4 := v_sql4||'                       ''5932'', ';
    v_sql4 := v_sql4||'                       ''7631'', ';
    v_sql4 := v_sql4||'                       ''7999'' ';
    v_sql4 := v_sql4||'                       ) ';
    v_sql4 := v_sql4||'                       AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                       OR E.src_ind = ''I'' ) ';
    v_sql4 := v_sql4||'                       AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                       THEN ';
    v_sql4 := v_sql4||'                        CASE ';
    v_sql4 := v_sql4||'                           WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                           ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                        END ';
    v_sql4 := v_sql4||'                     ELSE ';
    v_sql4 := v_sql4||'                        0 ';
    v_sql4 := v_sql4||'                     END ';
    v_sql4 := v_sql4||'                  ) AS MCC90NETSUM_CM2, ';
    v_sql4 := v_sql4||'                 SUM(CASE ';
    v_sql4 := v_sql4||'                       WHEN ';
    v_sql4 := v_sql4||'                       (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 1 AND ';
    v_sql4 := v_sql4||'                       mer_cat_cd in ';
    v_sql4 := v_sql4||'                       ( ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'' ';
    v_sql4 := v_sql4||'                       ) ';
    v_sql4 := v_sql4||'                       AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                       AND TRANS_TYPE != '' '' AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                        AND coal(E.src_ind,'' '') <> ''I''    ';
    v_sql4 := v_sql4||'                       AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                       THEN ';
    v_sql4 := v_sql4||'                        CASE ';
    v_sql4 := v_sql4||'                           WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                           ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                        END ';
    v_sql4 := v_sql4||'                     ELSE ';
    v_sql4 := v_sql4||'                        0 ';
    v_sql4 := v_sql4||'                     END ';
    v_sql4 := v_sql4||'                  ) AS MCC55SUM_CM2, ';
    v_sql4 := v_sql4||'                   SUM(CASE ';
    v_sql4 := v_sql4||'                       WHEN ';
    v_sql4 := v_sql4||'                       (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 1 AND ';
    v_sql4 := v_sql4||'                       mer_cat_cd in ';
    v_sql4 := v_sql4||'                       ( ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'' ';
    v_sql4 := v_sql4||'                       ) ';
    v_sql4 := v_sql4||'                       AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                       OR E.src_ind = ''I'' )  ';
    v_sql4 := v_sql4||'                       AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                       THEN ';
    v_sql4 := v_sql4||'                        CASE ';
    v_sql4 := v_sql4||'                           WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                           ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                        END ';
    v_sql4 := v_sql4||'                     ELSE ';
    v_sql4 := v_sql4||'                        0 ';
    v_sql4 := v_sql4||'                     END ';
    v_sql4 := v_sql4||'                  ) AS MCC55NETSUM_CM2, ';
    v_sql4 := v_sql4||'                SUM(CASE ';
    v_sql4 := v_sql4||'                       WHEN ';
    v_sql4 := v_sql4||'                       (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 1 AND ';
    v_sql4 := v_sql4||'                       mer_cat_cd in ';
    v_sql4 := v_sql4||'                       ( ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'' ';
    v_sql4 := v_sql4||'                       ) ';
    v_sql4 := v_sql4||'                       AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                       AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''       ';
    v_sql4 := v_sql4||'                       AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                       THEN ';
    v_sql4 := v_sql4||'                        CASE ';
    v_sql4 := v_sql4||'                           WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                           ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                        END ';
    v_sql4 := v_sql4||'                     ELSE ';
    v_sql4 := v_sql4||'                        0 ';
    v_sql4 := v_sql4||'                     END ';
    v_sql4 := v_sql4||'                  ) AS MCC26SUM_CM2, ';
    v_sql4 := v_sql4||'                         SUM(CASE ';
    v_sql4 := v_sql4||'                       WHEN ';
    v_sql4 := v_sql4||'                       (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 1 AND ';
    v_sql4 := v_sql4||'                       mer_cat_cd in ';
    v_sql4 := v_sql4||'                       ( ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'' ';
    v_sql4 := v_sql4||'                       ) ';
    v_sql4 := v_sql4||'                       AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                       OR E.src_ind = ''I'' )  ';
    v_sql4 := v_sql4||'                       AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                       THEN ';
    v_sql4 := v_sql4||'                        CASE ';
    v_sql4 := v_sql4||'                           WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                           ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                        END ';
    v_sql4 := v_sql4||'                     ELSE ';
    v_sql4 := v_sql4||'                        0 ';
    v_sql4 := v_sql4||'                     END ';
    v_sql4 := v_sql4||'                  ) AS MCC26NETSUM_CM2, ';
    v_sql4 := v_sql4||'                                  SUM(CASE ';
    v_sql4 := v_sql4||'                       WHEN ';
    v_sql4 := v_sql4||'                       (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 1 AND ';
    v_sql4 := v_sql4||'                            TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                       AND coal(E.Src_Ind,'' '') <> ''I'' ';
    v_sql4 := v_sql4||'                       AND ( coal(E.MERCH_STAT,'' '') <> ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                       THEN ';
    v_sql4 := v_sql4||'                        CASE ';
    v_sql4 := v_sql4||'                           WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                           ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                        END ';
    v_sql4 := v_sql4||'                     ELSE ';
    v_sql4 := v_sql4||'                        0 ';
    v_sql4 := v_sql4||'                     END ';
    v_sql4 := v_sql4||'                  ) AS JW120SUM_CM2, ';
    v_sql4 := v_sql4||'                         SUM(CASE ';
    v_sql4 := v_sql4||'                       WHEN ';
    v_sql4 := v_sql4||'                      TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                       AND E.Src_Ind = ''I'' ';
    v_sql4 := v_sql4||'                       AND ( coal(E.MERCH_STAT,'' '') <> ''156'' and E.MERCH_STAT is not null ) ';
    v_sql4 := v_sql4||'                       THEN ';
    v_sql4 := v_sql4||'                        CASE ';
    v_sql4 := v_sql4||'                           WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                           ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                        END ';
    v_sql4 := v_sql4||'                     ELSE ';
    v_sql4 := v_sql4||'                        0 ';
    v_sql4 := v_sql4||'                     END ';
    v_sql4 := v_sql4||'                  ) AS JW120NETSUM_CM2, ';
    v_sql4 := v_sql4||'                 SUM(CASE ';
    v_sql4 := v_sql4||'                       WHEN ';
    v_sql4 := v_sql4||'                       (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 1 AND ';
    v_sql4 := v_sql4||'                          (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                           ''7013'', ';
    v_sql4 := v_sql4||'                                           ''5271'', ';
    v_sql4 := v_sql4||'                                           ''5511'', ';
    v_sql4 := v_sql4||'                                           ''5521'', ';
    v_sql4 := v_sql4||'                                           ''5551'', ';
    v_sql4 := v_sql4||'                                           ''5561'', ';
    v_sql4 := v_sql4||'                                           ''5571'', ';
    v_sql4 := v_sql4||'                                           ''5592'', ';
    v_sql4 := v_sql4||'                                           ''5598'', ';
    v_sql4 := v_sql4||'                                           ''5599'', ';
    v_sql4 := v_sql4||'                                           ''5933'', ';
    v_sql4 := v_sql4||'                                           ''8062'', ';
    v_sql4 := v_sql4||'                                           ''8211'', ';
    v_sql4 := v_sql4||'                                           ''8220'', ';
    v_sql4 := v_sql4||'                                           ''8398'', ';
    v_sql4 := v_sql4||'                                           ''5021'', ';
    v_sql4 := v_sql4||'                                           ''5039'', ';
    v_sql4 := v_sql4||'                                           ''5044'', ';
    v_sql4 := v_sql4||'                                           ''5045'', ';
    v_sql4 := v_sql4||'                                           ''5046'', ';
    v_sql4 := v_sql4||'                                           ''5047'', ';
    v_sql4 := v_sql4||'                                           ''5051'', ';
    v_sql4 := v_sql4||'                                           ''5065'', ';
    v_sql4 := v_sql4||'                                           ''5072'', ';
    v_sql4 := v_sql4||'                                           ''5074'', ';
    v_sql4 := v_sql4||'                                           ''5111'', ';
    v_sql4 := v_sql4||'                                           ''5122'', ';
    v_sql4 := v_sql4||'                                           ''5131'', ';
    v_sql4 := v_sql4||'                                           ''5137'', ';
    v_sql4 := v_sql4||'                                           ''5139'', ';
    v_sql4 := v_sql4||'                                           ''5172'', ';
    v_sql4 := v_sql4||'                                           ''5192'', ';
    v_sql4 := v_sql4||'                                           ''5193'', ';
    v_sql4 := v_sql4||'                                           ''5198'', ';
    v_sql4 := v_sql4||'                                           ''5998'', ';
    v_sql4 := v_sql4||'                                           ''5013'', ';
    v_sql4 := v_sql4||'                                           ''5398'', ';
    v_sql4 := v_sql4||'                                           ''4458'', ';
    v_sql4 := v_sql4||'                                           ''9498'', ';
    v_sql4 := v_sql4||'                                           ''9703'', ';
    v_sql4 := v_sql4||'                                           ''9704'', ';
    v_sql4 := v_sql4||'                                           ''9705'', ';
    v_sql4 := v_sql4||'                                           ''9706'', ';
    v_sql4 := v_sql4||'                                           ''9707'', ';
    v_sql4 := v_sql4||'                                           ''9708'', ';
    v_sql4 := v_sql4||'                                           ''5200'', ';
    v_sql4 := v_sql4||'                                           ''5300'') ';
    v_sql4 := v_sql4||'                                           OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                       AND E.TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                       AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''    ';
    v_sql4 := v_sql4||'                       AND BILL_AMT <= 3500 ';
    v_sql4 := v_sql4||'                       AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                       THEN ';
    v_sql4 := v_sql4||'                        CASE ';
    v_sql4 := v_sql4||'                           WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                           ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                        END ';
    v_sql4 := v_sql4||'                     ELSE ';
    v_sql4 := v_sql4||'                        0 ';
    v_sql4 := v_sql4||'                     END ';
    v_sql4 := v_sql4||'                  ) AS DLSUM_CM2, ';
    v_sql4 := v_sql4||'                   SUM(CASE ';
    v_sql4 := v_sql4||'                       WHEN ';
    v_sql4 := v_sql4||'                       (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 1 AND ';
    v_sql4 := v_sql4||'                          (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                           ''7013'', ';
    v_sql4 := v_sql4||'                                           ''5271'', ';
    v_sql4 := v_sql4||'                                           ''5511'', ';
    v_sql4 := v_sql4||'                                           ''5521'', ';
    v_sql4 := v_sql4||'                                           ''5551'', ';
    v_sql4 := v_sql4||'                                           ''5561'', ';
    v_sql4 := v_sql4||'                                           ''5571'', ';
    v_sql4 := v_sql4||'                                           ''5592'', ';
    v_sql4 := v_sql4||'                                           ''5598'', ';
    v_sql4 := v_sql4||'                                           ''5599'', ';
    v_sql4 := v_sql4||'                                           ''5933'', ';
    v_sql4 := v_sql4||'                                           ''8062'', ';
    v_sql4 := v_sql4||'                                           ''8211'', ';
    v_sql4 := v_sql4||'                                           ''8220'', ';
    v_sql4 := v_sql4||'                                           ''8398'', ';
    v_sql4 := v_sql4||'                                           ''5021'', ';
    v_sql4 := v_sql4||'                                           ''5039'', ';
    v_sql4 := v_sql4||'                                           ''5044'', ';
    v_sql4 := v_sql4||'                                           ''5045'', ';
    v_sql4 := v_sql4||'                                           ''5046'', ';
    v_sql4 := v_sql4||'                                           ''5047'', ';
    v_sql4 := v_sql4||'                                           ''5051'', ';
    v_sql4 := v_sql4||'                                           ''5065'', ';
    v_sql4 := v_sql4||'                                           ''5072'', ';
    v_sql4 := v_sql4||'                                           ''5074'', ';
    v_sql4 := v_sql4||'                                           ''5111'', ';
    v_sql4 := v_sql4||'                                           ''5122'', ';
    v_sql4 := v_sql4||'                                           ''5131'', ';
    v_sql4 := v_sql4||'                                           ''5137'', ';
    v_sql4 := v_sql4||'                                           ''5139'', ';
    v_sql4 := v_sql4||'                                           ''5172'', ';
    v_sql4 := v_sql4||'                                           ''5192'', ';
    v_sql4 := v_sql4||'                                           ''5193'', ';
    v_sql4 := v_sql4||'                                           ''5198'', ';
    v_sql4 := v_sql4||'                                           ''5998'', ';
    v_sql4 := v_sql4||'                                           ''5013'', ';
    v_sql4 := v_sql4||'                                           ''5398'', ';
    v_sql4 := v_sql4||'                                           ''4458'', ';
    v_sql4 := v_sql4||'                                           ''9498'', ';
    v_sql4 := v_sql4||'                                           ''9703'', ';
    v_sql4 := v_sql4||'                                           ''9704'', ';
    v_sql4 := v_sql4||'                                           ''9705'', ';
    v_sql4 := v_sql4||'                                           ''9706'', ';
    v_sql4 := v_sql4||'                                           ''9707'', ';
    v_sql4 := v_sql4||'                                           ''9708'', ';
    v_sql4 := v_sql4||'                                           ''5200'', ';
    v_sql4 := v_sql4||'                                           ''5300'') ';
    v_sql4 := v_sql4||'                                           OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                       AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                       OR E.src_ind = ''I'' )   ';
    v_sql4 := v_sql4||'                       AND BILL_AMT <= 3500 ';
    v_sql4 := v_sql4||'                       AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                       THEN ';
    v_sql4 := v_sql4||'                        CASE ';
    v_sql4 := v_sql4||'                           WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                           ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                        END ';
    v_sql4 := v_sql4||'                     ELSE ';
    v_sql4 := v_sql4||'                        0 ';
    v_sql4 := v_sql4||'                     END ';
    v_sql4 := v_sql4||'                  ) AS DLNETSUM_CM2, ';
    v_sql4 := v_sql4||'                                    COUNT(CASE ';
    v_sql4 := v_sql4||'                       WHEN ';
    v_sql4 := v_sql4||'                       (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 1 AND ';
    v_sql4 := v_sql4||'                       mer_cat_cd in ';
    v_sql4 := v_sql4||'                       ( ';
    v_sql4 := v_sql4||'                       ''7011'', ';
    v_sql4 := v_sql4||'                       ''7012'', ';
    v_sql4 := v_sql4||'                       ''5811'', ';
    v_sql4 := v_sql4||'                       ''5812'', ';
    v_sql4 := v_sql4||'                       ''5813'', ';
    v_sql4 := v_sql4||'                       ''5094'', ';
    v_sql4 := v_sql4||'                       ''5937'', ';
    v_sql4 := v_sql4||'                       ''5950'', ';
    v_sql4 := v_sql4||'                       ''5970'', ';
    v_sql4 := v_sql4||'                       ''5971'', ';
    v_sql4 := v_sql4||'                       ''7297'', ';
    v_sql4 := v_sql4||'                       ''7298'', ';
    v_sql4 := v_sql4||'                       ''7829'', ';
    v_sql4 := v_sql4||'                       ''7911'', ';
    v_sql4 := v_sql4||'                       ''7922'', ';
    v_sql4 := v_sql4||'                       ''7929'', ';
    v_sql4 := v_sql4||'                       ''7932'', ';
    v_sql4 := v_sql4||'                       ''7933'', ';
    v_sql4 := v_sql4||'                       ''7941'', ';
    v_sql4 := v_sql4||'                       ''7992'', ';
    v_sql4 := v_sql4||'                       ''7994'', ';
    v_sql4 := v_sql4||'                       ''7996'', ';
    v_sql4 := v_sql4||'                       ''7997'', ';
    v_sql4 := v_sql4||'                       ''7998'', ';
    v_sql4 := v_sql4||'                       ''7032'', ';
    v_sql4 := v_sql4||'                       ''7033'', ';
    v_sql4 := v_sql4||'                       ''5944'', ';
    v_sql4 := v_sql4||'                       ''5932'', ';
    v_sql4 := v_sql4||'                       ''7631'', ';
    v_sql4 := v_sql4||'                       ''7999'' ';
    v_sql4 := v_sql4||'                       ) ';
    v_sql4 := v_sql4||'                       AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                       AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''       ';
    v_sql4 := v_sql4||'                       AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                       THEN ';
    v_sql4 := v_sql4||'                        1 ';
    v_sql4 := v_sql4||'                     ELSE ';
    v_sql4 := v_sql4||'                        NULL ';
    v_sql4 := v_sql4||'                     END ';
    v_sql4 := v_sql4||'                  ) AS MCC90COUNT_CM2, ';
    v_sql4 := v_sql4||'                               COUNT(CASE ';
    v_sql4 := v_sql4||'                       WHEN ';
    v_sql4 := v_sql4||'                       (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 1 AND ';
    v_sql4 := v_sql4||'                       mer_cat_cd in ';
    v_sql4 := v_sql4||'                       ( ';
    v_sql4 := v_sql4||'                       ''7011'', ';
    v_sql4 := v_sql4||'                       ''7012'', ';
    v_sql4 := v_sql4||'                       ''5811'', ';
    v_sql4 := v_sql4||'                       ''5812'', ';
    v_sql4 := v_sql4||'                       ''5813'', ';
    v_sql4 := v_sql4||'                       ''5094'', ';
    v_sql4 := v_sql4||'                       ''5937'', ';
    v_sql4 := v_sql4||'                       ''5950'', ';
    v_sql4 := v_sql4||'                       ''5970'', ';
    v_sql4 := v_sql4||'                       ''5971'', ';
    v_sql4 := v_sql4||'                       ''7297'', ';
    v_sql4 := v_sql4||'                       ''7298'', ';
    v_sql4 := v_sql4||'                       ''7829'', ';
    v_sql4 := v_sql4||'                       ''7911'', ';
    v_sql4 := v_sql4||'                       ''7922'', ';
    v_sql4 := v_sql4||'                       ''7929'', ';
    v_sql4 := v_sql4||'                       ''7932'', ';
    v_sql4 := v_sql4||'                       ''7933'', ';
    v_sql4 := v_sql4||'                       ''7941'', ';
    v_sql4 := v_sql4||'                       ''7992'', ';
    v_sql4 := v_sql4||'                       ''7994'', ';
    v_sql4 := v_sql4||'                       ''7996'', ';
    v_sql4 := v_sql4||'                       ''7997'', ';
    v_sql4 := v_sql4||'                       ''7998'', ';
    v_sql4 := v_sql4||'                       ''7032'', ';
    v_sql4 := v_sql4||'                       ''7033'', ';
    v_sql4 := v_sql4||'                       ''5944'', ';
    v_sql4 := v_sql4||'                       ''5932'', ';
    v_sql4 := v_sql4||'                       ''7631'', ';
    v_sql4 := v_sql4||'                       ''7999'' ';
    v_sql4 := v_sql4||'                       ) ';
    v_sql4 := v_sql4||'                       AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                       OR E.src_ind = ''I'' )  ';
    v_sql4 := v_sql4||'                       AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                       THEN ';
    v_sql4 := v_sql4||'                        1 ';
    v_sql4 := v_sql4||'                     ELSE ';
    v_sql4 := v_sql4||'                        NULL ';
    v_sql4 := v_sql4||'                     END ';
    v_sql4 := v_sql4||'                  ) AS MCC90NETCOUNT_CM2, ';
    v_sql4 := v_sql4||'                 COUNT(CASE ';
    v_sql4 := v_sql4||'                       WHEN ';
    v_sql4 := v_sql4||'                       (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 1 AND ';
    v_sql4 := v_sql4||'                       mer_cat_cd in ';
    v_sql4 := v_sql4||'                       ( ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'' ';
    v_sql4 := v_sql4||'                       ) ';
    v_sql4 := v_sql4||'                       AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                       AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''       ';
    v_sql4 := v_sql4||'                       AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                       THEN ';
    v_sql4 := v_sql4||'                        1 ';
    v_sql4 := v_sql4||'                     ELSE ';
    v_sql4 := v_sql4||'                        NULL ';
    v_sql4 := v_sql4||'                     END ';
    v_sql4 := v_sql4||'                  ) AS MCC55COUNT_CM2, ';
    v_sql4 := v_sql4||'                   COUNT(CASE ';
    v_sql4 := v_sql4||'                       WHEN ';
    v_sql4 := v_sql4||'                       (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 1 AND ';
    v_sql4 := v_sql4||'                       mer_cat_cd in ';
    v_sql4 := v_sql4||'                       ( ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'' ';
    v_sql4 := v_sql4||'                       ) ';
    v_sql4 := v_sql4||'                       AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                       OR E.src_ind = ''I'' )   ';
    v_sql4 := v_sql4||'                       AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                         AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                       THEN ';
    v_sql4 := v_sql4||'                        1 ';
    v_sql4 := v_sql4||'                     ELSE ';
    v_sql4 := v_sql4||'                        NULL ';
    v_sql4 := v_sql4||'                     END ';
    v_sql4 := v_sql4||'                  ) AS MCC55NETCOUNT_CM2, ';
    v_sql4 := v_sql4||'                COUNT(CASE ';
    v_sql4 := v_sql4||'                       WHEN ';
    v_sql4 := v_sql4||'                       (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 1 AND ';
    v_sql4 := v_sql4||'                       mer_cat_cd in ';
    v_sql4 := v_sql4||'                       ( ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'' ';
    v_sql4 := v_sql4||'                       ) ';
    v_sql4 := v_sql4||'                       AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                       AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''       ';
    v_sql4 := v_sql4||'                       AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                         AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                       THEN ';
    v_sql4 := v_sql4||'                        1 ';
    v_sql4 := v_sql4||'                     ELSE ';
    v_sql4 := v_sql4||'                        NULL ';
    v_sql4 := v_sql4||'                     END ';
    v_sql4 := v_sql4||'                  ) AS MCC26COUNT_CM2, ';
    v_sql4 := v_sql4||'                         COUNT(CASE ';
    v_sql4 := v_sql4||'                       WHEN ';
    v_sql4 := v_sql4||'                       (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 1 AND ';
    v_sql4 := v_sql4||'                       mer_cat_cd in ';
    v_sql4 := v_sql4||'                       ( ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'' ';
    v_sql4 := v_sql4||'                       ) ';
    v_sql4 := v_sql4||'                       AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                       OR E.src_ind = ''I'' )  ';
    v_sql4 := v_sql4||'                       AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                         AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                       THEN ';
    v_sql4 := v_sql4||'                        1 ';
    v_sql4 := v_sql4||'                     ELSE ';
    v_sql4 := v_sql4||'                        NULL ';
    v_sql4 := v_sql4||'                     END ';
    v_sql4 := v_sql4||'                  ) AS MCC26NETCOUNT_CM2, ';
    v_sql4 := v_sql4||'                                  COUNT(CASE ';
    v_sql4 := v_sql4||'                       WHEN ';
    v_sql4 := v_sql4||'                       (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 1 AND ';
    v_sql4 := v_sql4||'                            TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                       AND coal(E.Src_Ind,'' '') <> ''I'' ';
    v_sql4 := v_sql4||'                       AND ( coal(E.MERCH_STAT,'' '') <> ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                       THEN ';
    v_sql4 := v_sql4||'                        1 ';
    v_sql4 := v_sql4||'                     ELSE ';
    v_sql4 := v_sql4||'                        NULL ';
    v_sql4 := v_sql4||'                     END ';
    v_sql4 := v_sql4||'                  ) AS JW120COUNT_CM2, ';
    v_sql4 := v_sql4||'                         COUNT(CASE ';
    v_sql4 := v_sql4||'                       WHEN ';
    v_sql4 := v_sql4||'                      TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                       AND E.Src_Ind = ''I'' ';
    v_sql4 := v_sql4||'                       AND ( coal(E.MERCH_STAT,'' '') <> ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                       THEN ';
    v_sql4 := v_sql4||'                        1 ';
    v_sql4 := v_sql4||'                     ELSE ';
    v_sql4 := v_sql4||'                        NULL ';
    v_sql4 := v_sql4||'                     END ';
    v_sql4 := v_sql4||'                  ) AS JW120NETCOUNT_CM2, ';
    v_sql4 := v_sql4||'                 COUNT(CASE ';
    v_sql4 := v_sql4||'                       WHEN ';
    v_sql4 := v_sql4||'                       (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 1 AND ';
    v_sql4 := v_sql4||'                          (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                           ''7013'', ';
    v_sql4 := v_sql4||'                                           ''5271'', ';
    v_sql4 := v_sql4||'                                           ''5511'', ';
    v_sql4 := v_sql4||'                                           ''5521'', ';
    v_sql4 := v_sql4||'                                           ''5551'', ';
    v_sql4 := v_sql4||'                                           ''5561'', ';
    v_sql4 := v_sql4||'                                           ''5571'', ';
    v_sql4 := v_sql4||'                                           ''5592'', ';
    v_sql4 := v_sql4||'                                           ''5598'', ';
    v_sql4 := v_sql4||'                                           ''5599'', ';
    v_sql4 := v_sql4||'                                           ''5933'', ';
    v_sql4 := v_sql4||'                                           ''8062'', ';
    v_sql4 := v_sql4||'                                           ''8211'', ';
    v_sql4 := v_sql4||'                                           ''8220'', ';
    v_sql4 := v_sql4||'                                           ''8398'', ';
    v_sql4 := v_sql4||'                                           ''5021'', ';
    v_sql4 := v_sql4||'                                           ''5039'', ';
    v_sql4 := v_sql4||'                                           ''5044'', ';
    v_sql4 := v_sql4||'                                           ''5045'', ';
    v_sql4 := v_sql4||'                                           ''5046'', ';
    v_sql4 := v_sql4||'                                           ''5047'', ';
    v_sql4 := v_sql4||'                                           ''5051'', ';
    v_sql4 := v_sql4||'                                           ''5065'', ';
    v_sql4 := v_sql4||'                                           ''5072'', ';
    v_sql4 := v_sql4||'                                           ''5074'', ';
    v_sql4 := v_sql4||'                                           ''5111'', ';
    v_sql4 := v_sql4||'                                           ''5122'', ';
    v_sql4 := v_sql4||'                                           ''5131'', ';
    v_sql4 := v_sql4||'                                           ''5137'', ';
    v_sql4 := v_sql4||'                                           ''5139'', ';
    v_sql4 := v_sql4||'                                           ''5172'', ';
    v_sql4 := v_sql4||'                                           ''5192'', ';
    v_sql4 := v_sql4||'                                           ''5193'', ';
    v_sql4 := v_sql4||'                                           ''5198'', ';
    v_sql4 := v_sql4||'                                           ''5998'', ';
    v_sql4 := v_sql4||'                                           ''5013'', ';
    v_sql4 := v_sql4||'                                           ''5398'', ';
    v_sql4 := v_sql4||'                                           ''4458'', ';
    v_sql4 := v_sql4||'                                           ''9498'', ';
    v_sql4 := v_sql4||'                                           ''9703'', ';
    v_sql4 := v_sql4||'                                           ''9704'', ';
    v_sql4 := v_sql4||'                                           ''9705'', ';
    v_sql4 := v_sql4||'                                           ''9706'', ';
    v_sql4 := v_sql4||'                                           ''9707'', ';
    v_sql4 := v_sql4||'                                           ''9708'', ';
    v_sql4 := v_sql4||'                                           ''5200'', ';
    v_sql4 := v_sql4||'                                           ''5300'') ';
    v_sql4 := v_sql4||'                                           OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                       AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                       AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''      ';
    v_sql4 := v_sql4||'                       AND BILL_AMT <= 3500 ';
    v_sql4 := v_sql4||'                       AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                       THEN ';
    v_sql4 := v_sql4||'                        1 ';
    v_sql4 := v_sql4||'                     ELSE ';
    v_sql4 := v_sql4||'                        NULL ';
    v_sql4 := v_sql4||'                     END ';
    v_sql4 := v_sql4||'                  ) AS DLCOUNT_CM2, ';
    v_sql4 := v_sql4||'                   COUNT(CASE ';
    v_sql4 := v_sql4||'                       WHEN ';
    v_sql4 := v_sql4||'                       (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 1 AND ';
    v_sql4 := v_sql4||'                          (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                           ''7013'', ';
    v_sql4 := v_sql4||'                                           ''5271'', ';
    v_sql4 := v_sql4||'                                           ''5511'', ';
    v_sql4 := v_sql4||'                                           ''5521'', ';
    v_sql4 := v_sql4||'                                           ''5551'', ';
    v_sql4 := v_sql4||'                                           ''5561'', ';
    v_sql4 := v_sql4||'                                           ''5571'', ';
    v_sql4 := v_sql4||'                                           ''5592'', ';
    v_sql4 := v_sql4||'                                           ''5598'', ';
    v_sql4 := v_sql4||'                                           ''5599'', ';
    v_sql4 := v_sql4||'                                           ''5933'', ';
    v_sql4 := v_sql4||'                                           ''8062'', ';
    v_sql4 := v_sql4||'                                           ''8211'', ';
    v_sql4 := v_sql4||'                                           ''8220'', ';
    v_sql4 := v_sql4||'                                           ''8398'', ';
    v_sql4 := v_sql4||'                                           ''5021'', ';
    v_sql4 := v_sql4||'                                           ''5039'', ';
    v_sql4 := v_sql4||'                                           ''5044'', ';
    v_sql4 := v_sql4||'                                           ''5045'', ';
    v_sql4 := v_sql4||'                                           ''5046'', ';
    v_sql4 := v_sql4||'                                           ''5047'', ';
    v_sql4 := v_sql4||'                                           ''5051'', ';
    v_sql4 := v_sql4||'                                           ''5065'', ';
    v_sql4 := v_sql4||'                                           ''5072'', ';
    v_sql4 := v_sql4||'                                           ''5074'', ';
    v_sql4 := v_sql4||'                                           ''5111'', ';
    v_sql4 := v_sql4||'                                           ''5122'', ';
    v_sql4 := v_sql4||'                                           ''5131'', ';
    v_sql4 := v_sql4||'                                           ''5137'', ';
    v_sql4 := v_sql4||'                                           ''5139'', ';
    v_sql4 := v_sql4||'                                           ''5172'', ';
    v_sql4 := v_sql4||'                                           ''5192'', ';
    v_sql4 := v_sql4||'                                           ''5193'', ';
    v_sql4 := v_sql4||'                                           ''5198'', ';
    v_sql4 := v_sql4||'                                           ''5998'', ';
    v_sql4 := v_sql4||'                                           ''5013'', ';
    v_sql4 := v_sql4||'                                           ''5398'', ';
    v_sql4 := v_sql4||'                                           ''4458'', ';
    v_sql4 := v_sql4||'                                           ''9498'', ';
    v_sql4 := v_sql4||'                                           ''9703'', ';
    v_sql4 := v_sql4||'                                           ''9704'', ';
    v_sql4 := v_sql4||'                                           ''9705'', ';
    v_sql4 := v_sql4||'                                           ''9706'', ';
    v_sql4 := v_sql4||'                                           ''9707'', ';
    v_sql4 := v_sql4||'                                           ''9708'', ';
    v_sql4 := v_sql4||'                                           ''5200'', ';
    v_sql4 := v_sql4||'                                           ''5300'') ';
    v_sql4 := v_sql4||'                                           OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                       AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                       OR E.src_ind = ''I'' )  ';
    v_sql4 := v_sql4||'                       AND BILL_AMT <= 3500 ';
    v_sql4 := v_sql4||'                       AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                       THEN ';
    v_sql4 := v_sql4||'                        1 ';
    v_sql4 := v_sql4||'                     ELSE ';
    v_sql4 := v_sql4||'                        NULL ';
    v_sql4 := v_sql4||'                     END ';
    v_sql4 := v_sql4||'                  ) AS DLNETCOUNT_CM2, ';
    v_sql4 := v_sql4||'                   MIN(CASE ';
    v_sql4 := v_sql4||'                       WHEN ';
    v_sql4 := v_sql4||'                       (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 1 AND ';
    v_sql4 := v_sql4||'                            TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                            AND coal(E.src_ind,'' '') <> ''I''    ';
    v_sql4 := v_sql4||'                       AND ( coal(E.MERCH_STAT,'' '') <> ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                       THEN ';
    v_sql4 := v_sql4||'                        CEIL(date_diff(SYSDATE(), toDate(CREATE_DATE,''yyyy-mm-dd''))) ';
    v_sql4 := v_sql4||'                     ELSE ';
    v_sql4 := v_sql4||'                        9999 ';
    v_sql4 := v_sql4||'                     END ';
    v_sql4 := v_sql4||'                  ) AS JWRECENCY_CM2, ';
    v_sql4 := v_sql4||'                 COUNT(CASE ';
    v_sql4 := v_sql4||'                       WHEN ';
    v_sql4 := v_sql4||'                       (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 1 AND ';
    v_sql4 := v_sql4||'                          (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                           ''7013'', ';
    v_sql4 := v_sql4||'                                           ''5271'', ';
    v_sql4 := v_sql4||'                                           ''5511'', ';
    v_sql4 := v_sql4||'                                           ''5521'', ';
    v_sql4 := v_sql4||'                                           ''5551'', ';
    v_sql4 := v_sql4||'                                           ''5561'', ';
    v_sql4 := v_sql4||'                                           ''5571'', ';
    v_sql4 := v_sql4||'                                           ''5592'', ';
    v_sql4 := v_sql4||'                                           ''5598'', ';
    v_sql4 := v_sql4||'                                           ''5599'', ';
    v_sql4 := v_sql4||'                                           ''5933'', ';
    v_sql4 := v_sql4||'                                           ''8062'', ';
    v_sql4 := v_sql4||'                                           ''8211'', ';
    v_sql4 := v_sql4||'                                           ''8220'', ';
    v_sql4 := v_sql4||'                                           ''8398'', ';
    v_sql4 := v_sql4||'                                           ''5021'', ';
    v_sql4 := v_sql4||'                                           ''5039'', ';
    v_sql4 := v_sql4||'                                           ''5044'', ';
    v_sql4 := v_sql4||'                                           ''5045'', ';
    v_sql4 := v_sql4||'                                           ''5046'', ';
    v_sql4 := v_sql4||'                                           ''5047'', ';
    v_sql4 := v_sql4||'                                           ''5051'', ';
    v_sql4 := v_sql4||'                                           ''5065'', ';
    v_sql4 := v_sql4||'                                           ''5072'', ';
    v_sql4 := v_sql4||'                                           ''5074'', ';
    v_sql4 := v_sql4||'                                           ''5111'', ';
    v_sql4 := v_sql4||'                                           ''5122'', ';
    v_sql4 := v_sql4||'                                           ''5131'', ';
    v_sql4 := v_sql4||'                                           ''5137'', ';
    v_sql4 := v_sql4||'                                           ''5139'', ';
    v_sql4 := v_sql4||'                                           ''5172'', ';
    v_sql4 := v_sql4||'                                           ''5192'', ';
    v_sql4 := v_sql4||'                                           ''5193'', ';
    v_sql4 := v_sql4||'                                           ''5198'', ';
    v_sql4 := v_sql4||'                                           ''5998'', ';
    v_sql4 := v_sql4||'                                           ''5013'', ';
    v_sql4 := v_sql4||'                                           ''5398'', ';
    v_sql4 := v_sql4||'                                           ''4458'', ';
    v_sql4 := v_sql4||'                                           ''9498'', ';
    v_sql4 := v_sql4||'                                           ''9703'', ';
    v_sql4 := v_sql4||'                                           ''9704'', ';
    v_sql4 := v_sql4||'                                           ''9705'', ';
    v_sql4 := v_sql4||'                                           ''9706'', ';
    v_sql4 := v_sql4||'                                           ''9707'', ';
    v_sql4 := v_sql4||'                                           ''9708'', ';
    v_sql4 := v_sql4||'                                           ''5200'', ';
    v_sql4 := v_sql4||'                                           ''5300'') ';
    v_sql4 := v_sql4||'                                           OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                       AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                       AND TRANS_TYPE != '' '' AND BILL_AMT > 3500 ';
    v_sql4 := v_sql4||'                       AND coal(E.src_ind,'' '') <> ''I''      ';
    v_sql4 := v_sql4||'                       AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                       THEN ';
    v_sql4 := v_sql4||'                        1 ';
    v_sql4 := v_sql4||'                     ELSE ';
    v_sql4 := v_sql4||'                        NULL ';
    v_sql4 := v_sql4||'                     END ';
    v_sql4 := v_sql4||'                  ) AS DLCOUNT_2_CM2, ';
    v_sql4 := v_sql4||'                                     COUNT(CASE ';
    v_sql4 := v_sql4||'                       WHEN ';
    v_sql4 := v_sql4||'                       (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 1 AND ';
    v_sql4 := v_sql4||'                          (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                           ''7013'', ';
    v_sql4 := v_sql4||'                                           ''5271'', ';
    v_sql4 := v_sql4||'                                           ''5511'', ';
    v_sql4 := v_sql4||'                                           ''5521'', ';
    v_sql4 := v_sql4||'                                           ''5551'', ';
    v_sql4 := v_sql4||'                                           ''5561'', ';
    v_sql4 := v_sql4||'                                           ''5571'', ';
    v_sql4 := v_sql4||'                                           ''5592'', ';
    v_sql4 := v_sql4||'                                           ''5598'', ';
    v_sql4 := v_sql4||'                                           ''5599'', ';
    v_sql4 := v_sql4||'                                           ''5933'', ';
    v_sql4 := v_sql4||'                                           ''8062'', ';
    v_sql4 := v_sql4||'                                           ''8211'', ';
    v_sql4 := v_sql4||'                                           ''8220'', ';
    v_sql4 := v_sql4||'                                           ''8398'', ';
    v_sql4 := v_sql4||'                                           ''5021'', ';
    v_sql4 := v_sql4||'                                           ''5039'', ';
    v_sql4 := v_sql4||'                                           ''5044'', ';
    v_sql4 := v_sql4||'                                           ''5045'', ';
    v_sql4 := v_sql4||'                                           ''5046'', ';
    v_sql4 := v_sql4||'                                           ''5047'', ';
    v_sql4 := v_sql4||'                                           ''5051'', ';
    v_sql4 := v_sql4||'                                           ''5065'', ';
    v_sql4 := v_sql4||'                                           ''5072'', ';
    v_sql4 := v_sql4||'                                           ''5074'', ';
    v_sql4 := v_sql4||'                                           ''5111'', ';
    v_sql4 := v_sql4||'                                           ''5122'', ';
    v_sql4 := v_sql4||'                                           ''5131'', ';
    v_sql4 := v_sql4||'                                           ''5137'', ';
    v_sql4 := v_sql4||'                                           ''5139'', ';
    v_sql4 := v_sql4||'                                           ''5172'', ';
    v_sql4 := v_sql4||'                                           ''5192'', ';
    v_sql4 := v_sql4||'                                           ''5193'', ';
    v_sql4 := v_sql4||'                                           ''5198'', ';
    v_sql4 := v_sql4||'                                           ''5998'', ';
    v_sql4 := v_sql4||'                                           ''5013'', ';
    v_sql4 := v_sql4||'                                           ''5398'', ';
    v_sql4 := v_sql4||'                                           ''4458'', ';
    v_sql4 := v_sql4||'                                           ''9498'', ';
    v_sql4 := v_sql4||'                                           ''9703'', ';
    v_sql4 := v_sql4||'                                           ''9704'', ';
    v_sql4 := v_sql4||'                                           ''9705'', ';
    v_sql4 := v_sql4||'                                           ''9706'', ';
    v_sql4 := v_sql4||'                                           ''9707'', ';
    v_sql4 := v_sql4||'                                           ''9708'', ';
    v_sql4 := v_sql4||'                                           ''5200'', ';
    v_sql4 := v_sql4||'                                           ''5300'') ';
    v_sql4 := v_sql4||'                                           OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                       AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                       OR E.src_ind = ''I'' ) ';
    v_sql4 := v_sql4||'                       AND BILL_AMT > 3500 ';
    v_sql4 := v_sql4||'                       AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                       THEN ';
    v_sql4 := v_sql4||'                        1 ';
    v_sql4 := v_sql4||'                     ELSE ';
    v_sql4 := v_sql4||'                        NULL ';
    v_sql4 := v_sql4||'                     END ';
    v_sql4 := v_sql4||'                  ) AS DLNETCOUNT_2_CM2, ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                   SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 2 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||'                        ''7011'', ';
    v_sql4 := v_sql4||'                        ''7012'', ';
    v_sql4 := v_sql4||'                        ''5811'', ';
    v_sql4 := v_sql4||'                        ''5812'', ';
    v_sql4 := v_sql4||'                        ''5813'', ';
    v_sql4 := v_sql4||'                        ''5094'', ';
    v_sql4 := v_sql4||'                        ''5937'', ';
    v_sql4 := v_sql4||'                        ''5950'', ';
    v_sql4 := v_sql4||'                        ''5970'', ';
    v_sql4 := v_sql4||'                        ''5971'', ';
    v_sql4 := v_sql4||'                        ''7297'', ';
    v_sql4 := v_sql4||'                        ''7298'', ';
    v_sql4 := v_sql4||'                        ''7829'', ';
    v_sql4 := v_sql4||'                        ''7911'', ';
    v_sql4 := v_sql4||'                        ''7922'', ';
    v_sql4 := v_sql4||'                        ''7929'', ';
    v_sql4 := v_sql4||'                        ''7932'', ';
    v_sql4 := v_sql4||'                        ''7933'', ';
    v_sql4 := v_sql4||'                        ''7941'', ';
    v_sql4 := v_sql4||'                        ''7992'', ';
    v_sql4 := v_sql4||'                        ''7994'', ';
    v_sql4 := v_sql4||'                        ''7996'', ';
    v_sql4 := v_sql4||'                        ''7997'', ';
    v_sql4 := v_sql4||'                        ''7998'', ';
    v_sql4 := v_sql4||'                        ''7032'', ';
    v_sql4 := v_sql4||'                        ''7033'', ';
    v_sql4 := v_sql4||'                        ''5944'', ';
    v_sql4 := v_sql4||'                        ''5932'', ';
    v_sql4 := v_sql4||'                        ''7631'', ';
    v_sql4 := v_sql4||'                        ''7999'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''      ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                          AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC90SUM_CM3, ';
    v_sql4 := v_sql4||'                                SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 2 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||'                        ''7011'', ';
    v_sql4 := v_sql4||'                        ''7012'', ';
    v_sql4 := v_sql4||'                        ''5811'', ';
    v_sql4 := v_sql4||'                        ''5812'', ';
    v_sql4 := v_sql4||'                        ''5813'', ';
    v_sql4 := v_sql4||'                        ''5094'', ';
    v_sql4 := v_sql4||'                        ''5937'', ';
    v_sql4 := v_sql4||'                        ''5950'', ';
    v_sql4 := v_sql4||'                        ''5970'', ';
    v_sql4 := v_sql4||'                        ''5971'', ';
    v_sql4 := v_sql4||'                        ''7297'', ';
    v_sql4 := v_sql4||'                        ''7298'', ';
    v_sql4 := v_sql4||'                        ''7829'', ';
    v_sql4 := v_sql4||'                        ''7911'', ';
    v_sql4 := v_sql4||'                        ''7922'', ';
    v_sql4 := v_sql4||'                        ''7929'', ';
    v_sql4 := v_sql4||'                        ''7932'', ';
    v_sql4 := v_sql4||'                        ''7933'', ';
    v_sql4 := v_sql4||'                        ''7941'', ';
    v_sql4 := v_sql4||'                        ''7992'', ';
    v_sql4 := v_sql4||'                        ''7994'', ';
    v_sql4 := v_sql4||'                        ''7996'', ';
    v_sql4 := v_sql4||'                        ''7997'', ';
    v_sql4 := v_sql4||'                        ''7998'', ';
    v_sql4 := v_sql4||'                        ''7032'', ';
    v_sql4 := v_sql4||'                        ''7033'', ';
    v_sql4 := v_sql4||'                        ''5944'', ';
    v_sql4 := v_sql4||'                        ''5932'', ';
    v_sql4 := v_sql4||'                        ''7631'', ';
    v_sql4 := v_sql4||'                        ''7999'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )  ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                          AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC90NETSUM_CM3, ';
    v_sql4 := v_sql4||'                  SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 2 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                          AND coal(E.src_ind,'' '') <> ''I''     ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC55SUM_CM3, ';
    v_sql4 := v_sql4||'                    SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 2 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )   ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                          AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC55NETSUM_CM3, ';
    v_sql4 := v_sql4||'                 SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 2 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''   ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                          AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC26SUM_CM3, ';
    v_sql4 := v_sql4||'                          SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 2 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )  ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                          AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC26NETSUM_CM3, ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                                   SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 2 AND ';
    v_sql4 := v_sql4||'                             TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND coal(E.Src_Ind,'' '') <> ''I'' ';
    v_sql4 := v_sql4||'                        AND ( coal(E.MERCH_STAT,'' '') <> ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS JW120SUM_CM3, ';
    v_sql4 := v_sql4||'                          SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                       TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND E.Src_Ind = ''I'' ';
    v_sql4 := v_sql4||'                        AND ( coal(E.MERCH_STAT,'' '') <> ''156'' and E.MERCH_STAT is not null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS JW120NETSUM_CM3, ';
    v_sql4 := v_sql4||'                  SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 2 AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                        AND E.TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''      ';
    v_sql4 := v_sql4||'                        AND BILL_AMT <= 3500 ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS DLSUM_CM3, ';
    v_sql4 := v_sql4||'                    SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 2 AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )  ';
    v_sql4 := v_sql4||'                        AND BILL_AMT <= 3500 ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS DLNETSUM_CM3, ';
    v_sql4 := v_sql4||'                                     COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 2 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||'                        ''7011'', ';
    v_sql4 := v_sql4||'                        ''7012'', ';
    v_sql4 := v_sql4||'                        ''5811'', ';
    v_sql4 := v_sql4||'                        ''5812'', ';
    v_sql4 := v_sql4||'                        ''5813'', ';
    v_sql4 := v_sql4||'                        ''5094'', ';
    v_sql4 := v_sql4||'                        ''5937'', ';
    v_sql4 := v_sql4||'                        ''5950'', ';
    v_sql4 := v_sql4||'                        ''5970'', ';
    v_sql4 := v_sql4||'                        ''5971'', ';
    v_sql4 := v_sql4||'                        ''7297'', ';
    v_sql4 := v_sql4||'                        ''7298'', ';
    v_sql4 := v_sql4||'                        ''7829'', ';
    v_sql4 := v_sql4||'                        ''7911'', ';
    v_sql4 := v_sql4||'                        ''7922'', ';
    v_sql4 := v_sql4||'                        ''7929'', ';
    v_sql4 := v_sql4||'                        ''7932'', ';
    v_sql4 := v_sql4||'                        ''7933'', ';
    v_sql4 := v_sql4||'                        ''7941'', ';
    v_sql4 := v_sql4||'                        ''7992'', ';
    v_sql4 := v_sql4||'                        ''7994'', ';
    v_sql4 := v_sql4||'                        ''7996'', ';
    v_sql4 := v_sql4||'                        ''7997'', ';
    v_sql4 := v_sql4||'                        ''7998'', ';
    v_sql4 := v_sql4||'                        ''7032'', ';
    v_sql4 := v_sql4||'                        ''7033'', ';
    v_sql4 := v_sql4||'                        ''5944'', ';
    v_sql4 := v_sql4||'                        ''5932'', ';
    v_sql4 := v_sql4||'                        ''7631'', ';
    v_sql4 := v_sql4||'                        ''7999'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''       ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                         AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC90COUNT_CM3, ';
    v_sql4 := v_sql4||'                                COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 2 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||'                        ''7011'', ';
    v_sql4 := v_sql4||'                        ''7012'', ';
    v_sql4 := v_sql4||'                        ''5811'', ';
    v_sql4 := v_sql4||'                        ''5812'', ';
    v_sql4 := v_sql4||'                        ''5813'', ';
    v_sql4 := v_sql4||'                        ''5094'', ';
    v_sql4 := v_sql4||'                        ''5937'', ';
    v_sql4 := v_sql4||'                        ''5950'', ';
    v_sql4 := v_sql4||'                        ''5970'', ';
    v_sql4 := v_sql4||'                        ''5971'', ';
    v_sql4 := v_sql4||'                        ''7297'', ';
    v_sql4 := v_sql4||'                        ''7298'', ';
    v_sql4 := v_sql4||'                        ''7829'', ';
    v_sql4 := v_sql4||'                        ''7911'', ';
    v_sql4 := v_sql4||'                        ''7922'', ';
    v_sql4 := v_sql4||'                        ''7929'', ';
    v_sql4 := v_sql4||'                        ''7932'', ';
    v_sql4 := v_sql4||'                        ''7933'', ';
    v_sql4 := v_sql4||'                        ''7941'', ';
    v_sql4 := v_sql4||'                        ''7992'', ';
    v_sql4 := v_sql4||'                        ''7994'', ';
    v_sql4 := v_sql4||'                        ''7996'', ';
    v_sql4 := v_sql4||'                        ''7997'', ';
    v_sql4 := v_sql4||'                        ''7998'', ';
    v_sql4 := v_sql4||'                        ''7032'', ';
    v_sql4 := v_sql4||'                        ''7033'', ';
    v_sql4 := v_sql4||'                        ''5944'', ';
    v_sql4 := v_sql4||'                        ''5932'', ';
    v_sql4 := v_sql4||'                        ''7631'', ';
    v_sql4 := v_sql4||'                        ''7999'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )  ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                         AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC90NETCOUNT_CM3, ';
    v_sql4 := v_sql4||'                  COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 2 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''  ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                         AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC55COUNT_CM3, ';
    v_sql4 := v_sql4||'                    COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 2 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )  ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                          AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC55NETCOUNT_CM3, ';
    v_sql4 := v_sql4||'                 COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 2 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''     ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                         AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC26COUNT_CM3, ';
    v_sql4 := v_sql4||'                          COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 2 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' ) ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                         AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC26NETCOUNT_CM3, ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                                   COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 2 AND ';
    v_sql4 := v_sql4||'                             TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND coal(E.Src_Ind,'' '') <> ''I'' ';
    v_sql4 := v_sql4||'                        AND ( coal(E.MERCH_STAT,'' '') <> ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS JW120COUNT_CM3, ';
    v_sql4 := v_sql4||'                          COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                       TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND E.Src_Ind = ''I'' ';
    v_sql4 := v_sql4||'                        AND ( coal(E.MERCH_STAT,'' '') <> ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS JW120NETCOUNT_CM3, ';
    v_sql4 := v_sql4||'                  COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 2 AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''   ';
    v_sql4 := v_sql4||'                        AND BILL_AMT <= 3500 ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS DLCOUNT_CM3, ';
    v_sql4 := v_sql4||'                    COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 2 AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )  ';
    v_sql4 := v_sql4||'                        AND BILL_AMT <= 3500 ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS DLNETCOUNT_CM3, ';
    v_sql4 := v_sql4||'                    MIN(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 2 AND ';
    v_sql4 := v_sql4||'                             TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                             AND coal(E.src_ind,'' '') <> ''I''      ';
    v_sql4 := v_sql4||'                        AND ( coal(E.MERCH_STAT,'' '') <> ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CEIL(date_diff(SYSDATE(), toDate(CREATE_DATE,''yyyy-mm-dd''))) ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         9999 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS JWRECENCY_CM3, ';
    v_sql4 := v_sql4||'                  COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 2 AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND BILL_AMT > 3500 ';
    v_sql4 := v_sql4||'                        AND coal(E.src_ind,'' '') <> ''I''      ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS DLCOUNT_2_CM3, ';
    v_sql4 := v_sql4||'                                      COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 2 AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )  ';
    v_sql4 := v_sql4||'                        AND BILL_AMT > 3500 ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS DLNETCOUNT_2_CM3, ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                   SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 3 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||'                        ''7011'', ';
    v_sql4 := v_sql4||'                        ''7012'', ';
    v_sql4 := v_sql4||'                        ''5811'', ';
    v_sql4 := v_sql4||'                        ''5812'', ';
    v_sql4 := v_sql4||'                        ''5813'', ';
    v_sql4 := v_sql4||'                        ''5094'', ';
    v_sql4 := v_sql4||'                        ''5937'', ';
    v_sql4 := v_sql4||'                        ''5950'', ';
    v_sql4 := v_sql4||'                        ''5970'', ';
    v_sql4 := v_sql4||'                        ''5971'', ';
    v_sql4 := v_sql4||'                        ''7297'', ';
    v_sql4 := v_sql4||'                        ''7298'', ';
    v_sql4 := v_sql4||'                        ''7829'', ';
    v_sql4 := v_sql4||'                        ''7911'', ';
    v_sql4 := v_sql4||'                        ''7922'', ';
    v_sql4 := v_sql4||'                        ''7929'', ';
    v_sql4 := v_sql4||'                        ''7932'', ';
    v_sql4 := v_sql4||'                        ''7933'', ';
    v_sql4 := v_sql4||'                        ''7941'', ';
    v_sql4 := v_sql4||'                        ''7992'', ';
    v_sql4 := v_sql4||'                        ''7994'', ';
    v_sql4 := v_sql4||'                        ''7996'', ';
    v_sql4 := v_sql4||'                        ''7997'', ';
    v_sql4 := v_sql4||'                        ''7998'', ';
    v_sql4 := v_sql4||'                        ''7032'', ';
    v_sql4 := v_sql4||'                        ''7033'', ';
    v_sql4 := v_sql4||'                        ''5944'', ';
    v_sql4 := v_sql4||'                        ''5932'', ';
    v_sql4 := v_sql4||'                        ''7631'', ';
    v_sql4 := v_sql4||'                        ''7999'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''    ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                          AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC90SUM_CM4, ';
    v_sql4 := v_sql4||'                                SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 3 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||'                        ''7011'', ';
    v_sql4 := v_sql4||'                        ''7012'', ';
    v_sql4 := v_sql4||'                        ''5811'', ';
    v_sql4 := v_sql4||'                        ''5812'', ';
    v_sql4 := v_sql4||'                        ''5813'', ';
    v_sql4 := v_sql4||'                        ''5094'', ';
    v_sql4 := v_sql4||'                        ''5937'', ';
    v_sql4 := v_sql4||'                        ''5950'', ';
    v_sql4 := v_sql4||'                        ''5970'', ';
    v_sql4 := v_sql4||'                        ''5971'', ';
    v_sql4 := v_sql4||'                        ''7297'', ';
    v_sql4 := v_sql4||'                        ''7298'', ';
    v_sql4 := v_sql4||'                        ''7829'', ';
    v_sql4 := v_sql4||'                        ''7911'', ';
    v_sql4 := v_sql4||'                        ''7922'', ';
    v_sql4 := v_sql4||'                        ''7929'', ';
    v_sql4 := v_sql4||'                        ''7932'', ';
    v_sql4 := v_sql4||'                        ''7933'', ';
    v_sql4 := v_sql4||'                        ''7941'', ';
    v_sql4 := v_sql4||'                        ''7992'', ';
    v_sql4 := v_sql4||'                        ''7994'', ';
    v_sql4 := v_sql4||'                        ''7996'', ';
    v_sql4 := v_sql4||'                        ''7997'', ';
    v_sql4 := v_sql4||'                        ''7998'', ';
    v_sql4 := v_sql4||'                        ''7032'', ';
    v_sql4 := v_sql4||'                        ''7033'', ';
    v_sql4 := v_sql4||'                        ''5944'', ';
    v_sql4 := v_sql4||'                        ''5932'', ';
    v_sql4 := v_sql4||'                        ''7631'', ';
    v_sql4 := v_sql4||'                        ''7999'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )   ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                          AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC90NETSUM_CM4, ';
    v_sql4 := v_sql4||'                  SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 3 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                         AND coal(E.src_ind,'' '') <> ''I''     ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC55SUM_CM4, ';
    v_sql4 := v_sql4||'                    SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 3 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )  ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                         AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC55NETSUM_CM4, ';
    v_sql4 := v_sql4||'                 SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 3 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''   ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                         AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC26SUM_CM4, ';
    v_sql4 := v_sql4||'                          SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 3 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )  ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                         AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC26NETSUM_CM4, ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                                   SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 3 AND ';
    v_sql4 := v_sql4||'                             TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND coal(E.Src_Ind,'' '') <> ''I'' ';
    v_sql4 := v_sql4||'                        AND ( coal(E.MERCH_STAT,'' '') <> ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS JW120SUM_CM4, ';
    v_sql4 := v_sql4||'                          SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                       TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND E.Src_Ind = ''I'' ';
    v_sql4 := v_sql4||'                        AND ( coal(E.MERCH_STAT,'' '') <> ''156'' and E.MERCH_STAT is not null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS JW120NETSUM_CM4, ';
    v_sql4 := v_sql4||'                  SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 3 AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                        AND E.TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''      ';
    v_sql4 := v_sql4||'                        AND BILL_AMT <= 3500 ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS DLSUM_CM4, ';
    v_sql4 := v_sql4||'                    SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 3 AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )  ';
    v_sql4 := v_sql4||'                        AND BILL_AMT <= 3500 ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS DLNETSUM_CM4, ';
    v_sql4 := v_sql4||'                                     COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 3 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||'                        ''7011'', ';
    v_sql4 := v_sql4||'                        ''7012'', ';
    v_sql4 := v_sql4||'                        ''5811'', ';
    v_sql4 := v_sql4||'                        ''5812'', ';
    v_sql4 := v_sql4||'                        ''5813'', ';
    v_sql4 := v_sql4||'                        ''5094'', ';
    v_sql4 := v_sql4||'                        ''5937'', ';
    v_sql4 := v_sql4||'                        ''5950'', ';
    v_sql4 := v_sql4||'                        ''5970'', ';
    v_sql4 := v_sql4||'                        ''5971'', ';
    v_sql4 := v_sql4||'                        ''7297'', ';
    v_sql4 := v_sql4||'                        ''7298'', ';
    v_sql4 := v_sql4||'                        ''7829'', ';
    v_sql4 := v_sql4||'                        ''7911'', ';
    v_sql4 := v_sql4||'                        ''7922'', ';
    v_sql4 := v_sql4||'                        ''7929'', ';
    v_sql4 := v_sql4||'                        ''7932'', ';
    v_sql4 := v_sql4||'                        ''7933'', ';
    v_sql4 := v_sql4||'                        ''7941'', ';
    v_sql4 := v_sql4||'                        ''7992'', ';
    v_sql4 := v_sql4||'                        ''7994'', ';
    v_sql4 := v_sql4||'                        ''7996'', ';
    v_sql4 := v_sql4||'                        ''7997'', ';
    v_sql4 := v_sql4||'                        ''7998'', ';
    v_sql4 := v_sql4||'                        ''7032'', ';
    v_sql4 := v_sql4||'                        ''7033'', ';
    v_sql4 := v_sql4||'                        ''5944'', ';
    v_sql4 := v_sql4||'                        ''5932'', ';
    v_sql4 := v_sql4||'                        ''7631'', ';
    v_sql4 := v_sql4||'                        ''7999'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''      ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                         AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC90COUNT_CM4, ';
    v_sql4 := v_sql4||'                                COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 3 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||'                        ''7011'', ';
    v_sql4 := v_sql4||'                        ''7012'', ';
    v_sql4 := v_sql4||'                        ''5811'', ';
    v_sql4 := v_sql4||'                        ''5812'', ';
    v_sql4 := v_sql4||'                        ''5813'', ';
    v_sql4 := v_sql4||'                        ''5094'', ';
    v_sql4 := v_sql4||'                        ''5937'', ';
    v_sql4 := v_sql4||'                        ''5950'', ';
    v_sql4 := v_sql4||'                        ''5970'', ';
    v_sql4 := v_sql4||'                        ''5971'', ';
    v_sql4 := v_sql4||'                        ''7297'', ';
    v_sql4 := v_sql4||'                        ''7298'', ';
    v_sql4 := v_sql4||'                        ''7829'', ';
    v_sql4 := v_sql4||'                        ''7911'', ';
    v_sql4 := v_sql4||'                        ''7922'', ';
    v_sql4 := v_sql4||'                        ''7929'', ';
    v_sql4 := v_sql4||'                        ''7932'', ';
    v_sql4 := v_sql4||'                        ''7933'', ';
    v_sql4 := v_sql4||'                        ''7941'', ';
    v_sql4 := v_sql4||'                        ''7992'', ';
    v_sql4 := v_sql4||'                        ''7994'', ';
    v_sql4 := v_sql4||'                        ''7996'', ';
    v_sql4 := v_sql4||'                        ''7997'', ';
    v_sql4 := v_sql4||'                        ''7998'', ';
    v_sql4 := v_sql4||'                        ''7032'', ';
    v_sql4 := v_sql4||'                        ''7033'', ';
    v_sql4 := v_sql4||'                        ''5944'', ';
    v_sql4 := v_sql4||'                        ''5932'', ';
    v_sql4 := v_sql4||'                        ''7631'', ';
    v_sql4 := v_sql4||'                        ''7999'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )  ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                         AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC90NETCOUNT_CM4, ';
    v_sql4 := v_sql4||'                  COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 3 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''     ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                         AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC55COUNT_CM4, ';
    v_sql4 := v_sql4||'                    COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 3 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' ) ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                          AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC55NETCOUNT_CM4, ';
    v_sql4 := v_sql4||'                 COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 3 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''      ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                         AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC26COUNT_CM4, ';
    v_sql4 := v_sql4||'                          COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 3 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )   ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                          AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC26NETCOUNT_CM4, ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                                   COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 3 AND ';
    v_sql4 := v_sql4||'                             TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND coal(E.Src_Ind,'' '') <> ''I'' ';
    v_sql4 := v_sql4||'                        AND ( coal(E.MERCH_STAT,'' '') <> ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS JW120COUNT_CM4, ';
    v_sql4 := v_sql4||'                          COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                       TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND E.Src_Ind = ''I'' ';
    v_sql4 := v_sql4||'                        AND ( coal(E.MERCH_STAT,'' '') <> ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS JW120NETCOUNT_CM4, ';
    v_sql4 := v_sql4||'                  COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 3 AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''    ';
    v_sql4 := v_sql4||'                        AND BILL_AMT <= 3500 ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS DLCOUNT_CM4, ';
    v_sql4 := v_sql4||'                    COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 3 AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )   ';
    v_sql4 := v_sql4||'                        AND BILL_AMT <= 3500 ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS DLNETCOUNT_CM4, ';
    v_sql4 := v_sql4||'                    MIN(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 3 AND ';
    v_sql4 := v_sql4||'                             TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                             AND coal(E.src_ind,'' '') <> ''I''   ';
    v_sql4 := v_sql4||'                        AND ( coal(E.MERCH_STAT,'' '') <> ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CEIL(date_diff(SYSDATE(), toDate(CREATE_DATE,''yyyy-mm-dd''))) ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         9999 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS JWRECENCY_CM4, ';
    v_sql4 := v_sql4||'                  COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 3 AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND BILL_AMT > 3500 ';
    v_sql4 := v_sql4||'                        AND coal(E.src_ind,'' '') <> ''I''      ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS DLCOUNT_2_CM4, ';
    v_sql4 := v_sql4||'                                      COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 3 AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' ) ';
    v_sql4 := v_sql4||'                        AND BILL_AMT > 3500 ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS DLNETCOUNT_2_CM4, ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                   SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 4 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||'                        ''7011'', ';
    v_sql4 := v_sql4||'                        ''7012'', ';
    v_sql4 := v_sql4||'                        ''5811'', ';
    v_sql4 := v_sql4||'                        ''5812'', ';
    v_sql4 := v_sql4||'                        ''5813'', ';
    v_sql4 := v_sql4||'                        ''5094'', ';
    v_sql4 := v_sql4||'                        ''5937'', ';
    v_sql4 := v_sql4||'                        ''5950'', ';
    v_sql4 := v_sql4||'                        ''5970'', ';
    v_sql4 := v_sql4||'                        ''5971'', ';
    v_sql4 := v_sql4||'                        ''7297'', ';
    v_sql4 := v_sql4||'                        ''7298'', ';
    v_sql4 := v_sql4||'                        ''7829'', ';
    v_sql4 := v_sql4||'                        ''7911'', ';
    v_sql4 := v_sql4||'                        ''7922'', ';
    v_sql4 := v_sql4||'                        ''7929'', ';
    v_sql4 := v_sql4||'                        ''7932'', ';
    v_sql4 := v_sql4||'                        ''7933'', ';
    v_sql4 := v_sql4||'                        ''7941'', ';
    v_sql4 := v_sql4||'                        ''7992'', ';
    v_sql4 := v_sql4||'                        ''7994'', ';
    v_sql4 := v_sql4||'                        ''7996'', ';
    v_sql4 := v_sql4||'                        ''7997'', ';
    v_sql4 := v_sql4||'                        ''7998'', ';
    v_sql4 := v_sql4||'                        ''7032'', ';
    v_sql4 := v_sql4||'                        ''7033'', ';
    v_sql4 := v_sql4||'                        ''5944'', ';
    v_sql4 := v_sql4||'                        ''5932'', ';
    v_sql4 := v_sql4||'                        ''7631'', ';
    v_sql4 := v_sql4||'                        ''7999'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''      ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                          AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC90SUM_CM5, ';
    v_sql4 := v_sql4||'                                SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 4 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||'                        ''7011'', ';
    v_sql4 := v_sql4||'                        ''7012'', ';
    v_sql4 := v_sql4||'                        ''5811'', ';
    v_sql4 := v_sql4||'                        ''5812'', ';
    v_sql4 := v_sql4||'                        ''5813'', ';
    v_sql4 := v_sql4||'                        ''5094'', ';
    v_sql4 := v_sql4||'                        ''5937'', ';
    v_sql4 := v_sql4||'                        ''5950'', ';
    v_sql4 := v_sql4||'                        ''5970'', ';
    v_sql4 := v_sql4||'                        ''5971'', ';
    v_sql4 := v_sql4||'                        ''7297'', ';
    v_sql4 := v_sql4||'                        ''7298'', ';
    v_sql4 := v_sql4||'                        ''7829'', ';
    v_sql4 := v_sql4||'                        ''7911'', ';
    v_sql4 := v_sql4||'                        ''7922'', ';
    v_sql4 := v_sql4||'                        ''7929'', ';
    v_sql4 := v_sql4||'                        ''7932'', ';
    v_sql4 := v_sql4||'                        ''7933'', ';
    v_sql4 := v_sql4||'                        ''7941'', ';
    v_sql4 := v_sql4||'                        ''7992'', ';
    v_sql4 := v_sql4||'                        ''7994'', ';
    v_sql4 := v_sql4||'                        ''7996'', ';
    v_sql4 := v_sql4||'                        ''7997'', ';
    v_sql4 := v_sql4||'                        ''7998'', ';
    v_sql4 := v_sql4||'                        ''7032'', ';
    v_sql4 := v_sql4||'                        ''7033'', ';
    v_sql4 := v_sql4||'                        ''5944'', ';
    v_sql4 := v_sql4||'                        ''5932'', ';
    v_sql4 := v_sql4||'                        ''7631'', ';
    v_sql4 := v_sql4||'                        ''7999'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )  ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                          AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC90NETSUM_CM5, ';
    v_sql4 := v_sql4||'                  SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 4 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                          AND coal(E.src_ind,'' '') <> ''I''       ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC55SUM_CM5, ';
    v_sql4 := v_sql4||'                    SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 4 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )   ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                          AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC55NETSUM_CM5, ';
    v_sql4 := v_sql4||'                 SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 4 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''       ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                          AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC26SUM_CM5, ';
    v_sql4 := v_sql4||'                          SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 4 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )  ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                          AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC26NETSUM_CM5, ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                                   SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 4 AND ';
    v_sql4 := v_sql4||'                             TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND coal(E.Src_Ind,'' '') <> ''I'' ';
    v_sql4 := v_sql4||'                        AND ( coal(E.MERCH_STAT,'' '') <> ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS JW120SUM_CM5, ';
    v_sql4 := v_sql4||'                          SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                       TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND E.Src_Ind = ''I'' ';
    v_sql4 := v_sql4||'                        AND ( coal(E.MERCH_STAT,'' '') <> ''156'' and E.MERCH_STAT is not null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS JW120NETSUM_CM5, ';
    v_sql4 := v_sql4||'                  SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 4 AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                        AND E.TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''      ';
    v_sql4 := v_sql4||'                        AND BILL_AMT <= 3500 ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS DLSUM_CM5, ';
    v_sql4 := v_sql4||'                    SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 4 AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )  ';
    v_sql4 := v_sql4||'                        AND BILL_AMT <= 3500 ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS DLNETSUM_CM5, ';
    v_sql4 := v_sql4||'                                     COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 4 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||'                        ''7011'', ';
    v_sql4 := v_sql4||'                        ''7012'', ';
    v_sql4 := v_sql4||'                        ''5811'', ';
    v_sql4 := v_sql4||'                        ''5812'', ';
    v_sql4 := v_sql4||'                        ''5813'', ';
    v_sql4 := v_sql4||'                        ''5094'', ';
    v_sql4 := v_sql4||'                        ''5937'', ';
    v_sql4 := v_sql4||'                        ''5950'', ';
    v_sql4 := v_sql4||'                        ''5970'', ';
    v_sql4 := v_sql4||'                        ''5971'', ';
    v_sql4 := v_sql4||'                        ''7297'', ';
    v_sql4 := v_sql4||'                        ''7298'', ';
    v_sql4 := v_sql4||'                        ''7829'', ';
    v_sql4 := v_sql4||'                        ''7911'', ';
    v_sql4 := v_sql4||'                        ''7922'', ';
    v_sql4 := v_sql4||'                        ''7929'', ';
    v_sql4 := v_sql4||'                        ''7932'', ';
    v_sql4 := v_sql4||'                        ''7933'', ';
    v_sql4 := v_sql4||'                        ''7941'', ';
    v_sql4 := v_sql4||'                        ''7992'', ';
    v_sql4 := v_sql4||'                        ''7994'', ';
    v_sql4 := v_sql4||'                        ''7996'', ';
    v_sql4 := v_sql4||'                        ''7997'', ';
    v_sql4 := v_sql4||'                        ''7998'', ';
    v_sql4 := v_sql4||'                        ''7032'', ';
    v_sql4 := v_sql4||'                        ''7033'', ';
    v_sql4 := v_sql4||'                        ''5944'', ';
    v_sql4 := v_sql4||'                        ''5932'', ';
    v_sql4 := v_sql4||'                        ''7631'', ';
    v_sql4 := v_sql4||'                        ''7999'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''      ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                         AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC90COUNT_CM5, ';
    v_sql4 := v_sql4||'                                COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 4 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||'                        ''7011'', ';
    v_sql4 := v_sql4||'                        ''7012'', ';
    v_sql4 := v_sql4||'                        ''5811'', ';
    v_sql4 := v_sql4||'                        ''5812'', ';
    v_sql4 := v_sql4||'                        ''5813'', ';
    v_sql4 := v_sql4||'                        ''5094'', ';
    v_sql4 := v_sql4||'                        ''5937'', ';
    v_sql4 := v_sql4||'                        ''5950'', ';
    v_sql4 := v_sql4||'                        ''5970'', ';
    v_sql4 := v_sql4||'                        ''5971'', ';
    v_sql4 := v_sql4||'                        ''7297'', ';
    v_sql4 := v_sql4||'                        ''7298'', ';
    v_sql4 := v_sql4||'                        ''7829'', ';
    v_sql4 := v_sql4||'                        ''7911'', ';
    v_sql4 := v_sql4||'                        ''7922'', ';
    v_sql4 := v_sql4||'                        ''7929'', ';
    v_sql4 := v_sql4||'                        ''7932'', ';
    v_sql4 := v_sql4||'                        ''7933'', ';
    v_sql4 := v_sql4||'                        ''7941'', ';
    v_sql4 := v_sql4||'                        ''7992'', ';
    v_sql4 := v_sql4||'                        ''7994'', ';
    v_sql4 := v_sql4||'                        ''7996'', ';
    v_sql4 := v_sql4||'                        ''7997'', ';
    v_sql4 := v_sql4||'                        ''7998'', ';
    v_sql4 := v_sql4||'                        ''7032'', ';
    v_sql4 := v_sql4||'                        ''7033'', ';
    v_sql4 := v_sql4||'                        ''5944'', ';
    v_sql4 := v_sql4||'                        ''5932'', ';
    v_sql4 := v_sql4||'                        ''7631'', ';
    v_sql4 := v_sql4||'                        ''7999'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' ) ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                         AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC90NETCOUNT_CM5, ';
    v_sql4 := v_sql4||'                  COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 4 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''     ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                         AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC55COUNT_CM5, ';
    v_sql4 := v_sql4||'                    COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 4 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )   ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                          AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC55NETCOUNT_CM5, ';
    v_sql4 := v_sql4||'                 COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 4 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''    ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                          AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC26COUNT_CM5, ';
    v_sql4 := v_sql4||'                          COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 4 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )   ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                         AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC26NETCOUNT_CM5, ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                                   COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 4 AND ';
    v_sql4 := v_sql4||'                             TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND coal(E.Src_Ind,'' '') <> ''I'' ';
    v_sql4 := v_sql4||'                        AND ( coal(E.MERCH_STAT,'' '') <> ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS JW120COUNT_CM5, ';
    v_sql4 := v_sql4||'                          COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                       TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND E.Src_Ind = ''I'' ';
    v_sql4 := v_sql4||'                        AND ( coal(E.MERCH_STAT,'' '') <> ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS JW120NETCOUNT_CM5, ';
    v_sql4 := v_sql4||'                  COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 4 AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''       ';
    v_sql4 := v_sql4||'                        AND BILL_AMT <= 3500 ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS DLCOUNT_CM5, ';
    v_sql4 := v_sql4||'                    COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 4 AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )  ';
    v_sql4 := v_sql4||'                        AND BILL_AMT <= 3500 ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS DLNETCOUNT_CM5, ';
    v_sql4 := v_sql4||'                    MIN(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 4 AND ';
    v_sql4 := v_sql4||'                             TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                             AND coal(E.src_ind,'' '') <> ''I''     ';
    v_sql4 := v_sql4||'                        AND ( coal(E.MERCH_STAT,'' '') <> ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CEIL(date_diff(SYSDATE(), toDate(CREATE_DATE,''yyyy-mm-dd''))) ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         9999 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS JWRECENCY_CM5, ';
    v_sql4 := v_sql4||'                  COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 4 AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND BILL_AMT > 3500 ';
    v_sql4 := v_sql4||'                        AND coal(E.src_ind,'' '') <> ''I''       ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS DLCOUNT_2_CM5, ';
    v_sql4 := v_sql4||'                                      COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 4 AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )  ';
    v_sql4 := v_sql4||'                        AND BILL_AMT > 3500 ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS DLNETCOUNT_2_CM5, ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                   SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 5 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||'                        ''7011'', ';
    v_sql4 := v_sql4||'                        ''7012'', ';
    v_sql4 := v_sql4||'                        ''5811'', ';
    v_sql4 := v_sql4||'                        ''5812'', ';
    v_sql4 := v_sql4||'                        ''5813'', ';
    v_sql4 := v_sql4||'                        ''5094'', ';
    v_sql4 := v_sql4||'                        ''5937'', ';
    v_sql4 := v_sql4||'                        ''5950'', ';
    v_sql4 := v_sql4||'                        ''5970'', ';
    v_sql4 := v_sql4||'                        ''5971'', ';
    v_sql4 := v_sql4||'                        ''7297'', ';
    v_sql4 := v_sql4||'                        ''7298'', ';
    v_sql4 := v_sql4||'                        ''7829'', ';
    v_sql4 := v_sql4||'                        ''7911'', ';
    v_sql4 := v_sql4||'                        ''7922'', ';
    v_sql4 := v_sql4||'                        ''7929'', ';
    v_sql4 := v_sql4||'                        ''7932'', ';
    v_sql4 := v_sql4||'                        ''7933'', ';
    v_sql4 := v_sql4||'                        ''7941'', ';
    v_sql4 := v_sql4||'                        ''7992'', ';
    v_sql4 := v_sql4||'                        ''7994'', ';
    v_sql4 := v_sql4||'                        ''7996'', ';
    v_sql4 := v_sql4||'                        ''7997'', ';
    v_sql4 := v_sql4||'                        ''7998'', ';
    v_sql4 := v_sql4||'                        ''7032'', ';
    v_sql4 := v_sql4||'                        ''7033'', ';
    v_sql4 := v_sql4||'                        ''5944'', ';
    v_sql4 := v_sql4||'                        ''5932'', ';
    v_sql4 := v_sql4||'                        ''7631'', ';
    v_sql4 := v_sql4||'                        ''7999'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''      ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                         AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC90SUM_CM6, ';
    v_sql4 := v_sql4||'                                SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 5 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||'                        ''7011'', ';
    v_sql4 := v_sql4||'                        ''7012'', ';
    v_sql4 := v_sql4||'                        ''5811'', ';
    v_sql4 := v_sql4||'                        ''5812'', ';
    v_sql4 := v_sql4||'                        ''5813'', ';
    v_sql4 := v_sql4||'                        ''5094'', ';
    v_sql4 := v_sql4||'                        ''5937'', ';
    v_sql4 := v_sql4||'                        ''5950'', ';
    v_sql4 := v_sql4||'                        ''5970'', ';
    v_sql4 := v_sql4||'                        ''5971'', ';
    v_sql4 := v_sql4||'                        ''7297'', ';
    v_sql4 := v_sql4||'                        ''7298'', ';
    v_sql4 := v_sql4||'                        ''7829'', ';
    v_sql4 := v_sql4||'                        ''7911'', ';
    v_sql4 := v_sql4||'                        ''7922'', ';
    v_sql4 := v_sql4||'                        ''7929'', ';
    v_sql4 := v_sql4||'                        ''7932'', ';
    v_sql4 := v_sql4||'                        ''7933'', ';
    v_sql4 := v_sql4||'                        ''7941'', ';
    v_sql4 := v_sql4||'                        ''7992'', ';
    v_sql4 := v_sql4||'                        ''7994'', ';
    v_sql4 := v_sql4||'                        ''7996'', ';
    v_sql4 := v_sql4||'                        ''7997'', ';
    v_sql4 := v_sql4||'                        ''7998'', ';
    v_sql4 := v_sql4||'                        ''7032'', ';
    v_sql4 := v_sql4||'                        ''7033'', ';
    v_sql4 := v_sql4||'                        ''5944'', ';
    v_sql4 := v_sql4||'                        ''5932'', ';
    v_sql4 := v_sql4||'                        ''7631'', ';
    v_sql4 := v_sql4||'                        ''7999'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )   ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                         AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC90NETSUM_CM6, ';
    v_sql4 := v_sql4||'                  SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 5 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                         AND coal(E.src_ind,'' '') <> ''I''     ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC55SUM_CM6, ';
    v_sql4 := v_sql4||'                    SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 5 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )   ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                          AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC55NETSUM_CM6, ';
    v_sql4 := v_sql4||'                 SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 5 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''  ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                          AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC26SUM_CM6, ';
    v_sql4 := v_sql4||'                          SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 5 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )  ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                          AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC26NETSUM_CM6, ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                                   SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 5 AND ';
    v_sql4 := v_sql4||'                             TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND coal(E.Src_Ind,'' '') <> ''I'' ';
    v_sql4 := v_sql4||'                        AND ( coal(E.MERCH_STAT,'' '') <> ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS JW120SUM_CM6, ';
    v_sql4 := v_sql4||'                          SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                       TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND E.Src_Ind = ''I'' ';
    v_sql4 := v_sql4||'                        AND ( coal(E.MERCH_STAT,'' '') <> ''156'' and E.MERCH_STAT is not null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS JW120NETSUM_CM6, ';
    v_sql4 := v_sql4||'                  SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 5 AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030''))  ';
    v_sql4 := v_sql4||'                        AND E.TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''       ';
    v_sql4 := v_sql4||'                        AND BILL_AMT <= 3500 ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS DLSUM_CM6, ';
    v_sql4 := v_sql4||'                    SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 5 AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' ) ';
    v_sql4 := v_sql4||'                        AND BILL_AMT <= 3500 ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS DLNETSUM_CM6, ';
    v_sql4 := v_sql4||'                                     COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 5 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||'                        ''7011'', ';
    v_sql4 := v_sql4||'                        ''7012'', ';
    v_sql4 := v_sql4||'                        ''5811'', ';
    v_sql4 := v_sql4||'                        ''5812'', ';
    v_sql4 := v_sql4||'                        ''5813'', ';
    v_sql4 := v_sql4||'                        ''5094'', ';
    v_sql4 := v_sql4||'                        ''5937'', ';
    v_sql4 := v_sql4||'                        ''5950'', ';
    v_sql4 := v_sql4||'                        ''5970'', ';
    v_sql4 := v_sql4||'                        ''5971'', ';
    v_sql4 := v_sql4||'                        ''7297'', ';
    v_sql4 := v_sql4||'                        ''7298'', ';
    v_sql4 := v_sql4||'                        ''7829'', ';
    v_sql4 := v_sql4||'                        ''7911'', ';
    v_sql4 := v_sql4||'                        ''7922'', ';
    v_sql4 := v_sql4||'                        ''7929'', ';
    v_sql4 := v_sql4||'                        ''7932'', ';
    v_sql4 := v_sql4||'                        ''7933'', ';
    v_sql4 := v_sql4||'                        ''7941'', ';
    v_sql4 := v_sql4||'                        ''7992'', ';
    v_sql4 := v_sql4||'                        ''7994'', ';
    v_sql4 := v_sql4||'                        ''7996'', ';
    v_sql4 := v_sql4||'                        ''7997'', ';
    v_sql4 := v_sql4||'                        ''7998'', ';
    v_sql4 := v_sql4||'                        ''7032'', ';
    v_sql4 := v_sql4||'                        ''7033'', ';
    v_sql4 := v_sql4||'                        ''5944'', ';
    v_sql4 := v_sql4||'                        ''5932'', ';
    v_sql4 := v_sql4||'                        ''7631'', ';
    v_sql4 := v_sql4||'                        ''7999'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''   ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                          AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC90COUNT_CM6, ';
    v_sql4 := v_sql4||'                                COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 5 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||'                        ''7011'', ';
    v_sql4 := v_sql4||'                        ''7012'', ';
    v_sql4 := v_sql4||'                        ''5811'', ';
    v_sql4 := v_sql4||'                        ''5812'', ';
    v_sql4 := v_sql4||'                        ''5813'', ';
    v_sql4 := v_sql4||'                        ''5094'', ';
    v_sql4 := v_sql4||'                        ''5937'', ';
    v_sql4 := v_sql4||'                        ''5950'', ';
    v_sql4 := v_sql4||'                        ''5970'', ';
    v_sql4 := v_sql4||'                        ''5971'', ';
    v_sql4 := v_sql4||'                        ''7297'', ';
    v_sql4 := v_sql4||'                        ''7298'', ';
    v_sql4 := v_sql4||'                        ''7829'', ';
    v_sql4 := v_sql4||'                        ''7911'', ';
    v_sql4 := v_sql4||'                        ''7922'', ';
    v_sql4 := v_sql4||'                        ''7929'', ';
    v_sql4 := v_sql4||'                        ''7932'', ';
    v_sql4 := v_sql4||'                        ''7933'', ';
    v_sql4 := v_sql4||'                        ''7941'', ';
    v_sql4 := v_sql4||'                        ''7992'', ';
    v_sql4 := v_sql4||'                        ''7994'', ';
    v_sql4 := v_sql4||'                        ''7996'', ';
    v_sql4 := v_sql4||'                        ''7997'', ';
    v_sql4 := v_sql4||'                        ''7998'', ';
    v_sql4 := v_sql4||'                        ''7032'', ';
    v_sql4 := v_sql4||'                        ''7033'', ';
    v_sql4 := v_sql4||'                        ''5944'', ';
    v_sql4 := v_sql4||'                        ''5932'', ';
    v_sql4 := v_sql4||'                        ''7631'', ';
    v_sql4 := v_sql4||'                        ''7999'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )  ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                          AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC90NETCOUNT_CM6, ';
    v_sql4 := v_sql4||'                  COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 5 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''      ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                          AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC55COUNT_CM6, ';
    v_sql4 := v_sql4||'                    COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 5 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' ) ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                          AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC55NETCOUNT_CM6, ';
    v_sql4 := v_sql4||'                 COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 5 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''     ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                          AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC26COUNT_CM6, ';
    v_sql4 := v_sql4||'                          COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 5 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )  ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                         AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC26NETCOUNT_CM6, ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                                   COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 5 AND ';
    v_sql4 := v_sql4||'                             TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND coal(E.Src_Ind,'' '') <> ''I'' ';
    v_sql4 := v_sql4||'                        AND ( coal(E.MERCH_STAT,'' '') <> ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS JW120COUNT_CM6, ';
    v_sql4 := v_sql4||'                          COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                       TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND E.Src_Ind = ''I'' ';
    v_sql4 := v_sql4||'                        AND ( coal(E.MERCH_STAT,'' '') <> ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS JW120NETCOUNT_CM6, ';
    v_sql4 := v_sql4||'                  COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 5 AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''      ';
    v_sql4 := v_sql4||'                        AND BILL_AMT <= 3500 ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS DLCOUNT_CM6, ';
    v_sql4 := v_sql4||'                    COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 5 AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )  ';
    v_sql4 := v_sql4||'                        AND BILL_AMT <= 3500 ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS DLNETCOUNT_CM6, ';
    v_sql4 := v_sql4||'                    MIN(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 5 AND ';
    v_sql4 := v_sql4||'                             TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                             AND coal(E.src_ind,'' '') <> ''I''      ';
    v_sql4 := v_sql4||'                        AND ( coal(E.MERCH_STAT,'' '') <> ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CEIL(date_diff(SYSDATE(), toDate(CREATE_DATE,''yyyy-mm-dd''))) ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         9999 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS JWRECENCY_CM6, ';
    v_sql4 := v_sql4||'                  COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 5 AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND BILL_AMT > 3500 ';
    v_sql4 := v_sql4||'                        AND coal(E.src_ind,'' '') <> ''I''       ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS DLCOUNT_2_CM6, ';
    v_sql4 := v_sql4||'                                      COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 5 AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )   ';
    v_sql4 := v_sql4||'                        AND BILL_AMT > 3500 ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS DLNETCOUNT_2_CM6, ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                   SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR + 1 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||'                        ''7011'', ';
    v_sql4 := v_sql4||'                        ''7012'', ';
    v_sql4 := v_sql4||'                        ''5811'', ';
    v_sql4 := v_sql4||'                        ''5812'', ';
    v_sql4 := v_sql4||'                        ''5813'', ';
    v_sql4 := v_sql4||'                        ''5094'', ';
    v_sql4 := v_sql4||'                        ''5937'', ';
    v_sql4 := v_sql4||'                        ''5950'', ';
    v_sql4 := v_sql4||'                        ''5970'', ';
    v_sql4 := v_sql4||'                        ''5971'', ';
    v_sql4 := v_sql4||'                        ''7297'', ';
    v_sql4 := v_sql4||'                        ''7298'', ';
    v_sql4 := v_sql4||'                        ''7829'', ';
    v_sql4 := v_sql4||'                        ''7911'', ';
    v_sql4 := v_sql4||'                        ''7922'', ';
    v_sql4 := v_sql4||'                        ''7929'', ';
    v_sql4 := v_sql4||'                        ''7932'', ';
    v_sql4 := v_sql4||'                        ''7933'', ';
    v_sql4 := v_sql4||'                        ''7941'', ';
    v_sql4 := v_sql4||'                        ''7992'', ';
    v_sql4 := v_sql4||'                        ''7994'', ';
    v_sql4 := v_sql4||'                        ''7996'', ';
    v_sql4 := v_sql4||'                        ''7997'', ';
    v_sql4 := v_sql4||'                        ''7998'', ';
    v_sql4 := v_sql4||'                        ''7032'', ';
    v_sql4 := v_sql4||'                        ''7033'', ';
    v_sql4 := v_sql4||'                        ''5944'', ';
    v_sql4 := v_sql4||'                        ''5932'', ';
    v_sql4 := v_sql4||'                        ''7631'', ';
    v_sql4 := v_sql4||'                        ''7999'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''      ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                         AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC90SUM_CM0, ';
    v_sql4 := v_sql4||'                                SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR + 1 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||'                        ''7011'', ';
    v_sql4 := v_sql4||'                        ''7012'', ';
    v_sql4 := v_sql4||'                        ''5811'', ';
    v_sql4 := v_sql4||'                        ''5812'', ';
    v_sql4 := v_sql4||'                        ''5813'', ';
    v_sql4 := v_sql4||'                        ''5094'', ';
    v_sql4 := v_sql4||'                        ''5937'', ';
    v_sql4 := v_sql4||'                        ''5950'', ';
    v_sql4 := v_sql4||'                        ''5970'', ';
    v_sql4 := v_sql4||'                        ''5971'', ';
    v_sql4 := v_sql4||'                        ''7297'', ';
    v_sql4 := v_sql4||'                        ''7298'', ';
    v_sql4 := v_sql4||'                        ''7829'', ';
    v_sql4 := v_sql4||'                        ''7911'', ';
    v_sql4 := v_sql4||'                        ''7922'', ';
    v_sql4 := v_sql4||'                        ''7929'', ';
    v_sql4 := v_sql4||'                        ''7932'', ';
    v_sql4 := v_sql4||'                        ''7933'', ';
    v_sql4 := v_sql4||'                        ''7941'', ';
    v_sql4 := v_sql4||'                        ''7992'', ';
    v_sql4 := v_sql4||'                        ''7994'', ';
    v_sql4 := v_sql4||'                        ''7996'', ';
    v_sql4 := v_sql4||'                        ''7997'', ';
    v_sql4 := v_sql4||'                        ''7998'', ';
    v_sql4 := v_sql4||'                        ''7032'', ';
    v_sql4 := v_sql4||'                        ''7033'', ';
    v_sql4 := v_sql4||'                        ''5944'', ';
    v_sql4 := v_sql4||'                        ''5932'', ';
    v_sql4 := v_sql4||'                        ''7631'', ';
    v_sql4 := v_sql4||'                        ''7999'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )  ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                         AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC90NETSUM_CM0, ';
    v_sql4 := v_sql4||'                  SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR + 1 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                         AND coal(E.src_ind,'' '') <> ''I''      ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC55SUM_CM0, ';
    v_sql4 := v_sql4||'                    SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR + 1 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )  ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                         AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC55NETSUM_CM0, ';
    v_sql4 := v_sql4||'                 SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR + 1 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''      ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                         AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC26SUM_CM0, ';
    v_sql4 := v_sql4||'                          SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR + 1 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )   ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                         AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC26NETSUM_CM0, ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                                   SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR + 1 AND ';
    v_sql4 := v_sql4||'                             TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND coal(E.Src_Ind,'' '') <> ''I'' ';
    v_sql4 := v_sql4||'                        AND ( coal(E.MERCH_STAT,'' '') <> ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS JW120SUM_CM0, ';
    v_sql4 := v_sql4||'                          SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                       TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND E.Src_Ind = ''I'' ';
    v_sql4 := v_sql4||'                        AND ( coal(E.MERCH_STAT,'' '') <> ''156'' and E.MERCH_STAT is not null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS JW120NETSUM_CM0, ';
    v_sql4 := v_sql4||'                  SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR + 1 AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                        AND E.TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''      ';
    v_sql4 := v_sql4||'                        AND BILL_AMT <= 3500 ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS DLSUM_CM0, ';
    v_sql4 := v_sql4||'                    SUM(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR + 1 AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )  ';
    v_sql4 := v_sql4||'                        AND BILL_AMT <= 3500 ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CASE ';
    v_sql4 := v_sql4||'                            WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql4 := v_sql4||'                            ELSE E.BILL_AMT ';
    v_sql4 := v_sql4||'                         END ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         0 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS DLNETSUM_CM0, ';
    v_sql4 := v_sql4||'                                     COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR + 1 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||'                        ''7011'', ';
    v_sql4 := v_sql4||'                        ''7012'', ';
    v_sql4 := v_sql4||'                        ''5811'', ';
    v_sql4 := v_sql4||'                        ''5812'', ';
    v_sql4 := v_sql4||'                        ''5813'', ';
    v_sql4 := v_sql4||'                        ''5094'', ';
    v_sql4 := v_sql4||'                        ''5937'', ';
    v_sql4 := v_sql4||'                        ''5950'', ';
    v_sql4 := v_sql4||'                        ''5970'', ';
    v_sql4 := v_sql4||'                        ''5971'', ';
    v_sql4 := v_sql4||'                        ''7297'', ';
    v_sql4 := v_sql4||'                        ''7298'', ';
    v_sql4 := v_sql4||'                        ''7829'', ';
    v_sql4 := v_sql4||'                        ''7911'', ';
    v_sql4 := v_sql4||'                        ''7922'', ';
    v_sql4 := v_sql4||'                        ''7929'', ';
    v_sql4 := v_sql4||'                        ''7932'', ';
    v_sql4 := v_sql4||'                        ''7933'', ';
    v_sql4 := v_sql4||'                        ''7941'', ';
    v_sql4 := v_sql4||'                        ''7992'', ';
    v_sql4 := v_sql4||'                        ''7994'', ';
    v_sql4 := v_sql4||'                        ''7996'', ';
    v_sql4 := v_sql4||'                        ''7997'', ';
    v_sql4 := v_sql4||'                        ''7998'', ';
    v_sql4 := v_sql4||'                        ''7032'', ';
    v_sql4 := v_sql4||'                        ''7033'', ';
    v_sql4 := v_sql4||'                        ''5944'', ';
    v_sql4 := v_sql4||'                        ''5932'', ';
    v_sql4 := v_sql4||'                        ''7631'', ';
    v_sql4 := v_sql4||'                        ''7999'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''       ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                         AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC90COUNT_CM0, ';
    v_sql4 := v_sql4||'                                COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR + 1 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||'                        ''7011'', ';
    v_sql4 := v_sql4||'                        ''7012'', ';
    v_sql4 := v_sql4||'                        ''5811'', ';
    v_sql4 := v_sql4||'                        ''5812'', ';
    v_sql4 := v_sql4||'                        ''5813'', ';
    v_sql4 := v_sql4||'                        ''5094'', ';
    v_sql4 := v_sql4||'                        ''5937'', ';
    v_sql4 := v_sql4||'                        ''5950'', ';
    v_sql4 := v_sql4||'                        ''5970'', ';
    v_sql4 := v_sql4||'                        ''5971'', ';
    v_sql4 := v_sql4||'                        ''7297'', ';
    v_sql4 := v_sql4||'                        ''7298'', ';
    v_sql4 := v_sql4||'                        ''7829'', ';
    v_sql4 := v_sql4||'                        ''7911'', ';
    v_sql4 := v_sql4||'                        ''7922'', ';
    v_sql4 := v_sql4||'                        ''7929'', ';
    v_sql4 := v_sql4||'                        ''7932'', ';
    v_sql4 := v_sql4||'                        ''7933'', ';
    v_sql4 := v_sql4||'                        ''7941'', ';
    v_sql4 := v_sql4||'                        ''7992'', ';
    v_sql4 := v_sql4||'                        ''7994'', ';
    v_sql4 := v_sql4||'                        ''7996'', ';
    v_sql4 := v_sql4||'                        ''7997'', ';
    v_sql4 := v_sql4||'                        ''7998'', ';
    v_sql4 := v_sql4||'                        ''7032'', ';
    v_sql4 := v_sql4||'                        ''7033'', ';
    v_sql4 := v_sql4||'                        ''5944'', ';
    v_sql4 := v_sql4||'                        ''5932'', ';
    v_sql4 := v_sql4||'                        ''7631'', ';
    v_sql4 := v_sql4||'                        ''7999'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' ) ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                         AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC90NETCOUNT_CM0, ';
    v_sql4 := v_sql4||'                  COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR + 1 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''       ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                         AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC55COUNT_CM0, ';
    v_sql4 := v_sql4||'                    COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR + 1 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''742'', ';
    v_sql4 := v_sql4||' ''763'', ';
    v_sql4 := v_sql4||' ''780'', ';
    v_sql4 := v_sql4||' ''4011'', ';
    v_sql4 := v_sql4||' ''4119'', ';
    v_sql4 := v_sql4||' ''4214'', ';
    v_sql4 := v_sql4||' ''4215'', ';
    v_sql4 := v_sql4||' ''4225'', ';
    v_sql4 := v_sql4||' ''4411'', ';
    v_sql4 := v_sql4||' ''4457'', ';
    v_sql4 := v_sql4||' ''4468'', ';
    v_sql4 := v_sql4||' ''4582'', ';
    v_sql4 := v_sql4||' ''4722'', ';
    v_sql4 := v_sql4||' ''4733'', ';
    v_sql4 := v_sql4||' ''4789'', ';
    v_sql4 := v_sql4||' ''4812'', ';
    v_sql4 := v_sql4||' ''4816'', ';
    v_sql4 := v_sql4||' ''4821'', ';
    v_sql4 := v_sql4||' ''5211'', ';
    v_sql4 := v_sql4||' ''5231'', ';
    v_sql4 := v_sql4||' ''5251'', ';
    v_sql4 := v_sql4||' ''5261'', ';
    v_sql4 := v_sql4||' ''5309'', ';
    v_sql4 := v_sql4||' ''5310'', ';
    v_sql4 := v_sql4||' ''5311'', ';
    v_sql4 := v_sql4||' ''5331'', ';
    v_sql4 := v_sql4||' ''5399'', ';
    v_sql4 := v_sql4||' ''5422'', ';
    v_sql4 := v_sql4||' ''5441'', ';
    v_sql4 := v_sql4||' ''5451'', ';
    v_sql4 := v_sql4||' ''5462'', ';
    v_sql4 := v_sql4||' ''5499'', ';
    v_sql4 := v_sql4||' ''5532'', ';
    v_sql4 := v_sql4||' ''5533'', ';
    v_sql4 := v_sql4||' ''5611'', ';
    v_sql4 := v_sql4||' ''5621'', ';
    v_sql4 := v_sql4||' ''5631'', ';
    v_sql4 := v_sql4||' ''5641'', ';
    v_sql4 := v_sql4||' ''5651'', ';
    v_sql4 := v_sql4||' ''5655'', ';
    v_sql4 := v_sql4||' ''5661'', ';
    v_sql4 := v_sql4||' ''5681'', ';
    v_sql4 := v_sql4||' ''5691'', ';
    v_sql4 := v_sql4||' ''5697'', ';
    v_sql4 := v_sql4||' ''5698'', ';
    v_sql4 := v_sql4||' ''5699'', ';
    v_sql4 := v_sql4||' ''5712'', ';
    v_sql4 := v_sql4||' ''5713'', ';
    v_sql4 := v_sql4||' ''5714'', ';
    v_sql4 := v_sql4||' ''5718'', ';
    v_sql4 := v_sql4||' ''5719'', ';
    v_sql4 := v_sql4||' ''5732'', ';
    v_sql4 := v_sql4||' ''5733'', ';
    v_sql4 := v_sql4||' ''5734'', ';
    v_sql4 := v_sql4||' ''5735'', ';
    v_sql4 := v_sql4||' ''5814'', ';
    v_sql4 := v_sql4||' ''5912'', ';
    v_sql4 := v_sql4||' ''5921'', ';
    v_sql4 := v_sql4||' ''5931'', ';
    v_sql4 := v_sql4||' ''5935'', ';
    v_sql4 := v_sql4||' ''5940'', ';
    v_sql4 := v_sql4||' ''5941'', ';
    v_sql4 := v_sql4||' ''5942'', ';
    v_sql4 := v_sql4||' ''5943'', ';
    v_sql4 := v_sql4||' ''5945'', ';
    v_sql4 := v_sql4||' ''5946'', ';
    v_sql4 := v_sql4||' ''5947'', ';
    v_sql4 := v_sql4||' ''5948'', ';
    v_sql4 := v_sql4||' ''5949'', ';
    v_sql4 := v_sql4||' ''5962'', ';
    v_sql4 := v_sql4||' ''5963'', ';
    v_sql4 := v_sql4||' ''5964'', ';
    v_sql4 := v_sql4||' ''5965'', ';
    v_sql4 := v_sql4||' ''5966'', ';
    v_sql4 := v_sql4||' ''5967'', ';
    v_sql4 := v_sql4||' ''5968'', ';
    v_sql4 := v_sql4||' ''5969'', ';
    v_sql4 := v_sql4||' ''5972'', ';
    v_sql4 := v_sql4||' ''5973'', ';
    v_sql4 := v_sql4||' ''5975'', ';
    v_sql4 := v_sql4||' ''5976'', ';
    v_sql4 := v_sql4||' ''5977'', ';
    v_sql4 := v_sql4||' ''5978'', ';
    v_sql4 := v_sql4||' ''5983'', ';
    v_sql4 := v_sql4||' ''5992'', ';
    v_sql4 := v_sql4||' ''5993'', ';
    v_sql4 := v_sql4||' ''5995'', ';
    v_sql4 := v_sql4||' ''5996'', ';
    v_sql4 := v_sql4||' ''5997'', ';
    v_sql4 := v_sql4||' ''5999'', ';
    v_sql4 := v_sql4||' ''6010'', ';
    v_sql4 := v_sql4||' ''6011'', ';
    v_sql4 := v_sql4||' ''6012'', ';
    v_sql4 := v_sql4||' ''6051'', ';
    v_sql4 := v_sql4||' ''6211'', ';
    v_sql4 := v_sql4||' ''6513'', ';
    v_sql4 := v_sql4||' ''7210'', ';
    v_sql4 := v_sql4||' ''7211'', ';
    v_sql4 := v_sql4||' ''7216'', ';
    v_sql4 := v_sql4||' ''7217'', ';
    v_sql4 := v_sql4||' ''7221'', ';
    v_sql4 := v_sql4||' ''7230'', ';
    v_sql4 := v_sql4||' ''7251'', ';
    v_sql4 := v_sql4||' ''7261'', ';
    v_sql4 := v_sql4||' ''7273'', ';
    v_sql4 := v_sql4||' ''7276'', ';
    v_sql4 := v_sql4||' ''7277'', ';
    v_sql4 := v_sql4||' ''7278'', ';
    v_sql4 := v_sql4||' ''7295'', ';
    v_sql4 := v_sql4||' ''7296'', ';
    v_sql4 := v_sql4||' ''7299'', ';
    v_sql4 := v_sql4||' ''7311'', ';
    v_sql4 := v_sql4||' ''7321'', ';
    v_sql4 := v_sql4||' ''7333'', ';
    v_sql4 := v_sql4||' ''7338'', ';
    v_sql4 := v_sql4||' ''7339'', ';
    v_sql4 := v_sql4||' ''7342'', ';
    v_sql4 := v_sql4||' ''7349'', ';
    v_sql4 := v_sql4||' ''7361'', ';
    v_sql4 := v_sql4||' ''7372'', ';
    v_sql4 := v_sql4||' ''7375'', ';
    v_sql4 := v_sql4||' ''7379'', ';
    v_sql4 := v_sql4||' ''7392'', ';
    v_sql4 := v_sql4||' ''7393'', ';
    v_sql4 := v_sql4||' ''7394'', ';
    v_sql4 := v_sql4||' ''7395'', ';
    v_sql4 := v_sql4||' ''7399'', ';
    v_sql4 := v_sql4||' ''7512'', ';
    v_sql4 := v_sql4||' ''7513'', ';
    v_sql4 := v_sql4||' ''7519'', ';
    v_sql4 := v_sql4||' ''7531'', ';
    v_sql4 := v_sql4||' ''7534'', ';
    v_sql4 := v_sql4||' ''7535'', ';
    v_sql4 := v_sql4||' ''7538'', ';
    v_sql4 := v_sql4||' ''7542'', ';
    v_sql4 := v_sql4||' ''7549'', ';
    v_sql4 := v_sql4||' ''7622'', ';
    v_sql4 := v_sql4||' ''7623'', ';
    v_sql4 := v_sql4||' ''7629'', ';
    v_sql4 := v_sql4||' ''7641'', ';
    v_sql4 := v_sql4||' ''7692'', ';
    v_sql4 := v_sql4||' ''7699'', ';
    v_sql4 := v_sql4||' ''7832'', ';
    v_sql4 := v_sql4||' ''7841'', ';
    v_sql4 := v_sql4||' ''7991'', ';
    v_sql4 := v_sql4||' ''7993'', ';
    v_sql4 := v_sql4||' ''7995'', ';
    v_sql4 := v_sql4||' ''8011'', ';
    v_sql4 := v_sql4||' ''8021'', ';
    v_sql4 := v_sql4||' ''8031'', ';
    v_sql4 := v_sql4||' ''8041'', ';
    v_sql4 := v_sql4||' ''8042'', ';
    v_sql4 := v_sql4||' ''8043'', ';
    v_sql4 := v_sql4||' ''8049'', ';
    v_sql4 := v_sql4||' ''8050'', ';
    v_sql4 := v_sql4||' ''8071'', ';
    v_sql4 := v_sql4||' ''8099'', ';
    v_sql4 := v_sql4||' ''8111'', ';
    v_sql4 := v_sql4||' ''8241'', ';
    v_sql4 := v_sql4||' ''8244'', ';
    v_sql4 := v_sql4||' ''8249'', ';
    v_sql4 := v_sql4||' ''8299'', ';
    v_sql4 := v_sql4||' ''8351'', ';
    v_sql4 := v_sql4||' ''8641'', ';
    v_sql4 := v_sql4||' ''8661'', ';
    v_sql4 := v_sql4||' ''8675'', ';
    v_sql4 := v_sql4||' ''8699'', ';
    v_sql4 := v_sql4||' ''8911'', ';
    v_sql4 := v_sql4||' ''8912'', ';
    v_sql4 := v_sql4||' ''8931'', ';
    v_sql4 := v_sql4||' ''8999'', ';
    v_sql4 := v_sql4||' ''1001'', ';
    v_sql4 := v_sql4||' ''6013'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )   ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                          AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC55NETCOUNT_CM0, ';
    v_sql4 := v_sql4||'                 COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR + 1 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''      ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                          AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC26COUNT_CM0, ';
    v_sql4 := v_sql4||'                          COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR + 1 AND ';
    v_sql4 := v_sql4||'                        mer_cat_cd in ';
    v_sql4 := v_sql4||'                        ( ';
    v_sql4 := v_sql4||' ''5541'', ';
    v_sql4 := v_sql4||' ''5542'', ';
    v_sql4 := v_sql4||' ''5411'', ';
    v_sql4 := v_sql4||' ''5722'', ';
    v_sql4 := v_sql4||' ''4511'', ';
    v_sql4 := v_sql4||' ''4111'', ';
    v_sql4 := v_sql4||' ''4121'', ';
    v_sql4 := v_sql4||' ''4131'', ';
    v_sql4 := v_sql4||' ''4784'', ';
    v_sql4 := v_sql4||' ''3998'', ';
    v_sql4 := v_sql4||' ''4112'', ';
    v_sql4 := v_sql4||' ''4900'', ';
    v_sql4 := v_sql4||' ''4814'', ';
    v_sql4 := v_sql4||' ''4899'', ';
    v_sql4 := v_sql4||' ''6300'', ';
    v_sql4 := v_sql4||' ''5960'', ';
    v_sql4 := v_sql4||' ''8651'', ';
    v_sql4 := v_sql4||' ''9211'', ';
    v_sql4 := v_sql4||' ''9222'', ';
    v_sql4 := v_sql4||' ''9223'', ';
    v_sql4 := v_sql4||' ''9311'', ';
    v_sql4 := v_sql4||' ''9399'', ';
    v_sql4 := v_sql4||' ''9400'', ';
    v_sql4 := v_sql4||' ''5994'', ';
    v_sql4 := v_sql4||' ''7523'', ';
    v_sql4 := v_sql4||' ''9402'' ';
    v_sql4 := v_sql4||'                        ) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )   ';
    v_sql4 := v_sql4||'                        AND substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'') ';
    v_sql4 := v_sql4||'                         AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS MCC26NETCOUNT_CM0, ';
    v_sql4 := v_sql4||'  ';
    v_sql4 := v_sql4||'                                   COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR + 1 AND ';
    v_sql4 := v_sql4||'                             TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND coal(E.Src_Ind,'' '') <> ''I'' ';
    v_sql4 := v_sql4||'                        AND ( coal(E.MERCH_STAT,'' '') <> ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS JW120COUNT_CM0, ';
    v_sql4 := v_sql4||'                          COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                       TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND E.Src_Ind = ''I'' ';
    v_sql4 := v_sql4||'                        AND ( coal(E.MERCH_STAT,'' '') <> ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS JW120NETCOUNT_CM0, ';
    v_sql4 := v_sql4||'                  COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR + 1 AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND coal(E.src_ind,'' '') <> ''I''      ';
    v_sql4 := v_sql4||'                        AND BILL_AMT <= 3500 ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS DLCOUNT_CM0, ';
    v_sql4 := v_sql4||'                    COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR + 1 AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )  ';
    v_sql4 := v_sql4||'                        AND BILL_AMT <= 3500 ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS DLNETCOUNT_CM0, ';
    v_sql4 := v_sql4||'                    MIN(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR + 1 AND ';
    v_sql4 := v_sql4||'                             TRANS_TYPE IN (''1184'',''1201'') ';
    v_sql4 := v_sql4||'                             AND coal(E.src_ind,'' '') <> ''I''    ';
    v_sql4 := v_sql4||'                        AND ( coal(E.MERCH_STAT,'' '') <> ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         CEIL(date_diff(SYSDATE(), toDate(CREATE_DATE,''yyyy-mm-dd''))) ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         9999 ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS JWRECENCY_CM0, ';
    v_sql4 := v_sql4||'                  COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR + 1 AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE NOT IN (''1016'',''1022'',''1030'',''1060'',''1050'',''1051'',''1184'',''1201'') ';
    v_sql4 := v_sql4||'                        AND TRANS_TYPE != '' '' AND BILL_AMT > 3500 ';
    v_sql4 := v_sql4||'                        AND coal(E.src_ind,'' '') <> ''I''       ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS DLCOUNT_2_CM0, ';
    v_sql4 := v_sql4||'                                      COUNT(CASE ';
    v_sql4 := v_sql4||'                        WHEN ';
    v_sql4 := v_sql4||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR + 1 AND ';
    v_sql4 := v_sql4||'                           (E.MER_CAT_CD IN (''1520'', ';
    v_sql4 := v_sql4||'                                            ''7013'', ';
    v_sql4 := v_sql4||'                                            ''5271'', ';
    v_sql4 := v_sql4||'                                            ''5511'', ';
    v_sql4 := v_sql4||'                                            ''5521'', ';
    v_sql4 := v_sql4||'                                            ''5551'', ';
    v_sql4 := v_sql4||'                                            ''5561'', ';
    v_sql4 := v_sql4||'                                            ''5571'', ';
    v_sql4 := v_sql4||'                                            ''5592'', ';
    v_sql4 := v_sql4||'                                            ''5598'', ';
    v_sql4 := v_sql4||'                                            ''5599'', ';
    v_sql4 := v_sql4||'                                            ''5933'', ';
    v_sql4 := v_sql4||'                                            ''8062'', ';
    v_sql4 := v_sql4||'                                            ''8211'', ';
    v_sql4 := v_sql4||'                                            ''8220'', ';
    v_sql4 := v_sql4||'                                            ''8398'', ';
    v_sql4 := v_sql4||'                                            ''5021'', ';
    v_sql4 := v_sql4||'                                            ''5039'', ';
    v_sql4 := v_sql4||'                                            ''5044'', ';
    v_sql4 := v_sql4||'                                            ''5045'', ';
    v_sql4 := v_sql4||'                                            ''5046'', ';
    v_sql4 := v_sql4||'                                            ''5047'', ';
    v_sql4 := v_sql4||'                                            ''5051'', ';
    v_sql4 := v_sql4||'                                            ''5065'', ';
    v_sql4 := v_sql4||'                                            ''5072'', ';
    v_sql4 := v_sql4||'                                            ''5074'', ';
    v_sql4 := v_sql4||'                                            ''5111'', ';
    v_sql4 := v_sql4||'                                            ''5122'', ';
    v_sql4 := v_sql4||'                                            ''5131'', ';
    v_sql4 := v_sql4||'                                            ''5137'', ';
    v_sql4 := v_sql4||'                                            ''5139'', ';
    v_sql4 := v_sql4||'                                            ''5172'', ';
    v_sql4 := v_sql4||'                                            ''5192'', ';
    v_sql4 := v_sql4||'                                            ''5193'', ';
    v_sql4 := v_sql4||'                                            ''5198'', ';
    v_sql4 := v_sql4||'                                            ''5998'', ';
    v_sql4 := v_sql4||'                                            ''5013'', ';
    v_sql4 := v_sql4||'                                            ''5398'', ';
    v_sql4 := v_sql4||'                                            ''4458'', ';
    v_sql4 := v_sql4||'                                            ''9498'', ';
    v_sql4 := v_sql4||'                                            ''9703'', ';
    v_sql4 := v_sql4||'                                            ''9704'', ';
    v_sql4 := v_sql4||'                                            ''9705'', ';
    v_sql4 := v_sql4||'                                            ''9706'', ';
    v_sql4 := v_sql4||'                                            ''9707'', ';
    v_sql4 := v_sql4||'                                            ''9708'', ';
    v_sql4 := v_sql4||'                                            ''5200'', ';
    v_sql4 := v_sql4||'                                            ''5300'') ';
    v_sql4 := v_sql4||'                                            OR substr(E.merch_seq,-4,3) in (''041'',''011'',''030'')) ';
    v_sql4 := v_sql4||'                        AND ( TRANS_TYPE IN (''1016'',''1022'') ';
    v_sql4 := v_sql4||'                        OR E.src_ind = ''I'' )   ';
    v_sql4 := v_sql4||'                        AND BILL_AMT > 3500 ';
    v_sql4 := v_sql4||'                        AND ( E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null ) ';
    v_sql4 := v_sql4||'                        THEN ';
    v_sql4 := v_sql4||'                         1 ';
    v_sql4 := v_sql4||'                      ELSE ';
    v_sql4 := v_sql4||'                         NULL ';
    v_sql4 := v_sql4||'                      END ';
    v_sql4 := v_sql4||'                   ) AS DLNETCOUNT_2_CM0 ';
    v_sql4 := v_sql4||'           FROM FDM_S24_EVENT E, TEMP_ACCT_CDATE A ';
    v_sql4 := v_sql4||'          WHERE     E.trans_type BETWEEN 1000 AND 1999 ';
    v_sql4 := v_sql4||'                AND E.trans_type NOT IN (''1050'', ''1051'') ';
    v_sql4 := v_sql4||'                AND TRANS_TYPE != '' '' AND E.MONTH_NBR <= A.CLOSE_CYCLE_NBR + 1 ';
    v_sql4 := v_sql4||'                AND E.MONTH_NBR >= A.CLOSE_CYCLE_NBR -5 ';
    v_sql4 := v_sql4||'                AND (coal(E.rev_ind,'' '') <> ''1'' or (E.rev_ind + 0) is null) ';
    v_sql4 := v_sql4||'                AND E.acctnbr = A.xaccount ';
    v_sql4 := v_sql4||'       GROUP BY E.ACCTNBR ';

       DBMS_OUTPUT.PUT_LINE('temp_event_pur_6m after:==========' || v_sql4);

       execute immediate v_sql4;

       DBMS_OUTPUT.PUT_LINE('temp_event_pur_6m over:==========success!');

         --删除变动的数据
       EXECUTE IMMEDIATE ('truncate table  temp_event_pur_merchant_1');

       DBMS_OUTPUT.PUT_LINE('temp_event_pur_merchant_1 before:=========' || v_sql5);

    v_sql5 := ' INSERT INTO temp_event_pur_merchant_1 ';
    v_sql5 := v_sql5||' select t.ACCTNBR,MAX(t.AMT+0),COUNT(t.AMT),SUM(t.AMT) from ( ';
    v_sql5 := v_sql5||'     select E.ACCTNBR as ACCTNBR, E.MERCHANT,SUM(   CASE ';
    v_sql5 := v_sql5||'                                   WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql5 := v_sql5||'                                     ELSE E.BILL_AMT ';
    v_sql5 := v_sql5||'                         END) as AMT ';
    v_sql5 := v_sql5||'               from FDM_S24_EVENT E inner join TEMP_ACCT_CDATE A ';
    v_sql5 := v_sql5||'               on (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR AND E.acctnbr = A.xaccount left join ';
    v_sql5 := v_sql5||' (select C.code_value,C.bank_id from ccam_codes C,tbl_banks B  where B.bankid = C.bank_id and C.code_type = ''WSSH'') ta ';	
    v_sql5 := v_sql5||'               on E.MERCHANT = ta.code_value ';
    v_sql5 := v_sql5||'     WHERE  E.trans_type BETWEEN 1000 AND 1999 ';
    v_sql5 := v_sql5||'            AND E.trans_type NOT IN (''1050'', ''1051'') ';
    v_sql5 := v_sql5||'            AND (E.trans_type + 0) is not null ';
    v_sql5 := v_sql5||'            AND (coal(E.rev_ind,'' '') <> ''1'' or (E.rev_ind + 0) is null) ';
    v_sql5 := v_sql5||'            AND ta.bank_id is null AND LENGTH(E.MERCHANT) != 0';
    v_sql5 := v_sql5||'     GROUP BY E.ACCTNBR,E.MERCHANT ';
    v_sql5 := v_sql5||'  ) t GROUP BY t.ACCTNBR ';

        DBMS_OUTPUT.PUT_LINE('temp_event_pur_merchant_1 after:==========' || v_sql5);

        execute immediate v_sql5;

        DBMS_OUTPUT.PUT_LINE('temp_event_pur_merchant_1 over:==========success!');

    ----2期商户交易统计
      EXECUTE IMMEDIATE ('truncate table  temp_event_pur_merchant_2');
      DBMS_OUTPUT.PUT_LINE('temp_event_pur_merchant_2 before:=========' || v_sql6);

    v_sql6 := ' INSERT INTO temp_event_pur_merchant_2 ';
    v_sql6 := v_sql6||' select t.ACCTNBR,MAX(t.AMT+0),COUNT(t.AMT),SUM(t.AMT) from ( ';
    v_sql6 := v_sql6||'     select E.ACCTNBR as ACCTNBR, E.MERCHANT,SUM(   CASE ';
    v_sql6 := v_sql6||'                                   WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql6 := v_sql6||'                                     ELSE E.BILL_AMT ';
    v_sql6 := v_sql6||'                         END) as AMT ';
    v_sql6 := v_sql6||'               from FDM_S24_EVENT E inner join TEMP_ACCT_CDATE A ';
    v_sql6 := v_sql6||'               on (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 1 AND E.acctnbr = A.xaccount left join ';
    v_sql6 := v_sql6||' (select C.code_value,C.bank_id from ccam_codes C,tbl_banks B  where B.bankid = C.bank_id and  C.code_type = ''WSSH'') ta ';
    v_sql6 := v_sql6||'               on E.MERCHANT = ta.code_value ';
    v_sql6 := v_sql6||'     WHERE  E.trans_type BETWEEN 1000 AND 1999 ';
    v_sql6 := v_sql6||'            AND E.trans_type NOT IN (''1050'', ''1051'') ';
    v_sql6 := v_sql6||'            AND (E.trans_type + 0) is not null';
    v_sql6 := v_sql6||'            AND (coal(E.rev_ind,'' '') <> ''1'' or (E.rev_ind + 0) is null) ';
    v_sql6 := v_sql6||'            AND ta.bank_id is null AND LENGTH(E.MERCHANT) != 0';
    v_sql6 := v_sql6||'     GROUP BY E.ACCTNBR,E.MERCHANT ';
    v_sql6 := v_sql6||' ) t GROUP BY t.ACCTNBR ';

        DBMS_OUTPUT.PUT_LINE('temp_event_pur_merchant_2 after:==========' || v_sql6);

        execute immediate v_sql6;

        DBMS_OUTPUT.PUT_LINE('temp_event_pur_merchant_2 over:==========success!');

    ----3期商户交易统计
      EXECUTE IMMEDIATE ('truncate table  temp_event_pur_merchant_3');

      DBMS_OUTPUT.PUT_LINE('temp_event_pur_merchant_3 before:=========' || v_sql7);

    v_sql7 := ' INSERT INTO temp_event_pur_merchant_3 ';
    v_sql7 := v_sql7||' select t.ACCTNBR,MAX(t.AMT+0),COUNT(t.AMT),SUM(t.AMT) from ( ';
    v_sql7 := v_sql7||'     select E.ACCTNBR as ACCTNBR, E.MERCHANT,SUM(   CASE ';
    v_sql7 := v_sql7||'                                   WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql7 := v_sql7||'                                     ELSE E.BILL_AMT ';
    v_sql7 := v_sql7||'                         END) as AMT ';
    v_sql7 := v_sql7||'               from FDM_S24_EVENT E inner join TEMP_ACCT_CDATE A ';
    v_sql7 := v_sql7||'               on (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 2 and E.acctnbr = A.xaccount left join ';
    v_sql7 := v_sql7||' (select C.code_value,C.bank_id from ccam_codes C,tbl_banks B  where B.bankid = C.bank_id and  C.code_type = ''WSSH'') ta ';
    v_sql7 := v_sql7||'               on E.MERCHANT = ta.code_value ';
    v_sql7 := v_sql7||'     WHERE  E.trans_type BETWEEN 1000 AND 1999 ';
    v_sql7 := v_sql7||'            AND E.trans_type NOT IN (''1050'', ''1051'') ';
    v_sql7 := v_sql7||'            AND (E.trans_type + 0) is not null';
    v_sql7 := v_sql7||'            AND (coal(E.rev_ind,'' '') <> ''1'' or (E.rev_ind + 0) is null) ';
    v_sql7 := v_sql7||'            AND ta.bank_id is null AND LENGTH(E.MERCHANT) != 0';
    v_sql7 := v_sql7||'     GROUP BY E.ACCTNBR,E.MERCHANT ';
    v_sql7 := v_sql7||' ) t GROUP BY t.ACCTNBR ';

        DBMS_OUTPUT.PUT_LINE('temp_event_pur_merchant_3 after:==========' || v_sql7);

        execute immediate v_sql7;

        DBMS_OUTPUT.PUT_LINE('temp_event_pur_merchant_3 over:==========success!');

    ----第4期商户交易统计
      EXECUTE IMMEDIATE ('truncate table  temp_event_pur_merchant_4');
      DBMS_OUTPUT.PUT_LINE('temp_event_pur_merchant_4 before:=========' || v_sql8);

    v_sql8 := ' INSERT INTO temp_event_pur_merchant_4 ';
    v_sql8 := v_sql8||' select t.ACCTNBR,MAX(t.AMT+0),COUNT(t.AMT),SUM(t.AMT) from ( ';
    v_sql8 := v_sql8||'     select E.ACCTNBR as ACCTNBR, E.MERCHANT,SUM(   CASE ';
    v_sql8 := v_sql8||'                                   WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql8 := v_sql8||'                                     ELSE E.BILL_AMT ';
    v_sql8 := v_sql8||'                         END) as AMT ';
    v_sql8 := v_sql8||'               from FDM_S24_EVENT E inner join TEMP_ACCT_CDATE A ';
    v_sql8 := v_sql8||'               on (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 3 and E.acctnbr = A.xaccount left join ';
    v_sql8 := v_sql8||' (select C.code_value,C.bank_id from ccam_codes C,tbl_banks B  where B.bankid = C.bank_id and  C.code_type = ''WSSH'') ta ';
    v_sql8 := v_sql8||'               on E.MERCHANT = ta.code_value ';
    v_sql8 := v_sql8||'     WHERE  E.trans_type BETWEEN 1000 AND 1999 ';
    v_sql8 := v_sql8||'            AND E.trans_type NOT IN (''1050'', ''1051'') ';
    v_sql8 := v_sql8||'            AND (E.trans_type + 0) is not null';
    v_sql8 := v_sql8||'            AND (coal(E.rev_ind,'' '') <> ''1'' or (E.rev_ind + 0) is null) ';
    v_sql8 := v_sql8||'            AND ta.bank_id is null AND LENGTH(E.MERCHANT) != 0';
    v_sql8 := v_sql8||'     GROUP BY E.ACCTNBR,E.MERCHANT ';
    v_sql8 := v_sql8||' ) t GROUP BY t.ACCTNBR ';

        DBMS_OUTPUT.PUT_LINE('temp_event_pur_merchant_4 after:==========' || v_sql8);

        execute immediate v_sql8;

        DBMS_OUTPUT.PUT_LINE('temp_event_pur_merchant_4 over:==========success!');

    ----第5期商户交易统计
      EXECUTE IMMEDIATE ('truncate table  temp_event_pur_merchant_5');
      DBMS_OUTPUT.PUT_LINE('temp_event_pur_merchant_5 before:=========' || v_sql9);

    v_sql9 := ' INSERT INTO temp_event_pur_merchant_5 ';
    v_sql9 := v_sql9||' select t.ACCTNBR,MAX(t.AMT+0),COUNT(t.AMT),SUM(t.AMT) from ( ';
    v_sql9 := v_sql9||'     select E.ACCTNBR as ACCTNBR, E.MERCHANT,SUM(   CASE ';
    v_sql9 := v_sql9||'                                   WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql9 := v_sql9||'                                     ELSE E.BILL_AMT ';
    v_sql9 := v_sql9||'                         END) as AMT ';
    v_sql9 := v_sql9||'               from FDM_S24_EVENT E inner join TEMP_ACCT_CDATE A ';
    v_sql9 := v_sql9||'               on (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 4 and E.acctnbr = A.xaccount left join ';
    v_sql9 := v_sql9||' (select C.code_value,C.bank_id from ccam_codes C,tbl_banks B  where B.bankid = C.bank_id and  C.code_type = ''WSSH'') ta ';	
    v_sql9 := v_sql9||'               on E.MERCHANT = ta.code_value ';
    v_sql9 := v_sql9||'     WHERE  E.trans_type BETWEEN 1000 AND 1999 ';
    v_sql9 := v_sql9||'            AND E.trans_type NOT IN (''1050'', ''1051'') ';
    v_sql9 := v_sql9||'            AND (E.trans_type + 0) is not null';
    v_sql9 := v_sql9||'            AND (coal(E.rev_ind,'' '') <> ''1'' or (E.rev_ind + 0) is null) ';
    v_sql9 := v_sql9||'        AND ta.bank_id is null AND LENGTH(E.MERCHANT) != 0';
    v_sql9 := v_sql9||'     GROUP BY E.ACCTNBR,E.MERCHANT ';
    v_sql9 := v_sql9||' ) t GROUP BY t.ACCTNBR ';

        DBMS_OUTPUT.PUT_LINE('temp_event_pur_merchant_5 after:==========' || v_sql9);

        execute immediate v_sql9;

        DBMS_OUTPUT.PUT_LINE('temp_event_pur_merchant_5 over:==========success!');

    ----第6期商户交易统计
      EXECUTE IMMEDIATE ('truncate table  temp_event_pur_merchant_6');
      DBMS_OUTPUT.PUT_LINE('temp_event_pur_merchant_6 before:=========' || v_sql10);

    v_sql10 := ' INSERT INTO temp_event_pur_merchant_6 ';
    v_sql10 := v_sql10||' select t.ACCTNBR,MAX(t.AMT+0),COUNT(t.AMT),SUM(t.AMT) from ( ';
    v_sql10 := v_sql10||'     select E.ACCTNBR as ACCTNBR, E.MERCHANT,SUM(   CASE ';
    v_sql10 := v_sql10||'                                   WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql10 := v_sql10||'                                     ELSE E.BILL_AMT ';
    v_sql10 := v_sql10||'                         END) as AMT ';
    v_sql10 := v_sql10||'               from FDM_S24_EVENT E inner join TEMP_ACCT_CDATE A ';
    v_sql10 := v_sql10||'               on (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 5 and E.acctnbr = A.xaccount left join ';
    v_sql10 := v_sql10||' (select C.code_value,C.bank_id from ccam_codes C,tbl_banks B  where B.bankid = C.bank_id and  C.code_type = ''WSSH'') ta ';
    v_sql10 := v_sql10||'               on E.MERCHANT = ta.code_value ';
    v_sql10 := v_sql10||'     WHERE     E.trans_type BETWEEN 1000 AND 1999 ';
    v_sql10 := v_sql10||'            AND E.trans_type NOT IN (''1050'', ''1051'') ';
    v_sql10 := v_sql10||'            AND (E.trans_type + 0) is not null';
    v_sql10 := v_sql10||'            AND (coal(E.rev_ind,'' '') <> ''1'' or (E.rev_ind + 0) is null) ';
    v_sql10 := v_sql10||'            AND ta.bank_id is null AND LENGTH(E.MERCHANT) != 0';
    v_sql10 := v_sql10||'     GROUP BY E.ACCTNBR,E.MERCHANT ';
    v_sql10 := v_sql10||' ) t GROUP BY t.ACCTNBR ';

        DBMS_OUTPUT.PUT_LINE('temp_event_pur_merchant_6 after:==========' || v_sql10);

        execute immediate v_sql10;

        DBMS_OUTPUT.PUT_LINE('temp_event_pur_merchant_6 over:==========success!');

    ----第0期商户交易统计
      EXECUTE IMMEDIATE ('truncate table  temp_event_pur_merchant_0');
      DBMS_OUTPUT.PUT_LINE('temp_event_pur_merchant_0 before:=========' || v_sql11);

    v_sql11 := ' INSERT INTO temp_event_pur_merchant_0 ';
    v_sql11 := v_sql11||' select t.ACCTNBR,MAX(t.AMT+0),COUNT(t.AMT),SUM(t.AMT) from ( ';
    v_sql11 := v_sql11||'     select E.ACCTNBR as ACCTNBR, E.MERCHANT,SUM(   CASE ';
    v_sql11 := v_sql11||'                                   WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql11 := v_sql11||'                                     ELSE E.BILL_AMT ';
    v_sql11 := v_sql11||'                         END) as AMT ';
    v_sql11 := v_sql11||'               from FDM_S24_EVENT E inner join TEMP_ACCT_CDATE A ';
    v_sql11 := v_sql11||'               on (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR + 1 and E.acctnbr = A.xaccount left join ';
    v_sql11 := v_sql11||' (select C.code_value,C.bank_id from ccam_codes C,tbl_banks B  where B.bankid = C.bank_id and  C.code_type = ''WSSH'') ta ';	
    v_sql11 := v_sql11||'               on E.MERCHANT = ta.code_value ';	
    v_sql11 := v_sql11||'     WHERE     E.trans_type BETWEEN 1000 AND 1999 ';
    v_sql11 := v_sql11||'            AND E.trans_type NOT IN (''1050'', ''1051'') ';
    v_sql11 := v_sql11||'            AND (E.trans_type + 0) is not null';
    v_sql11 := v_sql11||'            AND (coal(E.rev_ind,'' '') <> ''1'' or (E.rev_ind + 0) is null) ';
    v_sql11 := v_sql11||'            AND ta.bank_id is null AND LENGTH(E.MERCHANT) != 0';
    v_sql11 := v_sql11||'     GROUP BY E.ACCTNBR,E.MERCHANT ';
    v_sql11 := v_sql11||' ) t GROUP BY t.ACCTNBR ';

        DBMS_OUTPUT.PUT_LINE('temp_event_pur_merchant_0 after:==========' || v_sql11);

        execute immediate v_sql11;

        DBMS_OUTPUT.PUT_LINE('temp_event_pur_merchant_0 over:==========success!');

        DBMS_OUTPUT.PUT_LINE('temp_event_pur_merchant over:==========success!');

    	   --删除变动的数据
       EXECUTE IMMEDIATE ('truncate table  TEMP_EVENT_PUR_TOP3SUM_1');

       DBMS_OUTPUT.PUT_LINE('TEMP_EVENT_PUR_TOP3SUM_1 before:=========' || v_sql12);

    v_sql12 := ' insert into TEMP_EVENT_PUR_TOP3SUM_1 ';
    v_sql12 := v_sql12||' select acctnbr,	 SUM(BILL_AMT) as amt1 from ';
    v_sql12 := v_sql12||' ( ';
    v_sql12 := v_sql12||' select E.acctnbr, E.BILL_AMT , ROW_NUMBER() OVER ';
    v_sql12 := v_sql12||' (PARTITION BY E.acctnbr ORDER BY (E.BILL_AMT + 0) DESC) as rn ';
    v_sql12 := v_sql12||'       from FDM_S24_EVENT e, TEMP_ACCT_CDATE A ';
    v_sql12 := v_sql12||'       where (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR ';
    v_sql12 := v_sql12||'             AND e.trans_type BETWEEN 1000 AND 1999 ';
    v_sql12 := v_sql12||'             AND e.trans_type NOT IN (''1050'', ''1051'') ';
    v_sql12 := v_sql12||'             AND (e.trans_type + 0) is not null';
    v_sql12 := v_sql12||'             AND (coal(E.rev_ind,'' '') <> ''1'' or (e.rev_ind + 0) is null) ';
    v_sql12 := v_sql12||'             AND E.BILL_AMTFLAG = ''+'' ';
    v_sql12 := v_sql12||'             AND E.acctnbr = A.xaccount ';
    v_sql12 := v_sql12||' ) T ';
    v_sql12 := v_sql12||' where rn <=3  group by acctnbr ';

        DBMS_OUTPUT.PUT_LINE('TEMP_EVENT_PUR_TOP3SUM_1 after:==========' || v_sql12);

        execute immediate v_sql12;

        DBMS_OUTPUT.PUT_LINE('TEMP_EVENT_PUR_TOP3SUM_1 over:==========success!');

        EXECUTE IMMEDIATE ('truncate table  TEMP_EVENT_PUR_TOP3SUM_2');

    	DBMS_OUTPUT.PUT_LINE('TEMP_EVENT_PUR_TOP3SUM_2 before:=========' || v_sql13);

    v_sql13 := ' insert into TEMP_EVENT_PUR_TOP3SUM_2 ';
    v_sql13 := v_sql13||' select acctnbr,	 SUM(BILL_AMT) as amt1 from ';
    v_sql13 := v_sql13||' ( ';
    v_sql13 := v_sql13||' select E.acctnbr, E.BILL_AMT , ROW_NUMBER() OVER ';
    v_sql13 := v_sql13||' (PARTITION BY E.acctnbr ORDER BY (E.BILL_AMT + 0) DESC) as rn ';
    v_sql13 := v_sql13||'       from FDM_S24_EVENT e,TEMP_ACCT_CDATE A ';
    v_sql13 := v_sql13||'       where (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 1 ';
    v_sql13 := v_sql13||'             AND e.trans_type BETWEEN 1000 AND 1999 ';
    v_sql13 := v_sql13||'             AND e.trans_type NOT IN (''1050'', ''1051'') ';
    v_sql13 := v_sql13||'             AND (e.trans_type + 0) is not null';
    v_sql13 := v_sql13||'             AND (coal(E.rev_ind,'' '') <> ''1'' or (e.rev_ind + 0) is null) ';
    v_sql13 := v_sql13||'             AND E.BILL_AMTFLAG = ''+'' ';
    v_sql13 := v_sql13||'             AND E.acctnbr = A.xaccount ';
    v_sql13 := v_sql13||' ) T ';
    v_sql13 := v_sql13||' where rn <=3  group by acctnbr ';

        DBMS_OUTPUT.PUT_LINE('TEMP_EVENT_PUR_TOP3SUM_2 after:==========' || v_sql13);

        execute immediate v_sql13;

        DBMS_OUTPUT.PUT_LINE('TEMP_EVENT_PUR_TOP3SUM_2 over:==========success!');

        EXECUTE IMMEDIATE ('truncate table  TEMP_EVENT_PUR_TOP3SUM_3');

    	DBMS_OUTPUT.PUT_LINE('TEMP_EVENT_PUR_TOP3SUM_3 before:=========' || v_sql14);

    v_sql14 := ' insert into TEMP_EVENT_PUR_TOP3SUM_3 ';
    v_sql14 := v_sql14||' select acctnbr,	 SUM(BILL_AMT) as amt1 from ';
    v_sql14 := v_sql14||' ( ';
    v_sql14 := v_sql14||' select E.acctnbr, E.BILL_AMT , ROW_NUMBER() OVER ';
    v_sql14 := v_sql14||' (PARTITION BY E.acctnbr ORDER BY (E.BILL_AMT + 0) DESC) as rn ';
    v_sql14 := v_sql14||'       from FDM_S24_EVENT e,TEMP_ACCT_CDATE A ';
    v_sql14 := v_sql14||'       where (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 2 ';
    v_sql14 := v_sql14||'             AND e.trans_type BETWEEN 1000 AND 1999 ';
    v_sql14 := v_sql14||'             AND e.trans_type NOT IN (''1050'', ''1051'') ';
    v_sql14 := v_sql14||'             AND (e.trans_type + 0) is not null';
    v_sql14 := v_sql14||'             AND (coal(E.rev_ind,'' '') <> ''1'' or (e.rev_ind + 0) is null) ';
    v_sql14 := v_sql14||'             AND E.BILL_AMTFLAG = ''+'' ';
    v_sql14 := v_sql14||'             AND E.acctnbr = A.xaccount ';
    v_sql14 := v_sql14||' ) T ';
    v_sql14 := v_sql14||' where rn <=3  group by acctnbr ';

        DBMS_OUTPUT.PUT_LINE('TEMP_EVENT_PUR_TOP3SUM_3 after:==========' || v_sql14);

        execute immediate v_sql14;

        DBMS_OUTPUT.PUT_LINE('TEMP_EVENT_PUR_TOP3SUM_3 over:==========success!');

        EXECUTE IMMEDIATE ('truncate table  TEMP_EVENT_PUR_TOP3SUM_4');

    	DBMS_OUTPUT.PUT_LINE('TEMP_EVENT_PUR_TOP3SUM_4 before:=========' || v_sql15);

    v_sql15 := ' insert into TEMP_EVENT_PUR_TOP3SUM_4 ';
    v_sql15 := v_sql15||' select acctnbr,	 SUM(BILL_AMT) as amt1 from ';
    v_sql15 := v_sql15||' ( ';
    v_sql15 := v_sql15||' select E.acctnbr, E.BILL_AMT , ROW_NUMBER() OVER ';
    v_sql15 := v_sql15||' (PARTITION BY E.acctnbr ORDER BY (E.BILL_AMT + 0) DESC) as rn ';
    v_sql15 := v_sql15||'       from FDM_S24_EVENT e,TEMP_ACCT_CDATE A ';
    v_sql15 := v_sql15||'       where (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 3 ';
    v_sql15 := v_sql15||'             AND e.trans_type BETWEEN 1000 AND 1999 ';
    v_sql15 := v_sql15||'             AND e.trans_type NOT IN (''1050'', ''1051'') ';
    v_sql15 := v_sql15||'             AND (e.trans_type + 0) is not null';
    v_sql15 := v_sql15||'             AND (coal(E.rev_ind,'' '') <> ''1'' or (e.rev_ind + 0) is null) ';
    v_sql15 := v_sql15||'             AND E.BILL_AMTFLAG = ''+'' ';
    v_sql15 := v_sql15||'             AND E.acctnbr = A.xaccount ';
    v_sql15 := v_sql15||' ) T ';
    v_sql15 := v_sql15||' where rn <=3  group by acctnbr ';

        DBMS_OUTPUT.PUT_LINE('TEMP_EVENT_PUR_TOP3SUM_4 after:==========' || v_sql15);

        execute immediate v_sql15;

        DBMS_OUTPUT.PUT_LINE('TEMP_EVENT_PUR_TOP3SUM_4 over:==========success!');

        EXECUTE IMMEDIATE ('truncate table  TEMP_EVENT_PUR_TOP3SUM_5');

    	DBMS_OUTPUT.PUT_LINE('TEMP_EVENT_PUR_TOP3SUM_5 before:=========' || v_sql16);

    v_sql16 := ' insert into TEMP_EVENT_PUR_TOP3SUM_5 ';
    v_sql16 := v_sql16||' select acctnbr,	 SUM(BILL_AMT) as amt1 from ';
    v_sql16 := v_sql16||' ( ';
    v_sql16 := v_sql16||' select E.acctnbr, E.BILL_AMT , ROW_NUMBER() OVER ';
    v_sql16 := v_sql16||' (PARTITION BY E.acctnbr ORDER BY (E.BILL_AMT + 0) DESC) as rn ';
    v_sql16 := v_sql16||'       from FDM_S24_EVENT e,TEMP_ACCT_CDATE A ';
    v_sql16 := v_sql16||'       where (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 4 ';
    v_sql16 := v_sql16||'             AND e.trans_type BETWEEN 1000 AND 1999 ';
    v_sql16 := v_sql16||'             AND e.trans_type NOT IN (''1050'', ''1051'') ';
    v_sql16 := v_sql16||'             AND (e.trans_type + 0) is not null';
    v_sql16 := v_sql16||'             AND (coal(E.rev_ind,'' '') <> ''1'' or (e.rev_ind + 0) is null) ';
    v_sql16 := v_sql16||'             AND E.BILL_AMTFLAG = ''+'' ';
    v_sql16 := v_sql16||'             AND E.acctnbr = A.xaccount ';
    v_sql16 := v_sql16||' ) T ';
    v_sql16 := v_sql16||' where rn <=3  group by acctnbr ';

        DBMS_OUTPUT.PUT_LINE('TEMP_EVENT_PUR_TOP3SUM_5 after:==========' || v_sql16);

        execute immediate v_sql16;

        DBMS_OUTPUT.PUT_LINE('TEMP_EVENT_PUR_TOP3SUM_5 over:==========success!');

        EXECUTE IMMEDIATE ('truncate table  TEMP_EVENT_PUR_TOP3SUM_6');

    	DBMS_OUTPUT.PUT_LINE('TEMP_EVENT_PUR_TOP3SUM_6 before:=========' || v_sql17);

    v_sql17 := ' insert into TEMP_EVENT_PUR_TOP3SUM_6 ';
    v_sql17 := v_sql17||' select acctnbr,	 SUM(BILL_AMT) as amt1 from ';
    v_sql17 := v_sql17||' ( ';
    v_sql17 := v_sql17||' select E.acctnbr, E.BILL_AMT , ROW_NUMBER() OVER ';
    v_sql17 := v_sql17||' (PARTITION BY E.acctnbr ORDER BY (E.BILL_AMT + 0) DESC) as rn ';
    v_sql17 := v_sql17||'       from FDM_S24_EVENT e,TEMP_ACCT_CDATE A ';
    v_sql17 := v_sql17||'       where (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 5 ';
    v_sql17 := v_sql17||'             AND e.trans_type BETWEEN 1000 AND 1999 ';
    v_sql17 := v_sql17||'             AND e.trans_type NOT IN (''1050'', ''1051'') ';
    v_sql17 := v_sql17||'             AND (e.trans_type + 0) is not null';
    v_sql17 := v_sql17||'             AND (coal(E.rev_ind,'' '') <> ''1'' or (e.rev_ind + 0) is null) ';
    v_sql17 := v_sql17||'             AND E.BILL_AMTFLAG = ''+'' ';
    v_sql17 := v_sql17||'             AND E.acctnbr = A.xaccount ';
    v_sql17 := v_sql17||' ) T ';
    v_sql17 := v_sql17||' where rn <=3  group by acctnbr ';

        DBMS_OUTPUT.PUT_LINE('TEMP_EVENT_PUR_TOP3SUM_6 after:==========' || v_sql17);

        execute immediate v_sql17;

        DBMS_OUTPUT.PUT_LINE('TEMP_EVENT_PUR_TOP3SUM_6 over:==========success!');

        EXECUTE IMMEDIATE ('truncate table  TEMP_EVENT_PUR_TOP3SUM_0');

    	DBMS_OUTPUT.PUT_LINE('TEMP_EVENT_PUR_TOP3SUM_0 before:=========' || v_sql18);

    v_sql18 := ' insert into TEMP_EVENT_PUR_TOP3SUM_0 ';
    v_sql18 := v_sql18||' select acctnbr,	 SUM(BILL_AMT) as amt1 from ';
    v_sql18 := v_sql18||' ( ';
    v_sql18 := v_sql18||' select E.acctnbr, E.BILL_AMT , ROW_NUMBER() OVER ';
    v_sql18 := v_sql18||' (PARTITION BY E.acctnbr ORDER BY (E.BILL_AMT + 0) DESC) as rn ';
    v_sql18 := v_sql18||'       from FDM_S24_EVENT e,TEMP_ACCT_CDATE A ';
    v_sql18 := v_sql18||'       where (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR + 1 ';
    v_sql18 := v_sql18||'             AND e.trans_type BETWEEN 1000 AND 1999 ';
    v_sql18 := v_sql18||'             AND e.trans_type NOT IN (''1050'', ''1051'') ';
    v_sql18 := v_sql18||'             AND (e.trans_type + 0) is not null';
    v_sql18 := v_sql18||'             AND (coal(E.rev_ind,'' '') <> ''1'' or (e.rev_ind + 0) is null) ';
    v_sql18 := v_sql18||'             AND E.BILL_AMTFLAG = ''+'' ';
    v_sql18 := v_sql18||'             AND E.acctnbr = A.xaccount ';
    v_sql18 := v_sql18||' ) T ';
    v_sql18 := v_sql18||' where rn <=3  group by acctnbr ';

        DBMS_OUTPUT.PUT_LINE('TEMP_EVENT_PUR_TOP3SUM_0 after:==========' || v_sql18);

        execute immediate v_sql18;

        DBMS_OUTPUT.PUT_LINE('TEMP_EVENT_PUR_TOP3SUM_0 over:==========success!');

    	   --删除变动的数据
       EXECUTE IMMEDIATE ('truncate table  TEMP_EVENT_PUR_MERCHANT_6M');

       DBMS_OUTPUT.PUT_LINE('TEMP_EVENT_PUR_MERCHANT_6M before:=========' || v_sql19);

    v_sql19 := ' insert into TEMP_EVENT_PUR_MERCHANT_6M ';
    v_sql19 := v_sql19||' select m.acctnbr ,sum(m.amt) as amt from  ( ';
    v_sql19 := v_sql19||'     select t.ACCTNBR, t.AMT , ROW_NUMBER() OVER (PARTITION BY t.ACCTNBR ORDER BY (t.AMT + 0) DESC) as rn from ';
    v_sql19 := v_sql19||'     ( ';
    v_sql19 := v_sql19||'         select E.ACCTNBR as ACCTNBR, E.MERCHANT,SUM(   CASE ';
    v_sql19 := v_sql19||'                                   WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql19 := v_sql19||'                                     ELSE E.BILL_AMT ';
    v_sql19 := v_sql19||'                         END) as AMT ';
    v_sql19 := v_sql19||'               from FDM_S24_EVENT E left join ';
    v_sql19 := v_sql19||' (select C.code_value,C.bank_id from ccam_codes C, tbl_banks B  where B.bankid = C.bank_id and  C.code_type = ''WSSH'') ta ';
    v_sql19 := v_sql19||'               on E.MERCHANT = ta.code_value ';
    v_sql19 := v_sql19||'         WHERE     E.trans_type BETWEEN 1000 AND 1999 ';
    v_sql19 := v_sql19||'            AND E.trans_type NOT IN (''1050'', ''1051'') ';
    v_sql19 := v_sql19||'            AND (E.trans_type + 0) is not null';
    v_sql19 := v_sql19||'            AND todate(E.CREATE_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -6) ';
    v_sql19 := v_sql19||'            AND todate(E.CREATE_DATE,''yyyy-mm-dd'') <= SYSDATE() ';
    v_sql19 := v_sql19||'            AND (coal(E.rev_ind,'' '') <> ''1'' or (E.rev_ind + 0) is null) ';
    v_sql19 := v_sql19||'            AND ta.bank_id is null AND LENGTH(E.MERCHANT) != 0';
    v_sql19 := v_sql19||'         GROUP BY E.ACCTNBR,E.MERCHANT ';
    v_sql19 := v_sql19||'     ) t ';
    v_sql19 := v_sql19||' ) m where rn <=3 ';
    v_sql19 := v_sql19||'   GROUP by m.ACCTNBR ';

    	  DBMS_OUTPUT.PUT_LINE('TEMP_EVENT_PUR_MERCHANT_6M after:==========' || v_sql19);

          execute immediate v_sql19;

          DBMS_OUTPUT.PUT_LINE('TEMP_EVENT_PUR_MERCHANT_6M over:==========success!');

       --非低零扣率商户数
       EXECUTE IMMEDIATE ('truncate table  TEMP_EVENT_PUR_MERCHANT_CNT_6M');

       DBMS_OUTPUT.PUT_LINE('TEMP_EVENT_PUR_MERCHANT_CNT_6M before:=========' || v_sql20);

    v_sql20 := ' insert into TEMP_EVENT_PUR_MERCHANT_CNT_6M ';
    v_sql20 := v_sql20||' select t.ACCTNBR,COUNT(*) as CNT from ( ';
    v_sql20 := v_sql20||'     select E.ACCTNBR as ACCTNBR,MERCHANT,SUM(   CASE ';
    v_sql20 := v_sql20||'                                   WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql20 := v_sql20||'                                     ELSE E.BILL_AMT ';
    v_sql20 := v_sql20||'                         END) as AMT ';
    v_sql20 := v_sql20||'               from FDM_S24_EVENT E left join ';
    v_sql20 := v_sql20||' (select C.code_value,C.bank_id from ccam_codes C, tbl_banks B  where B.bankid = C.bank_id and  C.code_type = ''WSSH'') ta ';
    v_sql20 := v_sql20||'               on E.MERCHANT = ta.code_value ';
    v_sql20 := v_sql20||'     WHERE     E.trans_type BETWEEN 1000 AND 1999 ';
    v_sql20 := v_sql20||'            AND E.trans_type NOT IN (''1050'', ''1051'') ';
    v_sql20 := v_sql20||'            AND (E.trans_type + 0) is not null';
    v_sql20 := v_sql20||'            AND todate(E.CREATE_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -6) ';
    v_sql20 := v_sql20||'            AND todate(E.CREATE_DATE,''yyyy-mm-dd'') <= SYSDATE() ';
    v_sql20 := v_sql20||'            AND (coal(E.rev_ind,'' '') <> ''1'' or (E.rev_ind + 0) is null) ';
    v_sql20 := v_sql20||'            AND ((E.MER_CAT_CD  IN ';
    v_sql20 := v_sql20||'                (''7011'', ';
    v_sql20 := v_sql20||'                 ''7012'', ';
    v_sql20 := v_sql20||'                 ''5811'', ';
    v_sql20 := v_sql20||'                 ''5812'', ';
    v_sql20 := v_sql20||'                 ''5813'', ';
    v_sql20 := v_sql20||'                 ''5094'', ';
    v_sql20 := v_sql20||'                 ''5937'', ';
    v_sql20 := v_sql20||'                 ''5950'', ';
    v_sql20 := v_sql20||'                 ''5970'', ';
    v_sql20 := v_sql20||'                 ''5971'', ';
    v_sql20 := v_sql20||'                 ''7297'', ';
    v_sql20 := v_sql20||'                 ''7298'', ';
    v_sql20 := v_sql20||'                 ''7829'', ';
    v_sql20 := v_sql20||'                 ''7911'', ';
    v_sql20 := v_sql20||'                 ''7922'', ';
    v_sql20 := v_sql20||'                 ''7929'', ';
    v_sql20 := v_sql20||'                 ''7932'', ';
    v_sql20 := v_sql20||'                 ''7933'', ';
    v_sql20 := v_sql20||'                 ''7941'', ';
    v_sql20 := v_sql20||'                 ''7992'', ';
    v_sql20 := v_sql20||'                 ''7994'', ';
    v_sql20 := v_sql20||'                 ''7996'', ';
    v_sql20 := v_sql20||'                 ''7997'', ';
    v_sql20 := v_sql20||'                 ''7998'', ';
    v_sql20 := v_sql20||'                 ''7032'', ';
    v_sql20 := v_sql20||'                 ''7033'', ';
    v_sql20 := v_sql20||'                 ''5944'', ';
    v_sql20 := v_sql20||'                 ''5932'', ';
    v_sql20 := v_sql20||'                 ''7631'', ';
    v_sql20 := v_sql20||'                 ''7999'', ';
    v_sql20 := v_sql20||'                 ''5541'', ';
    v_sql20 := v_sql20||'                 ''5542'', ';
    v_sql20 := v_sql20||'                 ''5411'', ';
    v_sql20 := v_sql20||'                 ''5722'', ';
    v_sql20 := v_sql20||'                 ''4511'', ';
    v_sql20 := v_sql20||'                 ''4111'', ';
    v_sql20 := v_sql20||'                 ''4121'', ';
    v_sql20 := v_sql20||'                 ''4131'', ';
    v_sql20 := v_sql20||'                 ''4784'', ';
    v_sql20 := v_sql20||'                 ''3998'', ';
    v_sql20 := v_sql20||'                 ''4112'', ';
    v_sql20 := v_sql20||'                 ''4900'', ';
    v_sql20 := v_sql20||'                 ''4814'', ';
    v_sql20 := v_sql20||'                 ''4899'', ';
    v_sql20 := v_sql20||'                 ''6300'', ';
    v_sql20 := v_sql20||'                 ''5960'', ';
    v_sql20 := v_sql20||'                 ''8651'', ';
    v_sql20 := v_sql20||'                 ''9211'', ';
    v_sql20 := v_sql20||'                 ''9222'', ';
    v_sql20 := v_sql20||'                 ''9223'', ';
    v_sql20 := v_sql20||'                 ''9311'', ';
    v_sql20 := v_sql20||'                 ''9399'', ';
    v_sql20 := v_sql20||'                 ''9400'', ';
    v_sql20 := v_sql20||'                 ''5994'', ';
    v_sql20 := v_sql20||'                 ''7523'', ';
    v_sql20 := v_sql20||'                 ''9402'', ';
    v_sql20 := v_sql20||'                 ''742'',  ';
    v_sql20 := v_sql20||'                 ''763'',  ';
    v_sql20 := v_sql20||'                 ''780'',  ';
    v_sql20 := v_sql20||'                 ''4011'', ';
    v_sql20 := v_sql20||'                 ''4119'', ';
    v_sql20 := v_sql20||'                 ''4214'', ';
    v_sql20 := v_sql20||'                 ''4215'', ';
    v_sql20 := v_sql20||'                 ''4225'', ';
    v_sql20 := v_sql20||'                 ''4411'', ';
    v_sql20 := v_sql20||'                 ''4457'', ';
    v_sql20 := v_sql20||'                 ''4468'', ';
    v_sql20 := v_sql20||'                 ''4582'', ';
    v_sql20 := v_sql20||'                 ''4722'', ';
    v_sql20 := v_sql20||'                 ''4733'', ';
    v_sql20 := v_sql20||'                 ''4789'', ';
    v_sql20 := v_sql20||'                 ''4812'', ';
    v_sql20 := v_sql20||'                 ''4816'', ';
    v_sql20 := v_sql20||'                 ''4821'', ';
    v_sql20 := v_sql20||'                 ''5211'', ';
    v_sql20 := v_sql20||'                 ''5231'', ';
    v_sql20 := v_sql20||'                 ''5251'', ';
    v_sql20 := v_sql20||'                 ''5261'', ';
    v_sql20 := v_sql20||'                 ''5309'', ';
    v_sql20 := v_sql20||'                 ''5310'', ';
    v_sql20 := v_sql20||'                 ''5311'', ';
    v_sql20 := v_sql20||'                 ''5331'', ';
    v_sql20 := v_sql20||'                 ''5399'', ';
    v_sql20 := v_sql20||'                 ''5422'', ';
    v_sql20 := v_sql20||'                 ''5441'', ';
    v_sql20 := v_sql20||'                 ''5451'', ';
    v_sql20 := v_sql20||'                 ''5462'', ';
    v_sql20 := v_sql20||'                 ''5499'', ';
    v_sql20 := v_sql20||'                 ''5532'', ';
    v_sql20 := v_sql20||'                 ''5533'', ';
    v_sql20 := v_sql20||'                 ''5611'', ';
    v_sql20 := v_sql20||'                 ''5621'', ';
    v_sql20 := v_sql20||'                 ''5631'', ';
    v_sql20 := v_sql20||'                 ''5641'', ';
    v_sql20 := v_sql20||'                 ''5651'', ';
    v_sql20 := v_sql20||'                 ''5655'', ';
    v_sql20 := v_sql20||'                 ''5661'', ';
    v_sql20 := v_sql20||'                 ''5681'', ';
    v_sql20 := v_sql20||'                 ''5691'', ';
    v_sql20 := v_sql20||'                 ''5697'', ';
    v_sql20 := v_sql20||'                 ''5698'', ';
    v_sql20 := v_sql20||'                 ''5699'', ';
    v_sql20 := v_sql20||'                 ''5712'', ';
    v_sql20 := v_sql20||'                 ''5713'', ';
    v_sql20 := v_sql20||'                 ''5714'', ';
    v_sql20 := v_sql20||'                 ''5718'', ';
    v_sql20 := v_sql20||'                 ''5719'', ';
    v_sql20 := v_sql20||'                 ''5732'', ';
    v_sql20 := v_sql20||'                 ''5733'', ';
    v_sql20 := v_sql20||'                 ''5734'', ';
    v_sql20 := v_sql20||'                 ''5735'', ';
    v_sql20 := v_sql20||'                 ''5814'', ';
    v_sql20 := v_sql20||'                 ''5912'', ';
    v_sql20 := v_sql20||'                 ''5921'', ';
    v_sql20 := v_sql20||'                 ''5931'', ';
    v_sql20 := v_sql20||'                 ''5935'', ';
    v_sql20 := v_sql20||'                 ''5940'', ';
    v_sql20 := v_sql20||'                 ''5941'', ';
    v_sql20 := v_sql20||'                 ''5942'', ';
    v_sql20 := v_sql20||'                 ''5943'', ';
    v_sql20 := v_sql20||'                 ''5945'', ';
    v_sql20 := v_sql20||'                 ''5946'', ';
    v_sql20 := v_sql20||'                 ''5947'', ';
    v_sql20 := v_sql20||'                 ''5948'', ';
    v_sql20 := v_sql20||'                 ''5949'', ';
    v_sql20 := v_sql20||'                 ''5962'', ';
    v_sql20 := v_sql20||'                 ''5963'', ';
    v_sql20 := v_sql20||'                 ''5964'', ';
    v_sql20 := v_sql20||'                 ''5965'', ';
    v_sql20 := v_sql20||'                 ''5966'', ';
    v_sql20 := v_sql20||'                 ''5967'', ';
    v_sql20 := v_sql20||'                 ''5968'', ';
    v_sql20 := v_sql20||'                 ''5969'', ';
    v_sql20 := v_sql20||'                 ''5972'', ';
    v_sql20 := v_sql20||'                 ''5973'', ';
    v_sql20 := v_sql20||'                 ''5975'', ';
    v_sql20 := v_sql20||'                 ''5976'', ';
    v_sql20 := v_sql20||'                 ''5977'', ';
    v_sql20 := v_sql20||'                 ''5978'', ';
    v_sql20 := v_sql20||'                 ''5983'', ';
    v_sql20 := v_sql20||'                 ''5992'', ';
    v_sql20 := v_sql20||'                 ''5993'', ';
    v_sql20 := v_sql20||'                 ''5995'', ';
    v_sql20 := v_sql20||'                 ''5996'', ';
    v_sql20 := v_sql20||'                 ''5997'', ';
    v_sql20 := v_sql20||'                 ''5999'', ';
    v_sql20 := v_sql20||'                 ''6010'', ';
    v_sql20 := v_sql20||'                 ''6011'', ';
    v_sql20 := v_sql20||'                 ''6012'', ';
    v_sql20 := v_sql20||'                 ''6051'', ';
    v_sql20 := v_sql20||'                 ''6211'', ';
    v_sql20 := v_sql20||'                 ''6513'', ';
    v_sql20 := v_sql20||'                 ''7210'', ';
    v_sql20 := v_sql20||'                 ''7211'', ';
    v_sql20 := v_sql20||'                 ''7216'', ';
    v_sql20 := v_sql20||'                 ''7217'', ';
    v_sql20 := v_sql20||'                 ''7221'', ';
    v_sql20 := v_sql20||'                 ''7230'', ';
    v_sql20 := v_sql20||'                 ''7251'', ';
    v_sql20 := v_sql20||'                 ''7261'', ';
    v_sql20 := v_sql20||'                 ''7273'', ';
    v_sql20 := v_sql20||'                 ''7276'', ';
    v_sql20 := v_sql20||'                 ''7277'', ';
    v_sql20 := v_sql20||'                 ''7278'', ';
    v_sql20 := v_sql20||'                 ''7295'', ';
    v_sql20 := v_sql20||'                 ''7296'', ';
    v_sql20 := v_sql20||'                 ''7299'', ';
    v_sql20 := v_sql20||'                 ''7311'', ';
    v_sql20 := v_sql20||'                 ''7321'', ';
    v_sql20 := v_sql20||'                 ''7333'', ';
    v_sql20 := v_sql20||'                 ''7338'', ';
    v_sql20 := v_sql20||'                 ''7339'', ';
    v_sql20 := v_sql20||'                 ''7342'', ';
    v_sql20 := v_sql20||'                 ''7349'', ';
    v_sql20 := v_sql20||'                 ''7361'', ';
    v_sql20 := v_sql20||'                 ''7372'', ';
    v_sql20 := v_sql20||'                 ''7375'', ';
    v_sql20 := v_sql20||'                 ''7379'', ';
    v_sql20 := v_sql20||'                 ''7392'', ';
    v_sql20 := v_sql20||'                 ''7393'', ';
    v_sql20 := v_sql20||'                 ''7394'', ';
    v_sql20 := v_sql20||'                 ''7395'', ';
    v_sql20 := v_sql20||'                 ''7399'', ';
    v_sql20 := v_sql20||'                 ''7512'', ';
    v_sql20 := v_sql20||'                 ''7513'', ';
    v_sql20 := v_sql20||'                 ''7519'', ';
    v_sql20 := v_sql20||'                 ''7531'', ';
    v_sql20 := v_sql20||'                 ''7534'', ';
    v_sql20 := v_sql20||'                 ''7535'', ';
    v_sql20 := v_sql20||'                 ''7538'', ';
    v_sql20 := v_sql20||'                 ''7542'', ';
    v_sql20 := v_sql20||'                 ''7549'', ';
    v_sql20 := v_sql20||'                 ''7622'', ';
    v_sql20 := v_sql20||'                 ''7623'', ';
    v_sql20 := v_sql20||'                 ''7629'', ';
    v_sql20 := v_sql20||'                 ''7641'', ';
    v_sql20 := v_sql20||'                 ''7692'', ';
    v_sql20 := v_sql20||'                 ''7699'', ';
    v_sql20 := v_sql20||'                 ''7832'', ';
    v_sql20 := v_sql20||'                 ''7841'', ';
    v_sql20 := v_sql20||'                 ''7991'', ';
    v_sql20 := v_sql20||'                 ''7993'', ';
    v_sql20 := v_sql20||'                 ''7995'', ';
    v_sql20 := v_sql20||'                 ''8011'', ';
    v_sql20 := v_sql20||'                 ''8021'', ';
    v_sql20 := v_sql20||'                 ''8031'', ';
    v_sql20 := v_sql20||'                 ''8041'', ';
    v_sql20 := v_sql20||'                 ''8042'', ';
    v_sql20 := v_sql20||'                 ''8043'', ';
    v_sql20 := v_sql20||'                 ''8049'', ';
    v_sql20 := v_sql20||'                 ''8050'', ';
    v_sql20 := v_sql20||'                 ''8071'', ';
    v_sql20 := v_sql20||'                 ''8099'', ';
    v_sql20 := v_sql20||'                 ''8111'', ';
    v_sql20 := v_sql20||'                 ''8241'', ';
    v_sql20 := v_sql20||'                 ''8244'', ';
    v_sql20 := v_sql20||'                 ''8249'', ';
    v_sql20 := v_sql20||'                 ''8299'', ';
    v_sql20 := v_sql20||'                 ''8351'', ';
    v_sql20 := v_sql20||'                 ''8641'', ';
    v_sql20 := v_sql20||'                 ''8661'', ';
    v_sql20 := v_sql20||'                 ''8675'', ';
    v_sql20 := v_sql20||'                 ''8699'', ';
    v_sql20 := v_sql20||'                 ''8911'', ';
    v_sql20 := v_sql20||'                 ''8912'', ';
    v_sql20 := v_sql20||'                 ''8931'', ';
    v_sql20 := v_sql20||'                 ''8999'', ';
    v_sql20 := v_sql20||'                 ''1001'', ';
    v_sql20 := v_sql20||'                 ''6013'') ';
    v_sql20 := v_sql20||'          AND  (E.MERCH_STAT = ''156'' or (E.MERCH_STAT + 0) is null) ';
    v_sql20 := v_sql20||'          AND  substr(E.merch_seq,-4,3) not in (''041'',''011'',''030'')) ';
    v_sql20 := v_sql20||'          AND (substr(E.merch_seq,-4,3) + 0) is not null ';
    v_sql20 := v_sql20||'          OR coal(E.MERCH_STAT,'' '') <> ''156'') ';
    v_sql20 := v_sql20||'          AND ta.bank_id is null AND LENGTH(E.MERCHANT) != 0';
    v_sql20 := v_sql20||'     GROUP BY E.ACCTNBR,E.MERCHANT ';
    v_sql20 := v_sql20||' ) t GROUP BY t.ACCTNBR ';

          DBMS_OUTPUT.PUT_LINE('TEMP_EVENT_PUR_MERCHANT_CNT_6M after:==========' || v_sql20);

          execute immediate v_sql20;

          DBMS_OUTPUT.PUT_LINE('TEMP_EVENT_PUR_MERCHANT_CNT_6M over:==========success!');

          EXECUTE IMMEDIATE ('truncate table  TEMP_EVENT_PUR_TOP3SUM');

          DBMS_OUTPUT.PUT_LINE('TEMP_EVENT_PUR_TOP3SUM before:=========' || v_sql21);

    v_sql21 := ' INSERT INTO TEMP_EVENT_PUR_TOP3SUM ';
    v_sql21 := v_sql21||' SELECT T.XACCOUNT, ';
    v_sql21 := v_sql21||'        COAL (T0.TOP3SUM, 0) as TOP3SUM0, ';
    v_sql21 := v_sql21||'        COAL (T1.TOP3SUM, 0) as TOP3SUM1, ';
    v_sql21 := v_sql21||'        COAL (T2.TOP3SUM, 0) as TOP3SUM2, ';
    v_sql21 := v_sql21||'        COAL (T3.TOP3SUM, 0) as TOP3SUM3, ';
    v_sql21 := v_sql21||'        COAL (T4.TOP3SUM, 0) as TOP3SUM4, ';
    v_sql21 := v_sql21||'        COAL (T5.TOP3SUM, 0) as TOP3SUM5, ';
    v_sql21 := v_sql21||'        COAL (T6.TOP3SUM, 0) as TOP3SUM6, ';
    v_sql21 := v_sql21||'        COAL (T7.MERCHANTSUM6M, 0) as MERCHANTSUM6M, ';
    v_sql21 := v_sql21||'        COAL (T8.OFFLINE_NODL_MERCHANT_CNT, 0) as OFFLINE_NODL_MERCHANT_CNT, ';
    v_sql21 := v_sql21||'        COAL (T9.max_amt, 0) as max_amt_0,  ';
    v_sql21 := v_sql21||'        COAL (T9.cnt, 0)     as cnt_0,      ';
    v_sql21 := v_sql21||'        COAL (T9.sum_amt, 0) as sum_amt_0,  ';
    v_sql21 := v_sql21||'        COAL (T10.max_amt, 0) as max_amt_1, ';
    v_sql21 := v_sql21||'        COAL (T10.cnt, 0)     as cnt_1,     ';
    v_sql21 := v_sql21||'        COAL (T10.sum_amt, 0) as sum_amt_1, ';
    v_sql21 := v_sql21||'        COAL (T11.max_amt, 0) as max_amt_2, ';
    v_sql21 := v_sql21||'        COAL (T11.cnt, 0)     as cnt_2,     ';
    v_sql21 := v_sql21||'        COAL (T11.sum_amt, 0) as sum_amt_2, ';
    v_sql21 := v_sql21||'        COAL (T12.max_amt, 0) as max_amt_3, ';
    v_sql21 := v_sql21||'        COAL (T12.cnt, 0)     as cnt_3,     ';
    v_sql21 := v_sql21||'        COAL (T12.sum_amt, 0) as sum_amt_3, ';
    v_sql21 := v_sql21||'        COAL (T13.max_amt, 0) as max_amt_4, ';
    v_sql21 := v_sql21||'        COAL (T13.cnt, 0)     as cnt_4,     ';
    v_sql21 := v_sql21||'        COAL (T13.sum_amt, 0) as sum_amt_4, ';
    v_sql21 := v_sql21||'        COAL (T14.max_amt, 0) as max_amt_5, ';
    v_sql21 := v_sql21||'        COAL (T14.cnt, 0)     as cnt_5,     ';
    v_sql21 := v_sql21||'        COAL (T14.sum_amt, 0) as sum_amt_5, ';
    v_sql21 := v_sql21||'        COAL (T15.max_amt, 0) as max_amt_6, ';
    v_sql21 := v_sql21||'        COAL (T15.cnt, 0)     as cnt_6,     ';
    v_sql21 := v_sql21||'        COAL (T15.sum_amt, 0) as sum_amt_6, ';
    v_sql21 := v_sql21||'        COAL (c.min_active_day, 0) as active_day, ';
    v_sql21 := v_sql21||'        COAL (T16.max_ovd_6m, ''0'') as max_ovd_6m ';
    v_sql21 := v_sql21||' from FDM_S24_CUR_ACCT T ';
    v_sql21 := v_sql21||'     LEFT JOIN TEMP_EVENT_PUR_TOP3SUM_0 T0 ON (T.XACCOUNT + 0) = T0.ACCTNBR ';
    v_sql21 := v_sql21||'     LEFT JOIN TEMP_EVENT_PUR_TOP3SUM_1 T1 ON (T.XACCOUNT + 0) = T1.ACCTNBR ';
    v_sql21 := v_sql21||'     LEFT JOIN TEMP_EVENT_PUR_TOP3SUM_2 T2 ON (T.XACCOUNT + 0) = T2.ACCTNBR ';
    v_sql21 := v_sql21||'     LEFT JOIN TEMP_EVENT_PUR_TOP3SUM_3 T3 ON (T.XACCOUNT + 0) = T3.ACCTNBR ';
    v_sql21 := v_sql21||'     LEFT JOIN TEMP_EVENT_PUR_TOP3SUM_4 T4 ON (T.XACCOUNT + 0) = T4.ACCTNBR ';
    v_sql21 := v_sql21||'     LEFT JOIN TEMP_EVENT_PUR_TOP3SUM_5 T5 ON (T.XACCOUNT + 0) = T5.ACCTNBR ';
    v_sql21 := v_sql21||'     LEFT JOIN TEMP_EVENT_PUR_TOP3SUM_6 T6 ON (T.XACCOUNT + 0) = T6.ACCTNBR ';
    v_sql21 := v_sql21||'     LEFT JOIN TEMP_EVENT_PUR_MERCHANT_6M T7 ON (T.XACCOUNT + 0) = T7.ACCTNBR ';
    v_sql21 := v_sql21||'     LEFT JOIN TEMP_EVENT_PUR_MERCHANT_CNT_6M T8 ON (T.XACCOUNT + 0) = T8.ACCTNBR ';
    v_sql21 := v_sql21||'     LEFT JOIN temp_event_pur_merchant_0 T9 ON (T.XACCOUNT + 0) = T9.ACCTNBR   ';
    v_sql21 := v_sql21||'     LEFT JOIN temp_event_pur_merchant_1 T10 ON (T.XACCOUNT + 0) = T10.ACCTNBR ';
    v_sql21 := v_sql21||'     LEFT JOIN temp_event_pur_merchant_2 T11 ON (T.XACCOUNT + 0) = T11.ACCTNBR ';
    v_sql21 := v_sql21||'     LEFT JOIN temp_event_pur_merchant_3 T12 ON (T.XACCOUNT + 0) = T12.ACCTNBR ';
    v_sql21 := v_sql21||'     LEFT JOIN temp_event_pur_merchant_4 T13 ON (T.XACCOUNT + 0) = T13.ACCTNBR ';
    v_sql21 := v_sql21||'     LEFT JOIN temp_event_pur_merchant_5 T14 ON (T.XACCOUNT + 0) = T14.ACCTNBR ';
    v_sql21 := v_sql21||'     LEFT JOIN temp_event_pur_merchant_6 T15 ON (T.XACCOUNT + 0) = T15.ACCTNBR ';
    v_sql21 := v_sql21||'     LEFT JOIN (select xaccount , min(MAILER_1ST) as min_active_day from  fdm_s24_cur_card ';
    v_sql21 := v_sql21||' where  MAILER_1ST > ''0'' group by xaccount) C on t.xaccount =  c.xaccount ';
    v_sql21 := v_sql21||'     LEFT JOIN  (select t.xaccount,max(t.ovd+0) as max_ovd_6m  from ';
    v_sql21 := v_sql21||'     ( ';
    v_sql21 := v_sql21||'      select xaccount, ';
    v_sql21 := v_sql21||'           case when age6 > 0 then ''6'' ';
    v_sql21 := v_sql21||'      else case when age5 > 0 then ''5'' ';
    v_sql21 := v_sql21||'      else case when age4 > 0 then ''4'' ';
    v_sql21 := v_sql21||'      else case when age3 > 0 then ''3'' ';
    v_sql21 := v_sql21||'      else case when age2 > 0 then ''2'' ';
    v_sql21 := v_sql21||'      else case when age1 > 0 then ''1'' ';
    v_sql21 := v_sql21||'        else ''0'' ';
    v_sql21 := v_sql21||'          end ';
    v_sql21 := v_sql21||'          end ';
    v_sql21 := v_sql21||'          end ';
    v_sql21 := v_sql21||'          end ';
    v_sql21 := v_sql21||'          end ';
    v_sql21 := v_sql21||'          end as ovd ';
    v_sql21 := v_sql21||'      from fdm_s24_stmt ';
    v_sql21 := v_sql21||'     where  ADD_MONTHS (create_date, +1) < SYSDATE() ';
    v_sql21 := v_sql21||'       and ADD_MONTHS (create_date, +1)  >= ADD_MONTHS (SYSDATE(), -6) ';
    v_sql21 := v_sql21||'     ) t ';
    v_sql21 := v_sql21||' group by xaccount ) T16 ON T.XACCOUNT = T16.xaccount ';

          DBMS_OUTPUT.PUT_LINE('TEMP_EVENT_PUR_TOP3SUM after:==========' || v_sql21);

          execute immediate v_sql21;

          DBMS_OUTPUT.PUT_LINE('TEMP_EVENT_PUR_TOP3SUM over:==========success!');


       --取现统计
       EXECUTE IMMEDIATE ('truncate table  temp_event_cash_6m');

       DBMS_OUTPUT.PUT_LINE('temp_event_cash_6m before:=========' || v_sql22);

    v_sql22 := ' INSERT INTO temp_event_cash_6m ';
    v_sql22 := v_sql22||' SELECT E.ACCTNBR AS XACCOUNT, ';
    v_sql22 := v_sql22||'        SUM (  CASE ';
    v_sql22 := v_sql22||'               WHEN ';
    v_sql22 := v_sql22||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR ';
    v_sql22 := v_sql22||'                    THEN ';
    v_sql22 := v_sql22||'                             CASE ';
    v_sql22 := v_sql22||'                               WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql22 := v_sql22||'                                 ELSE E.BILL_AMT ';
    v_sql22 := v_sql22||'                     END ';
    v_sql22 := v_sql22||'                ELSE ';
    v_sql22 := v_sql22||'                    0 ';
    v_sql22 := v_sql22||'                END) ';
    v_sql22 := v_sql22||'           AS CASH_1, ';
    v_sql22 := v_sql22||'          COUNT ( CASE ';
    v_sql22 := v_sql22||'               WHEN ';
    v_sql22 := v_sql22||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR ';
    v_sql22 := v_sql22||'                    THEN ';
    v_sql22 := v_sql22||'                             1 ';
    v_sql22 := v_sql22||'                    ELSE ';
    v_sql22 := v_sql22||'                    NULL ';
    v_sql22 := v_sql22||'                END ';
    v_sql22 := v_sql22||'          ) AS CASH_CNT_1, ';
    v_sql22 := v_sql22||'        SUM (  CASE ';
    v_sql22 := v_sql22||'               WHEN ';
    v_sql22 := v_sql22||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 1 ';
    v_sql22 := v_sql22||'                    THEN ';
    v_sql22 := v_sql22||'                             CASE ';
    v_sql22 := v_sql22||'                               WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql22 := v_sql22||'                                 ELSE E.BILL_AMT ';
    v_sql22 := v_sql22||'                     END ';
    v_sql22 := v_sql22||'                ELSE ';
    v_sql22 := v_sql22||'                    0 ';
    v_sql22 := v_sql22||'                END) ';
    v_sql22 := v_sql22||'           AS CASH_2, ';
    v_sql22 := v_sql22||'          COUNT ( CASE ';
    v_sql22 := v_sql22||'               WHEN ';
    v_sql22 := v_sql22||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 1 ';
    v_sql22 := v_sql22||'                    THEN ';
    v_sql22 := v_sql22||'                             1 ';
    v_sql22 := v_sql22||'                    ELSE ';
    v_sql22 := v_sql22||'                    NULL ';
    v_sql22 := v_sql22||'                END ';
    v_sql22 := v_sql22||'          ) AS CASH_CNT_2, ';
    v_sql22 := v_sql22||'        SUM (  CASE ';
    v_sql22 := v_sql22||'               WHEN ';
    v_sql22 := v_sql22||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 2 ';
    v_sql22 := v_sql22||'                    THEN ';
    v_sql22 := v_sql22||'                             CASE ';
    v_sql22 := v_sql22||'                               WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql22 := v_sql22||'                                 ELSE E.BILL_AMT ';
    v_sql22 := v_sql22||'                     END ';
    v_sql22 := v_sql22||'                ELSE ';
    v_sql22 := v_sql22||'                    0 ';
    v_sql22 := v_sql22||'                END) ';
    v_sql22 := v_sql22||'           AS CASH_3, ';
    v_sql22 := v_sql22||'          COUNT ( CASE ';
    v_sql22 := v_sql22||'               WHEN ';
    v_sql22 := v_sql22||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 2 ';
    v_sql22 := v_sql22||'                    THEN ';
    v_sql22 := v_sql22||'                             1 ';
    v_sql22 := v_sql22||'                    ELSE ';
    v_sql22 := v_sql22||'                    NULL ';
    v_sql22 := v_sql22||'                END ';
    v_sql22 := v_sql22||'          ) AS CASH_CNT_3, ';
    v_sql22 := v_sql22||'        SUM (  CASE ';
    v_sql22 := v_sql22||'               WHEN ';
    v_sql22 := v_sql22||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 3 ';
    v_sql22 := v_sql22||'                    THEN ';
    v_sql22 := v_sql22||'                             CASE ';
    v_sql22 := v_sql22||'                               WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql22 := v_sql22||'                                 ELSE E.BILL_AMT ';
    v_sql22 := v_sql22||'                     END ';
    v_sql22 := v_sql22||'                ELSE ';
    v_sql22 := v_sql22||'                    0 ';
    v_sql22 := v_sql22||'                END) ';
    v_sql22 := v_sql22||'           AS CASH_4, ';
    v_sql22 := v_sql22||'          COUNT ( CASE ';
    v_sql22 := v_sql22||'               WHEN ';
    v_sql22 := v_sql22||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 3 ';
    v_sql22 := v_sql22||'                    THEN ';
    v_sql22 := v_sql22||'                             1 ';
    v_sql22 := v_sql22||'                    ELSE ';
    v_sql22 := v_sql22||'                    NULL ';
    v_sql22 := v_sql22||'                END ';
    v_sql22 := v_sql22||'          ) AS CASH_CNT_4, ';
    v_sql22 := v_sql22||'        SUM (  CASE ';
    v_sql22 := v_sql22||'               WHEN ';
    v_sql22 := v_sql22||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 4 ';
    v_sql22 := v_sql22||'                    THEN ';
    v_sql22 := v_sql22||'                             CASE ';
    v_sql22 := v_sql22||'                               WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql22 := v_sql22||'                                 ELSE E.BILL_AMT ';
    v_sql22 := v_sql22||'                     END ';
    v_sql22 := v_sql22||'                ELSE ';
    v_sql22 := v_sql22||'                    0 ';
    v_sql22 := v_sql22||'                END) ';
    v_sql22 := v_sql22||'           AS CASH_5, ';
    v_sql22 := v_sql22||'          COUNT ( CASE ';
    v_sql22 := v_sql22||'               WHEN ';
    v_sql22 := v_sql22||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 4 ';
    v_sql22 := v_sql22||'                    THEN ';
    v_sql22 := v_sql22||'                             1 ';
    v_sql22 := v_sql22||'                    ELSE ';
    v_sql22 := v_sql22||'                    NULL ';
    v_sql22 := v_sql22||'                END ';
    v_sql22 := v_sql22||'          ) AS CASH_CNT_5, ';
    v_sql22 := v_sql22||'        SUM (  CASE ';
    v_sql22 := v_sql22||'               WHEN ';
    v_sql22 := v_sql22||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 5 ';
    v_sql22 := v_sql22||'                    THEN ';
    v_sql22 := v_sql22||'                             CASE ';
    v_sql22 := v_sql22||'                               WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql22 := v_sql22||'                                 ELSE E.BILL_AMT ';
    v_sql22 := v_sql22||'                     END ';
    v_sql22 := v_sql22||'                ELSE ';
    v_sql22 := v_sql22||'                    0 ';
    v_sql22 := v_sql22||'                END) ';
    v_sql22 := v_sql22||'           AS CASH_6, ';
    v_sql22 := v_sql22||'          COUNT ( CASE ';
    v_sql22 := v_sql22||'               WHEN ';
    v_sql22 := v_sql22||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR - 5 ';
    v_sql22 := v_sql22||'                    THEN ';
    v_sql22 := v_sql22||'                             1 ';
    v_sql22 := v_sql22||'                    ELSE ';
    v_sql22 := v_sql22||'                    NULL ';
    v_sql22 := v_sql22||'                END ';
    v_sql22 := v_sql22||'          ) AS CASH_CNT_6, ';
    v_sql22 := v_sql22||'        SUM (  CASE ';
    v_sql22 := v_sql22||'               WHEN ';
    v_sql22 := v_sql22||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR + 1 ';
    v_sql22 := v_sql22||'                    THEN ';
    v_sql22 := v_sql22||'                             CASE ';
    v_sql22 := v_sql22||'                               WHEN E.BILL_AMTFLAG = ''-'' THEN E.BILL_AMT * -1 ';
    v_sql22 := v_sql22||'                                 ELSE E.BILL_AMT ';
    v_sql22 := v_sql22||'                     END ';
    v_sql22 := v_sql22||'                ELSE ';
    v_sql22 := v_sql22||'                    0 ';
    v_sql22 := v_sql22||'                END) ';
    v_sql22 := v_sql22||'           AS CASH_0, ';
    v_sql22 := v_sql22||'          COUNT ( CASE ';
    v_sql22 := v_sql22||'               WHEN ';
    v_sql22 := v_sql22||'                        (E.MONTH_NBR + 0) = A.CLOSE_CYCLE_NBR + 1 ';
    v_sql22 := v_sql22||'                    THEN ';
    v_sql22 := v_sql22||'                             1 ';
    v_sql22 := v_sql22||'                    ELSE ';
    v_sql22 := v_sql22||'                    NULL ';
    v_sql22 := v_sql22||'                END ';
    v_sql22 := v_sql22||'          ) AS CASH_CNT_0 ';
    v_sql22 := v_sql22||'   FROM FDM_S24_EVENT E, TEMP_ACCT_CDATE A ';
    v_sql22 := v_sql22||'  WHERE     E.trans_type BETWEEN 2000 AND 2999 ';
    v_sql22 := v_sql22||'        AND E.MONTH_NBR <= A.CLOSE_CYCLE_NBR + 1 ';
    v_sql22 := v_sql22||'        AND E.MONTH_NBR >= A.CLOSE_CYCLE_NBR -5 ';
    v_sql22 := v_sql22||'        AND (coal(E.rev_ind,'' '') <> ''1'' or (E.rev_ind + 0) is null) ';
    v_sql22 := v_sql22||'        AND E.acctnbr = A.xaccount ';
    v_sql22 := v_sql22||'  GROUP BY E.ACCTNBR ';

          DBMS_OUTPUT.PUT_LINE('temp_event_cash_6m after:==========' || v_sql22);

          execute immediate v_sql22;

          DBMS_OUTPUT.PUT_LINE('temp_event_cash_6m over:==========success!');

    	     --删除批次已经加载的数据
       EXECUTE IMMEDIATE ('truncate table  ACCOUNT');

       DBMS_OUTPUT.PUT_LINE('ACCOUNT before:=========' || v_sql23);

       --信用卡账户层当前数据处理
    v_sql23 := ' INSERT INTO ACCOUNT ';
    v_sql23 := v_sql23||' SELECT T1.CUSTR_NBR, ';
    v_sql23 := v_sql23||'      T1.XACCOUNT, ';
    v_sql23 := v_sql23||'      T12.BADPUR, ';
    v_sql23 := v_sql23||'      T12.PUR, ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      COAL (T10.eventcounts, 0) + COAL (mpaudata.mpaucounts, 0), ';
    v_sql23 := v_sql23||'      t20.active_day, ';
    v_sql23 := v_sql23||'      CASE ';
    v_sql23 := v_sql23||'         WHEN t20.active_day = 0 ';
    v_sql23 := v_sql23||'         THEN ';
    v_sql23 := v_sql23||'            -9999 ';
    v_sql23 := v_sql23||'         ELSE ';
    v_sql23 := v_sql23||'       CEIL(date_diff(SYSDATE(),toDate(t20.active_day, ''yyyy-mm-dd''))) ';
    v_sql23 := v_sql23||'      END, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      T5.CURR_TERM, ';
    v_sql23 := v_sql23||'      T1.CYCLE_DATE, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      T4.YYYYMM_BIRTH, ';
    v_sql23 := v_sql23||'      T4.YYYYMMDD_BIRTH, ';
    v_sql23 := v_sql23||'      T5.PAST13_AC_LINS_FLG, ';
    v_sql23 := v_sql23||'      T5.CU_LINS_CUR_FLG, ';
    v_sql23 := v_sql23||'      T8.MP_L_LMT, ';
    v_sql23 := v_sql23||'      T5.LINS_DATE_END, ';
    v_sql23 := v_sql23||'      T5.LINS_DATE_ST, ';
    v_sql23 := v_sql23||'      ''01'', ';
    v_sql23 := v_sql23||'      T5.LINS_TERM, ';
    v_sql23 := v_sql23||'      T5.LINS_REM_TERM, ';
    v_sql23 := v_sql23||'      T5.LINS_UNSH_PRINCIPAL, ';
    v_sql23 := v_sql23||'      T5.LINS_SH_UNPAY_PRINCIPAL_BIG, ';
    v_sql23 := v_sql23||'      T5.LINS_SH_UNPAY_BAL, ';
    v_sql23 := v_sql23||'      T5.LINS_STATUS, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      T4.APP_CORPTYPE, ';
    v_sql23 := v_sql23||'      T12.mcc90sum + T12.mcc55sum + T12.jw120sum + T12.dlsum, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      T1.CURR_OVD_STATUS, ';
    v_sql23 := v_sql23||'      T1.LINS_CUR_SH_AMT, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      '' '', ';
    v_sql23 := v_sql23||'      T1.HISTUPDATEDLIMITTYPE, ';
    v_sql23 := v_sql23||'      T1.LIMITUSAGE, ';
    v_sql23 := v_sql23||'      T1.BRANCH, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      T6.PRODUCT, ';
    v_sql23 := v_sql23||'      T12.mcc90count + T12.mcc55count + T12.jw120count + T12.dlcount, ';
    v_sql23 := v_sql23||'      T6.FIRSTPAYMENT, ';
    v_sql23 := v_sql23||'      T7.APP_SUPP_BIRTHDATE, ';
    v_sql23 := v_sql23||'      T7.APP_RELATION_SUPP, ';
    v_sql23 := v_sql23||'      T7.EMPLOYERGEOCODE, ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      T1.STMTUTILITY_AVE_L12M, ';
    v_sql23 := v_sql23||'      T1.STMTREPAYRATIO_L12M, ';
    v_sql23 := v_sql23||'      T1.PAST12_REPAY_AVG_RATIO, ';
    v_sql23 := v_sql23||'      T1.STMTFEEACCOUR_L12M, ';
    v_sql23 := v_sql23||'      T1.PAST12_GET_CASH_COUNT, ';
    v_sql23 := v_sql23||'      T1.COLLECTTEMPLATE, ';
    v_sql23 := v_sql23||'      T1.PAST12_MAX_DUE_MTHS, ';
    v_sql23 := v_sql23||'      T1.STMTBALINCREASEMONTH_L12M, ';
    v_sql23 := v_sql23||'      T1.PAST3_DUE_COUNT, ';
    v_sql23 := v_sql23||'      T1.PAST3_CREDIT_USE_RATIO, ';
    v_sql23 := v_sql23||'      T1.PAST3_CREDIT_USE_RATIO_MAX, ';
    v_sql23 := v_sql23||'      T1.PAST3_PAY_AMT_MTHS, ';
    v_sql23 := v_sql23||'      T21.cash_cnt_1 + T21.cash_cnt_0, ';
    v_sql23 := v_sql23||'      T21.cash_cnt_2, ';
    v_sql23 := v_sql23||'      T21.cash_cnt_3, ';
    v_sql23 := v_sql23||'      T1.STMTUTILITY_AVE_L3M, ';
    v_sql23 := v_sql23||'      T1.STMTCASHINCREASERATIO, ';
    v_sql23 := v_sql23||'      T1.PAST3_GET_CASH_RATIO, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      T1.STMTUTILITY_AVE_L6M, ';
    v_sql23 := v_sql23||'      T1.STMTREPAYRATIO10MONTH_L6M, ';
    v_sql23 := v_sql23||'      T1.STMTREPAYRATIO_L6M, ';
    v_sql23 := v_sql23||'      T1.STMTREWARD_AVE_L6M, ';
    v_sql23 := v_sql23||'      COAL (T11.INCOME, 0), ';
    v_sql23 := v_sql23||'      T1.PAST6_FEE_COUNT, ';
    v_sql23 := v_sql23||'      T1.STMTFEEINCREASEMONTH_L6M, ';
    v_sql23 := v_sql23||'      T1.STMTSUMCASH_L6M, ';
    v_sql23 := v_sql23||'      T1.STMTCASHADVANCEMONTH_L6M, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      T1.STMTSUMCONSUME_L6M, ';
    v_sql23 := v_sql23||'      T1.PAST6_DUE_COUNT_MAX, ';
    v_sql23 := v_sql23||'      T4.ACCTBLACKLIST, ';
    v_sql23 := v_sql23||'      T4.ACCTWHITELIST, ';
    v_sql23 := v_sql23||'      T4.MARRIAGE, ';
    v_sql23 := v_sql23||'      T4.EDUCATION_LEVEL, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      T1.ARREARINCREASE_L12M, ';
    v_sql23 := v_sql23||'      COAL(T13.pur_1,0), ';
    v_sql23 := v_sql23||'      COAL(T13.pur_2,0), ';
    v_sql23 := v_sql23||'      COAL(T13.pur_3,0), ';
    v_sql23 := v_sql23||'      COAL(T13.pur_4,0), ';
    v_sql23 := v_sql23||'      COAL(T13.pur_5,0), ';
    v_sql23 := v_sql23||'      COAL(T13.pur_6,0), ';
    v_sql23 := v_sql23||'      COAL(T13.badpur_1,0) + COAL(T13.BXJY_PUR_1,0), ';
    v_sql23 := v_sql23||'      COAL(T13.badpur_2,0) + COAL(T13.BXJY_PUR_2,0), ';
    v_sql23 := v_sql23||'      COAL(T13.badpur_3,0) + COAL(T13.BXJY_PUR_3,0), ';
    v_sql23 := v_sql23||'      COAL(T13.badpur_4,0) + COAL(T13.BXJY_PUR_4,0), ';
    v_sql23 := v_sql23||'      COAL(T13.badpur_5,0) + COAL(T13.BXJY_PUR_5,0), ';
    v_sql23 := v_sql23||'      COAL(T13.badpur_6,0) + COAL(T13.BXJY_PUR_6,0), ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_ALOP_AMT_1, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_ALOP_AMT_2, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_ALOP_AMT_3, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_ALOP_AMT_4, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_ALOP_AMT_5, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_ALOP_AMT_6, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_ALOP_AMT_7, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_ALOP_AMT_8, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_ALOP_AMT_9, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_ALOP_AMT_10, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_ALOP_AMT_11, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_ALOP_AMT_12, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_ALOP_AMT_13, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_ALOP_OVR_INT_1, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_ALOP_OVR_INT_2, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_ALOP_OVR_INT_3, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_ALOP_OVR_INT_4, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_ALOP_OVR_INT_5, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_ALOP_OVR_INT_6, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_ALOP_OVR_INT_7, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_ALOP_OVR_INT_8, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_ALOP_OVR_INT_9, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_ALOP_OVR_INT_10, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_ALOP_OVR_INT_11, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_ALOP_OVR_INT_12, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_ALOP_OVR_INT_13, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPPCATALOG_CONSU_1, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPPCATALOG_CONSU_2, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPPCATALOG_CONSU_3, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPPCATALOG_CONSU_4, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPPCATALOG_CONSU_5, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPPCATALOG_CONSU_6, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPPCATALOG_CONSU_7, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPPCATALOG_CONSU_8, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPPCATALOG_CONSU_9, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPPCATALOG_CONSU_10, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPPCATALOG_CONSU_11, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPPCATALOG_CONSU_12, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPPCATALOG_CONSU_13, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPP_OVR_INT_1, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPP_OVR_INT_2, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPP_OVR_INT_3, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPP_OVR_INT_4, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPP_OVR_INT_5, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPP_OVR_INT_6, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPP_OVR_INT_7, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPP_OVR_INT_8, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPP_OVR_INT_9, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPP_OVR_INT_10, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPP_OVR_INT_11, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPP_OVR_INT_12, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPP_OVR_INT_13, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPP_RETURN_1, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPP_RETURN_2, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPP_RETURN_3, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPP_RETURN_4, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPP_RETURN_5, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPP_RETURN_6, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPP_RETURN_7, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPP_RETURN_8, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPP_RETURN_9, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPP_RETURN_10, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPP_RETURN_11, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPP_RETURN_12, ';
    v_sql23 := v_sql23||'      T5.LAST_13MON_EPP_RETURN_13, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_RETAIL_AMT_1, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_RETAIL_AMT_2, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_RETAIL_AMT_3, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_RETAIL_AMT_4, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_RETAIL_AMT_5, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_RETAIL_AMT_6, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_RETAIL_AMT_7, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_RETAIL_AMT_8, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_RETAIL_AMT_9, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_RETAIL_AMT_10, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_RETAIL_AMT_11, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_RETAIL_AMT_12, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_RETAIL_AMT_13, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_REPAYMENT_1, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_REPAYMENT_2, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_REPAYMENT_3, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_REPAYMENT_4, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_REPAYMENT_5, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_REPAYMENT_6, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_REPAYMENT_7, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_REPAYMENT_8, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_REPAYMENT_9, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_REPAYMENT_10, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_REPAYMENT_11, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_REPAYMENT_12, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_REPAYMENT_13, ';
    v_sql23 := v_sql23||'      T21.cash_1, ';
    v_sql23 := v_sql23||'      T21.cash_2, ';
    v_sql23 := v_sql23||'      T21.cash_3, ';
    v_sql23 := v_sql23||'      T21.cash_4, ';
    v_sql23 := v_sql23||'      T21.cash_5, ';
    v_sql23 := v_sql23||'      T21.cash_6, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_CASH_7, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_CASH_8, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_CASH_9, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_CASH_10, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_CASH_11, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_CASH_12, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_CASH_13, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_CREDIT_AMT_1, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_CREDIT_AMT_2, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_CREDIT_AMT_3, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_CREDIT_AMT_4, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_CREDIT_AMT_5, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_CREDIT_AMT_6, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_CREDIT_AMT_7, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_CREDIT_AMT_8, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_CREDIT_AMT_9, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_CREDIT_AMT_10, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_CREDIT_AMT_11, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_CREDIT_AMT_12, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_CREDIT_AMT_13, ';
    v_sql23 := v_sql23||'      T5.LINS_SH_UNPAY_BAL_1, ';
    v_sql23 := v_sql23||'      T5.LINS_SH_UNPAY_BAL_2, ';
    v_sql23 := v_sql23||'      T5.LINS_SH_UNPAY_BAL_3, ';
    v_sql23 := v_sql23||'      T5.LINS_SH_UNPAY_BAL_4, ';
    v_sql23 := v_sql23||'      T5.LINS_SH_UNPAY_BAL_5, ';
    v_sql23 := v_sql23||'      T5.LINS_SH_UNPAY_BAL_6, ';
    v_sql23 := v_sql23||'      T5.LINS_SH_UNPAY_BAL_7, ';
    v_sql23 := v_sql23||'      T5.LINS_SH_UNPAY_BAL_8, ';
    v_sql23 := v_sql23||'      T5.LINS_SH_UNPAY_BAL_9, ';
    v_sql23 := v_sql23||'      T5.LINS_SH_UNPAY_BAL_10, ';
    v_sql23 := v_sql23||'      T5.LINS_SH_UNPAY_BAL_11, ';
    v_sql23 := v_sql23||'      T5.LINS_SH_UNPAY_BAL_12, ';
    v_sql23 := v_sql23||'      T5.LINS_SH_UNPAY_BAL_13, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_TEMP_AMT_1, ';
    v_sql23 := v_sql23||'      T20.TOP3SUM1, ';
    v_sql23 := v_sql23||'      T20.TOP3SUM2, ';
    v_sql23 := v_sql23||'      T20.TOP3SUM3, ';
    v_sql23 := v_sql23||'      T20.TOP3SUM4, ';
    v_sql23 := v_sql23||'      T20.TOP3SUM5, ';
    v_sql23 := v_sql23||'      T20.TOP3SUM6, ';
    v_sql23 := v_sql23||'      T20.SUM_AMT_1, ';
    v_sql23 := v_sql23||'      T20.SUM_AMT_2, ';
    v_sql23 := v_sql23||'      T20.SUM_AMT_3, ';
    v_sql23 := v_sql23||'      T20.SUM_AMT_4, ';
    v_sql23 := v_sql23||'      T20.SUM_AMT_5, ';
    v_sql23 := v_sql23||'      T20.SUM_AMT_6, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_BILL_AMT_1, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_BILL_AMT_2, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_BILL_AMT_3, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_BILL_AMT_4, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_BILL_AMT_5, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_BILL_AMT_6, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_BILL_AMT_7, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_BILL_AMT_8, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_BILL_AMT_9, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_BILL_AMT_10, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_BILL_AMT_11, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_BILL_AMT_12, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_BILL_AMT_13, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_LOWEST_REPAY_1, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_LOWEST_REPAY_2, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_LOWEST_REPAY_3, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_LOWEST_REPAY_4, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_LOWEST_REPAY_5, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_LOWEST_REPAY_6, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_LOWEST_REPAY_7, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_LOWEST_REPAY_8, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_LOWEST_REPAY_9, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_LOWEST_REPAY_10, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_LOWEST_REPAY_11, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_LOWEST_REPAY_12, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_LOWEST_REPAY_13, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_ACC_OVERRUN_FLAG_1, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_ACC_OVERRUN_FLAG_2, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_ACC_OVERRUN_FLAG_3, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_ACC_OVERRUN_FLAG_4, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_ACC_OVERRUN_FLAG_5, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_ACC_OVERRUN_FLAG_6, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_ACC_OVERRUN_FLAG_7, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_ACC_OVERRUN_FLAG_8, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_ACC_OVERRUN_FLAG_9, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_ACC_OVERRUN_FLAG_10, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_ACC_OVERRUN_FLAG_11, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_ACC_OVERRUN_FLAG_12, ';
    v_sql23 := v_sql23||'      T1.LAST_13MON_ACC_OVERRUN_FLAG_13, ';
    v_sql23 := v_sql23||'      T12.badmaxpur, ';
    v_sql23 := v_sql23||'      T1.LAST_24MON_OVD_FLAG_1, ';
    v_sql23 := v_sql23||'      T1.LAST_24MON_OVD_FLAG_2, ';
    v_sql23 := v_sql23||'      T1.LAST_24MON_OVD_FLAG_3, ';
    v_sql23 := v_sql23||'      T1.LAST_24MON_OVD_FLAG_4, ';
    v_sql23 := v_sql23||'      T1.LAST_24MON_OVD_FLAG_5, ';
    v_sql23 := v_sql23||'      T1.LAST_24MON_OVD_FLAG_6, ';
    v_sql23 := v_sql23||'      T1.LAST_24MON_OVD_FLAG_7, ';
    v_sql23 := v_sql23||'      T1.LAST_24MON_OVD_FLAG_8, ';
    v_sql23 := v_sql23||'      T1.LAST_24MON_OVD_FLAG_9, ';
    v_sql23 := v_sql23||'      T1.LAST_24MON_OVD_FLAG_10, ';
    v_sql23 := v_sql23||'      T1.LAST_24MON_OVD_FLAG_11, ';
    v_sql23 := v_sql23||'      T1.LAST_24MON_OVD_FLAG_12, ';
    v_sql23 := v_sql23||'      COAL (T11.GOODINCOME, 0), ';
    v_sql23 := v_sql23||'       (  2.2 * T12.MCC90SUM ';
    v_sql23 := v_sql23||'       + 0.72 * T12.MCC90NETSUM ';
    v_sql23 := v_sql23||'       +  2.0 * T12.MCC55SUM ';
    v_sql23 := v_sql23||'       + 0.48 * T12.MCC55NETSUM ';
    v_sql23 := v_sql23||'       + 0.18 * T12.MCC26SUM ';
    v_sql23 := v_sql23||'       + 0.18 * T12.MCC26NETSUM ';
    v_sql23 := v_sql23||'       + 2.8  * T12.JW120SUM ';
    v_sql23 := v_sql23||'       + 0.72 * T12.JW120NETSUM ';
    v_sql23 := v_sql23||'       + 1.6  * T12.DLSUM ';
    v_sql23 := v_sql23||'       + 0.48 * T12.DLNETSUM ';
    v_sql23 := v_sql23||'       + T12.dlcount_2 * 2100 ';
    v_sql23 := v_sql23||'       + T12.dlnetcount_2 * 2100) * 0.01 , ';
    v_sql23 := v_sql23||'      T20.OFFLINE_NODL_MERCHANT_CNT, ';
    v_sql23 := v_sql23||'      T12.GOODCNT, ';
    v_sql23 := v_sql23||'      T20.MERCHANTSUM6M, ';
    v_sql23 := v_sql23||'      T12.GAS_PUR, ';
    v_sql23 := v_sql23||'      T12.BX_PUR, ';
    v_sql23 := v_sql23||'      T12.GAS_CNT, ';
    v_sql23 := v_sql23||'      T12.BX_CNT, ';
    v_sql23 := v_sql23||'      T21.cash_cnt_4, ';
    v_sql23 := v_sql23||'      T21.cash_cnt_5, ';
    v_sql23 := v_sql23||'      T21.cash_cnt_6, ';
    v_sql23 := v_sql23||'      T1.LAST_6MON_INACTIVE_FLAG, ';
    v_sql23 := v_sql23||'      T1.ARREARINCREASE_L6M, ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      C2.CARD_NBR, ';
    v_sql23 := v_sql23||'      A1.PROD_NBR, ';
    v_sql23 := v_sql23||'      C2.CARD_BLOCK_CODES, ';
    v_sql23 := v_sql23||'      A1.PROD_LEVEL, ';
    v_sql23 := v_sql23||'      A1.DAY_OPENED, ';
    v_sql23 := v_sql23||'      T4.CUSTOMER_ID, ';
    v_sql23 := v_sql23||'      T4.APP_NATIONAL, ';
    v_sql23 := v_sql23||'      T4.CUSTINDUSTRY, ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      T4.RESTRICTIVETRADEFLAG, ';
    v_sql23 := v_sql23||'      T4.SENDINGMETHOD, ';
    v_sql23 := v_sql23||'      T4.CUSTTYPE, ';
    v_sql23 := v_sql23||'      T4.APP_RELATION_CONTACT, ';
    v_sql23 := v_sql23||'      T1.TEMP_LIMIT, ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      T2.ISSUERSUM, ';
    v_sql23 := v_sql23||'      T4.ANNUAL_INCOME, ';
    v_sql23 := v_sql23||'      T4.CARDAPP_INCOME, ';
    v_sql23 := v_sql23||'      T4.ACCTWHITELIST, ';
    v_sql23 := v_sql23||'      T2.CHANNEL_CODE, ';
    v_sql23 := v_sql23||'      T1.ACCTCASHADVANCE, ';
    v_sql23 := v_sql23||'      T5.LAST_ALOP_TRANSACTION, ';
    v_sql23 := v_sql23||'      T3.HISTUPDATEDTYPE, ';
    v_sql23 := v_sql23||'      T3.HISTUPDATEDDATE, ';
    v_sql23 := v_sql23||'      T3.LAST_BANK_ALOP_LINE, ';
    v_sql23 := v_sql23||'      T1.LAST_CYCLEDAY_CASH_TIMES, ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      T4.APPTYPE, ';
    v_sql23 := v_sql23||'      T5.AMOUNT, ';
    v_sql23 := v_sql23||'      T5.APP_TERMS, ';
    v_sql23 := v_sql23||'      T6.APP_CHANNEL, ';
    v_sql23 := v_sql23||'      T4.PBOC_REVOLVEGUARANTOR, ';
    v_sql23 := v_sql23||'      T4.APPID, ';
    v_sql23 := v_sql23||'      T4.MONTHLYSALARY, ';
    v_sql23 := v_sql23||'      T4.IDISSUEDGEOCODE, ';
    v_sql23 := v_sql23||'      T2.APP_BIZ, ';
    v_sql23 := v_sql23||'      T2.APP_JOINT, ';
    v_sql23 := v_sql23||'      T2.APP_EMPLOYEE, ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      T2.APP_EXISTINGCC, ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      T4.APP_CRITICALINDUSTRY, ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      T4.LOCALPROPERTYSIZE, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      T2.APP_APPDATE, ';
    v_sql23 := v_sql23||'      T6.LINS_REM_UNSH_PRINCIPAL, ';
    v_sql23 := v_sql23||'      T6.LINS_REM_UNSH_FEE, ';
    v_sql23 := v_sql23||'      T1.APP_AUTODEBIT, ';
    v_sql23 := v_sql23||'      T1.ANNUAL_FEE_OVD_FLAG, ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      T2.CCONUS, ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      T1.DEATH_EXCLUDE_FLAG, ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      T1.PRO_ACCTSTATUS_CC_EXISTING, ';
    v_sql23 := v_sql23||'      T1.ACCTSTATUS, ';
    v_sql23 := v_sql23||'      T1.APP_BRANCH, ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      T4.RACE_TYPE, ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      T2.PRO_EXPIREMONTHSLEFT, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      T1.LIMITCC, ';
    v_sql23 := v_sql23||'      C2.CCVALID_DATE, ';
    v_sql23 := v_sql23||'      T1.PRO_STATUS_ACCT, ';
    v_sql23 := v_sql23||'      T1.UTILIZATION, ';
    v_sql23 := v_sql23||'      T4.GENDER, ';
    v_sql23 := v_sql23||'      T6.LINS_SH_UNPAY_PRINCIPAL, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      A1.BAL_WO_AUTHS, ';
    v_sql23 := v_sql23||'      T1.COLLECTMETHODS, ';
    v_sql23 := v_sql23||'      T1.COLLECTTIMES, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      T2.PRO_STATUS_EXISTINGCC, ';
    v_sql23 := v_sql23||'      T1.PRO_CCSTATE, ';
    v_sql23 := v_sql23||'      T1.APP_CC_LIMIT_EXISTING, ';
    v_sql23 := v_sql23||'      T4.yeyyday, ';
    v_sql23 := v_sql23||'      T4.leyyday, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      T1.LONG_CRED_LIMIT, ';
    v_sql23 := v_sql23||'      T1.ACCTACCTLIMIT, ';
    v_sql23 := v_sql23||'      T4.CUSTR_NBR, ';
    v_sql23 := v_sql23||'      T1.BILL_TAG, ';
    v_sql23 := v_sql23||'      T1.CYCLE_DAY_ONLY, ';
    v_sql23 := v_sql23||'      T1.ACCOUNT_ID, ';
    v_sql23 := v_sql23||'      T1.ACCOUNT_LOGO, ';
    v_sql23 := v_sql23||'      T1.ACC_BLOCK_CODES1, ';
    v_sql23 := v_sql23||'      T1.ACC_BLOCK_CODES2, ';
    v_sql23 := v_sql23||'      T1.ACCTNUMB, ';
    v_sql23 := v_sql23||'      T4.DISPUTE_EXCLUDE_FLAG, ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      T4.PLEDGEVALUE, ';
    v_sql23 := v_sql23||'      T4.PLEDGETYPE, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      T12.JWRECENCY, ';
    v_sql23 := v_sql23||'      T1.PBOC_ACCTNUMB_UTILIZATION50UP, ';
    v_sql23 := v_sql23||'      T1.PBOC_ACCTAGE_HIGHEST, ';
    v_sql23 := v_sql23||'      T4.APP_RESIDENTIALSTATUS, ';
    v_sql23 := v_sql23||'      COAL(T13.pur_cnt_1,0), ';
    v_sql23 := v_sql23||'      COAL(T13.pur_cnt_2,0), ';
    v_sql23 := v_sql23||'      COAL(T13.pur_cnt_3,0), ';
    v_sql23 := v_sql23||'      COAL(T13.pur_cnt_4,0), ';
    v_sql23 := v_sql23||'      COAL(T13.pur_cnt_5,0), ';
    v_sql23 := v_sql23||'      COAL(T13.pur_cnt_6,0), ';
    v_sql23 := v_sql23||'      COAL(T13.PUR_CNT_NET_1,0), ';
    v_sql23 := v_sql23||'      COAL(T13.PUR_CNT_NET_2,0), ';
    v_sql23 := v_sql23||'      COAL(T13.PUR_CNT_NET_3,0), ';
    v_sql23 := v_sql23||'      COAL(T13.PUR_CNT_NET_4,0), ';
    v_sql23 := v_sql23||'      COAL(T13.PUR_CNT_NET_5,0), ';
    v_sql23 := v_sql23||'      COAL(T13.PUR_CNT_NET_6,0), ';
    v_sql23 := v_sql23||'      T20.MAX_AMT_1, ';
    v_sql23 := v_sql23||'      T20.MAX_AMT_2, ';
    v_sql23 := v_sql23||'      T20.MAX_AMT_3, ';
    v_sql23 := v_sql23||'      T20.MAX_AMT_4, ';
    v_sql23 := v_sql23||'      T20.MAX_AMT_5, ';
    v_sql23 := v_sql23||'      T20.MAX_AMT_6, ';
    v_sql23 := v_sql23||'      T20.CNT_1, ';
    v_sql23 := v_sql23||'      T20.CNT_2, ';
    v_sql23 := v_sql23||'      T20.CNT_3, ';
    v_sql23 := v_sql23||'      T20.CNT_4, ';
    v_sql23 := v_sql23||'      T20.CNT_5, ';
    v_sql23 := v_sql23||'      T20.CNT_6, ';
    v_sql23 := v_sql23||'      T1.UTILITY_AVE_L6M, ';
    v_sql23 := v_sql23||'      ''0'', ';
    v_sql23 := v_sql23||'      T3.LAST_CUS_PERM_LINE_INC, ';
    v_sql23 := v_sql23||'      T3.LAST_CUS_TEMP_LINE_ADJ, ';
    v_sql23 := v_sql23||'      T3.LAST_BANK_PERM_LINE_INC, ';
    v_sql23 := v_sql23||'      T3.LAST_BANK_TEMP_ADJ, ';
    v_sql23 := v_sql23||'      T1.LAST_BILL_ADDRESS_CHANGE, ';
    v_sql23 := v_sql23||'      T2.ACCTSUM_REPAYED, ';
    v_sql23 := v_sql23||'      CASE ';
    v_sql23 := v_sql23||'         WHEN (T5.XACCOUNT + 0) IS NOT NULL OR (T6.XACCOUNT + 0) IS NOT NULL ';
    v_sql23 := v_sql23||'         THEN ';
    v_sql23 := v_sql23||'            ''1'' ';
    v_sql23 := v_sql23||'         ELSE ';
    v_sql23 := v_sql23||'            ''0'' ';
    v_sql23 := v_sql23||'      END, ';
    v_sql23 := v_sql23||' 	 ''0'', ';
    v_sql23 := v_sql23||' 	 ''0'', ';
    v_sql23 := v_sql23||'      COAL (t8.MP_BAL, 0) + t8.MP_AUTHS, ';
    v_sql23 := v_sql23||'      COAL(A1.mp_rem_ppl,0) + COAL(A1.mp_auths,0) + COAL (t9.mount, 0) + COAL (t8.MP_BAL, 0) + COAL (t8.MP_AUTHS, 0), ';
    v_sql23 := v_sql23||' 	 ''0'', ';
    v_sql23 := v_sql23||'      T7.MAIN_CARD_NBR, ';
    v_sql23 := v_sql23||'      T7.MO_PHONE, ';
    v_sql23 := v_sql23||'      COAL(T13.PUR_0,0), ';
    v_sql23 := v_sql23||'      COAL(T13.badpur_0,0)+COAL(T13.BXJY_PUR_0,0), ';
    v_sql23 := v_sql23||'      t21.cash_0, ';
    v_sql23 := v_sql23||'      t20.top3sum0, ';
    v_sql23 := v_sql23||'      t20.SUM_AMT_0, ';
    v_sql23 := v_sql23||'      COAL(T13.pur_cnt_0,0), ';
    v_sql23 := v_sql23||'      COAL(T13.pur_cnt_net_0,0), ';
    v_sql23 := v_sql23||'      t20.MAX_AMT_0, ';
    v_sql23 := v_sql23||'      t20.CNT_0, ';
    v_sql23 := v_sql23||'      T1.open_bal_wo_pay_1, ';
    v_sql23 := v_sql23||'      T1.open_bal_wo_pay_2, ';
    v_sql23 := v_sql23||'      T1.open_bal_wo_pay_3, ';
    v_sql23 := v_sql23||'      T1.open_bal_wo_pay_4, ';
    v_sql23 := v_sql23||'      T1.open_bal_wo_pay_5, ';
    v_sql23 := v_sql23||'      T1.open_bal_wo_pay_6, ';
    v_sql23 := v_sql23||'      CASE ';
    v_sql23 := v_sql23||'         WHEN t20.active_day <= 0 ';
    v_sql23 := v_sql23||'         THEN ';
    v_sql23 := v_sql23||'            30001231 ';
    v_sql23 := v_sql23||'         ELSE ';
    v_sql23 := v_sql23||'             CASE ';
    v_sql23 := v_sql23||'                WHEN  T1.CYCLE_DAY_ONLY >=  SUBSTR (t20.active_day, 7, 2) ';
    v_sql23 := v_sql23||'                AND   T1.CYCLE_DAY_ONLY < 10 ';
    v_sql23 := v_sql23||'                THEN ';
    v_sql23 := v_sql23||'                     CONCAT ( ';
    v_sql23 := v_sql23||'                      SUBSTR (t20.active_day, 1, 6) ';
    v_sql23 := v_sql23||'                    , ''0'' ';
    v_sql23 := v_sql23||'                    , T1.CYCLE_DAY_ONLY) ';
    v_sql23 := v_sql23||'                WHEN  T1.CYCLE_DAY_ONLY >= SUBSTR (t20.active_day, 7, 2) ';
    v_sql23 := v_sql23||'                AND T1.CYCLE_DAY_ONLY >= 10 ';
    v_sql23 := v_sql23||'                THEN ';
    v_sql23 := v_sql23||'                     CONCAT ( ';
    v_sql23 := v_sql23||'                      SUBSTR (t20.active_day, 1, 6) ';
    v_sql23 := v_sql23||'                    , T1.CYCLE_DAY_ONLY) ';
    v_sql23 := v_sql23||'                WHEN ';
    v_sql23 := v_sql23||'                      T1.CYCLE_DAY_ONLY < SUBSTR (t20.active_day, 7, 2) ';
    v_sql23 := v_sql23||'                     AND T1.CYCLE_DAY_ONLY < 10 ';
    v_sql23 := v_sql23||'                THEN ';
    v_sql23 := v_sql23||'                   CONCAT ( ';
    v_sql23 := v_sql23||'                   toDate ( ADD_MONTHS ( toDate(t20.active_day, ''yyyy-mm-dd'') , +1 ) , ''yyyymm'') ';
    v_sql23 := v_sql23||'                      , ''0'' ';
    v_sql23 := v_sql23||'                      , T1.CYCLE_DAY_ONLY) ';
    v_sql23 := v_sql23||'                WHEN ';
    v_sql23 := v_sql23||'                      T1.CYCLE_DAY_ONLY < SUBSTR (t20.active_day, 7, 2) ';
    v_sql23 := v_sql23||'                     AND T1.CYCLE_DAY_ONLY >= 10 ';
    v_sql23 := v_sql23||'                THEN ';
    v_sql23 := v_sql23||'                   CONCAT ( ';
    v_sql23 := v_sql23||'                   toDate ( ADD_MONTHS ( toDate(t20.active_day, ''yyyy-mm-dd'') , +1 ) , ''yyyymm'') ';
    v_sql23 := v_sql23||'                      , T1.CYCLE_DAY_ONLY) ';
    v_sql23 := v_sql23||'             END ';
    v_sql23 := v_sql23||'      END , ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      T1.new_bal_1, ';
    v_sql23 := v_sql23||'      T1.new_bal_2, ';
    v_sql23 := v_sql23||'      T1.new_bal_3, ';
    v_sql23 := v_sql23||'      T1.new_bal_4, ';
    v_sql23 := v_sql23||'      T1.new_bal_5, ';
    v_sql23 := v_sql23||'      T1.new_bal_6, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      T13.GOODCNT_1, ';
    v_sql23 := v_sql23||'      T13.GOODCNT_2, ';
    v_sql23 := v_sql23||'      T13.GOODCNT_3, ';
    v_sql23 := v_sql23||'      T13.GOODCNT_4, ';
    v_sql23 := v_sql23||'      T13.GOODCNT_5, ';
    v_sql23 := v_sql23||'      T13.GOODCNT_6, ';
    v_sql23 := v_sql23||'      T13.GOODCNT_0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      T13.GOODSUM_1, ';
    v_sql23 := v_sql23||'      T13.GOODSUM_2, ';
    v_sql23 := v_sql23||'      T13.GOODSUM_3, ';
    v_sql23 := v_sql23||'      T13.GOODSUM_4, ';
    v_sql23 := v_sql23||'      T13.GOODSUM_5, ';
    v_sql23 := v_sql23||'      T13.GOODSUM_6, ';
    v_sql23 := v_sql23||'      T13.GOODSUM_0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0, ';
    v_sql23 := v_sql23||'      0  ';
    v_sql23 := v_sql23||' FROM MDM_ACCT_INFO T1 ';
    v_sql23 := v_sql23||'      LEFT JOIN MDM_ACCT_X A1 ON T1.XACCOUNT = A1.XACCOUNT ';
    v_sql23 := v_sql23||'      LEFT JOIN MDM_CARD_INFO T2 ';
    v_sql23 := v_sql23||'           ON T1.XACCOUNT = T2.XACCOUNT ';
    v_sql23 := v_sql23||'      LEFT JOIN MDM_CARD C2 ';
    v_sql23 := v_sql23||'           ON T1.XACCOUNT = C2.XACCOUNT ';
    v_sql23 := v_sql23||'      LEFT JOIN MDM_LIMIT_ADJ_INFO T3 ';
    v_sql23 := v_sql23||'           ON T1.XACCOUNT = T3.XACCOUNT ';
    v_sql23 := v_sql23||'      LEFT JOIN MDM_CUSTR_INFO T4 ';
    v_sql23 := v_sql23||'           ON T1.XACCOUNT = T4.XACCOUNT ';
    v_sql23 := v_sql23||'      LEFT JOIN MDM_MP_INFO T5 ';
    v_sql23 := v_sql23||'           ON T1.XACCOUNT = T5.XACCOUNT ';
    v_sql23 := v_sql23||'      LEFT JOIN MDM_COMMON_MP_INFO T6 ';
    v_sql23 := v_sql23||'           ON T1.XACCOUNT = T6.XACCOUNT ';
    v_sql23 := v_sql23||'      LEFT JOIN MDM_CARD_CUSTR_INFO T7 ';
    v_sql23 := v_sql23||'           ON T1.XACCOUNT = T7.XACCOUNT ';
    v_sql23 := v_sql23||'      LEFT JOIN FDM_S24_CUR_ACCA t8 ';
    v_sql23 := v_sql23||'           ON T8.XACCOUNT = T1.XACCOUNT ';
    v_sql23 := v_sql23||'      LEFT JOIN ';
    v_sql23 := v_sql23||'      (SELECT (  ACCX.MP_REM_PPL * prmxr.RATE_VAL0 ';
    v_sql23 := v_sql23||'               + ACCX.MP_AUTHS * prmxr.RATE_VAL0) ';
    v_sql23 := v_sql23||'                 mount, ';
    v_sql23 := v_sql23||'              accx.XACCOUNT XACCOUNT ';
    v_sql23 := v_sql23||'         FROM FDM_S24_CUR_ACCX accx, V_PRMXR prmxr ';
    v_sql23 := v_sql23||'        WHERE     ACCX.BANK = prmxr.BANK ';
    v_sql23 := v_sql23||'              AND ACCX.CURR_NUM = PRMXR.CURR_NUM) t9 ';
    v_sql23 := v_sql23||'         ON T9.XACCOUNT = T1.XACCOUNT ';
    v_sql23 := v_sql23||'      LEFT JOIN temp_event_counts T10 ON T10.ACCTNBR = T1.XACCOUNT ';
    v_sql23 := v_sql23||'      LEFT JOIN temp_event_income T11 ON T11.ACCTNBR = T1.XACCOUNT ';
    v_sql23 := v_sql23||'      LEFT JOIN ';
    v_sql23 := v_sql23||'      (  SELECT mpau.ACCOUNT AS acctnum, COUNT (1) AS mpaucounts ';
    v_sql23 := v_sql23||'           FROM V_FDM_S24_MPAU mpau ';
    v_sql23 := v_sql23||'          WHERE     todate(mpau.end_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -6) ';
    v_sql23 := v_sql23||'                AND todate(mpau.end_DATE,''yyyy-mm-dd'') <= SYSDATE() ';
    v_sql23 := v_sql23||'                AND MPAU.MPAU_STS IN (10, ';
    v_sql23 := v_sql23||'                                      20, ';
    v_sql23 := v_sql23||'                                      30, ';
    v_sql23 := v_sql23||'                                      40) ';
    v_sql23 := v_sql23||'       GROUP BY mpau.ACCOUNT) mpaudata ';
    v_sql23 := v_sql23||'         ON mpaudata.acctnum = T1.XACCOUNT ';
    v_sql23 := v_sql23||'       left join temp_event_pur t12 on T12.XACCOUNT=t1.XACCOUNT ';
    v_sql23 := v_sql23||'       left join temp_event_pur_6m t13 on t13.acctnbr = t1.xaccount ';
    v_sql23 := v_sql23||'       left join TEMP_EVENT_PUR_TOP3SUM t20 on t20.acctnbr = t1.xaccount ';
    v_sql23 := v_sql23||'       left join TEMP_EVENT_CASH_6M t21 on t21.acctnbr = t1.xaccount ';

        DBMS_OUTPUT.PUT_LINE('account after:==========' || v_sql23);

        execute immediate v_sql23;

        DBMS_OUTPUT.PUT_LINE('account over:==========success!');

    	   --删除批次已经加载的数据
       EXECUTE IMMEDIATE ('truncate table  ACCOUNT_SP');

       DBMS_OUTPUT.PUT_LINE('ACCOUNT_SP before:=========' || v_sql24);

       --------------  信用卡账户层当前数据处理
    v_sql24 := ' INSERT INTO ACCOUNT_SP ';
    v_sql24 := v_sql24||' SELECT T1.CUSTR_NBR, ';
    v_sql24 := v_sql24||'      T1.XACCOUNT, ';
    v_sql24 := v_sql24||'      T12.BADPUR, ';
    v_sql24 := v_sql24||'      T12.PUR, ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      COAL (T10.eventcounts, 0) + COAL (mpaudata.mpaucounts, 0), ';
    v_sql24 := v_sql24||'      t20.active_day, ';
    v_sql24 := v_sql24||'      CASE ';
    v_sql24 := v_sql24||'         WHEN t20.active_day = 0 ';
    v_sql24 := v_sql24||'         THEN ';
    v_sql24 := v_sql24||'            -9999 ';
    v_sql24 := v_sql24||'         ELSE ';
    v_sql24 := v_sql24||'       CEIL(date_diff(SYSDATE(),toDate(t20.active_day, ''yyyy-mm-dd''))) ';
    v_sql24 := v_sql24||'      END, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      T5.CURR_TERM, ';
    v_sql24 := v_sql24||'      T1.CYCLE_DATE, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      T4.YYYYMM_BIRTH, ';
    v_sql24 := v_sql24||'      T4.YYYYMMDD_BIRTH, ';
    v_sql24 := v_sql24||'      T5.PAST13_AC_LINS_FLG, ';
    v_sql24 := v_sql24||'      T5.CU_LINS_CUR_FLG, ';
    v_sql24 := v_sql24||'      T8.MP_L_LMT, ';
    v_sql24 := v_sql24||'      T5.LINS_DATE_END, ';
    v_sql24 := v_sql24||'      T5.LINS_DATE_ST, ';
    v_sql24 := v_sql24||'      ''01'', ';
    v_sql24 := v_sql24||'      T5.LINS_TERM, ';
    v_sql24 := v_sql24||'      T5.LINS_REM_TERM, ';
    v_sql24 := v_sql24||'      T5.LINS_UNSH_PRINCIPAL, ';
    v_sql24 := v_sql24||'      T5.LINS_SH_UNPAY_PRINCIPAL_BIG, ';
    v_sql24 := v_sql24||'      T5.LINS_SH_UNPAY_BAL, ';
    v_sql24 := v_sql24||'      T5.LINS_STATUS, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      T4.APP_CORPTYPE, ';
    v_sql24 := v_sql24||'      T12.mcc90sum + T12.mcc55sum + T12.jw120sum + T12.dlsum, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      T1.CURR_OVD_STATUS, ';
    v_sql24 := v_sql24||'      T1.LINS_CUR_SH_AMT, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      '' '', ';
    v_sql24 := v_sql24||'      T1.HISTUPDATEDLIMITTYPE, ';
    v_sql24 := v_sql24||'      T1.LIMITUSAGE, ';
    v_sql24 := v_sql24||'      T1.BRANCH, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      T6.PRODUCT, ';
    v_sql24 := v_sql24||'      T12.mcc90count + T12.mcc55count + T12.jw120count + T12.dlcount, ';
    v_sql24 := v_sql24||'      T6.FIRSTPAYMENT, ';
    v_sql24 := v_sql24||'      T7.APP_SUPP_BIRTHDATE, ';
    v_sql24 := v_sql24||'      T7.APP_RELATION_SUPP, ';
    v_sql24 := v_sql24||'      T7.EMPLOYERGEOCODE, ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      T1.STMTUTILITY_AVE_L12M, ';
    v_sql24 := v_sql24||'      T1.STMTREPAYRATIO_L12M, ';
    v_sql24 := v_sql24||'      T1.PAST12_REPAY_AVG_RATIO, ';
    v_sql24 := v_sql24||'      T1.STMTFEEACCOUR_L12M, ';
    v_sql24 := v_sql24||'      T1.PAST12_GET_CASH_COUNT, ';
    v_sql24 := v_sql24||'      T1.COLLECTTEMPLATE, ';
    v_sql24 := v_sql24||'      T1.PAST12_MAX_DUE_MTHS, ';
    v_sql24 := v_sql24||'      T1.STMTBALINCREASEMONTH_L12M, ';
    v_sql24 := v_sql24||'      T1.PAST3_DUE_COUNT, ';
    v_sql24 := v_sql24||'      T1.PAST3_CREDIT_USE_RATIO, ';
    v_sql24 := v_sql24||'      T1.PAST3_CREDIT_USE_RATIO_MAX, ';
    v_sql24 := v_sql24||'      T1.PAST3_PAY_AMT_MTHS, ';
    v_sql24 := v_sql24||'      T21.cash_cnt_1 + T21.cash_cnt_0, ';
    v_sql24 := v_sql24||'      T21.cash_cnt_2, ';
    v_sql24 := v_sql24||'      T21.cash_cnt_3, ';
    v_sql24 := v_sql24||'      T1.STMTUTILITY_AVE_L3M, ';
    v_sql24 := v_sql24||'      T1.STMTCASHINCREASERATIO, ';
    v_sql24 := v_sql24||'      T1.PAST3_GET_CASH_RATIO, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      T1.STMTUTILITY_AVE_L6M, ';
    v_sql24 := v_sql24||'      T1.STMTREPAYRATIO10MONTH_L6M, ';
    v_sql24 := v_sql24||'      T1.STMTREPAYRATIO_L6M, ';
    v_sql24 := v_sql24||'      T1.STMTREWARD_AVE_L6M, ';
    v_sql24 := v_sql24||'      COAL (T11.INCOME, 0), ';
    v_sql24 := v_sql24||'      T1.PAST6_FEE_COUNT, ';
    v_sql24 := v_sql24||'      T1.STMTFEEINCREASEMONTH_L6M, ';
    v_sql24 := v_sql24||'      T1.STMTSUMCASH_L6M, ';
    v_sql24 := v_sql24||'      T1.STMTCASHADVANCEMONTH_L6M, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      T1.STMTSUMCONSUME_L6M, ';
    v_sql24 := v_sql24||'      T1.PAST6_DUE_COUNT_MAX, ';
    v_sql24 := v_sql24||'      T4.ACCTBLACKLIST, ';
    v_sql24 := v_sql24||'      T4.ACCTWHITELIST, ';
    v_sql24 := v_sql24||'      T4.MARRIAGE, ';
    v_sql24 := v_sql24||'      T4.EDUCATION_LEVEL, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      T1.ARREARINCREASE_L12M, ';
    v_sql24 := v_sql24||'      COAL(T13.pur_1,0), ';
    v_sql24 := v_sql24||'      COAL(T13.pur_2,0), ';
    v_sql24 := v_sql24||'      COAL(T13.pur_3,0), ';
    v_sql24 := v_sql24||'      COAL(T13.pur_4,0), ';
    v_sql24 := v_sql24||'      COAL(T13.pur_5,0), ';
    v_sql24 := v_sql24||'      COAL(T13.pur_6,0), ';
    v_sql24 := v_sql24||'      COAL(T13.badpur_1,0) + COAL(T13.BXJY_PUR_1,0), ';
    v_sql24 := v_sql24||'      COAL(T13.badpur_2,0) + COAL(T13.BXJY_PUR_2,0), ';
    v_sql24 := v_sql24||'      COAL(T13.badpur_3,0) + COAL(T13.BXJY_PUR_3,0), ';
    v_sql24 := v_sql24||'      COAL(T13.badpur_4,0) + COAL(T13.BXJY_PUR_4,0), ';
    v_sql24 := v_sql24||'      COAL(T13.badpur_5,0) + COAL(T13.BXJY_PUR_5,0), ';
    v_sql24 := v_sql24||'      COAL(T13.badpur_6,0) + COAL(T13.BXJY_PUR_6,0), ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_ALOP_AMT_1, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_ALOP_AMT_2, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_ALOP_AMT_3, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_ALOP_AMT_4, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_ALOP_AMT_5, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_ALOP_AMT_6, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_ALOP_AMT_7, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_ALOP_AMT_8, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_ALOP_AMT_9, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_ALOP_AMT_10, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_ALOP_AMT_11, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_ALOP_AMT_12, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_ALOP_AMT_13, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_ALOP_OVR_INT_1, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_ALOP_OVR_INT_2, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_ALOP_OVR_INT_3, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_ALOP_OVR_INT_4, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_ALOP_OVR_INT_5, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_ALOP_OVR_INT_6, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_ALOP_OVR_INT_7, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_ALOP_OVR_INT_8, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_ALOP_OVR_INT_9, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_ALOP_OVR_INT_10, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_ALOP_OVR_INT_11, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_ALOP_OVR_INT_12, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_ALOP_OVR_INT_13, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPPCATALOG_CONSU_1, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPPCATALOG_CONSU_2, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPPCATALOG_CONSU_3, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPPCATALOG_CONSU_4, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPPCATALOG_CONSU_5, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPPCATALOG_CONSU_6, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPPCATALOG_CONSU_7, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPPCATALOG_CONSU_8, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPPCATALOG_CONSU_9, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPPCATALOG_CONSU_10, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPPCATALOG_CONSU_11, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPPCATALOG_CONSU_12, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPPCATALOG_CONSU_13, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPP_OVR_INT_1, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPP_OVR_INT_2, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPP_OVR_INT_3, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPP_OVR_INT_4, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPP_OVR_INT_5, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPP_OVR_INT_6, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPP_OVR_INT_7, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPP_OVR_INT_8, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPP_OVR_INT_9, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPP_OVR_INT_10, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPP_OVR_INT_11, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPP_OVR_INT_12, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPP_OVR_INT_13, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPP_RETURN_1, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPP_RETURN_2, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPP_RETURN_3, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPP_RETURN_4, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPP_RETURN_5, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPP_RETURN_6, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPP_RETURN_7, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPP_RETURN_8, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPP_RETURN_9, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPP_RETURN_10, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPP_RETURN_11, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPP_RETURN_12, ';
    v_sql24 := v_sql24||'      T5.LAST_13MON_EPP_RETURN_13, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_RETAIL_AMT_1, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_RETAIL_AMT_2, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_RETAIL_AMT_3, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_RETAIL_AMT_4, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_RETAIL_AMT_5, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_RETAIL_AMT_6, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_RETAIL_AMT_7, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_RETAIL_AMT_8, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_RETAIL_AMT_9, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_RETAIL_AMT_10, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_RETAIL_AMT_11, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_RETAIL_AMT_12, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_RETAIL_AMT_13, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_REPAYMENT_1, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_REPAYMENT_2, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_REPAYMENT_3, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_REPAYMENT_4, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_REPAYMENT_5, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_REPAYMENT_6, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_REPAYMENT_7, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_REPAYMENT_8, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_REPAYMENT_9, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_REPAYMENT_10, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_REPAYMENT_11, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_REPAYMENT_12, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_REPAYMENT_13, ';
    v_sql24 := v_sql24||'      T21.cash_1, ';
    v_sql24 := v_sql24||'      T21.cash_2, ';
    v_sql24 := v_sql24||'      T21.cash_3, ';
    v_sql24 := v_sql24||'      T21.cash_4, ';
    v_sql24 := v_sql24||'      T21.cash_5, ';
    v_sql24 := v_sql24||'      T21.cash_6, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_CASH_7, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_CASH_8, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_CASH_9, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_CASH_10, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_CASH_11, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_CASH_12, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_CASH_13, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_CREDIT_AMT_1, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_CREDIT_AMT_2, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_CREDIT_AMT_3, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_CREDIT_AMT_4, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_CREDIT_AMT_5, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_CREDIT_AMT_6, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_CREDIT_AMT_7, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_CREDIT_AMT_8, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_CREDIT_AMT_9, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_CREDIT_AMT_10, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_CREDIT_AMT_11, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_CREDIT_AMT_12, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_CREDIT_AMT_13, ';
    v_sql24 := v_sql24||'      T5.LINS_SH_UNPAY_BAL_1, ';
    v_sql24 := v_sql24||'      T5.LINS_SH_UNPAY_BAL_2, ';
    v_sql24 := v_sql24||'      T5.LINS_SH_UNPAY_BAL_3, ';
    v_sql24 := v_sql24||'      T5.LINS_SH_UNPAY_BAL_4, ';
    v_sql24 := v_sql24||'      T5.LINS_SH_UNPAY_BAL_5, ';
    v_sql24 := v_sql24||'      T5.LINS_SH_UNPAY_BAL_6, ';
    v_sql24 := v_sql24||'      T5.LINS_SH_UNPAY_BAL_7, ';
    v_sql24 := v_sql24||'      T5.LINS_SH_UNPAY_BAL_8, ';
    v_sql24 := v_sql24||'      T5.LINS_SH_UNPAY_BAL_9, ';
    v_sql24 := v_sql24||'      T5.LINS_SH_UNPAY_BAL_10, ';
    v_sql24 := v_sql24||'      T5.LINS_SH_UNPAY_BAL_11, ';
    v_sql24 := v_sql24||'      T5.LINS_SH_UNPAY_BAL_12, ';
    v_sql24 := v_sql24||'      T5.LINS_SH_UNPAY_BAL_13, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_TEMP_AMT_1, ';
    v_sql24 := v_sql24||'      T20.TOP3SUM1, ';
    v_sql24 := v_sql24||'      T20.TOP3SUM2, ';
    v_sql24 := v_sql24||'      T20.TOP3SUM3, ';
    v_sql24 := v_sql24||'      T20.TOP3SUM4, ';
    v_sql24 := v_sql24||'      T20.TOP3SUM5, ';
    v_sql24 := v_sql24||'      T20.TOP3SUM6, ';
    v_sql24 := v_sql24||'      T20.SUM_AMT_1, ';
    v_sql24 := v_sql24||'      T20.SUM_AMT_2, ';
    v_sql24 := v_sql24||'      T20.SUM_AMT_3, ';
    v_sql24 := v_sql24||'      T20.SUM_AMT_4, ';
    v_sql24 := v_sql24||'      T20.SUM_AMT_5, ';
    v_sql24 := v_sql24||'      T20.SUM_AMT_6, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_BILL_AMT_1, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_BILL_AMT_2, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_BILL_AMT_3, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_BILL_AMT_4, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_BILL_AMT_5, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_BILL_AMT_6, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_BILL_AMT_7, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_BILL_AMT_8, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_BILL_AMT_9, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_BILL_AMT_10, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_BILL_AMT_11, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_BILL_AMT_12, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_BILL_AMT_13, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_LOWEST_REPAY_1, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_LOWEST_REPAY_2, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_LOWEST_REPAY_3, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_LOWEST_REPAY_4, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_LOWEST_REPAY_5, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_LOWEST_REPAY_6, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_LOWEST_REPAY_7, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_LOWEST_REPAY_8, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_LOWEST_REPAY_9, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_LOWEST_REPAY_10, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_LOWEST_REPAY_11, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_LOWEST_REPAY_12, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_LOWEST_REPAY_13, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_ACC_OVERRUN_FLAG_1, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_ACC_OVERRUN_FLAG_2, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_ACC_OVERRUN_FLAG_3, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_ACC_OVERRUN_FLAG_4, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_ACC_OVERRUN_FLAG_5, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_ACC_OVERRUN_FLAG_6, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_ACC_OVERRUN_FLAG_7, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_ACC_OVERRUN_FLAG_8, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_ACC_OVERRUN_FLAG_9, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_ACC_OVERRUN_FLAG_10, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_ACC_OVERRUN_FLAG_11, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_ACC_OVERRUN_FLAG_12, ';
    v_sql24 := v_sql24||'      T1.LAST_13MON_ACC_OVERRUN_FLAG_13, ';
    v_sql24 := v_sql24||'      T12.badmaxpur, ';
    v_sql24 := v_sql24||'      T1.LAST_24MON_OVD_FLAG_1, ';
    v_sql24 := v_sql24||'      T1.LAST_24MON_OVD_FLAG_2, ';
    v_sql24 := v_sql24||'      T1.LAST_24MON_OVD_FLAG_3, ';
    v_sql24 := v_sql24||'      T1.LAST_24MON_OVD_FLAG_4, ';
    v_sql24 := v_sql24||'      T1.LAST_24MON_OVD_FLAG_5, ';
    v_sql24 := v_sql24||'      T1.LAST_24MON_OVD_FLAG_6, ';
    v_sql24 := v_sql24||'      T1.LAST_24MON_OVD_FLAG_7, ';
    v_sql24 := v_sql24||'      T1.LAST_24MON_OVD_FLAG_8, ';
    v_sql24 := v_sql24||'      T1.LAST_24MON_OVD_FLAG_9, ';
    v_sql24 := v_sql24||'      T1.LAST_24MON_OVD_FLAG_10, ';
    v_sql24 := v_sql24||'      T1.LAST_24MON_OVD_FLAG_11, ';
    v_sql24 := v_sql24||'      T1.LAST_24MON_OVD_FLAG_12, ';
    v_sql24 := v_sql24||'      COAL (T11.GOODINCOME, 0), ';
    v_sql24 := v_sql24||'       (  2.2 * T12.MCC90SUM ';
    v_sql24 := v_sql24||'       + 0.72 * T12.MCC90NETSUM ';
    v_sql24 := v_sql24||'       +  2.0 * T12.MCC55SUM ';
    v_sql24 := v_sql24||'       + 0.48 * T12.MCC55NETSUM ';
    v_sql24 := v_sql24||'       + 0.18 * T12.MCC26SUM ';
    v_sql24 := v_sql24||'       + 0.18 * T12.MCC26NETSUM ';
    v_sql24 := v_sql24||'       + 2.8  * T12.JW120SUM ';
    v_sql24 := v_sql24||'       + 0.72 * T12.JW120NETSUM ';
    v_sql24 := v_sql24||'       + 1.6  * T12.DLSUM ';
    v_sql24 := v_sql24||'       + 0.48 * T12.DLNETSUM ';
    v_sql24 := v_sql24||'       + T12.dlcount_2 * 2100 ';
    v_sql24 := v_sql24||'       + T12.dlnetcount_2 * 2100) * 0.01 , ';
    v_sql24 := v_sql24||'      T20.OFFLINE_NODL_MERCHANT_CNT, ';
    v_sql24 := v_sql24||'      T12.GOODCNT, ';
    v_sql24 := v_sql24||'      T20.MERCHANTSUM6M, ';
    v_sql24 := v_sql24||'      T12.GAS_PUR, ';
    v_sql24 := v_sql24||'      T12.BX_PUR, ';
    v_sql24 := v_sql24||'      T12.GAS_CNT, ';
    v_sql24 := v_sql24||'      T12.BX_CNT, ';
    v_sql24 := v_sql24||'      T21.cash_cnt_4, ';
    v_sql24 := v_sql24||'      T21.cash_cnt_5, ';
    v_sql24 := v_sql24||'      T21.cash_cnt_6, ';
    v_sql24 := v_sql24||'      T1.LAST_6MON_INACTIVE_FLAG, ';
    v_sql24 := v_sql24||'      T1.ARREARINCREASE_L6M, ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      C2.CARD_NBR, ';
    v_sql24 := v_sql24||'      A1.PROD_NBR, ';
    v_sql24 := v_sql24||'      C2.CARD_BLOCK_CODES, ';
    v_sql24 := v_sql24||'      A1.PROD_LEVEL, ';
    v_sql24 := v_sql24||'      A1.DAY_OPENED, ';
    v_sql24 := v_sql24||'      T4.CUSTOMER_ID, ';
    v_sql24 := v_sql24||'      T4.APP_NATIONAL, ';
    v_sql24 := v_sql24||'      T4.CUSTINDUSTRY, ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      T4.RESTRICTIVETRADEFLAG, ';
    v_sql24 := v_sql24||'      T4.SENDINGMETHOD, ';
    v_sql24 := v_sql24||'      T4.CUSTTYPE, ';
    v_sql24 := v_sql24||'      T4.APP_RELATION_CONTACT, ';
    v_sql24 := v_sql24||'      T1.TEMP_LIMIT, ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      T2.ISSUERSUM, ';
    v_sql24 := v_sql24||'      T4.ANNUAL_INCOME, ';
    v_sql24 := v_sql24||'      T4.CARDAPP_INCOME, ';
    v_sql24 := v_sql24||'      T4.ACCTWHITELIST, ';
    v_sql24 := v_sql24||'      T2.CHANNEL_CODE, ';
    v_sql24 := v_sql24||'      T1.ACCTCASHADVANCE, ';
    v_sql24 := v_sql24||'      T5.LAST_ALOP_TRANSACTION, ';
    v_sql24 := v_sql24||'      T3.HISTUPDATEDTYPE, ';
    v_sql24 := v_sql24||'      T3.HISTUPDATEDDATE, ';
    v_sql24 := v_sql24||'      T3.LAST_BANK_ALOP_LINE, ';
    v_sql24 := v_sql24||'      T1.LAST_CYCLEDAY_CASH_TIMES, ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      T4.APPTYPE, ';
    v_sql24 := v_sql24||'      T5.AMOUNT, ';
    v_sql24 := v_sql24||'      T5.APP_TERMS, ';
    v_sql24 := v_sql24||'      T6.APP_CHANNEL, ';
    v_sql24 := v_sql24||'      T4.PBOC_REVOLVEGUARANTOR, ';
    v_sql24 := v_sql24||'      T4.APPID, ';
    v_sql24 := v_sql24||'      T4.MONTHLYSALARY, ';
    v_sql24 := v_sql24||'      T4.IDISSUEDGEOCODE, ';
    v_sql24 := v_sql24||'      T2.APP_BIZ, ';
    v_sql24 := v_sql24||'      T2.APP_JOINT, ';
    v_sql24 := v_sql24||'      T2.APP_EMPLOYEE, ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      T2.APP_EXISTINGCC, ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      T4.APP_CRITICALINDUSTRY, ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      T4.LOCALPROPERTYSIZE, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      T2.APP_APPDATE, ';
    v_sql24 := v_sql24||'      T6.LINS_REM_UNSH_PRINCIPAL, ';
    v_sql24 := v_sql24||'      T6.LINS_REM_UNSH_FEE, ';
    v_sql24 := v_sql24||'      T1.APP_AUTODEBIT, ';
    v_sql24 := v_sql24||'      T1.ANNUAL_FEE_OVD_FLAG, ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      T2.CCONUS, ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      T1.DEATH_EXCLUDE_FLAG, ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      T1.PRO_ACCTSTATUS_CC_EXISTING, ';
    v_sql24 := v_sql24||'      T1.ACCTSTATUS, ';
    v_sql24 := v_sql24||'      T1.APP_BRANCH, ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      T4.RACE_TYPE, ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      T2.PRO_EXPIREMONTHSLEFT, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      T1.LIMITCC, ';
    v_sql24 := v_sql24||'      C2.CCVALID_DATE, ';
    v_sql24 := v_sql24||'      T1.PRO_STATUS_ACCT, ';
    v_sql24 := v_sql24||'      T1.UTILIZATION, ';
    v_sql24 := v_sql24||'      T4.GENDER, ';
    v_sql24 := v_sql24||'      T6.LINS_SH_UNPAY_PRINCIPAL, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      A1.BAL_WO_AUTHS, ';
    v_sql24 := v_sql24||'      T1.COLLECTMETHODS, ';
    v_sql24 := v_sql24||'      T1.COLLECTTIMES, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      T2.PRO_STATUS_EXISTINGCC, ';
    v_sql24 := v_sql24||'      T1.PRO_CCSTATE, ';
    v_sql24 := v_sql24||'      T1.APP_CC_LIMIT_EXISTING, ';
    v_sql24 := v_sql24||'      T4.yeyyday, ';
    v_sql24 := v_sql24||'      T4.leyyday, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      T1.LONG_CRED_LIMIT, ';
    v_sql24 := v_sql24||'      T1.ACCTACCTLIMIT, ';
    v_sql24 := v_sql24||'      T4.CUSTR_NBR, ';
    v_sql24 := v_sql24||'      T1.BILL_TAG, ';
    v_sql24 := v_sql24||'      T1.CYCLE_DAY_ONLY, ';
    v_sql24 := v_sql24||'      T1.ACCOUNT_ID, ';
    v_sql24 := v_sql24||'      T1.ACCOUNT_LOGO, ';
    v_sql24 := v_sql24||'      T1.ACC_BLOCK_CODES1, ';
    v_sql24 := v_sql24||'      T1.ACC_BLOCK_CODES2, ';
    v_sql24 := v_sql24||'      T1.ACCTNUMB, ';
    v_sql24 := v_sql24||'      T4.DISPUTE_EXCLUDE_FLAG, ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      T4.PLEDGEVALUE, ';
    v_sql24 := v_sql24||'      T4.PLEDGETYPE, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      T12.JWRECENCY, ';
    v_sql24 := v_sql24||'      T1.PBOC_ACCTNUMB_UTILIZATION50UP, ';
    v_sql24 := v_sql24||'      T1.PBOC_ACCTAGE_HIGHEST, ';
    v_sql24 := v_sql24||'      T4.APP_RESIDENTIALSTATUS, ';
    v_sql24 := v_sql24||'      COAL(T13.pur_cnt_1,0), ';
    v_sql24 := v_sql24||'      COAL(T13.pur_cnt_2,0), ';
    v_sql24 := v_sql24||'      COAL(T13.pur_cnt_3,0), ';
    v_sql24 := v_sql24||'      COAL(T13.pur_cnt_4,0), ';
    v_sql24 := v_sql24||'      COAL(T13.pur_cnt_5,0), ';
    v_sql24 := v_sql24||'      COAL(T13.pur_cnt_6,0), ';
    v_sql24 := v_sql24||'      COAL(T13.PUR_CNT_NET_1,0), ';
    v_sql24 := v_sql24||'      COAL(T13.PUR_CNT_NET_2,0), ';
    v_sql24 := v_sql24||'      COAL(T13.PUR_CNT_NET_3,0), ';
    v_sql24 := v_sql24||'      COAL(T13.PUR_CNT_NET_4,0), ';
    v_sql24 := v_sql24||'      COAL(T13.PUR_CNT_NET_5,0), ';
    v_sql24 := v_sql24||'      COAL(T13.PUR_CNT_NET_6,0), ';
    v_sql24 := v_sql24||'      T20.MAX_AMT_1, ';
    v_sql24 := v_sql24||'      T20.MAX_AMT_2, ';
    v_sql24 := v_sql24||'      T20.MAX_AMT_3, ';
    v_sql24 := v_sql24||'      T20.MAX_AMT_4, ';
    v_sql24 := v_sql24||'      T20.MAX_AMT_5, ';
    v_sql24 := v_sql24||'      T20.MAX_AMT_6, ';
    v_sql24 := v_sql24||'      T20.CNT_1, ';
    v_sql24 := v_sql24||'      T20.CNT_2, ';
    v_sql24 := v_sql24||'      T20.CNT_3, ';
    v_sql24 := v_sql24||'      T20.CNT_4, ';
    v_sql24 := v_sql24||'      T20.CNT_5, ';
    v_sql24 := v_sql24||'      T20.CNT_6, ';
    v_sql24 := v_sql24||'      T1.UTILITY_AVE_L6M, ';
    v_sql24 := v_sql24||'      ''0'', ';
    v_sql24 := v_sql24||'      T3.LAST_CUS_PERM_LINE_INC, ';
    v_sql24 := v_sql24||'      T3.LAST_CUS_TEMP_LINE_ADJ, ';
    v_sql24 := v_sql24||'      T3.LAST_BANK_PERM_LINE_INC, ';
    v_sql24 := v_sql24||'      T3.LAST_BANK_TEMP_ADJ, ';
    v_sql24 := v_sql24||'      T1.LAST_BILL_ADDRESS_CHANGE, ';
    v_sql24 := v_sql24||'      T2.ACCTSUM_REPAYED, ';
    v_sql24 := v_sql24||'      CASE ';
    v_sql24 := v_sql24||'         WHEN T5.XACCOUNT IS NOT NULL OR T6.XACCOUNT IS NOT NULL ';
    v_sql24 := v_sql24||'         THEN ';
    v_sql24 := v_sql24||'            ''1'' ';
    v_sql24 := v_sql24||'         ELSE ';
    v_sql24 := v_sql24||'            ''0'' ';
    v_sql24 := v_sql24||'      END , ';
    v_sql24 := v_sql24||' 	 ''0'', ';
    v_sql24 := v_sql24||' 	 ''0'', ';
    v_sql24 := v_sql24||'      COAL (t8.MP_BAL, 0) + t8.MP_AUTHS, ';
    v_sql24 := v_sql24||'      COAL(A1.mp_rem_ppl,0) + COAL(A1.mp_auths,0) + COAL (t9.mount, 0) + COAL (t8.MP_BAL, 0) + COAL (t8.MP_AUTHS, 0), ';
    v_sql24 := v_sql24||' 	 ''0'', ';
    v_sql24 := v_sql24||'      T7.MAIN_CARD_NBR, ';
    v_sql24 := v_sql24||'      T7.MO_PHONE, ';
    v_sql24 := v_sql24||'      COAL(T13.PUR_0,0), ';
    v_sql24 := v_sql24||'      COAL(T13.badpur_0,0)+COAL(T13.BXJY_PUR_0,0), ';
    v_sql24 := v_sql24||'      t21.cash_0, ';
    v_sql24 := v_sql24||'      t20.top3sum0, ';
    v_sql24 := v_sql24||'      t20.SUM_AMT_0, ';
    v_sql24 := v_sql24||'      COAL(T13.pur_cnt_0,0), ';
    v_sql24 := v_sql24||'      COAL(T13.pur_cnt_net_0,0), ';
    v_sql24 := v_sql24||'      t20.MAX_AMT_0, ';
    v_sql24 := v_sql24||'      t20.CNT_0, ';
    v_sql24 := v_sql24||'      T1.open_bal_wo_pay_1, ';
    v_sql24 := v_sql24||'      T1.open_bal_wo_pay_2, ';
    v_sql24 := v_sql24||'      T1.open_bal_wo_pay_3, ';
    v_sql24 := v_sql24||'      T1.open_bal_wo_pay_4, ';
    v_sql24 := v_sql24||'      T1.open_bal_wo_pay_5, ';
    v_sql24 := v_sql24||'      T1.open_bal_wo_pay_6, ';
    v_sql24 := v_sql24||'      CASE ';
    v_sql24 := v_sql24||'         WHEN t20.active_day <= 0 ';
    v_sql24 := v_sql24||'         THEN ';
    v_sql24 := v_sql24||'            30001231 ';
    v_sql24 := v_sql24||'         ELSE ';
    v_sql24 := v_sql24||'             CASE ';
    v_sql24 := v_sql24||'                WHEN  T1.CYCLE_DAY_ONLY >=  SUBSTR (t20.active_day, 7, 2) ';
    v_sql24 := v_sql24||'                AND   T1.CYCLE_DAY_ONLY < 10 ';
    v_sql24 := v_sql24||'                THEN ';
    v_sql24 := v_sql24||'                      CONCAT(SUBSTR (t20.active_day, 1, 6) ';
    v_sql24 := v_sql24||'                    , ''0'' ';
    v_sql24 := v_sql24||'                    , T1.CYCLE_DAY_ONLY) ';
    v_sql24 := v_sql24||'                WHEN  T1.CYCLE_DAY_ONLY >= SUBSTR (t20.active_day, 7, 2) ';
    v_sql24 := v_sql24||'                AND T1.CYCLE_DAY_ONLY >= 10 ';
    v_sql24 := v_sql24||'                THEN ';
    v_sql24 := v_sql24||'                     CONCAT ( ';
    v_sql24 := v_sql24||'                      SUBSTR (t20.active_day, 1, 6) ';
    v_sql24 := v_sql24||'                    , T1.CYCLE_DAY_ONLY) ';
    v_sql24 := v_sql24||'                WHEN ';
    v_sql24 := v_sql24||'                      T1.CYCLE_DAY_ONLY < SUBSTR (t20.active_day, 7, 2) ';
    v_sql24 := v_sql24||'                     AND T1.CYCLE_DAY_ONLY < 10 ';
    v_sql24 := v_sql24||'                THEN ';
    v_sql24 := v_sql24||'                   CONCAT ( ';
    v_sql24 := v_sql24||'                   toDate ( ADD_MONTHS ( toDate(t20.active_day, ''yyyy-mm-dd'') , +1 ) , ''yyyymm'') ';
    v_sql24 := v_sql24||'                      , ''0'' ';
    v_sql24 := v_sql24||'                      , T1.CYCLE_DAY_ONLY) ';
    v_sql24 := v_sql24||'                WHEN ';
    v_sql24 := v_sql24||'                      T1.CYCLE_DAY_ONLY < SUBSTR (t20.active_day, 7, 2) ';
    v_sql24 := v_sql24||'                     AND T1.CYCLE_DAY_ONLY >= 10 ';
    v_sql24 := v_sql24||'                THEN ';
    v_sql24 := v_sql24||'                   CONCAT ( ';
    v_sql24 := v_sql24||'                   toDate ( ADD_MONTHS ( toDate(t20.active_day, ''yyyy-mm-dd'') , +1 ) , ''yyyymm'') ';
    v_sql24 := v_sql24||'                      , T1.CYCLE_DAY_ONLY) ';
    v_sql24 := v_sql24||'             END ';
    v_sql24 := v_sql24||'      END , ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      T1.new_bal_1, ';
    v_sql24 := v_sql24||'      T1.new_bal_2, ';
    v_sql24 := v_sql24||'      T1.new_bal_3, ';
    v_sql24 := v_sql24||'      T1.new_bal_4, ';
    v_sql24 := v_sql24||'      T1.new_bal_5, ';
    v_sql24 := v_sql24||'      T1.new_bal_6, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      T13.GOODCNT_1, ';
    v_sql24 := v_sql24||'      T13.GOODCNT_2, ';
    v_sql24 := v_sql24||'      T13.GOODCNT_3, ';
    v_sql24 := v_sql24||'      T13.GOODCNT_4, ';
    v_sql24 := v_sql24||'      T13.GOODCNT_5, ';
    v_sql24 := v_sql24||'      T13.GOODCNT_6, ';
    v_sql24 := v_sql24||'      T13.GOODCNT_0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      T13.GOODSUM_1, ';
    v_sql24 := v_sql24||'      T13.GOODSUM_2, ';
    v_sql24 := v_sql24||'      T13.GOODSUM_3, ';
    v_sql24 := v_sql24||'      T13.GOODSUM_4, ';
    v_sql24 := v_sql24||'      T13.GOODSUM_5, ';
    v_sql24 := v_sql24||'      T13.GOODSUM_6, ';
    v_sql24 := v_sql24||'      T13.GOODSUM_0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0, ';
    v_sql24 := v_sql24||'      0  ';
    v_sql24 := v_sql24||' FROM MDM_ACCT_INFO_SP T1 ';
    v_sql24 := v_sql24||'      LEFT JOIN MDM_ACCT_X_SP A1 ON T1.XACCOUNT = A1.XACCOUNT ';
    v_sql24 := v_sql24||'      LEFT JOIN MDM_CARD_INFO T2 ';
    v_sql24 := v_sql24||'           ON T1.XACCOUNT = T2.XACCOUNT ';
    v_sql24 := v_sql24||'      LEFT JOIN MDM_CARD C2 ';
    v_sql24 := v_sql24||'           ON T1.XACCOUNT = C2.XACCOUNT ';
    v_sql24 := v_sql24||'      LEFT JOIN MDM_LIMIT_ADJ_INFO T3 ';
    v_sql24 := v_sql24||'           ON T1.XACCOUNT = T3.XACCOUNT ';
    v_sql24 := v_sql24||'      LEFT JOIN MDM_CUSTR_INFO T4 ';
    v_sql24 := v_sql24||'           ON T1.XACCOUNT = T4.XACCOUNT ';
    v_sql24 := v_sql24||'      LEFT JOIN MDM_MP_INFO T5 ';
    v_sql24 := v_sql24||'           ON T1.XACCOUNT = T5.XACCOUNT ';
    v_sql24 := v_sql24||'      LEFT JOIN MDM_COMMON_MP_INFO T6 ';
    v_sql24 := v_sql24||'           ON T1.XACCOUNT = T6.XACCOUNT ';
    v_sql24 := v_sql24||'      LEFT JOIN MDM_CARD_CUSTR_INFO T7 ';
    v_sql24 := v_sql24||'           ON T1.XACCOUNT = T7.XACCOUNT ';
    v_sql24 := v_sql24||'      LEFT JOIN FDM_S24_CUR_ACCA t8 ';
    v_sql24 := v_sql24||'           ON T8.XACCOUNT = T1.XACCOUNT ';
    v_sql24 := v_sql24||'      LEFT JOIN ';
    v_sql24 := v_sql24||'      (SELECT (  ACCX.MP_REM_PPL * prmxr.RATE_VAL0 ';
    v_sql24 := v_sql24||'               + ACCX.MP_AUTHS * prmxr.RATE_VAL0) ';
    v_sql24 := v_sql24||'                 mount, ';
    v_sql24 := v_sql24||'              accx.XACCOUNT XACCOUNT ';
    v_sql24 := v_sql24||'         FROM FDM_S24_CUR_ACCX accx, V_PRMXR prmxr ';
    v_sql24 := v_sql24||'        WHERE     ACCX.BANK = prmxr.BANK ';
    v_sql24 := v_sql24||'              AND ACCX.CURR_NUM = PRMXR.CURR_NUM) t9 ';
    v_sql24 := v_sql24||'         ON T9.XACCOUNT = T1.XACCOUNT ';
    v_sql24 := v_sql24||'      LEFT JOIN temp_event_counts T10 ON T10.ACCTNBR = T1.XACCOUNT ';
    v_sql24 := v_sql24||'      LEFT JOIN temp_event_income T11 ON T11.ACCTNBR = T1.XACCOUNT ';
    v_sql24 := v_sql24||'      LEFT JOIN ';
    v_sql24 := v_sql24||'      (  SELECT mpau.ACCOUNT AS acctnum, COUNT (1) AS mpaucounts ';
    v_sql24 := v_sql24||'           FROM V_FDM_S24_MPAU mpau ';
    v_sql24 := v_sql24||'          WHERE     todate(mpau.end_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -6) ';
    v_sql24 := v_sql24||'                AND todate(mpau.end_DATE,''yyyy-mm-dd'') <= SYSDATE() ';
    v_sql24 := v_sql24||'                AND MPAU.MPAU_STS IN (10, ';
    v_sql24 := v_sql24||'                                      20, ';
    v_sql24 := v_sql24||'                                      30, ';
    v_sql24 := v_sql24||'                                      40) ';
    v_sql24 := v_sql24||'       GROUP BY mpau.ACCOUNT) mpaudata ';
    v_sql24 := v_sql24||'         ON (mpaudata.acctnum + 0) = T1.XACCOUNT ';
    v_sql24 := v_sql24||'       left join temp_event_pur t12 on (T12.XACCOUNT+0)=t1.XACCOUNT ';
    v_sql24 := v_sql24||'       left join temp_event_pur_6m t13 on (t13.acctnbr+0) = t1.xaccount ';
    v_sql24 := v_sql24||'       left join TEMP_EVENT_PUR_TOP3SUM t20 on (t20.acctnbr+0) = t1.xaccount ';
    v_sql24 := v_sql24||'       left join TEMP_EVENT_CASH_6M t21 on (t21.acctnbr+0) = t1.xaccount ';

    DBMS_OUTPUT.PUT_LINE('account_sp after:==========' || v_sql24);

    execute immediate v_sql24;

    DBMS_OUTPUT.PUT_LINE('PRC_ACCOUNT END');

    SET RESULT = '1';
END;

DECLARE RESULT_OUT STRING;
DECLARE ETL_DATE STRING = '2015-12-14 00:00:00';
call PRC_ACCOUNT(ETL_DATE, RESULT_OUT);
PRING RESULT_OUT;
