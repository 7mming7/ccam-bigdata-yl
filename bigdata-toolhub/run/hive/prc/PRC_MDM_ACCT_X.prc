INCLUDE INCLUDE_HEAD.sql

CREATE OR REPLACE PROCEDURE PRC_MDM_ACCT_X(IN ETL_DATE STRING, OUT RESULT STRING)
BEGIN
    DECLARE v_ETL_DATE       STRING;    --ETL调度日期

    DECLARE v_sql            STRING;
    DECLARE v_sql1           STRING;

    SET RESULT = '0';

    DBMS_OUTPUT.PUT_LINE('PRC_MDM_CARD_CUSTR_INFO START');
    DBMS_OUTPUT.PUT_LINE('ETL_DATE ==' || ETL_DATE);
    IF ETL_DATE <>' ' THEN
        SELECT todate(ETL_DATE,'yyyymmdd') INTO v_ETL_DATE FROM DUAL;
        DBMS_OUTPUT.PUT_LINE('v_ETL_DATE2==' || v_ETL_DATE );
    ELSE
        DBMS_OUTPUT.PUT_LINE('ETL_DATE 为空');
        SELECT SYSDATE() INTO v_ETL_DATE  FROM dual;
    END IF;

    DBMS_OUTPUT.PUT_LINE('v_ETL_DATE3 ==' || v_ETL_DATE);

    DBMS_OUTPUT.PUT_LINE('START EXECUTE TRUNCATE TABLE MDM_ACCT_X');
    DECLARE TRUN_TBL_MDM_ACCT_X STRING = 'TRUNCATE TABLE MDM_ACCT_X';
    EXECUTE TRUN_TBL_MDM_ACCT_X;

    DBMS_OUTPUT.PUT_LINE('START INSERT INTO MDM_ACCT_X');
    DBMS_OUTPUT.PUT_LINE('v_sql before:=========' || v_sql);
    v_sql := 'INSERT INTO MDM_ACCT_X  ';
    v_sql := v_sql||'      SELECT COAL(T1.XACCOUNT, T2.XACCOUNT)                        ';
    v_sql := v_sql||'                                                ,';
    v_sql := v_sql||'             COAL(T1.BANK, T2.BANK)                                ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'             COAL(T1.BUSINESS, T2.BUSINESS)             ';
    v_sql := v_sql||'                                                ,';
    v_sql := v_sql||'             COAL(T1.CATEGORY, T2.CATEGORY)                        ';
    v_sql := v_sql||'                                                ,';
    v_sql := v_sql||'             COAL(T1.CUSTR_NBR, '' '')                          ';
    v_sql := v_sql||'                                         ,';
    v_sql := v_sql||'             COAL(T1.CYCLE_NBR, 0)                                ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'             COAL(T1.DAY_OPENED, 0) AS DAY_OPENED                 ';
    v_sql := v_sql||'                                                      ,';
    v_sql := v_sql||'             COAL(T1.ACC_NAME1, '' '')                              ';
    v_sql := v_sql||'                                         ,';
    v_sql := v_sql||'             COAL(T1.ACC_TYPE, '' '')                          ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'             COAL(T1.ADD_CHGDAY, 0)                            ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'             COAL(T1.ADDR_TYPE, '' '')                            ';
    v_sql := v_sql||'                                         ,';
    v_sql := v_sql||'             COAL(T1.ADDR_TYPE2, '' '')                          ';
    v_sql := v_sql||'                                          ,';
    v_sql := v_sql||'               COAL(T1.AGE1, 0)';
    v_sql := v_sql||'             + COAL(T1.AGE2, 0)';
    v_sql := v_sql||'             + COAL(T1.AGE3, 0)';
    v_sql := v_sql||'             + COAL(T1.AGE4, 0)';
    v_sql := v_sql||'             + COAL(T1.AGE5, 0)';
    v_sql := v_sql||'             + COAL(T1.AGE6, 0)';
    v_sql := v_sql||'             + COAL(T2.AGE1, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'             + COAL(T2.AGE2, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'             + COAL(T2.AGE3, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'             + COAL(T2.AGE4, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'             + COAL(T2.AGE5, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'             + COAL(T2.AGE6, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'                AS AGE                                             ';
    v_sql := v_sql||'             ,'' ''      ';
    v_sql := v_sql||'             ,'' ''       ';
    v_sql := v_sql||'             ,';
    v_sql := v_sql||'             COAL(T1.AUTH_OVER, 0)                           ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'             COAL(T1.AUTHOV_YN, '' '')                         ';
    v_sql := v_sql||'                                         ,';
    v_sql := v_sql||'               COAL(T1.AUTHS_AMT, 0)';
    v_sql := v_sql||'             + COAL(T2.AUTHS_AMT, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                     ,';
    v_sql := v_sql||'               COAL(T1.BAL_CMPINT, 0)';
    v_sql := v_sql||'             + COAL(T2.BAL_CMPINT, 0) * COAL(B.RATE_VAL0, 0)  ';
    v_sql := v_sql||'                                                                      ,';
    v_sql := v_sql||'               COAL(T1.BAL_FREE, 0)';
    v_sql := v_sql||'             + COAL(T2.BAL_FREE, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                    ,';
    v_sql := v_sql||'               CASE';
    v_sql := v_sql||'                  WHEN T1.BAL_INTFLAG = ''+'' THEN T1.BAL_INT';
    v_sql := v_sql||'                  ELSE T1.BAL_INT * -1';
    v_sql := v_sql||'               END';
    v_sql := v_sql||'             + CASE';
    v_sql := v_sql||'                  WHEN T2.BALINTFLAG = ''+''   ';
    v_sql := v_sql||'                  THEN';
    v_sql := v_sql||'                     COAL(T2.BAL_INT, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'                  ELSE';
    v_sql := v_sql||'                       COAL(T2.BAL_INT, 0)';
    v_sql := v_sql||'                     * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'                     * -1';
    v_sql := v_sql||'               END';
    v_sql := v_sql||'                AS BAL_INT                                   ';
    v_sql := v_sql||'                          ,';
    v_sql := v_sql||'               COAL(T1.BAL_NOINT, 0)';
    v_sql := v_sql||'             + COAL(T2.BAL_NOINT, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                     ,';
    v_sql := v_sql||'               COAL(T1.BAL_ORINT, 0)';
    v_sql := v_sql||'             + COAL(T2.BAL_ORINT, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                     ,';
    v_sql := v_sql||'             COAL(T1.BANKACCT1, '' '')                            ';
    v_sql := v_sql||'                                         ,';
    v_sql := v_sql||'             COAL(T1.BANKCODE1, '' '')                        ';
    v_sql := v_sql||'                                         ,';
    v_sql := v_sql||'             COAL(T1.BANKACCT2, '' '')                       ';
    v_sql := v_sql||'                                         ,';
    v_sql := v_sql||'             COAL(T1.BANKCODE2, '' '')                       ';
    v_sql := v_sql||'                                         ,';
    v_sql := v_sql||'             COAL(T1.BANKACCT3, '' '')                           ';
    v_sql := v_sql||'                                         ,';
    v_sql := v_sql||'             COAL(T1.BANKCODE3, '' '')                        ';
    v_sql := v_sql||'                                         ,';
    v_sql := v_sql||'             COAL(T1.BANKACCT4, '' '')                        ';
    v_sql := v_sql||'                                         ,';
    v_sql := v_sql||'             COAL(T1.BANKCODE4, '' '')                        ';
    v_sql := v_sql||'                                         ,';
    v_sql := v_sql||'             COAL(T1.BRANCH, 0)                                     ';
    v_sql := v_sql||'                                    ,';
    v_sql := v_sql||'             COAL(T1.BRANCH_DAY, 0)                            ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'             COAL(T1.CA_PCNT, 0)                                 ';
    v_sql := v_sql||'                                     ,';
    v_sql := v_sql||'             COAL(T1.CARD_FEES, 0)                                   ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'             COAL(T1.CARDS_CANC, 0)                           ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'             COAL(T1.CARDS_ISSD, 0)                           ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'             COAL(T1.CASH_1ST, 0)                          ';
    v_sql := v_sql||'                                      ,';
    v_sql := v_sql||'               COAL(T1.CASH_ADFEE, 0)';
    v_sql := v_sql||'             + COAL(T2.CASH_ADFEE, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                      ,';
    v_sql := v_sql||'               COAL(T1.CASH_ADVCE, 0)';
    v_sql := v_sql||'             + COAL(T2.CASH_ADVCE, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                      ,';
    v_sql := v_sql||'               COAL(T1.CASH_TDAY, 0)';
    v_sql := v_sql||'             + COAL(T2.CASH_TDAY, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                     ,';
    v_sql := v_sql||'             COAL(T1.CASH1STAC, 0)                      ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'             COAL(T1.CLASS_CHDY, 0)                     ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'             COAL(T1.CLASS_CODE, '' '')                   ';
    v_sql := v_sql||'                                          ,';
    v_sql := v_sql||'             COAL(T1.CLOSE_CHDY, 0)                     ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'             COAL(T1.CLOSE_CODE, '' '')                   ';
    v_sql := v_sql||'                                          ,';
    v_sql := v_sql||'             COAL(T1.COLLS_DAY, 0)                      ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'             COAL(T1.CRDACT_DAY, 0)                     ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'             COAL(T1.CRDNXT_DAY, 0)                     ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'             COAL(T1.CRED_ACTIV, '' '')                   ';
    v_sql := v_sql||'                                          ,';
    v_sql := v_sql||'               COAL(T1.CRED_ADJ, 0)';
    v_sql := v_sql||'             + COAL(T2.CRED_ADJ, 0) * COAL(B.RATE_VAL0, 0)  ';
    v_sql := v_sql||'                                                                    ,';
    v_sql := v_sql||'             COAL(T1.CRED_CHDAY, 0)                     ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'             COAL(T1.CRED_LIMIT, 0)                     ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'             COAL(T1.CRED_VOUCH, 0)                     ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'             COAL(T1.CREDLIM_X, 0)                  ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'             COAL(T1.CURR_NUM, '' '')                            ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'             COAL(T1.CUTOFF_DAY, 0)                            ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'             COAL(T1.CY_CHGCNT, 0)                             ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'             COAL(T1.CY_CHGDAY, 0)                           ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'             COAL(T1.CY_EFFDAY, 0)                           ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'             COAL(T1.CY_YRCNT, 0)                               ';
    v_sql := v_sql||'                                      ,';
    v_sql := v_sql||'             COAL(T1.CYCLE_NEW, 0)                                ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'             COAL(T1.CYCLE_PRV, 0)                                ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'               COAL(T1.DEBIT_ADJ, 0)';
    v_sql := v_sql||'             + COAL(T2.DEBIT_ADJ, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                     ,';
    v_sql := v_sql||'             COAL(T1.DISHNRDAY, 0)                         ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'             ''0''            ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'             ''0''                      ,';
    v_sql := v_sql||'             COAL(T1.EXCH_CODE, '' '')                            ';
    v_sql := v_sql||'                                         ,';
    v_sql := v_sql||'             COAL(T1.EXCH_FLAG, '' '')               ';
    v_sql := v_sql||'                                         ,';
    v_sql := v_sql||'             COAL(T1.EXCH_PERC, 0)                 ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'             COAL(T1.EXCH_RTDT, 0)                 ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'             COAL(T1.FEE_MONTH, 0)                         ';
    v_sql := v_sql||'                                       ,''0''            ';
    v_sql := v_sql||'             ,';
    v_sql := v_sql||'             COAL(T1.FIX_EXAMT, 0)                               ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'             COAL(T1.GUARN_FLAG, 0)                               ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'             CASE';
    v_sql := v_sql||'                WHEN T1.HI_CASHADV + 0 >=';
    v_sql := v_sql||'                          COAL(T2.HI_CASHADV, 0)';
    v_sql := v_sql||'                        * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'                THEN';
    v_sql := v_sql||'                   T1.HI_CASHADV';
    v_sql := v_sql||'                ELSE';
    v_sql := v_sql||'                   COAL(T2.HI_CASHADV, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'             END                                                   ';
    v_sql := v_sql||'                ,';
    v_sql := v_sql||'             CASE';
    v_sql := v_sql||'                WHEN T1.HI_CASHADV >=';
    v_sql := v_sql||'                          COAL(T2.HI_CASHADV, 0)';
    v_sql := v_sql||'                        * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'                THEN';
    v_sql := v_sql||'                   T1.HI_CASMMYY';
    v_sql := v_sql||'                ELSE';
    v_sql := v_sql||'                   COAL(T2.HI_CASMMYY, 0)';
    v_sql := v_sql||'             END';
    v_sql := v_sql||'                ,''0''            ';
    v_sql := v_sql||'                ,''0''            ';
    v_sql := v_sql||'                ,''0''            ';
    v_sql := v_sql||'                ,''0''            ';
    v_sql := v_sql||'                ,''0''            ';
    v_sql := v_sql||'                ,''0''            ';
    v_sql := v_sql||'                ,''0''            ';
    v_sql := v_sql||'                ,''0''            ';
    v_sql := v_sql||'             ,';
    v_sql := v_sql||'             CASE';
    v_sql := v_sql||'                WHEN T1.HI_PURCHSE + 0 >=';
    v_sql := v_sql||'                          COAL(T2.HI_PURCHSE, 0)';
    v_sql := v_sql||'                        * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'                THEN';
    v_sql := v_sql||'                   T1.HI_PURCHSE';
    v_sql := v_sql||'                ELSE';
    v_sql := v_sql||'                   COAL(T2.HI_PURCHSE, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'             END                                                     ';
    v_sql := v_sql||'                ,';
    v_sql := v_sql||'             CASE';
    v_sql := v_sql||'                WHEN T1.HI_PURCHSE + 0 >=';
    v_sql := v_sql||'                          COAL(T2.HI_PURCHSE, 0)';
    v_sql := v_sql||'                        * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'                THEN';
    v_sql := v_sql||'                   T1.HI_PURMMYY';
    v_sql := v_sql||'                ELSE';
    v_sql := v_sql||'                   COAL(T2.HI_PURMMYY, 0)';
    v_sql := v_sql||'             END';
    v_sql := v_sql||'             ,';
    v_sql := v_sql||'               COAL(T1.INT_CASH, 0)';
    v_sql := v_sql||'             + COAL(T2.INT_CASH, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                    ,';
    v_sql := v_sql||'               COAL(T1.INT_CHDCMP, 0)';
    v_sql := v_sql||'             + COAL(T2.INT_CHDCMP, 0) * COAL(B.RATE_VAL0, 0)  ';
    v_sql := v_sql||'                                                                      ,';
    v_sql := v_sql||'             COAL(T1.INT_CHDY, 0)                          ';
    v_sql := v_sql||'                                      ,';
    v_sql := v_sql||'               COAL(T1.INT_CHGD, 0)';
    v_sql := v_sql||'             + COAL(T2.INT_CHGD, 0) * COAL(B.RATE_VAL0, 0)  ';
    v_sql := v_sql||'                                                                    ,';
    v_sql := v_sql||'               COAL(T1.INT_CMPOND, 0)';
    v_sql := v_sql||'             + COAL(T2.INT_CMPOND, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                      ,';
    v_sql := v_sql||'             COAL(T1.INT_CODE, T2.INT_CODE)                        ';
    v_sql := v_sql||'                                                ,';
    v_sql := v_sql||'               COAL(T1.INT_CUNOT, 0)';
    v_sql := v_sql||'             + COAL(T2.INT_CUNOT, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                     ,';
    v_sql := v_sql||'               COAL(T1.INT_CURCMP, 0)';
    v_sql := v_sql||'             + COAL(T2.INT_CURCMP, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                      ,';
    v_sql := v_sql||'               COAL(T1.INT_EARNED, 0)';
    v_sql := v_sql||'             + COAL(T2.INT_EARNED, 0) * COAL(B.RATE_VAL0, 0)  ';
    v_sql := v_sql||'                                                                      ,';
    v_sql := v_sql||'               COAL(T1.INT_NOTION, 0)';
    v_sql := v_sql||'             + COAL(T2.INT_NOTION, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                      ,';
    v_sql := v_sql||'             COAL(T1.INT_PROCDY, T2.INT_PROCDY)                  ';
    v_sql := v_sql||'                                                    ,';
    v_sql := v_sql||'             COAL(T1.INT_RATE, T2.INT_RATE)                        ';
    v_sql := v_sql||'                                                ,''0''            ';
    v_sql := v_sql||'             ,';
    v_sql := v_sql||'             COAL(T1.INT_UPTODY, T2.INT_UPTODY)                ';
    v_sql := v_sql||'                                                    ,';
    v_sql := v_sql||'             COAL(T1.LANG_CODE, 0)                                 ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'             COAL(T1.LAST_TRDAY, T2.LAST_TRDAY)             ';
    v_sql := v_sql||'                                                    ,';
    v_sql := v_sql||'             COAL(T1.LASTAUTHDY, 0)                         ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'             COAL(T1.LASTNTDATE, T2.LASTNTDATE)             ';
    v_sql := v_sql||'                                                    ,';
    v_sql := v_sql||'             CASE';
    v_sql := v_sql||'                WHEN T1.LASTPAYDAY + 0 = COAL(T2.LASTPAYDAY, 0) + 0';
    v_sql := v_sql||'                THEN';
    v_sql := v_sql||'                     T1.LASTPAYAMT';
    v_sql := v_sql||'                   + COAL(T2.LASTPAYAMT, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'                WHEN T1.LASTPAYDAY + 0 > COAL(T2.LASTPAYDAY, 0) + 0';
    v_sql := v_sql||'                THEN';
    v_sql := v_sql||'                   T1.LASTPAYAMT * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'                ELSE';
    v_sql := v_sql||'                   COAL(T2.LASTPAYAMT, 0)';
    v_sql := v_sql||'             END                                                    ';
    v_sql := v_sql||'                ,';
    v_sql := v_sql||'             CASE';
    v_sql := v_sql||'                WHEN T1.LASTPAYDAY + 0 = COAL(T2.LASTPAYDAY, 0) + 0';
    v_sql := v_sql||'                THEN';
    v_sql := v_sql||'                   T1.LASTPAYDAY';
    v_sql := v_sql||'                WHEN T1.LASTPAYDAY + 0 > COAL(T2.LASTPAYDAY, 0) + 0';
    v_sql := v_sql||'                THEN';
    v_sql := v_sql||'                   T1.LASTPAYDAY';
    v_sql := v_sql||'                ELSE';
    v_sql := v_sql||'                   COAL(T2.LASTPAYDAY, 0)';
    v_sql := v_sql||'             END ';
    v_sql := v_sql||'             ,';
    v_sql := v_sql||'             COAL(T1.LOSSES, 0)                                ';
    v_sql := v_sql||'                                    ,';
    v_sql := v_sql||'             COAL(T1.MONTH_NBR, 0)                               ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'             COAL(T1.MONTR_CHDY, 0)                        ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'             COAL(T1.MONTR_CODE, '' '')                             ';
    v_sql := v_sql||'                                          ,';
    v_sql := v_sql||'             COAL(T1.MP_AM_TDY, 0)                             ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'               COAL(T1.MP_AUTHS, 0)';
    v_sql := v_sql||'             + COAL(T2.MP_AUTHS, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                    ,';
    v_sql := v_sql||'               COAL(T1.MP_BAL, 0)';
    v_sql := v_sql||'             + COAL(T2.MP_BAL, 0) * COAL(B.RATE_VAL0, 0)  ';
    v_sql := v_sql||'                                                                  ,';
    v_sql := v_sql||'               COAL(T1.MP_BIL_AMT, 0)';
    v_sql := v_sql||'             + COAL(T2.STM_BALMP, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                     ,';
    v_sql := v_sql||'             COAL(T1.MP_LIMIT, 0)                              ';
    v_sql := v_sql||'                                      ,';
    v_sql := v_sql||'             COAL(T1.MP_NO_TDY, 0)                           ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'               COAL(T1.MP_REM_PPL, 0)';
    v_sql := v_sql||'             + COAL(T2.MP_REM_PPL, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                      ,';
    v_sql := v_sql||'             COAL(T1.MPLM_CHDAY, 0)                          ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'             CASE';
    v_sql := v_sql||'                WHEN T1.MTHS_ODUE >= COAL(T2.MTHS_ODUE, 0)';
    v_sql := v_sql||'                THEN';
    v_sql := v_sql||'                   T1.MTHS_ODUE';
    v_sql := v_sql||'                ELSE';
    v_sql := v_sql||'                   COAL(T2.MTHS_ODUE, 0)';
    v_sql := v_sql||'             END                                                      ';
    v_sql := v_sql||'                ,';
    v_sql := v_sql||'             COAL(T1.NBR_CASHAD, 0) + COAL(T2.NBR_CASHAD, 0) ';
    v_sql := v_sql||'                                                                      ,';
    v_sql := v_sql||'             COAL(T1.NBR_FEEDTY, 0) + COAL(T2.NBR_FEEDTY, 0) ';
    v_sql := v_sql||'                                                                      ,';
    v_sql := v_sql||'             COAL(T1.NBR_OLIMIT, 0) + COAL(T2.NBR_OLIMIT, 0) ';
    v_sql := v_sql||'                                                                      ,';
    v_sql := v_sql||'             COAL(T1.NBR_OTHERS, 0) + COAL(T2.NBR_OTHERS, 0) ';
    v_sql := v_sql||'                                                                      ,';
    v_sql := v_sql||'             COAL(T1.NBR_PAYMNT, 0) + COAL(T2.NBR_PAYMNT, 0) ';
    v_sql := v_sql||'                                                                      ,';
    v_sql := v_sql||'             COAL(T1.NBR_PURCH, 0) + COAL(T2.NBR_PURCH, 0) ';
    v_sql := v_sql||'                                                                    ,';
    v_sql := v_sql||'             COAL(T1.NBR_TRANS, 0) + COAL(T2.NBR_TRANS, 0) ';
    v_sql := v_sql||'                                                                    ,';
    v_sql := v_sql||'             COAL(T1.OCT_COUNT, 0)                           ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'             COAL(T1.OCT_DAYIN, 0)                           ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'             COAL(T1.ODUE_FLAG, T2.ODUE_FLAG, 0)               ';
    v_sql := v_sql||'                                                     ,';
    v_sql := v_sql||'               COAL(T1.ODUE_HELD, 0)';
    v_sql := v_sql||'             + COAL(T2.ODUE_HELD, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                     ,';
    v_sql := v_sql||'             COAL(T1.OLFLAG, T2.OLFLAG, 0)                     ';
    v_sql := v_sql||'                                               ,';
    v_sql := v_sql||'               COAL(T1.OTHER_FEES, 0)';
    v_sql := v_sql||'             + COAL(T2.OTHER_FEES, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                      ,';
    v_sql := v_sql||'             CASE';
    v_sql := v_sql||'                WHEN     COAL(T1.PAY_FLAG, ''1'') = ''1'' ';
    v_sql := v_sql||'                     AND COAL(T2.PAY_FLAG, ''1'') = ''1'' ';
    v_sql := v_sql||'                THEN';
    v_sql := v_sql||'                   ''1'' ';
    v_sql := v_sql||'                ELSE';
    v_sql := v_sql||'                   ''0''   ';
    v_sql := v_sql||'             END                                                    ';
    v_sql := v_sql||'                ,';
    v_sql := v_sql||'             COAL(T1.PAY1ST_IND, '' '')                          ';
    v_sql := v_sql||'                                          ,';
    v_sql := v_sql||'               COAL(T1.PAYMT_CLRD, 0)';
    v_sql := v_sql||'             + COAL(T2.PAYMT_CLRD, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                      ,';
    v_sql := v_sql||'                T1.PAYMT_TDAY';
    v_sql := v_sql||'             +';
    v_sql := v_sql||'                     COAL(T2.PAYMT_TDAY, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'';
    v_sql := v_sql||'                                                                   ';
    v_sql := v_sql||'                  ,';
    v_sql := v_sql||'               COAL(T1.PAYMT_UNCL, 0)';
    v_sql := v_sql||'             + COAL(T2.PAYMT_UNCL, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                      ,';
    v_sql := v_sql||'               COAL(T1.PEN_CHRG, 0)';
    v_sql := v_sql||'             + COAL(T2.PEN_CHRG, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                    ,';
    v_sql := v_sql||'               COAL(T1.PENCHG_ACC, 0)';
    v_sql := v_sql||'             + COAL(T2.PENCHG_ACC, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                      ,';
    v_sql := v_sql||'             COAL(T1.POINT_ADJ, 0)                               ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'             COAL(T1.PT_ADJFLAG, '' '')                       ';
    v_sql := v_sql||'                                          ,';
    v_sql := v_sql||'             COAL(T1.POINT_CLM, 0)                          ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'             COAL(T1.POINT_CUM, 0)                          ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'             COAL(T1.PT_CUMFLAG, '' '')                       ';
    v_sql := v_sql||'                                          ,';
    v_sql := v_sql||'             COAL(T1.POINT_CUM2, 0)                         ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'             COAL(T1.POINT_EAR, 0)                            ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'             COAL(T1.POINT_FREZ, '' '')                         ';
    v_sql := v_sql||'                                          ,';
    v_sql := v_sql||'             COAL(T1.POINT_FZDA, 0)                           ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'             COAL(T1.POST_DD, 0)                              ';
    v_sql := v_sql||'                                     ,';
    v_sql := v_sql||'             COAL(T1.PREV_BRDAY, 0)                           ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'             COAL(T1.PREV_BRNCH, 0)                              ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'               COAL(T1.PURCHASES, 0)';
    v_sql := v_sql||'             + COAL(T2.PURCHASES, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                     ,';
    v_sql := v_sql||'               COAL(T1.QUERY_AMT, 0)';
    v_sql := v_sql||'             + COAL(T2.QUERY_AMT, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                     ,';
    v_sql := v_sql||'             COAL(T1.QUERY_CODE, T2.QUERY_CODE, ''0'')        ';
    v_sql := v_sql||'                                                         ,';
    v_sql := v_sql||'             COAL(T1.QUERY_STMT, T2.QUERY_STMT, 0)          ';
    v_sql := v_sql||'                                                       ,';
    v_sql := v_sql||'             COAL(T1.RECLA_CHDY, 0)                         ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'             COAL(T1.RECLA_CODE, '' '')                      ';
    v_sql := v_sql||'                                          ,';
    v_sql := v_sql||'             COAL(T1.RECVRY_AMT, 0)                        ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'             COAL(T1.REPAY_AMT, 0)                            ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'             COAL(T1.REPAY_AMTX, 0)                           ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'             COAL(T1.REPAY_CODE, '' '')                         ';
    v_sql := v_sql||'                                          ,';
    v_sql := v_sql||'             COAL(T1.REPAY_CODX, '' '')                         ';
    v_sql := v_sql||'                                          ,';
    v_sql := v_sql||'             COAL(T1.REPAY_DAY, 0)                            ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'             COAL(T1.REPAY_PCT, 0)                            ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'             COAL(T1.REPAY_PCTX, 0)                           ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'             COAL(T1.REPY_CHGDY, 0)                      ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'             COAL(T1.SCORE_PTS, 0)                                 ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'             COAL(T1.STATEMENTS, 0)                      ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'               COAL(T1.STM_AMT_OL, 0)';
    v_sql := v_sql||'             + COAL(T2.STM_AMT_OL, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                      ,';
    v_sql := v_sql||'               COAL(T1.STM_BALFRE, 0)';
    v_sql := v_sql||'             + COAL(T2.STM_BALFRE, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                      ,';
    v_sql := v_sql||'               CASE';
    v_sql := v_sql||'                  WHEN T1.STMBALINTFLAG = ''+'' THEN T1.STM_BALINT';
    v_sql := v_sql||'                  ELSE T1.STM_BALINT * -1';
    v_sql := v_sql||'               END';
    v_sql := v_sql||'             + CASE';
    v_sql := v_sql||'                  WHEN T2.STMBALINTFLAG = ''+''   ';
    v_sql := v_sql||'                  THEN';
    v_sql := v_sql||'                     COAL(T2.STM_BALINT, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'                  ELSE';
    v_sql := v_sql||'                       COAL(T2.STM_BALINT, 0)';
    v_sql := v_sql||'                     * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'                     * -1';
    v_sql := v_sql||'               END';
    v_sql := v_sql||'                AS STM_BALINT                              ';
    v_sql := v_sql||'                             ,';
    v_sql := v_sql||'               CASE';
    v_sql := v_sql||'                  WHEN T1.STM_BALFLAG = ''+'' THEN T1.STM_BALNCE';
    v_sql := v_sql||'                  ELSE T1.STM_BALNCE * -1';
    v_sql := v_sql||'               END';
    v_sql := v_sql||'             + CASE';
    v_sql := v_sql||'                  WHEN T2.STM_BALFLAG = ''+''  ';
    v_sql := v_sql||'                  THEN';
    v_sql := v_sql||'                     COAL(T2.STM_BALNCE, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'                  ELSE';
    v_sql := v_sql||'                       COAL(T2.STM_BALNCE, 0)';
    v_sql := v_sql||'                     * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'                     * -1';
    v_sql := v_sql||'               END';
    v_sql := v_sql||'                AS STM_BALNCE                                ';
    v_sql := v_sql||'                             ,';
    v_sql := v_sql||'               COAL(T1.STM_BALORI, 0)';
    v_sql := v_sql||'             + COAL(T2.STM_BALORI, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                      ,';
    v_sql := v_sql||'             COAL(T1.STM_CLOSDY, 0)                         ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'             COAL(T1.STM_CODE, '' '')                                ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'               COAL(T1.STM_INSTL, 0)';
    v_sql := v_sql||'             + COAL(T2.STM_INSTL, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                     ,';
    v_sql := v_sql||'               COAL(T1.STM_MINDUE, 0)';
    v_sql := v_sql||'             + COAL(T2.STM_MINDUE, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                      ,';
    v_sql := v_sql||'               COAL(T1.STM_NOINT, 0)';
    v_sql := v_sql||'             + COAL(T2.STM_NOINT, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                     ,';
    v_sql := v_sql||'             COAL(T1.STM_OLFLAG, T2.STM_OLFLAG, 0)               ';
    v_sql := v_sql||'                                                       ,';
    v_sql := v_sql||'               COAL(T1.STM_OVERDU, 0)';
    v_sql := v_sql||'             + COAL(T2.STM_OVERDU, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                      ,';
    v_sql := v_sql||'               COAL(T1.STM_PAY_UN, 0)';
    v_sql := v_sql||'             + COAL(T2.STM_PAY_UN, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                      ,';
    v_sql := v_sql||'               COAL(T1.STM_QRYAMT, 0)';
    v_sql := v_sql||'             + COAL(T2.STM_QRYAMT, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                      ,';
    v_sql := v_sql||'               COAL(T1.STM_REPAY, 0)';
    v_sql := v_sql||'             + COAL(T2.STM_REPAY, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                     ,';
    v_sql := v_sql||'             COAL(T1.STMT_DD, 0)                                  ';
    v_sql := v_sql||'                                     ,';
    v_sql := v_sql||'             COAL(T1.STMT_PULL, '' '')                       ';
    v_sql := v_sql||'                                         ,';
    v_sql := v_sql||'               CASE';
    v_sql := v_sql||'                  WHEN T1.TODAY_AMTFLAG = ''+'' THEN T1.TODAY_AMT';
    v_sql := v_sql||'                  ELSE T1.TODAY_AMT * -1';
    v_sql := v_sql||'               END';
    v_sql := v_sql||'             + CASE';
    v_sql := v_sql||'                  WHEN T2.TODAY_AMTFLAG = ''+'' ';
    v_sql := v_sql||'                  THEN';
    v_sql := v_sql||'                     COAL(T2.TODAY_AMT, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'                  ELSE';
    v_sql := v_sql||'                       COAL(T2.TODAY_AMT, 0)';
    v_sql := v_sql||'                     * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'                     * -1';
    v_sql := v_sql||'               END';
    v_sql := v_sql||'                AS TODAY_AMT                             ';
    v_sql := v_sql||'                            ,';
    v_sql := v_sql||'             COAL(T1.TODAY_REL, T2.TODAY_REL)               ';
    v_sql := v_sql||'                                                  ,';
    v_sql := v_sql||'             COAL(T1.UNCL_PCT, T2.UNCL_PCT)                  ';
    v_sql := v_sql||'                                                ,';
    v_sql := v_sql||'             COAL(T1.WROFF_CHDY, 0)                               ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'             COAL(T1.WROFF_CODE, '' '')                              ';
    v_sql := v_sql||'                                          ,';
    v_sql := v_sql||'             COAL(T1.PROD_LEVEL, 0)                            ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'             COAL(T1.PROD_NBR, 0)                            ';
    v_sql := v_sql||'                                      ,';
    v_sql := v_sql||'             COAL(T1.ACCT_PRSTS, '' '')                         ';
    v_sql := v_sql||'                                          ,';
    v_sql := v_sql||'             COAL(T1.ACCT_STS, '' '')                              ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'             COAL(T1.APP_APQUE, '' '')                           ';
    v_sql := v_sql||'                                         ,';
    v_sql := v_sql||'             COAL(T1.POINT_ENC, 0)                              ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'             COAL(T1.POINT_IMP, 0)                           ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'             CASE';
    v_sql := v_sql||'                WHEN T1.PT_EXPFLAG = ''+'' THEN T1.POINT_EXP';
    v_sql := v_sql||'                ELSE T1.POINT_EXP * -1';
    v_sql := v_sql||'             END';
    v_sql := v_sql||'                AS POINT_EXP                                 ';
    v_sql := v_sql||'                            ,';
    v_sql := v_sql||'             COAL(T1.RISK_COUNT, 0)                           ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'             COAL(T1.RISK_DAYIN, 0)                            ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'               CASE';
    v_sql := v_sql||'                  WHEN T1.BAL_MPFLAG = ''+'' THEN T1.BAL_MP';
    v_sql := v_sql||'                  ELSE T1.BAL_MP * -1';
    v_sql := v_sql||'               END';
    v_sql := v_sql||'             + COAL(T2.BAL_MP, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'                AS BAL_MP                                      ';
    v_sql := v_sql||'                         ,';
    v_sql := v_sql||'               CASE';
    v_sql := v_sql||'                  WHEN T1.STM_BMFLAG = ''+'' THEN T1.STM_BALMP';
    v_sql := v_sql||'                  ELSE T1.STM_BALMP * -1';
    v_sql := v_sql||'               END';
    v_sql := v_sql||'             + COAL(T2.STM_BALMP, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'                AS STM_BALMP                                   ';
    v_sql := v_sql||'                            ,';
    v_sql := v_sql||'             COAL(T1.LMT_RSN, '' '')                             ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'             CASE';
    v_sql := v_sql||'                WHEN T1.PT_CDFLAG = ''+'' THEN T1.POINT_CARD';
    v_sql := v_sql||'                ELSE T1.POINT_CARD * -1';
    v_sql := v_sql||'             END';
    v_sql := v_sql||'                AS POINT_CARD                                 ';
    v_sql := v_sql||'                             ,';
    v_sql := v_sql||'             COAL(T1.TEMP_LIMIT, 0)                                ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'             COAL(T1.TLMT_BEG, 0)                              ';
    v_sql := v_sql||'                                      ,';
    v_sql := v_sql||'             COAL(T1.TLMT_END, 0)                              ';
    v_sql := v_sql||'                                      ,';
    v_sql := v_sql||'             COAL(T1.TLMT_NO, 0)                           ';
    v_sql := v_sql||'                                     ,';
    v_sql := v_sql||'             COAL(T1.CANCL_RESN, '' '')                            ';
    v_sql := v_sql||'                                          ,';
    v_sql := v_sql||'               COAL(T1.SHADOW_PEN, 0)';
    v_sql := v_sql||'             + COAL(T2.STM_REPAY, 0) * COAL(B.RATE_VAL0, 0)  ';
    v_sql := v_sql||'                                                                     ,';
    v_sql := v_sql||'               COAL(T1.SHADOW_INT, 0)';
    v_sql := v_sql||'             + COAL(T2.STM_REPAY, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                                                                     ,';
    v_sql := v_sql||'               COAL(T1.SHADOW_CMP, 0)';
    v_sql := v_sql||'             + COAL(T2.STM_REPAY, 0) * COAL(B.RATE_VAL0, 0)   ';
    v_sql := v_sql||'                                                                     ,';
    v_sql := v_sql||'               COAL(T1.BAL_NINT01, 0)';
    v_sql := v_sql||'             + COAL(T1.BAL_NINT02, 0)';
    v_sql := v_sql||'             + COAL(T1.BAL_NINT03, 0)';
    v_sql := v_sql||'             + COAL(T1.BAL_NINT04, 0)';
    v_sql := v_sql||'             + COAL(T1.BAL_NINT05, 0)';
    v_sql := v_sql||'             + COAL(T1.BAL_NINT06, 0)';
    v_sql := v_sql||'             + COAL(T1.BAL_NINT07, 0)';
    v_sql := v_sql||'             + COAL(T1.BAL_NINT08, 0)';
    v_sql := v_sql||'             + COAL(T1.BAL_NINT09, 0)';
    v_sql := v_sql||'             + COAL(T1.BAL_NINT10, 0)';
    v_sql := v_sql||'             + COAL(T2.BAL_NINT01, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'             + COAL(T2.BAL_NINT02, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'             + COAL(T2.BAL_NINT03, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'             + COAL(T2.BAL_NINT04, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'             + COAL(T2.BAL_NINT05, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'             + COAL(T2.BAL_NINT06, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'             + COAL(T2.BAL_NINT07, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'             + COAL(T2.BAL_NINT08, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'             + COAL(T2.BAL_NINT09, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'             + COAL(T2.BAL_NINT10, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'                AS BAL_NINT                                    ';
    v_sql := v_sql||'                           ,';
    v_sql := v_sql||'               COAL(T1.STM_NINT01, 0)';
    v_sql := v_sql||'             + COAL(T1.STM_NINT02, 0)';
    v_sql := v_sql||'             + COAL(T1.STM_NINT03, 0)';
    v_sql := v_sql||'             + COAL(T1.STM_NINT04, 0)';
    v_sql := v_sql||'             + COAL(T1.STM_NINT05, 0)';
    v_sql := v_sql||'             + COAL(T1.STM_NINT06, 0)';
    v_sql := v_sql||'             + COAL(T1.STM_NINT07, 0)';
    v_sql := v_sql||'             + COAL(T1.STM_NINT08, 0)';
    v_sql := v_sql||'             + COAL(T1.STM_NINT09, 0)';
    v_sql := v_sql||'             + COAL(T1.STM_NINT10, 0)';
    v_sql := v_sql||'             + COAL(T2.STM_NINT01, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'             + COAL(T2.STM_NINT02, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'             + COAL(T2.STM_NINT03, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'             + COAL(T2.STM_NINT04, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'             + COAL(T2.STM_NINT05, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'             + COAL(T2.STM_NINT06, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'             + COAL(T2.STM_NINT07, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'             + COAL(T2.STM_NINT08, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'             + COAL(T2.STM_NINT09, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'             + COAL(T2.STM_NINT10, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'                AS STM_NINT                                    ';
    v_sql := v_sql||'                           ,';
    v_sql := v_sql||'             COAL(T2.CURR_NUM, T1.CURR_NUM2, 0)                  ';
    v_sql := v_sql||'                                                    ,';
    v_sql := v_sql||'             COAL(T1.WROF_FLAG, 0)                              ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'             COAL(T1.LAYERCODER1, '' '')                          ';
    v_sql := v_sql||'                                           ,';
    v_sql := v_sql||'             COAL(T1.LAYERCODER2, '' '')                          ';
    v_sql := v_sql||'                                           ,';
    v_sql := v_sql||'             COAL(T1.MCNTRL_YN, '' '')                    ';
    v_sql := v_sql||'                                         ,';
    v_sql := v_sql||'             COAL(T1.NCRED_RSN, '' '')                          ';
    v_sql := v_sql||'                                         ,';
    v_sql := v_sql||'             COAL(T1.BSC_CRED, 0)                                ';
    v_sql := v_sql||'                                      ,';
    v_sql := v_sql||'             COAL(T1.CUSTR_REF, '' '')                           ';
    v_sql := v_sql||'                                         ,';
    v_sql := v_sql||'             COAL(T1.PBC_BRNCH, '' '')                             ';
    v_sql := v_sql||'                                         ,';
    v_sql := v_sql||'             COAL(T1.STOPMP_YN, '' '')                             ';
    v_sql := v_sql||'                                         ,';
    v_sql := v_sql||'             COAL(T1.CRED_LMT2, 0)                            ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'             COAL(T2.EXCH_AMT, 0)                  ';
    v_sql := v_sql||'                                      ,';
    v_sql := v_sql||'             COAL(T2.EXCH_AUTH, 0)                 ';
    v_sql := v_sql||'                                       ,';
    v_sql := v_sql||'             COAL(T2.EXCH_INQAM, 0)                ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'              ''0''                         ,';
    v_sql := v_sql||'             COAL(T1.BAL_CMPFEE, 0)                               ';
    v_sql := v_sql||'                                        ,';
    v_sql := v_sql||'               COAL(T1.STM_BALFRE, 0)';
    v_sql := v_sql||'             + COAL(T2.STM_BALFRE, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'             + CASE';
    v_sql := v_sql||'                  WHEN T1.STMBALINTFLAG = ''+'' THEN T1.STM_BALINT';
    v_sql := v_sql||'                  ELSE 0';
    v_sql := v_sql||'               END';
    v_sql := v_sql||'             + CASE';
    v_sql := v_sql||'                  WHEN T2.STMBALINTFLAG = ''+'' ';
    v_sql := v_sql||'                  THEN';
    v_sql := v_sql||'                     COAL(T2.STM_BALINT, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'                  ELSE';
    v_sql := v_sql||'                       0';
    v_sql := v_sql||'               END';
    v_sql := v_sql||'             + COAL(T1.STM_BALMP, 0)';
    v_sql := v_sql||'             + COAL(T2.STM_BALMP, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'             + COAL(T1.STM_BALORI, 0)';
    v_sql := v_sql||'             + COAL(T2.STM_BALORI, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'             + COAL(T1.STM_NOINT, 0)';
    v_sql := v_sql||'             + COAL(T2.STM_NOINT, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'             + COAL(T1.BAL_CMPINT, 0)';
    v_sql := v_sql||'             + COAL(T2.BAL_CMPINT, 0) * COAL(B.RATE_VAL0, 0)  ';
    v_sql := v_sql||'             + COAL(T1.BAL_FREE, 0)';
    v_sql := v_sql||'             + COAL(T2.BAL_FREE, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'             + CASE';
    v_sql := v_sql||'                  WHEN T1.BAL_INTFLAG = ''+'' THEN T1.BAL_INT';
    v_sql := v_sql||'                  ELSE 0';
    v_sql := v_sql||'               END';
    v_sql := v_sql||'             + CASE';
    v_sql := v_sql||'                  WHEN T2.BALINTFLAG = ''+'' ';
    v_sql := v_sql||'                  THEN';
    v_sql := v_sql||'                     COAL(T2.BAL_INT, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'                  ELSE';
    v_sql := v_sql||'                       0';
    v_sql := v_sql||'               END';
    v_sql := v_sql||'             + CASE';
    v_sql := v_sql||'                  WHEN T1.BAL_MPFLAG = ''+'' THEN T1.BAL_MP';
    v_sql := v_sql||'                  ELSE 0';
    v_sql := v_sql||'               END';
    v_sql := v_sql||'             + COAL(T2.BAL_MP, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'             + COAL(T1.BAL_ORINT, 0)';
    v_sql := v_sql||'             + COAL(T2.BAL_ORINT, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'             + COAL(T1.BAL_NOINT, 0)';
    v_sql := v_sql||'             + COAL(T2.BAL_NOINT, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'             + COAL(T1.Auths_Amt, 0)';
    v_sql := v_sql||'             + COAL(T2.Auths_Amt, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'             + COAL(T1.MP_REM_PPL, 0)';
    v_sql := v_sql||'             + COAL(T2.MP_REM_PPL, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'             + COAL(T3.MP_BAL, 0)                        ';
    v_sql := v_sql||'             + COAL(T1.MP_AUTHS, 0)';
    v_sql := v_sql||'             + COAL(T2.MP_AUTHS, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'             + COAL(T3.MP_AUTHS, 0)                           ';
    v_sql := v_sql||'                AS BAL_ADD14 ,';
    v_sql := v_sql||'             CASE';
    v_sql := v_sql||'                WHEN COAL(T3.MP_BAL, 0) > 0 THEN ''1'' ';
    v_sql := v_sql||'                WHEN COAL(T1.MP_BAL, 0) > 0 THEN ''2'' ';
    v_sql := v_sql||'                WHEN COAL(T2.MP_BAL, 0) > 0 THEN ''2'' ';
    v_sql := v_sql||'                ELSE ''0'' ';
    v_sql := v_sql||'             END';
    v_sql := v_sql||'                AS PRODUCT                                            ';
    v_sql := v_sql||'                          ,';
    v_sql := v_sql||'               COAL(T1.STM_BALFRE, 0)';
    v_sql := v_sql||'             + COAL(T2.STM_BALFRE, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'             + CASE';
    v_sql := v_sql||'                  WHEN T1.STMBALINTFLAG = ''+'' THEN T1.STM_BALINT';
    v_sql := v_sql||'                  ELSE 0';
    v_sql := v_sql||'               END';
    v_sql := v_sql||'             + CASE';
    v_sql := v_sql||'                  WHEN T2.STMBALINTFLAG = ''+''   ';
    v_sql := v_sql||'                  THEN';
    v_sql := v_sql||'                     COAL(T2.STM_BALINT, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'                  ELSE';
    v_sql := v_sql||'                       0';
    v_sql := v_sql||'               END';
    v_sql := v_sql||'             + COAL(T1.STM_BALMP, 0)';
    v_sql := v_sql||'             + COAL(T2.STM_BALMP, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'             + COAL(T1.STM_BALORI, 0)';
    v_sql := v_sql||'             + COAL(T2.STM_BALORI, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'             + COAL(T1.STM_NOINT, 0)';
    v_sql := v_sql||'             + COAL(T2.STM_NOINT, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'             + COAL(T1.BAL_CMPINT, 0)';
    v_sql := v_sql||'             + COAL(T2.BAL_CMPINT, 0) * COAL(B.RATE_VAL0, 0)  ';
    v_sql := v_sql||'             + COAL(T1.BAL_FREE, 0)';
    v_sql := v_sql||'             + COAL(T2.BAL_FREE, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'             + CASE';
    v_sql := v_sql||'                  WHEN T1.BAL_INTFLAG = ''+'' THEN T1.BAL_INT';
    v_sql := v_sql||'                  ELSE 0';
    v_sql := v_sql||'               END';
    v_sql := v_sql||'             + CASE';
    v_sql := v_sql||'                  WHEN T2.BALINTFLAG = ''+'' ';
    v_sql := v_sql||'                  THEN';
    v_sql := v_sql||'                     COAL(T2.BAL_INT, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql := v_sql||'                  ELSE';
    v_sql := v_sql||'                       0';
    v_sql := v_sql||'               END';
    v_sql := v_sql||'             + CASE';
    v_sql := v_sql||'                  WHEN T1.BAL_MPFLAG = ''+'' THEN T1.BAL_MP';
    v_sql := v_sql||'                  ELSE 0';
    v_sql := v_sql||'               END';
    v_sql := v_sql||'             + COAL(T2.BAL_MP, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'             + COAL(T1.BAL_ORINT, 0)';
    v_sql := v_sql||'             + COAL(T2.BAL_ORINT, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'             + COAL(T1.BAL_NOINT, 0)';
    v_sql := v_sql||'             + COAL(T2.BAL_NOINT, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'             + COAL(T1.Auths_Amt, 0)';
    v_sql := v_sql||'             + COAL(T2.Auths_Amt, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'             + COAL(T1.MP_REM_PPL, 0)';
    v_sql := v_sql||'             + COAL(T2.MP_REM_PPL, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'             + COAL(T1.MP_AUTHS, 0)';
    v_sql := v_sql||'             + COAL(T2.MP_AUTHS, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                AS BAL                                            ';
    v_sql := v_sql||'                      ,';
    v_sql := v_sql||'             COAL(T3.CAL_LIMIT, 0),';
    v_sql := v_sql||'             COAL(T3.MP_L_LMT, 0),';
    v_sql := v_sql||'             CASE WHEN T1.STMBALINTFLAG = ''+'' THEN  T1.STM_BALINT ELSE  T1.STM_BALINT * -1 END                                 ';
    v_sql := v_sql||'                        + CASE WHEN T2.STMBALINTFLAG = ''+'' THEN  COAL(T2.STM_BALINT ,0) * COAL(B.RATE_VAL0,0)  ELSE ';
    v_sql := v_sql||'                          COAL(T2.STM_BALINT ,0) * COAL(B.RATE_VAL0,0) * -1 END';
    v_sql := v_sql||'                        + COAL(T1.STM_BALMP,0) + COAL(T2.STM_BALMP ,0) * COAL(B.RATE_VAL0,0)        ';
    v_sql := v_sql||'                        + COAL(T1.STM_BALORI,0) + COAL(T2.STM_BALORI ,0) * COAL(B.RATE_VAL0,0)       ';
    v_sql := v_sql||'                        + COAL(T1.STM_NOINT,0)  + COAL(T2.STM_NOINT ,0) * COAL(B.RATE_VAL0,0)        ';
    v_sql := v_sql||'                        + COAL(T1.BAL_CMPINT,0) + COAL(T2.BAL_CMPINT ,0) * COAL(B.RATE_VAL0,0)      ';
    v_sql := v_sql||'                        + COAL(T1.BAL_FREE,0) + COAL(T2.BAL_FREE ,0) * COAL(B.RATE_VAL0,0)      ';
    v_sql := v_sql||'                        + CASE WHEN T1.BAL_INTFLAG = ''+'' THEN  T1.BAL_INT ELSE  T1.BAL_INT * -1 END';
    v_sql := v_sql||'                        + CASE WHEN T2.BALINTFLAG = ''+''  THEN  COAL(T2.BAL_INT ,0) * COAL(B.RATE_VAL0,0) ELSE  ';
    v_sql := v_sql||'                          COAL(T2.BAL_INT ,0) * COAL(B.RATE_VAL0,0) * -1 END';
    v_sql := v_sql||'                        + CASE WHEN T1.BAL_MPFLAG = ''+'' THEN  T1.BAL_MP ELSE  T1.BAL_MP * -1 END';
    v_sql := v_sql||'                        + COAL(T2.BAL_MP ,0) * COAL(B.RATE_VAL0,0)                                        ';
    v_sql := v_sql||'                        + COAL(T1.BAL_ORINT,0) + COAL(T2.BAL_ORINT ,0) * COAL(B.RATE_VAL0,0)   ';
    v_sql := v_sql||'                        + COAL(T1.BAL_NOINT,0) + COAL(T2.BAL_NOINT ,0) * COAL(B.RATE_VAL0,0)      ';
    v_sql := v_sql||'                        + COAL(T1.STM_BALFRE, 0)';
    v_sql := v_sql||'             + COAL(T2.STM_BALFRE, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql := v_sql||'                      as  BAL_WO_AUTHS ';
    v_sql := v_sql||'       FROM V_FDM_S24_CUR_ACCT_COM T1';
    v_sql := v_sql||'             LEFT JOIN FDM_S24_CUR_ACCX T2 ON T1.XACCOUNT = T2.XACCOUNT';
    v_sql := v_sql||'             LEFT JOIN FDM_S24_CUR_ACCA T3 ON T1.XACCOUNT = T3.XACCOUNT';
    v_sql := v_sql||'             LEFT JOIN V_PRMXR B';
    v_sql := v_sql||'                ON T2.BANK = B.BANK AND T2.CURR_NUM = B.CURR_NUM';
    DBMS_OUTPUT.PUT_LINE(v_sql);
    DBMS_OUTPUT.PUT_LINE('v_sql after:=========');
    EXECUTE IMMEDIATE v_sql;

    DBMS_OUTPUT.PUT_LINE('START EXECUTE TRUNCATE TABLE MDM_ACCT_X_SP');
    DECLARE TRUN_TBL_MDM_ACCT_X_SP STRING = 'TRUNCATE TABLE MDM_ACCT_X_SP';
    EXECUTE TRUN_TBL_MDM_ACCT_X_SP;

    DBMS_OUTPUT.PUT_LINE('START INSERT INTO MDM_ACCT_X_SP');
    DBMS_OUTPUT.PUT_LINE('v_sql1 before:=========' || v_sql1);
    v_sql1 := 'INSERT INTO MDM_ACCT_X_SP  ';
    v_sql1 := v_sql1||'      SELECT COAL(T1.XACCOUNT, T2.XACCOUNT)                        ';
    v_sql1 := v_sql1||'                                                ,';
    v_sql1 := v_sql1||'             COAL(T1.BANK, T2.BANK)                                ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'             COAL(T1.BUSINESS, T2.BUSINESS)             ';
    v_sql1 := v_sql1||'                                                ,';
    v_sql1 := v_sql1||'             COAL(T1.CATEGORY, T2.CATEGORY)                        ';
    v_sql1 := v_sql1||'                                                ,';
    v_sql1 := v_sql1||'             COAL(T1.CUSTR_NBR, '' '')                          ';
    v_sql1 := v_sql1||'                                         ,';
    v_sql1 := v_sql1||'             COAL(T1.CYCLE_NBR, 0)                                ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'             COAL(T1.DAY_OPENED, 0) AS DAY_OPENED                 ';
    v_sql1 := v_sql1||'                                                      ,';
    v_sql1 := v_sql1||'             COAL(T1.ACC_NAME1, '' '')                              ';
    v_sql1 := v_sql1||'                                         ,';
    v_sql1 := v_sql1||'             COAL(T1.ACC_TYPE, '' '')                          ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'             COAL(T1.ADD_CHGDAY, 0)                            ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'             COAL(T1.ADDR_TYPE, '' '')                            ';
    v_sql1 := v_sql1||'                                         ,';
    v_sql1 := v_sql1||'             COAL(T1.ADDR_TYPE2, '' '')                          ';
    v_sql1 := v_sql1||'                                          ,';
    v_sql1 := v_sql1||'               COAL(T1.AGE1, 0)';
    v_sql1 := v_sql1||'             + COAL(T1.AGE2, 0)';
    v_sql1 := v_sql1||'             + COAL(T1.AGE3, 0)';
    v_sql1 := v_sql1||'             + COAL(T1.AGE4, 0)';
    v_sql1 := v_sql1||'             + COAL(T1.AGE5, 0)';
    v_sql1 := v_sql1||'             + COAL(T1.AGE6, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.AGE1, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.AGE2, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.AGE3, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.AGE4, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.AGE5, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.AGE6, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'                AS AGE                                             ';
    v_sql1 := v_sql1||'             ,'' ''      ';
    v_sql1 := v_sql1||'             ,'' ''       ';
    v_sql1 := v_sql1||'             ,';
    v_sql1 := v_sql1||'             COAL(T1.AUTH_OVER, 0)                           ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'             COAL(T1.AUTHOV_YN, '' '')                         ';
    v_sql1 := v_sql1||'                                         ,';
    v_sql1 := v_sql1||'               COAL(T1.AUTHS_AMT, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.AUTHS_AMT, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                     ,';
    v_sql1 := v_sql1||'               COAL(T1.BAL_CMPINT, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.BAL_CMPINT, 0) * COAL(B.RATE_VAL0, 0)  ';
    v_sql1 := v_sql1||'                                                                      ,';
    v_sql1 := v_sql1||'               COAL(T1.BAL_FREE, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.BAL_FREE, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                    ,';
    v_sql1 := v_sql1||'               CASE';
    v_sql1 := v_sql1||'                  WHEN T1.BAL_INTFLAG = ''+'' THEN T1.BAL_INT';
    v_sql1 := v_sql1||'                  ELSE T1.BAL_INT * -1';
    v_sql1 := v_sql1||'               END';
    v_sql1 := v_sql1||'             + CASE';
    v_sql1 := v_sql1||'                  WHEN T2.BALINTFLAG = ''+''   ';
    v_sql1 := v_sql1||'                  THEN';
    v_sql1 := v_sql1||'                     COAL(T2.BAL_INT, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'                  ELSE';
    v_sql1 := v_sql1||'                       COAL(T2.BAL_INT, 0)';
    v_sql1 := v_sql1||'                     * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'                     * -1';
    v_sql1 := v_sql1||'               END';
    v_sql1 := v_sql1||'                AS BAL_INT                                   ';
    v_sql1 := v_sql1||'                          ,';
    v_sql1 := v_sql1||'               COAL(T1.BAL_NOINT, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.BAL_NOINT, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                     ,';
    v_sql1 := v_sql1||'               COAL(T1.BAL_ORINT, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.BAL_ORINT, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                     ,';
    v_sql1 := v_sql1||'             COAL(T1.BANKACCT1, '' '')                            ';
    v_sql1 := v_sql1||'                                         ,';
    v_sql1 := v_sql1||'             COAL(T1.BANKCODE1, '' '')                        ';
    v_sql1 := v_sql1||'                                         ,';
    v_sql1 := v_sql1||'             COAL(T1.BANKACCT2, '' '')                       ';
    v_sql1 := v_sql1||'                                         ,';
    v_sql1 := v_sql1||'             COAL(T1.BANKCODE2, '' '')                       ';
    v_sql1 := v_sql1||'                                         ,';
    v_sql1 := v_sql1||'             COAL(T1.BANKACCT3, '' '')                           ';
    v_sql1 := v_sql1||'                                         ,';
    v_sql1 := v_sql1||'             COAL(T1.BANKCODE3, '' '')                        ';
    v_sql1 := v_sql1||'                                         ,';
    v_sql1 := v_sql1||'             COAL(T1.BANKACCT4, '' '')                        ';
    v_sql1 := v_sql1||'                                         ,';
    v_sql1 := v_sql1||'             COAL(T1.BANKCODE4, '' '')                        ';
    v_sql1 := v_sql1||'                                         ,';
    v_sql1 := v_sql1||'             COAL(T1.BRANCH, 0)                                     ';
    v_sql1 := v_sql1||'                                    ,';
    v_sql1 := v_sql1||'             COAL(T1.BRANCH_DAY, 0)                            ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'             COAL(T1.CA_PCNT, 0)                                 ';
    v_sql1 := v_sql1||'                                     ,';
    v_sql1 := v_sql1||'             COAL(T1.CARD_FEES, 0)                                   ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'             COAL(T1.CARDS_CANC, 0)                           ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'             COAL(T1.CARDS_ISSD, 0)                           ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'             COAL(T1.CASH_1ST, 0)                          ';
    v_sql1 := v_sql1||'                                      ,';
    v_sql1 := v_sql1||'               COAL(T1.CASH_ADFEE, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.CASH_ADFEE, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                      ,';
    v_sql1 := v_sql1||'               COAL(T1.CASH_ADVCE, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.CASH_ADVCE, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                      ,';
    v_sql1 := v_sql1||'               COAL(T1.CASH_TDAY, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.CASH_TDAY, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                     ,';
    v_sql1 := v_sql1||'             COAL(T1.CASH1STAC, 0)                      ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'             COAL(T1.CLASS_CHDY, 0)                     ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'             COAL(T1.CLASS_CODE, '' '')                   ';
    v_sql1 := v_sql1||'                                          ,';
    v_sql1 := v_sql1||'             COAL(T1.CLOSE_CHDY, 0)                     ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'             COAL(T1.CLOSE_CODE, '' '')                   ';
    v_sql1 := v_sql1||'                                          ,';
    v_sql1 := v_sql1||'             COAL(T1.COLLS_DAY, 0)                      ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'             COAL(T1.CRDACT_DAY, 0)                     ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'             COAL(T1.CRDNXT_DAY, 0)                     ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'             COAL(T1.CRED_ACTIV, '' '')                   ';
    v_sql1 := v_sql1||'                                          ,';
    v_sql1 := v_sql1||'               COAL(T1.CRED_ADJ, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.CRED_ADJ, 0) * COAL(B.RATE_VAL0, 0)  ';
    v_sql1 := v_sql1||'                                                                    ,';
    v_sql1 := v_sql1||'             COAL(T1.CRED_CHDAY, 0)                     ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'             COAL(T1.CRED_LIMIT, 0)                     ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'             COAL(T1.CRED_VOUCH, 0)                     ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'             COAL(T1.CREDLIM_X, 0)                  ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'             COAL(T1.CURR_NUM, '' '')                            ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'             COAL(T1.CUTOFF_DAY, 0)                            ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'             COAL(T1.CY_CHGCNT, 0)                             ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'             COAL(T1.CY_CHGDAY, 0)                           ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'             COAL(T1.CY_EFFDAY, 0)                           ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'             COAL(T1.CY_YRCNT, 0)                               ';
    v_sql1 := v_sql1||'                                      ,';
    v_sql1 := v_sql1||'             COAL(T1.CYCLE_NEW, 0)                                ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'             COAL(T1.CYCLE_PRV, 0)                                ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'               COAL(T1.DEBIT_ADJ, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.DEBIT_ADJ, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                     ,';
    v_sql1 := v_sql1||'             COAL(T1.DISHNRDAY, 0)                         ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'             ''0''            ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'             ''0''                      ,';
    v_sql1 := v_sql1||'             COAL(T1.EXCH_CODE, '' '')                            ';
    v_sql1 := v_sql1||'                                         ,';
    v_sql1 := v_sql1||'             COAL(T1.EXCH_FLAG, '' '')               ';
    v_sql1 := v_sql1||'                                         ,';
    v_sql1 := v_sql1||'             COAL(T1.EXCH_PERC, 0)                 ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'             COAL(T1.EXCH_RTDT, 0)                 ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'             COAL(T1.FEE_MONTH, 0)                         ';
    v_sql1 := v_sql1||'                                       ,''0''            ';
    v_sql1 := v_sql1||'             ,';
    v_sql1 := v_sql1||'             COAL(T1.FIX_EXAMT, 0)                               ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'             COAL(T1.GUARN_FLAG, 0)                               ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'             CASE';
    v_sql1 := v_sql1||'                WHEN T1.HI_CASHADV >=';
    v_sql1 := v_sql1||'                          COAL(T2.HI_CASHADV, 0)';
    v_sql1 := v_sql1||'                        * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'                THEN';
    v_sql1 := v_sql1||'                   T1.HI_CASHADV';
    v_sql1 := v_sql1||'                ELSE';
    v_sql1 := v_sql1||'                   COAL(T2.HI_CASHADV, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'             END                                                   ';
    v_sql1 := v_sql1||'                ,';
    v_sql1 := v_sql1||'             CASE';
    v_sql1 := v_sql1||'                WHEN T1.HI_CASHADV >=';
    v_sql1 := v_sql1||'                          COAL(T2.HI_CASHADV, 0)';
    v_sql1 := v_sql1||'                        * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'                THEN';
    v_sql1 := v_sql1||'                   T1.HI_CASMMYY';
    v_sql1 := v_sql1||'                ELSE';
    v_sql1 := v_sql1||'                   COAL(T2.HI_CASMMYY, 0)';
    v_sql1 := v_sql1||'             END';
    v_sql1 := v_sql1||'                ,''0''            ';
    v_sql1 := v_sql1||'                ,''0''            ';
    v_sql1 := v_sql1||'                ,''0''            ';
    v_sql1 := v_sql1||'                ,''0''            ';
    v_sql1 := v_sql1||'                ,''0''            ';
    v_sql1 := v_sql1||'                ,''0''            ';
    v_sql1 := v_sql1||'                ,''0''            ';
    v_sql1 := v_sql1||'                ,''0''            ';
    v_sql1 := v_sql1||'             ,';
    v_sql1 := v_sql1||'             CASE';
    v_sql1 := v_sql1||'                WHEN T1.HI_PURCHSE >=';
    v_sql1 := v_sql1||'                          COAL(T2.HI_PURCHSE, 0)';
    v_sql1 := v_sql1||'                        * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'                THEN';
    v_sql1 := v_sql1||'                   T1.HI_PURCHSE';
    v_sql1 := v_sql1||'                ELSE';
    v_sql1 := v_sql1||'                   COAL(T2.HI_PURCHSE, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'             END                                                     ';
    v_sql1 := v_sql1||'                ,';
    v_sql1 := v_sql1||'             CASE';
    v_sql1 := v_sql1||'                WHEN T1.HI_PURCHSE >=';
    v_sql1 := v_sql1||'                          COAL(T2.HI_PURCHSE, 0)';
    v_sql1 := v_sql1||'                        * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'                THEN';
    v_sql1 := v_sql1||'                   T1.HI_PURMMYY';
    v_sql1 := v_sql1||'                ELSE';
    v_sql1 := v_sql1||'                   COAL(T2.HI_PURMMYY, 0)';
    v_sql1 := v_sql1||'             END';
    v_sql1 := v_sql1||'             ,';
    v_sql1 := v_sql1||'               COAL(T1.INT_CASH, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.INT_CASH, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                    ,';
    v_sql1 := v_sql1||'               COAL(T1.INT_CHDCMP, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.INT_CHDCMP, 0) * COAL(B.RATE_VAL0, 0)  ';
    v_sql1 := v_sql1||'                                                                      ,';
    v_sql1 := v_sql1||'             COAL(T1.INT_CHDY, 0)                          ';
    v_sql1 := v_sql1||'                                      ,';
    v_sql1 := v_sql1||'               COAL(T1.INT_CHGD, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.INT_CHGD, 0) * COAL(B.RATE_VAL0, 0)  ';
    v_sql1 := v_sql1||'                                                                    ,';
    v_sql1 := v_sql1||'               COAL(T1.INT_CMPOND, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.INT_CMPOND, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                      ,';
    v_sql1 := v_sql1||'             COAL(T1.INT_CODE, T2.INT_CODE)                        ';
    v_sql1 := v_sql1||'                                                ,';
    v_sql1 := v_sql1||'               COAL(T1.INT_CUNOT, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.INT_CUNOT, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                     ,';
    v_sql1 := v_sql1||'               COAL(T1.INT_CURCMP, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.INT_CURCMP, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                      ,';
    v_sql1 := v_sql1||'               COAL(T1.INT_EARNED, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.INT_EARNED, 0) * COAL(B.RATE_VAL0, 0)  ';
    v_sql1 := v_sql1||'                                                                      ,';
    v_sql1 := v_sql1||'               COAL(T1.INT_NOTION, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.INT_NOTION, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                      ,';
    v_sql1 := v_sql1||'             COAL(T1.INT_PROCDY, T2.INT_PROCDY)                  ';
    v_sql1 := v_sql1||'                                                    ,';
    v_sql1 := v_sql1||'             COAL(T1.INT_RATE, T2.INT_RATE)                        ';
    v_sql1 := v_sql1||'                                                ,''0''            ';
    v_sql1 := v_sql1||'             ,';
    v_sql1 := v_sql1||'             COAL(T1.INT_UPTODY, T2.INT_UPTODY)                ';
    v_sql1 := v_sql1||'                                                    ,';
    v_sql1 := v_sql1||'             COAL(T1.LANG_CODE, 0)                                 ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'             COAL(T1.LAST_TRDAY, T2.LAST_TRDAY)             ';
    v_sql1 := v_sql1||'                                                    ,';
    v_sql1 := v_sql1||'             COAL(T1.LASTAUTHDY, 0)                         ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'             COAL(T1.LASTNTDATE, T2.LASTNTDATE)             ';
    v_sql1 := v_sql1||'                                                    ,';
    v_sql1 := v_sql1||'             CASE';
    v_sql1 := v_sql1||'                WHEN T1.LASTPAYDAY + 0 = COAL(T2.LASTPAYDAY, 0)';
    v_sql1 := v_sql1||'                THEN';
    v_sql1 := v_sql1||'                     T1.LASTPAYAMT';
    v_sql1 := v_sql1||'                   + COAL(T2.LASTPAYAMT, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'                WHEN T1.LASTPAYDAY + 0 > COAL(T2.LASTPAYDAY, 0)';
    v_sql1 := v_sql1||'                THEN';
    v_sql1 := v_sql1||'                   T1.LASTPAYAMT * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'                ELSE';
    v_sql1 := v_sql1||'                   COAL(T2.LASTPAYAMT, 0)';
    v_sql1 := v_sql1||'             END                                                    ';
    v_sql1 := v_sql1||'                ,';
    v_sql1 := v_sql1||'             CASE';
    v_sql1 := v_sql1||'                WHEN T1.LASTPAYDAY + 0 = COAL(T2.LASTPAYDAY, 0)';
    v_sql1 := v_sql1||'                THEN';
    v_sql1 := v_sql1||'                   T1.LASTPAYDAY';
    v_sql1 := v_sql1||'                WHEN T1.LASTPAYDAY + 0 > COAL(T2.LASTPAYDAY, 0)';
    v_sql1 := v_sql1||'                THEN';
    v_sql1 := v_sql1||'                   T1.LASTPAYDAY';
    v_sql1 := v_sql1||'                ELSE';
    v_sql1 := v_sql1||'                   COAL(T2.LASTPAYDAY, 0)';
    v_sql1 := v_sql1||'             END ';
    v_sql1 := v_sql1||'             ,';
    v_sql1 := v_sql1||'             COAL(T1.LOSSES, 0)                                ';
    v_sql1 := v_sql1||'                                    ,';
    v_sql1 := v_sql1||'             COAL(T1.MONTH_NBR, 0)                               ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'             COAL(T1.MONTR_CHDY, 0)                        ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'             COAL(T1.MONTR_CODE, '' '')                             ';
    v_sql1 := v_sql1||'                                          ,';
    v_sql1 := v_sql1||'             COAL(T1.MP_AM_TDY, 0)                             ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'               COAL(T1.MP_AUTHS, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.MP_AUTHS, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                    ,';
    v_sql1 := v_sql1||'               COAL(T1.MP_BAL, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.MP_BAL, 0) * COAL(B.RATE_VAL0, 0)  ';
    v_sql1 := v_sql1||'                                                                  ,';
    v_sql1 := v_sql1||'               COAL(T1.MP_BIL_AMT, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.STM_BALMP, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                     ,';
    v_sql1 := v_sql1||'             COAL(T1.MP_LIMIT, 0)                              ';
    v_sql1 := v_sql1||'                                      ,';
    v_sql1 := v_sql1||'             COAL(T1.MP_NO_TDY, 0)                           ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'               COAL(T1.MP_REM_PPL, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.MP_REM_PPL, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                      ,';
    v_sql1 := v_sql1||'             COAL(T1.MPLM_CHDAY, 0)                          ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'             CASE';
    v_sql1 := v_sql1||'                WHEN T1.MTHS_ODUE + 0 >= COAL(T2.MTHS_ODUE, 0)';
    v_sql1 := v_sql1||'                THEN';
    v_sql1 := v_sql1||'                   T1.MTHS_ODUE';
    v_sql1 := v_sql1||'                ELSE';
    v_sql1 := v_sql1||'                   COAL(T2.MTHS_ODUE, 0)';
    v_sql1 := v_sql1||'             END                                                      ';
    v_sql1 := v_sql1||'                ,';
    v_sql1 := v_sql1||'             COAL(T1.NBR_CASHAD, 0) + COAL(T2.NBR_CASHAD, 0) ';
    v_sql1 := v_sql1||'                                                                      ,';
    v_sql1 := v_sql1||'             COAL(T1.NBR_FEEDTY, 0) + COAL(T2.NBR_FEEDTY, 0) ';
    v_sql1 := v_sql1||'                                                                      ,';
    v_sql1 := v_sql1||'             COAL(T1.NBR_OLIMIT, 0) + COAL(T2.NBR_OLIMIT, 0) ';
    v_sql1 := v_sql1||'                                                                      ,';
    v_sql1 := v_sql1||'             COAL(T1.NBR_OTHERS, 0) + COAL(T2.NBR_OTHERS, 0) ';
    v_sql1 := v_sql1||'                                                                      ,';
    v_sql1 := v_sql1||'             COAL(T1.NBR_PAYMNT, 0) + COAL(T2.NBR_PAYMNT, 0) ';
    v_sql1 := v_sql1||'                                                                      ,';
    v_sql1 := v_sql1||'             COAL(T1.NBR_PURCH, 0) + COAL(T2.NBR_PURCH, 0) ';
    v_sql1 := v_sql1||'                                                                    ,';
    v_sql1 := v_sql1||'             COAL(T1.NBR_TRANS, 0) + COAL(T2.NBR_TRANS, 0) ';
    v_sql1 := v_sql1||'                                                                    ,';
    v_sql1 := v_sql1||'             COAL(T1.OCT_COUNT, 0)                           ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'             COAL(T1.OCT_DAYIN, 0)                           ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'             COAL(T1.ODUE_FLAG, T2.ODUE_FLAG, 0)               ';
    v_sql1 := v_sql1||'                                                     ,';
    v_sql1 := v_sql1||'               COAL(T1.ODUE_HELD, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.ODUE_HELD, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                     ,';
    v_sql1 := v_sql1||'             COAL(T1.OLFLAG, T2.OLFLAG, 0)                     ';
    v_sql1 := v_sql1||'                                               ,';
    v_sql1 := v_sql1||'               COAL(T1.OTHER_FEES, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.OTHER_FEES, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                      ,';
    v_sql1 := v_sql1||'             CASE';
    v_sql1 := v_sql1||'                WHEN     COAL(T1.PAY_FLAG, ''1'') = ''1'' ';
    v_sql1 := v_sql1||'                     AND COAL(T2.PAY_FLAG, ''1'') = ''1'' ';
    v_sql1 := v_sql1||'                THEN';
    v_sql1 := v_sql1||'                   ''1'' ';
    v_sql1 := v_sql1||'                ELSE';
    v_sql1 := v_sql1||'                   ''0''   ';
    v_sql1 := v_sql1||'             END                                                    ';
    v_sql1 := v_sql1||'                ,';
    v_sql1 := v_sql1||'             COAL(T1.PAY1ST_IND, '' '')                          ';
    v_sql1 := v_sql1||'                                          ,';
    v_sql1 := v_sql1||'               COAL(T1.PAYMT_CLRD, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.PAYMT_CLRD, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                      ,';
    v_sql1 := v_sql1||'                T1.PAYMT_TDAY';
    v_sql1 := v_sql1||'             +';
    v_sql1 := v_sql1||'                     COAL(T2.PAYMT_TDAY, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'';
    v_sql1 := v_sql1||'                                                                   ';
    v_sql1 := v_sql1||'                  ,';
    v_sql1 := v_sql1||'               COAL(T1.PAYMT_UNCL, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.PAYMT_UNCL, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                      ,';
    v_sql1 := v_sql1||'               COAL(T1.PEN_CHRG, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.PEN_CHRG, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                    ,';
    v_sql1 := v_sql1||'               COAL(T1.PENCHG_ACC, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.PENCHG_ACC, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                      ,';
    v_sql1 := v_sql1||'             COAL(T1.POINT_ADJ, 0)                               ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'             COAL(T1.PT_ADJFLAG, '' '')                       ';
    v_sql1 := v_sql1||'                                          ,';
    v_sql1 := v_sql1||'             COAL(T1.POINT_CLM, 0)                          ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'             COAL(T1.POINT_CUM, 0)                          ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'             COAL(T1.PT_CUMFLAG, '' '')                       ';
    v_sql1 := v_sql1||'                                          ,';
    v_sql1 := v_sql1||'             COAL(T1.POINT_CUM2, 0)                         ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'             COAL(T1.POINT_EAR, 0)                            ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'             COAL(T1.POINT_FREZ, '' '')                         ';
    v_sql1 := v_sql1||'                                          ,';
    v_sql1 := v_sql1||'             COAL(T1.POINT_FZDA, 0)                           ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'             COAL(T1.POST_DD, 0)                              ';
    v_sql1 := v_sql1||'                                     ,';
    v_sql1 := v_sql1||'             COAL(T1.PREV_BRDAY, 0)                           ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'             COAL(T1.PREV_BRNCH, 0)                              ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'               COAL(T1.PURCHASES, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.PURCHASES, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                     ,';
    v_sql1 := v_sql1||'               COAL(T1.QUERY_AMT, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.QUERY_AMT, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                     ,';
    v_sql1 := v_sql1||'             COAL(T1.QUERY_CODE, T2.QUERY_CODE, ''0'')        ';
    v_sql1 := v_sql1||'                                                         ,';
    v_sql1 := v_sql1||'             COAL(T1.QUERY_STMT, T2.QUERY_STMT, 0)          ';
    v_sql1 := v_sql1||'                                                       ,';
    v_sql1 := v_sql1||'             COAL(T1.RECLA_CHDY, 0)                         ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'             COAL(T1.RECLA_CODE, '' '')                      ';
    v_sql1 := v_sql1||'                                          ,';
    v_sql1 := v_sql1||'             COAL(T1.RECVRY_AMT, 0)                        ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'             COAL(T1.REPAY_AMT, 0)                            ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'             COAL(T1.REPAY_AMTX, 0)                           ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'             COAL(T1.REPAY_CODE, '' '')                         ';
    v_sql1 := v_sql1||'                                          ,';
    v_sql1 := v_sql1||'             COAL(T1.REPAY_CODX, '' '')                         ';
    v_sql1 := v_sql1||'                                          ,';
    v_sql1 := v_sql1||'             COAL(T1.REPAY_DAY, 0)                            ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'             COAL(T1.REPAY_PCT, 0)                            ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'             COAL(T1.REPAY_PCTX, 0)                           ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'             COAL(T1.REPY_CHGDY, 0)                      ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'             COAL(T1.SCORE_PTS, 0)                                 ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'             COAL(T1.STATEMENTS, 0)                      ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'               COAL(T1.STM_AMT_OL, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.STM_AMT_OL, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                      ,';
    v_sql1 := v_sql1||'               COAL(T1.STM_BALFRE, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.STM_BALFRE, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                      ,';
    v_sql1 := v_sql1||'               CASE';
    v_sql1 := v_sql1||'                  WHEN T1.STMBALINTFLAG = ''+'' THEN T1.STM_BALINT';
    v_sql1 := v_sql1||'                  ELSE T1.STM_BALINT * -1';
    v_sql1 := v_sql1||'               END';
    v_sql1 := v_sql1||'             + CASE';
    v_sql1 := v_sql1||'                  WHEN T2.STMBALINTFLAG = ''+''   ';
    v_sql1 := v_sql1||'                  THEN';
    v_sql1 := v_sql1||'                     COAL(T2.STM_BALINT, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'                  ELSE';
    v_sql1 := v_sql1||'                       COAL(T2.STM_BALINT, 0)';
    v_sql1 := v_sql1||'                     * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'                     * -1';
    v_sql1 := v_sql1||'               END';
    v_sql1 := v_sql1||'                AS STM_BALINT                              ';
    v_sql1 := v_sql1||'                             ,';
    v_sql1 := v_sql1||'               CASE';
    v_sql1 := v_sql1||'                  WHEN T1.STM_BALFLAG = ''+'' THEN T1.STM_BALNCE';
    v_sql1 := v_sql1||'                  ELSE T1.STM_BALNCE * -1';
    v_sql1 := v_sql1||'               END';
    v_sql1 := v_sql1||'             + CASE';
    v_sql1 := v_sql1||'                  WHEN T2.STM_BALFLAG = ''+''  ';
    v_sql1 := v_sql1||'                  THEN';
    v_sql1 := v_sql1||'                     COAL(T2.STM_BALNCE, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'                  ELSE';
    v_sql1 := v_sql1||'                       COAL(T2.STM_BALNCE, 0)';
    v_sql1 := v_sql1||'                     * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'                     * -1';
    v_sql1 := v_sql1||'               END';
    v_sql1 := v_sql1||'                AS STM_BALNCE                                ';
    v_sql1 := v_sql1||'                             ,';
    v_sql1 := v_sql1||'               COAL(T1.STM_BALORI, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.STM_BALORI, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                      ,';
    v_sql1 := v_sql1||'             COAL(T1.STM_CLOSDY, 0)                         ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'             COAL(T1.STM_CODE, '' '')                                ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'               COAL(T1.STM_INSTL, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.STM_INSTL, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                     ,';
    v_sql1 := v_sql1||'               COAL(T1.STM_MINDUE, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.STM_MINDUE, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                      ,';
    v_sql1 := v_sql1||'               COAL(T1.STM_NOINT, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.STM_NOINT, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                     ,';
    v_sql1 := v_sql1||'             COAL(T1.STM_OLFLAG, T2.STM_OLFLAG, 0)               ';
    v_sql1 := v_sql1||'                                                       ,';
    v_sql1 := v_sql1||'               COAL(T1.STM_OVERDU, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.STM_OVERDU, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                      ,';
    v_sql1 := v_sql1||'               COAL(T1.STM_PAY_UN, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.STM_PAY_UN, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                      ,';
    v_sql1 := v_sql1||'               COAL(T1.STM_QRYAMT, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.STM_QRYAMT, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                      ,';
    v_sql1 := v_sql1||'               COAL(T1.STM_REPAY, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.STM_REPAY, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                     ,';
    v_sql1 := v_sql1||'             COAL(T1.STMT_DD, 0)                                  ';
    v_sql1 := v_sql1||'                                     ,';
    v_sql1 := v_sql1||'             COAL(T1.STMT_PULL, '' '')                       ';
    v_sql1 := v_sql1||'                                         ,';
    v_sql1 := v_sql1||'               CASE';
    v_sql1 := v_sql1||'                  WHEN T1.TODAY_AMTFLAG = ''+'' THEN T1.TODAY_AMT';
    v_sql1 := v_sql1||'                  ELSE T1.TODAY_AMT * -1';
    v_sql1 := v_sql1||'               END';
    v_sql1 := v_sql1||'             + CASE';
    v_sql1 := v_sql1||'                  WHEN T2.TODAY_AMTFLAG = ''+'' ';
    v_sql1 := v_sql1||'                  THEN';
    v_sql1 := v_sql1||'                     COAL(T2.TODAY_AMT, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'                  ELSE';
    v_sql1 := v_sql1||'                       COAL(T2.TODAY_AMT, 0)';
    v_sql1 := v_sql1||'                     * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'                     * -1';
    v_sql1 := v_sql1||'               END';
    v_sql1 := v_sql1||'                AS TODAY_AMT                             ';
    v_sql1 := v_sql1||'                            ,';
    v_sql1 := v_sql1||'             COAL(T1.TODAY_REL, T2.TODAY_REL)               ';
    v_sql1 := v_sql1||'                                                  ,';
    v_sql1 := v_sql1||'             COAL(T1.UNCL_PCT, T2.UNCL_PCT)                  ';
    v_sql1 := v_sql1||'                                                ,';
    v_sql1 := v_sql1||'             COAL(T1.WROFF_CHDY, 0)                               ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'             COAL(T1.WROFF_CODE, '' '')                              ';
    v_sql1 := v_sql1||'                                          ,';
    v_sql1 := v_sql1||'             COAL(T1.PROD_LEVEL, 0)                            ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'             COAL(T1.PROD_NBR, 0)                            ';
    v_sql1 := v_sql1||'                                      ,';
    v_sql1 := v_sql1||'             COAL(T1.ACCT_PRSTS, '' '')                         ';
    v_sql1 := v_sql1||'                                          ,';
    v_sql1 := v_sql1||'             COAL(T1.ACCT_STS, '' '')                              ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'             COAL(T1.APP_APQUE, '' '')                           ';
    v_sql1 := v_sql1||'                                         ,';
    v_sql1 := v_sql1||'             COAL(T1.POINT_ENC, 0)                              ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'             COAL(T1.POINT_IMP, 0)                           ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'             CASE';
    v_sql1 := v_sql1||'                WHEN T1.PT_EXPFLAG = ''+'' THEN T1.POINT_EXP';
    v_sql1 := v_sql1||'                ELSE T1.POINT_EXP * -1';
    v_sql1 := v_sql1||'             END';
    v_sql1 := v_sql1||'                AS POINT_EXP                                 ';
    v_sql1 := v_sql1||'                            ,';
    v_sql1 := v_sql1||'             COAL(T1.RISK_COUNT, 0)                           ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'             COAL(T1.RISK_DAYIN, 0)                            ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'               CASE';
    v_sql1 := v_sql1||'                  WHEN T1.BAL_MPFLAG = ''+'' THEN T1.BAL_MP';
    v_sql1 := v_sql1||'                  ELSE T1.BAL_MP * -1';
    v_sql1 := v_sql1||'               END';
    v_sql1 := v_sql1||'             + COAL(T2.BAL_MP, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'                AS BAL_MP                                      ';
    v_sql1 := v_sql1||'                         ,';
    v_sql1 := v_sql1||'               CASE';
    v_sql1 := v_sql1||'                  WHEN T1.STM_BMFLAG = ''+'' THEN T1.STM_BALMP';
    v_sql1 := v_sql1||'                  ELSE T1.STM_BALMP * -1';
    v_sql1 := v_sql1||'               END';
    v_sql1 := v_sql1||'             + COAL(T2.STM_BALMP, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'                AS STM_BALMP                                   ';
    v_sql1 := v_sql1||'                            ,';
    v_sql1 := v_sql1||'             COAL(T1.LMT_RSN, '' '')                             ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'             CASE';
    v_sql1 := v_sql1||'                WHEN T1.PT_CDFLAG = ''+'' THEN T1.POINT_CARD';
    v_sql1 := v_sql1||'                ELSE T1.POINT_CARD * -1';
    v_sql1 := v_sql1||'             END';
    v_sql1 := v_sql1||'                AS POINT_CARD                                 ';
    v_sql1 := v_sql1||'                             ,';
    v_sql1 := v_sql1||'             COAL(T1.TEMP_LIMIT, 0)                                ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'             COAL(T1.TLMT_BEG, 0)                              ';
    v_sql1 := v_sql1||'                                      ,';
    v_sql1 := v_sql1||'             COAL(T1.TLMT_END, 0)                              ';
    v_sql1 := v_sql1||'                                      ,';
    v_sql1 := v_sql1||'             COAL(T1.TLMT_NO, 0)                           ';
    v_sql1 := v_sql1||'                                     ,';
    v_sql1 := v_sql1||'             COAL(T1.CANCL_RESN, '' '')                            ';
    v_sql1 := v_sql1||'                                          ,';
    v_sql1 := v_sql1||'               COAL(T1.SHADOW_PEN, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.STM_REPAY, 0) * COAL(B.RATE_VAL0, 0)  ';
    v_sql1 := v_sql1||'                                                                     ,';
    v_sql1 := v_sql1||'               COAL(T1.SHADOW_INT, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.STM_REPAY, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                                                                     ,';
    v_sql1 := v_sql1||'               COAL(T1.SHADOW_CMP, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.STM_REPAY, 0) * COAL(B.RATE_VAL0, 0)   ';
    v_sql1 := v_sql1||'                                                                     ,';
    v_sql1 := v_sql1||'               COAL(T1.BAL_NINT01, 0)';
    v_sql1 := v_sql1||'             + COAL(T1.BAL_NINT02, 0)';
    v_sql1 := v_sql1||'             + COAL(T1.BAL_NINT03, 0)';
    v_sql1 := v_sql1||'             + COAL(T1.BAL_NINT04, 0)';
    v_sql1 := v_sql1||'             + COAL(T1.BAL_NINT05, 0)';
    v_sql1 := v_sql1||'             + COAL(T1.BAL_NINT06, 0)';
    v_sql1 := v_sql1||'             + COAL(T1.BAL_NINT07, 0)';
    v_sql1 := v_sql1||'             + COAL(T1.BAL_NINT08, 0)';
    v_sql1 := v_sql1||'             + COAL(T1.BAL_NINT09, 0)';
    v_sql1 := v_sql1||'             + COAL(T1.BAL_NINT10, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.BAL_NINT01, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.BAL_NINT02, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.BAL_NINT03, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.BAL_NINT04, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.BAL_NINT05, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.BAL_NINT06, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.BAL_NINT07, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.BAL_NINT08, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.BAL_NINT09, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.BAL_NINT10, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'                AS BAL_NINT                                    ';
    v_sql1 := v_sql1||'                           ,';
    v_sql1 := v_sql1||'               COAL(T1.STM_NINT01, 0)';
    v_sql1 := v_sql1||'             + COAL(T1.STM_NINT02, 0)';
    v_sql1 := v_sql1||'             + COAL(T1.STM_NINT03, 0)';
    v_sql1 := v_sql1||'             + COAL(T1.STM_NINT04, 0)';
    v_sql1 := v_sql1||'             + COAL(T1.STM_NINT05, 0)';
    v_sql1 := v_sql1||'             + COAL(T1.STM_NINT06, 0)';
    v_sql1 := v_sql1||'             + COAL(T1.STM_NINT07, 0)';
    v_sql1 := v_sql1||'             + COAL(T1.STM_NINT08, 0)';
    v_sql1 := v_sql1||'             + COAL(T1.STM_NINT09, 0)';
    v_sql1 := v_sql1||'             + COAL(T1.STM_NINT10, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.STM_NINT01, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.STM_NINT02, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.STM_NINT03, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.STM_NINT04, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.STM_NINT05, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.STM_NINT06, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.STM_NINT07, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.STM_NINT08, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.STM_NINT09, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.STM_NINT10, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'                AS STM_NINT                                    ';
    v_sql1 := v_sql1||'                           ,';
    v_sql1 := v_sql1||'             COAL(T2.CURR_NUM, T1.CURR_NUM2, 0)                  ';
    v_sql1 := v_sql1||'                                                    ,';
    v_sql1 := v_sql1||'             COAL(T1.WROF_FLAG, 0)                              ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'             COAL(T1.LAYERCODER1, '' '')                          ';
    v_sql1 := v_sql1||'                                           ,';
    v_sql1 := v_sql1||'             COAL(T1.LAYERCODER2, '' '')                          ';
    v_sql1 := v_sql1||'                                           ,';
    v_sql1 := v_sql1||'             COAL(T1.MCNTRL_YN, '' '')                    ';
    v_sql1 := v_sql1||'                                         ,';
    v_sql1 := v_sql1||'             COAL(T1.NCRED_RSN, '' '')                          ';
    v_sql1 := v_sql1||'                                         ,';
    v_sql1 := v_sql1||'             COAL(T1.BSC_CRED, 0)                                ';
    v_sql1 := v_sql1||'                                      ,';
    v_sql1 := v_sql1||'             COAL(T1.CUSTR_REF, '' '')                           ';
    v_sql1 := v_sql1||'                                         ,';
    v_sql1 := v_sql1||'             COAL(T1.PBC_BRNCH, '' '')                             ';
    v_sql1 := v_sql1||'                                         ,';
    v_sql1 := v_sql1||'             COAL(T1.STOPMP_YN, '' '')                             ';
    v_sql1 := v_sql1||'                                         ,';
    v_sql1 := v_sql1||'             COAL(T1.CRED_LMT2, 0)                            ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'             COAL(T2.EXCH_AMT, 0)                  ';
    v_sql1 := v_sql1||'                                      ,';
    v_sql1 := v_sql1||'             COAL(T2.EXCH_AUTH, 0)                 ';
    v_sql1 := v_sql1||'                                       ,';
    v_sql1 := v_sql1||'             COAL(T2.EXCH_INQAM, 0)                ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'              ''0''                         ,';
    v_sql1 := v_sql1||'             COAL(T1.BAL_CMPFEE, 0)                               ';
    v_sql1 := v_sql1||'                                        ,';
    v_sql1 := v_sql1||'               COAL(T1.STM_BALFRE, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.STM_BALFRE, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'             + CASE';
    v_sql1 := v_sql1||'                  WHEN T1.STMBALINTFLAG = ''+'' THEN T1.STM_BALINT';
    v_sql1 := v_sql1||'                  ELSE 0';
    v_sql1 := v_sql1||'               END';
    v_sql1 := v_sql1||'             + CASE';
    v_sql1 := v_sql1||'                  WHEN T2.STMBALINTFLAG = ''+'' ';
    v_sql1 := v_sql1||'                  THEN';
    v_sql1 := v_sql1||'                     COAL(T2.STM_BALINT, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'                  ELSE';
    v_sql1 := v_sql1||'                       0';
    v_sql1 := v_sql1||'               END';
    v_sql1 := v_sql1||'             + COAL(T1.STM_BALMP, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.STM_BALMP, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'             + COAL(T1.STM_BALORI, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.STM_BALORI, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'             + COAL(T1.STM_NOINT, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.STM_NOINT, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'             + COAL(T1.BAL_CMPINT, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.BAL_CMPINT, 0) * COAL(B.RATE_VAL0, 0)  ';
    v_sql1 := v_sql1||'             + COAL(T1.BAL_FREE, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.BAL_FREE, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'             + CASE';
    v_sql1 := v_sql1||'                  WHEN T1.BAL_INTFLAG = ''+'' THEN T1.BAL_INT';
    v_sql1 := v_sql1||'                  ELSE 0';
    v_sql1 := v_sql1||'               END';
    v_sql1 := v_sql1||'             + CASE';
    v_sql1 := v_sql1||'                  WHEN T2.BALINTFLAG = ''+'' ';
    v_sql1 := v_sql1||'                  THEN';
    v_sql1 := v_sql1||'                     COAL(T2.BAL_INT, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'                  ELSE';
    v_sql1 := v_sql1||'                       0';
    v_sql1 := v_sql1||'               END';
    v_sql1 := v_sql1||'             + CASE';
    v_sql1 := v_sql1||'                  WHEN T1.BAL_MPFLAG = ''+'' THEN T1.BAL_MP';
    v_sql1 := v_sql1||'                  ELSE 0';
    v_sql1 := v_sql1||'               END';
    v_sql1 := v_sql1||'             + COAL(T2.BAL_MP, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'             + COAL(T1.BAL_ORINT, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.BAL_ORINT, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'             + COAL(T1.BAL_NOINT, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.BAL_NOINT, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'             + COAL(T1.Auths_Amt, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.Auths_Amt, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'             + COAL(T1.MP_REM_PPL, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.MP_REM_PPL, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'             + COAL(T3.MP_BAL, 0)                        ';
    v_sql1 := v_sql1||'             + COAL(T1.MP_AUTHS, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.MP_AUTHS, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'             + COAL(T3.MP_AUTHS, 0)                           ';
    v_sql1 := v_sql1||'                AS BAL_ADD14 ,';
    v_sql1 := v_sql1||'             CASE';
    v_sql1 := v_sql1||'                WHEN COAL(T3.MP_BAL, 0) > 0 THEN ''1'' ';
    v_sql1 := v_sql1||'                WHEN COAL(T1.MP_BAL, 0) > 0 THEN ''2'' ';
    v_sql1 := v_sql1||'                WHEN COAL(T2.MP_BAL, 0) > 0 THEN ''2'' ';
    v_sql1 := v_sql1||'                ELSE ''0'' ';
    v_sql1 := v_sql1||'             END';
    v_sql1 := v_sql1||'                AS PRODUCT                                            ';
    v_sql1 := v_sql1||'                          ,';
    v_sql1 := v_sql1||'               COAL(T1.STM_BALFRE, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.STM_BALFRE, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'             + CASE';
    v_sql1 := v_sql1||'                  WHEN T1.STMBALINTFLAG = ''+'' THEN T1.STM_BALINT';
    v_sql1 := v_sql1||'                  ELSE 0';
    v_sql1 := v_sql1||'               END';
    v_sql1 := v_sql1||'             + CASE';
    v_sql1 := v_sql1||'                  WHEN T2.STMBALINTFLAG = ''+''   ';
    v_sql1 := v_sql1||'                  THEN';
    v_sql1 := v_sql1||'                     COAL(T2.STM_BALINT, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'                  ELSE';
    v_sql1 := v_sql1||'                       0';
    v_sql1 := v_sql1||'               END';
    v_sql1 := v_sql1||'             + COAL(T1.STM_BALMP, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.STM_BALMP, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'             + COAL(T1.STM_BALORI, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.STM_BALORI, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'             + COAL(T1.STM_NOINT, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.STM_NOINT, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'             + COAL(T1.BAL_CMPINT, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.BAL_CMPINT, 0) * COAL(B.RATE_VAL0, 0)  ';
    v_sql1 := v_sql1||'             + COAL(T1.BAL_FREE, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.BAL_FREE, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'             + CASE';
    v_sql1 := v_sql1||'                  WHEN T1.BAL_INTFLAG = ''+'' THEN T1.BAL_INT';
    v_sql1 := v_sql1||'                  ELSE 0';
    v_sql1 := v_sql1||'               END';
    v_sql1 := v_sql1||'             + CASE';
    v_sql1 := v_sql1||'                  WHEN T2.BALINTFLAG = ''+'' ';
    v_sql1 := v_sql1||'                  THEN';
    v_sql1 := v_sql1||'                     COAL(T2.BAL_INT, 0) * COAL(B.RATE_VAL0, 0)';
    v_sql1 := v_sql1||'                  ELSE';
    v_sql1 := v_sql1||'                       0';
    v_sql1 := v_sql1||'               END';
    v_sql1 := v_sql1||'             + CASE';
    v_sql1 := v_sql1||'                  WHEN T1.BAL_MPFLAG = ''+'' THEN T1.BAL_MP';
    v_sql1 := v_sql1||'                  ELSE 0';
    v_sql1 := v_sql1||'               END';
    v_sql1 := v_sql1||'             + COAL(T2.BAL_MP, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'             + COAL(T1.BAL_ORINT, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.BAL_ORINT, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'             + COAL(T1.BAL_NOINT, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.BAL_NOINT, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'             + COAL(T1.Auths_Amt, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.Auths_Amt, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'             + COAL(T1.MP_REM_PPL, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.MP_REM_PPL, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'             + COAL(T1.MP_AUTHS, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.MP_AUTHS, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                AS BAL                                            ';
    v_sql1 := v_sql1||'                      ,';
    v_sql1 := v_sql1||'             COAL(T3.CAL_LIMIT, 0),';
    v_sql1 := v_sql1||'             COAL(T3.MP_L_LMT, 0),';
    v_sql1 := v_sql1||'             CASE WHEN T1.STMBALINTFLAG = ''+'' THEN  T1.STM_BALINT ELSE  T1.STM_BALINT * -1 END                                 ';
    v_sql1 := v_sql1||'                        + CASE WHEN T2.STMBALINTFLAG = ''+'' THEN  COAL(T2.STM_BALINT ,0) * COAL(B.RATE_VAL0,0)  ELSE ';
    v_sql1 := v_sql1||'                          COAL(T2.STM_BALINT ,0) * COAL(B.RATE_VAL0,0) * -1 END';
    v_sql1 := v_sql1||'                        + COAL(T1.STM_BALMP,0) + COAL(T2.STM_BALMP ,0) * COAL(B.RATE_VAL0,0)        ';
    v_sql1 := v_sql1||'                        + COAL(T1.STM_BALORI,0) + COAL(T2.STM_BALORI ,0) * COAL(B.RATE_VAL0,0)       ';
    v_sql1 := v_sql1||'                        + COAL(T1.STM_NOINT,0)  + COAL(T2.STM_NOINT ,0) * COAL(B.RATE_VAL0,0)        ';
    v_sql1 := v_sql1||'                        + COAL(T1.BAL_CMPINT,0) + COAL(T2.BAL_CMPINT ,0) * COAL(B.RATE_VAL0,0)      ';
    v_sql1 := v_sql1||'                        + COAL(T1.BAL_FREE,0) + COAL(T2.BAL_FREE ,0) * COAL(B.RATE_VAL0,0)      ';
    v_sql1 := v_sql1||'                        + CASE WHEN T1.BAL_INTFLAG = ''+'' THEN  T1.BAL_INT ELSE  T1.BAL_INT * -1 END';
    v_sql1 := v_sql1||'                        + CASE WHEN T2.BALINTFLAG = ''+''  THEN  COAL(T2.BAL_INT ,0) * COAL(B.RATE_VAL0,0) ELSE  ';
    v_sql1 := v_sql1||'                          COAL(T2.BAL_INT ,0) * COAL(B.RATE_VAL0,0) * -1 END';
    v_sql1 := v_sql1||'                        + CASE WHEN T1.BAL_MPFLAG = ''+'' THEN  T1.BAL_MP ELSE  T1.BAL_MP * -1 END';
    v_sql1 := v_sql1||'                        + COAL(T2.BAL_MP ,0) * COAL(B.RATE_VAL0,0)                                        ';
    v_sql1 := v_sql1||'                        + COAL(T1.BAL_ORINT,0) + COAL(T2.BAL_ORINT ,0) * COAL(B.RATE_VAL0,0)   ';
    v_sql1 := v_sql1||'                        + COAL(T1.BAL_NOINT,0) + COAL(T2.BAL_NOINT ,0) * COAL(B.RATE_VAL0,0)      ';
    v_sql1 := v_sql1||'                        + COAL(T1.STM_BALFRE, 0)';
    v_sql1 := v_sql1||'             + COAL(T2.STM_BALFRE, 0) * COAL(B.RATE_VAL0, 0) ';
    v_sql1 := v_sql1||'                      as  BAL_WO_AUTHS ';
    v_sql1 := v_sql1||'       FROM V_FDM_S24_CUR_ACCT_COM_SP T1';
    v_sql1 := v_sql1||'             LEFT JOIN FDM_S24_CUR_ACCX T2 ON T1.XACCOUNT = T2.XACCOUNT';
    v_sql1 := v_sql1||'             LEFT JOIN FDM_S24_CUR_ACCA T3 ON T1.XACCOUNT = T3.XACCOUNT';
    v_sql1 := v_sql1||'             LEFT JOIN V_PRMXR B';
    v_sql1 := v_sql1||'                ON T2.BANK = B.BANK AND T2.CURR_NUM = B.CURR_NUM';
    DBMS_OUTPUT.PUT_LINE(v_sql1);
    DBMS_OUTPUT.PUT_LINE('v_sql1 after:=========');
    EXECUTE IMMEDIATE v_sql1;

    DBMS_OUTPUT.PUT_LINE('PRC_MDM_ACCT_X END');
    SET RESULT = '1';
END;

DECLARE RESULT_OUT STRING;
DECLARE ETL_DATE STRING = '2015-12-14 00:00:00';
call PRC_MDM_ACCT_X(ETL_DATE, RESULT_OUT);
PRING RESULT_OUT;