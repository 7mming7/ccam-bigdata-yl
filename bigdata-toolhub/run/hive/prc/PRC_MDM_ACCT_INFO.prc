INCLUDE INCLUDE_HEAD.sql

CREATE OR REPLACE PROCEDURE PRC_MDM_ACCT_INFO(IN ETL_DATE STRING, OUT RESULT STRING)
BEGIN
    DECLARE v_ETL_DATE           STRING;    --ETL调度日期
    DECLARE v_ETL_DATE_MM        STRING;    --月份日期
    DECLARE v_ETL_DATE_YYYY      STRING;    --年份日期
    DECLARE v_ETL_DATE_NUM       STRING;
    DECLARE v_ETL_DATE_MAX_DD    STRING;
    DECLARE v_CUR_MONTH_END      STRING;
    DECLARE v_ETL_DATE_LSY       STRING;
    DECLARE v_ETL_DATE_HALFYEAR  STRING;
    DECLARE v_ETL_DATE_MONTH     STRING;

    DECLARE v_sql          STRING;
    DECLARE v_sql1         STRING;
    DECLARE v_sql2         STRING;
    DECLARE v_sql3         STRING;
    DECLARE v_sql4         STRING;
    DECLARE v_sql5         STRING;
    DECLARE v_sql6         STRING;

    SET RESULT = '0';

    DBMS_OUTPUT.PUT_LINE('PRC_MDM_ACCT_INFO START');
    DBMS_OUTPUT.PUT_LINE('ETL_DATE ==' || ETL_DATE);
    IF ETL_DATE <>' ' THEN
        SELECT todate(ETL_DATE,'yyyymmdd') INTO v_ETL_DATE FROM DUAL;
        SELECT todate(ETL_DATE,'yyyy-mm-dd') INTO v_ETL_DATE_MONTH FROM DUAL;

        DBMS_OUTPUT.PUT_LINE('v_ETL_DATE2==' || v_ETL_DATE );
    ELSE
        DBMS_OUTPUT.PUT_LINE('ETL_DATE 为空');
        SELECT SYSDATE() INTO v_ETL_DATE  FROM dual;
    END IF;

    SELECT toDate(v_ETL_DATE, 'mm') INTO v_ETL_DATE_MM FROM DUAL;
    SELECT toDate(v_ETL_DATE, 'yyyy') INTO v_ETL_DATE_YYYY FROM DUAL;
    SELECT toDate(v_ETL_DATE, 'yyyymmdd') INTO v_ETL_DATE_NUM FROM DUAL;
    DBMS_OUTPUT.PUT_LINE('SELECT SUBSTR(toDate(LASTDAY( INTO v_ETL_DATE_MAX_DD FROM DUAL;');
    SELECT SUBSTR(toDate(LASTDAY(v_ETL_DATE),'yyyymmdd'),7,2) INTO v_ETL_DATE_MAX_DD FROM DUAL;
    DBMS_OUTPUT.PUT_LINE('SELECT toDate(LASTDAY(v_ETL_DATE) INTO v_CUR_MONTH_END FROM DUAL;');
    SELECT toDate(LASTDAY(v_ETL_DATE),'yyyymmdd') INTO v_CUR_MONTH_END FROM DUAL;
    SELECT toDate(ADD_MONTHS(v_ETL_DATE_MONTH,-12),'yyyy-mm-dd') INTO v_ETL_DATE_LSY FROM DUAL;
    SELECT toDate(ADD_MONTHS(v_ETL_DATE_MONTH,-6),'yyyymmdd') INTO v_ETL_DATE_HALFYEAR FROM DUAL;

    DBMS_OUTPUT.PUT_LINE('v_ETL_DATE_MONTH ==' || v_ETL_DATE_MONTH);
    DBMS_OUTPUT.PUT_LINE('v_ETL_DATE3 ==' || v_ETL_DATE);
    DBMS_OUTPUT.PUT_LINE('v_ETL_DATE_MM ==' || v_ETL_DATE_MM);
    DBMS_OUTPUT.PUT_LINE('v_ETL_DATE_YYYYMM ==' || v_ETL_DATE_YYYY);
    DBMS_OUTPUT.PUT_LINE('v_ETL_DATE_NUM ==' || v_ETL_DATE_NUM);
    DBMS_OUTPUT.PUT_LINE('v_ETL_DATE_MAX_DD ==' || v_ETL_DATE_MAX_DD);
    DBMS_OUTPUT.PUT_LINE('v_CUR_MONTH_END ==' || v_CUR_MONTH_END);
    DBMS_OUTPUT.PUT_LINE('v_ETL_DATE_LSY ==' || v_ETL_DATE_LSY);
    DBMS_OUTPUT.PUT_LINE('v_ETL_DATE_HALFYEAR ==' || v_ETL_DATE_HALFYEAR);

    DBMS_OUTPUT.PUT_LINE('START EXECUTE TRUNCATE TABLE MDM_ACCT_INFO');
    DECLARE TRUN_TBL_MDM_ACCT_INFO STRING = 'TRUNCATE TABLE MDM_ACCT_INFO';
    EXECUTE TRUN_TBL_MDM_ACCT_INFO;

    DBMS_OUTPUT.PUT_LINE('START INSERT INTO TEMP_ACCT_H_L12M');
    DBMS_OUTPUT.PUT_LINE('v_sql before:=========' || v_sql);
    v_sql := v_sql||'INSERT INTO TEMP_ACCT_H_L12M ';
    v_sql := v_sql||'        SELECT XACCOUNT, MAX (MTHS_ODUE + 0) AS MTHS_ODUE ';
    v_sql := v_sql||'          FROM V_FDM_S24_ACCT                               ';
    v_sql := v_sql||'         WHERE DATE_ADD(SYSDATE(),1) >= END_DATE AND '||v_ETL_DATE_LSY||' < END_DATE ';
    v_sql := v_sql||'      GROUP BY XACCOUNT';
    DBMS_OUTPUT.PUT_LINE(v_sql);
    DBMS_OUTPUT.PUT_LINE('v_sql after:=========');
    EXECUTE IMMEDIATE v_sql;

    DBMS_OUTPUT.PUT_LINE('START INSERT INTO TEMP_ACCT_H_L06M');
    DBMS_OUTPUT.PUT_LINE('v_sql1 before:=========' || v_sql1);
    v_sql1 := 'INSERT INTO TEMP_ACCT_H_L06M ';
    v_sql1 := v_sql1||'        SELECT XACCOUNT, MAX (MTHS_ODUE + 0) AS MTHS_ODUE ';
    v_sql1 := v_sql1||'          FROM V_FDM_S24_ACCT                                ';
    v_sql1 := v_sql1||'         WHERE DATE_ADD(SYSDATE(),1) >= END_DATE AND '||v_ETL_DATE_LSY||' < END_DATE ';
    v_sql1 := v_sql1||'      GROUP BY XACCOUNT';
    DBMS_OUTPUT.PUT_LINE(v_sql1);
    DBMS_OUTPUT.PUT_LINE('v_sql1 after:=========');
    EXECUTE IMMEDIATE v_sql1;

    DBMS_OUTPUT.PUT_LINE('START INSERT INTO TEMP_MPUR_H_CINSTL');
    DBMS_OUTPUT.PUT_LINE('v_sql2 before:=========' || v_sql2);
    v_sql2 := 'INSERT INTO TEMP_MPUR_H_CINSTL  ';
    v_sql2 := v_sql2||'        SELECT XACCOUNT, SUM (MTH_INSTL) AS MTH_INSTL ';
    v_sql2 := v_sql2||'          FROM V_FDM_S24_MPUR                                 ';
    v_sql2 := v_sql2||'         WHERE     STATUS IN (''N'', ';
    v_sql2 := v_sql2||'                              ''A'', ';
    v_sql2 := v_sql2||'                              ''R'', ';
    v_sql2 := v_sql2||'                              ''X'')                  ';
    v_sql2 := v_sql2||'               AND DATE_ADD(CAST('||v_ETL_DATE||' AS STRING),1) >= END_DATE ';
    v_sql2 := v_sql2||'               AND '||v_ETL_DATE_LSY||' < END_DATE ';
    v_sql2 := v_sql2||'      GROUP BY XACCOUNT ';
    DBMS_OUTPUT.PUT_LINE(v_sql2);
    DBMS_OUTPUT.PUT_LINE('v_sql2 after:=========');
    EXECUTE IMMEDIATE v_sql2;

    DBMS_OUTPUT.PUT_LINE('START EXECUTE TRUNCATE TABLE TEMP_STMTBALINCREASEMONTH_L12M');
    DECLARE TRUN_TBL_TEMP_STMTBALINCREASEMONTH_L12M STRING = 'TRUNCATE TABLE TEMP_STMTBALINCREASEMONTH_L12M';
    EXECUTE TRUN_TBL_TEMP_STMTBALINCREASEMONTH_L12M;

    DBMS_OUTPUT.PUT_LINE('START INSERT INTO TEMP_STMTBALINCREASEMONTH_L12M');
    DBMS_OUTPUT.PUT_LINE('v_sql3 before:=========' || v_sql3);
    v_sql3 := 'INSERT INTO TEMP_STMTBALINCREASEMONTH_L12M  ';
    v_sql3 := v_sql3||'SELECT T.XACCOUNT, MAX(COUNTNUM) FROM( ';
    v_sql3 := v_sql3||'SELECT XACCOUNT, COUNT(1) OVER(PARTITION BY XACCOUNT) AS COUNTNUM ';
    v_sql3 := v_sql3||'                     FROM (SELECT ROW_NUMBER() OVER(PARTITION BY XACCOUNT, FLAG_CON_ADD_BAL ORDER BY (MONTH_NBR + 0) DESC) SN,  ';
    v_sql3 := v_sql3||'                           ROW_NUMBER() OVER(ORDER BY (XACCOUNT + 0) , (MONTH_NBR + 0) DESC) N, ';
    v_sql3 := v_sql3||'                           A.XACCOUNT, ';
    v_sql3 := v_sql3||'                           A.FLAG_CON_ADD_BAL   ';
    v_sql3 := v_sql3||'                FROM V_S24_STMT_X_12M A   ) A  ';
    v_sql3 := v_sql3||'                WHERE  FLAG_CON_ADD_BAL = ''1'' ';
    v_sql3 := v_sql3||'                GROUP BY XACCOUNT, N - SN) T ';
    v_sql3 := v_sql3||'                GROUP BY T.XACCOUNT';
    DBMS_OUTPUT.PUT_LINE(v_sql3);
    DBMS_OUTPUT.PUT_LINE('v_sql3 after:=========');
    EXECUTE IMMEDIATE v_sql3;

    DBMS_OUTPUT.PUT_LINE('START EXECUTE TRUNCATE TABLE TEMP_STMTFEEINCREASEMONTH_L6M');
    DECLARE TRUN_TBL_TEMP_STMTFEEINCREASEMONTH_L6M STRING = 'TRUNCATE TABLE TEMP_STMTFEEINCREASEMONTH_L6M';
    EXECUTE TRUN_TBL_TEMP_STMTFEEINCREASEMONTH_L6M;

    DBMS_OUTPUT.PUT_LINE('START INSERT INTO TEMP_STMTFEEINCREASEMONTH_L6M');
    DBMS_OUTPUT.PUT_LINE('v_sql4 before:=========' || v_sql4);
    v_sql4 := 'INSERT INTO TEMP_STMTFEEINCREASEMONTH_L6M  ';
    v_sql4 := v_sql4||'SELECT T.XACCOUNT, MAX(COUNTNUM) FROM( ';
    v_sql4 := v_sql4||'SELECT XACCOUNT, COUNT(1) OVER(PARTITION BY XACCOUNT) AS COUNTNUM ';
    v_sql4 := v_sql4||'                     FROM (SELECT ROW_NUMBER() OVER(PARTITION BY XACCOUNT, FLAG_CON_ADD_COST ORDER BY (MONTH_NBR + 0) DESC) SN,  ';
    v_sql4 := v_sql4||'                           ROW_NUMBER() OVER(ORDER BY (XACCOUNT + 0) DESC, (MONTH_NBR + 0) DESC) N, ';
    v_sql4 := v_sql4||'                           A.XACCOUNT, ';
    v_sql4 := v_sql4||'                           A.FLAG_CON_ADD_COST   ';
    v_sql4 := v_sql4||'                FROM V_S24_STMT_X_6M A   ) A  ';
    v_sql4 := v_sql4||'                WHERE  FLAG_CON_ADD_COST = ''1'' ';
    v_sql4 := v_sql4||'                GROUP BY XACCOUNT, N - SN) T ';
    v_sql4 := v_sql4||'                GROUP BY T.XACCOUNT';
    DBMS_OUTPUT.PUT_LINE(v_sql4);
    DBMS_OUTPUT.PUT_LINE('v_sql4 after:=========');
    EXECUTE IMMEDIATE v_sql4;

    DBMS_OUTPUT.PUT_LINE('START EXECUTE TRUNCATE TABLE TEMP_STMTCASHINCREASERATIO');
    DECLARE TRUN_TBL_TEMP_STMTCASHINCREASERATIO STRING = 'TRUNCATE TABLE TEMP_STMTCASHINCREASERATIO';
    EXECUTE TRUN_TBL_TEMP_STMTCASHINCREASERATIO;

    DBMS_OUTPUT.PUT_LINE('START INSERT INTO TEMP_STMTCASHINCREASERATIO');
    DBMS_OUTPUT.PUT_LINE('v_sql5 before:=========' || v_sql5);
    v_sql5 := 'INSERT INTO TEMP_STMTCASHINCREASERATIO ';
    v_sql5 := v_sql5||'                SELECT DISTINCT XACCOUNT, MAX(COUNT(1)) OVER(PARTITION BY XACCOUNT)';
    v_sql5 := v_sql5||'                     FROM (SELECT ROW_NUMBER() OVER(PARTITION BY XACCOUNT, FLAG_CON_ADD_CASH ORDER BY MONTH_NBR DESC) SN,';
    v_sql5 := v_sql5||'                           ROW_NUMBER() OVER(ORDER BY XACCOUNT DESC, MONTH_NBR DESC) N,';
    v_sql5 := v_sql5||'                           A.XACCOUNT,';
    v_sql5 := v_sql5||'                           A.FLAG_CON_ADD_CASH';
    v_sql5 := v_sql5||'                FROM V_S24_STMT_X_3M A  ) A';
    v_sql5 := v_sql5||'                WHERE  FLAG_CON_ADD_CASH = ''1'' ';
    v_sql5 := v_sql5||'                GROUP BY XACCOUNT, N - SN';
    DBMS_OUTPUT.PUT_LINE(v_sql5);
    DBMS_OUTPUT.PUT_LINE('v_sql5 after:=========');
    EXECUTE IMMEDIATE v_sql5;

    DBMS_OUTPUT.PUT_LINE('START INSERT INTO MDM_ACCT_INFO');
    DBMS_OUTPUT.PUT_LINE('v_sql6 before:=========' || v_sql6);
    v_sql6 := 'INSERT INTO MDM_ACCT_INFO  ';
    v_sql6 := v_sql6||'     SELECT T0.BANK AS BANK                                              ';
    v_sql6 := v_sql6||'                           , ';
    v_sql6 := v_sql6||'            T0.XACCOUNT AS XACCOUNT                                       ';
    v_sql6 := v_sql6||'                                   , ';
    v_sql6 := v_sql6||'            T0.CUSTR_NBR AS CUSTR_NBR                              ';
    v_sql6 := v_sql6||'                                     , ';
    v_sql6 := v_sql6||'             CASE ';
    v_sql6 := v_sql6||'               WHEN  (T0.CYCLE_NBR + 0) >  SUBSTR (TRIM('' '||v_ETL_DATE||' ''), 7, 2) ';
    v_sql6 := v_sql6||'                    AND T0.CYCLE_NBR < 10 ';
    v_sql6 := v_sql6||'               THEN ';
    v_sql6 := v_sql6||'                       CONCAT(toDate ( ADD_MONTHS (TRIM('' '||v_ETL_DATE_MONTH||' ''), -1 ) , ''yyyymm'') ';
    v_sql6 := v_sql6||'                     , ''0'' ';
    v_sql6 := v_sql6||'                     , T0.CYCLE_NBR) ';
    v_sql6 := v_sql6||'               WHEN ';
    v_sql6 := v_sql6||'                     (T0.CYCLE_NBR + 0) > SUBSTR (TRIM('' '||v_ETL_DATE||' ''), 7, 2) ';
    v_sql6 := v_sql6||'                     AND T0.CYCLE_NBR >= 10 ';
    v_sql6 := v_sql6||'               THEN ';
    v_sql6 := v_sql6||'                      CONCAT(toDate ( ADD_MONTHS (TRIM('' '||v_ETL_DATE_MONTH||' ''), -1 ) , ''yyyymm'') ';
    v_sql6 := v_sql6||'                     , T0.CYCLE_NBR) ';
    v_sql6 := v_sql6||'               WHEN ';
    v_sql6 := v_sql6||'                     (T0.CYCLE_NBR + 0) <= SUBSTR (TRIM('' '||v_ETL_DATE||' ''), 7, 2) ';
    v_sql6 := v_sql6||'                    AND T0.CYCLE_NBR < 10 ';
    v_sql6 := v_sql6||'               THEN ';
    v_sql6 := v_sql6||'                     CONCAT(SUBSTR (TRIM('' '||v_ETL_DATE||' ''), 1, 6) ';
    v_sql6 := v_sql6||'                     , ''0'' ';
    v_sql6 := v_sql6||'                     , T0.CYCLE_NBR) ';
    v_sql6 := v_sql6||'               WHEN ';
    v_sql6 := v_sql6||'                     (T0.CYCLE_NBR + 0) <= SUBSTR (TRIM('' '||v_ETL_DATE||' ''), 7, 2) ';
    v_sql6 := v_sql6||'                    AND T0.CYCLE_NBR >= 10 ';
    v_sql6 := v_sql6||'               THEN ';
    v_sql6 := v_sql6||'                     CONCAT(SUBSTR (TRIM('' '||v_ETL_DATE||' ''), 1, 6) ';
    v_sql6 := v_sql6||'                     , T0.CYCLE_NBR) ';
    v_sql6 := v_sql6||'            END ';
    v_sql6 := v_sql6||'               AS CYCLE_DATE                                           ';
    v_sql6 := v_sql6||'                            , ';
    v_sql6 := v_sql6||'            COAL (T1.MIN_DUE, 0) AS MONTHLYPAYCC           ';
    v_sql6 := v_sql6||'                                                    , ';
    v_sql6 := v_sql6||'            CASE ';
    v_sql6 := v_sql6||'               WHEN T0.MTHS_ODUE IN (0, ';
    v_sql6 := v_sql6||'                                     1, ';
    v_sql6 := v_sql6||'                                     2, ';
    v_sql6 := v_sql6||'                                     3, ';
    v_sql6 := v_sql6||'                                     4) ';
    v_sql6 := v_sql6||'               THEN ';
    v_sql6 := v_sql6||'                  T0.MTHS_ODUE ';
    v_sql6 := v_sql6||'               ELSE ';
    v_sql6 := v_sql6||'                  ''5'' ';
    v_sql6 := v_sql6||'            END ';
    v_sql6 := v_sql6||'               AS CURR_OVD_STATUS                                     ';
    v_sql6 := v_sql6||'                                 , ';
    v_sql6 := v_sql6||'            COAL (T01.MTH_INSTL, 0) AS LINS_CUR_SH_AMT     ';
    v_sql6 := v_sql6||'                                                          , ';
    v_sql6 := v_sql6||'            CASE ';
    v_sql6 := v_sql6||'               WHEN    T0.TEMP_LIMIT = 0 ';
    v_sql6 := v_sql6||'                    OR (T0.TEMP_LIMIT > 0 AND '||v_ETL_DATE_NUM||'>= (T0.TLMT_END + 0))  ';
    v_sql6 := v_sql6||'               THEN ';
    v_sql6 := v_sql6||'                  ''1'' ';
    v_sql6 := v_sql6||'               WHEN     T0.TEMP_LIMIT > 0 ';
    v_sql6 := v_sql6||'                    AND (T0.TLMT_BEG + 0) <= '||v_ETL_DATE_NUM||' ';
    v_sql6 := v_sql6||'                    AND '||v_ETL_DATE_NUM||' < (T0.TLMT_END + 0) ';
    v_sql6 := v_sql6||'               THEN ';
    v_sql6 := v_sql6||'                  ''2'' ';
    v_sql6 := v_sql6||'               ELSE ';
    v_sql6 := v_sql6||'                  ''3'' ';
    v_sql6 := v_sql6||'            END ';
    v_sql6 := v_sql6||'               AS HISTUPDATEDLIMITTYPE                ';
    v_sql6 := v_sql6||'                                       ';
    v_sql6 := v_sql6||'            , ';
    v_sql6 := v_sql6||'            CASE ';
    v_sql6 := v_sql6||'               WHEN T1.BAL <= 0 OR COAL (T1.LIMIT, 0) = 0 THEN 0 ';
    v_sql6 := v_sql6||'               WHEN (T1.BAL + 0) >= COAL (T1.LIMIT, 0) THEN 100 ';
    v_sql6 := v_sql6||'               ELSE ROUND (T1.BAL / T1.LIMIT * 100, 2) ';
    v_sql6 := v_sql6||'            END ';
    v_sql6 := v_sql6||'               AS LIMITUSAGE                                           ';
    v_sql6 := v_sql6||'                            , ';
    v_sql6 := v_sql6||'            CASE WHEN T0.CLOSE_CODE = ''Z'' THEN ''1'' ELSE ''0'' END ';
    v_sql6 := v_sql6||'               AS DEATH_EXCLUDE_FLAG                                ';
    v_sql6 := v_sql6||'                                    , ';
    v_sql6 := v_sql6||'            T0.BRANCH AS BRANCH                                           ';
    v_sql6 := v_sql6||'                               , ';
    v_sql6 := v_sql6||'            ROUND (COAL (V12.RATIO_CREDIT_USE, 0), 4) ';
    v_sql6 := v_sql6||'               AS STMTUTILITY_AVE_L12M                ';
    v_sql6 := v_sql6||'                                      , ';
    v_sql6 := v_sql6||'            ROUND (COAL (V12.PAYMENT_RATIO, 0), 4) ';
    v_sql6 := v_sql6||'               AS STMTREPAYRATIO_L12M                           ';
    v_sql6 := v_sql6||'                                     , ';
    v_sql6 := v_sql6||'            CASE ';
    v_sql6 := v_sql6||'               WHEN    (COAL (V12.SUM_PAYMENT, 0) + 0) >= ';
    v_sql6 := v_sql6||'                          COAL (V12.OPEN_BAL, 0) ';
    v_sql6 := v_sql6||'                    OR COAL (V12.OPEN_BAL, 0) <= 10 ';
    v_sql6 := v_sql6||'               THEN ';
    v_sql6 := v_sql6||'                  100 ';
    v_sql6 := v_sql6||'               ELSE ';
    v_sql6 := v_sql6||'                  ROUND ( ';
    v_sql6 := v_sql6||'                       COAL (V12.SUM_PAYMENT, 0) ';
    v_sql6 := v_sql6||'                     / COAL (V12.OPEN_BAL, 0) ';
    v_sql6 := v_sql6||'                     * 100, ';
    v_sql6 := v_sql6||'                     4) ';
    v_sql6 := v_sql6||'            END ';
    v_sql6 := v_sql6||'               AS PAST12_REPAY_AVG_RATIO                       ';
    v_sql6 := v_sql6||'                                        , ';
    v_sql6 := v_sql6||'            COAL (V12.FLAG_COST, 0) AS STMTFEEACCOUR_L12M  ';
    v_sql6 := v_sql6||'                                                             , ';
    v_sql6 := v_sql6||'            COAL (V12.NBR_CASHAD_NEW, 0) AS PAST12_GET_CASH_COUNT  ';
    v_sql6 := v_sql6||'                                                                     , ';
    v_sql6 := v_sql6||'            ROUND (COAL (V12.FLAG_CON_ADD_AGE, 0) * 100, 2) ';
    v_sql6 := v_sql6||'               AS COLLECTTEMPLATE                       ';
    v_sql6 := v_sql6||'                                 , ';
    v_sql6 := v_sql6||'            COAL (V12.ODUE_MTHS, 0) AS PAST12_MAX_DUE_MTHS                         ';
    v_sql6 := v_sql6||'                                                              , ';
    v_sql6 := v_sql6||'            COAL (A1.FLAG_CON_ADD_BAL_CNT, 0) AS STMTBALINCREASEMONTH_L12M  ';
    v_sql6 := v_sql6||'                                                                           , ';
    v_sql6 := v_sql6||'            COAL (V3.FLAG_AGE, 0) AS PAST3_DUE_COUNT    ';
    v_sql6 := v_sql6||'                                                        , ';
    v_sql6 := v_sql6||'            COAL (V3.RATIO_CREDIT_USE, 0) AS PAST3_CREDIT_USE_RATIO  ';
    v_sql6 := v_sql6||'                                                                       , ';
    v_sql6 := v_sql6||'            COAL (V3.MAX_RATIO_CREDIT_USE, 0) ';
    v_sql6 := v_sql6||'               AS PAST3_CREDIT_USE_RATIO_MAX          ';
    v_sql6 := v_sql6||'                                            , ';
    v_sql6 := v_sql6||'            CASE ';
    v_sql6 := v_sql6||'               WHEN COAL (T1.PAYMENT, 0) > 0 ';
    v_sql6 := v_sql6||'               THEN ';
    v_sql6 := v_sql6||'                  0 ';
    v_sql6 := v_sql6||'               WHEN     COAL (T2.PAYMENT, 0) > 0 ';
    v_sql6 := v_sql6||'                    AND COAL (T1.PAYMENT, 0) = 0 ';
    v_sql6 := v_sql6||'               THEN ';
    v_sql6 := v_sql6||'                  1 ';
    v_sql6 := v_sql6||'               WHEN     COAL (T3.PAYMENT, 0) > 0 ';
    v_sql6 := v_sql6||'                    AND COAL (T1.PAYMENT, 0) + COAL (T2.PAYMENT, 0) = ';
    v_sql6 := v_sql6||'                           0 ';
    v_sql6 := v_sql6||'               THEN ';
    v_sql6 := v_sql6||'                  2 ';
    v_sql6 := v_sql6||'               ELSE ';
    v_sql6 := v_sql6||'                  3 ';
    v_sql6 := v_sql6||'            END ';
    v_sql6 := v_sql6||'               AS PAST3_PAY_AMT_MTHS                         ';
    v_sql6 := v_sql6||'                                    , ';
    v_sql6 := v_sql6||'            COAL (T1.NBR_CASHAD_NEW, 0) AS LAST_3MON_CASH_TIMES_1  ';
    v_sql6 := v_sql6||'                                                                     , ';
    v_sql6 := v_sql6||'            COAL (T2.NBR_CASHAD_NEW, 0) AS LAST_3MON_CASH_TIMES_2  ';
    v_sql6 := v_sql6||'                                                                     , ';
    v_sql6 := v_sql6||'            COAL (T3.NBR_CASHAD_NEW, 0) AS LAST_3MON_CASH_TIMES_3  ';
    v_sql6 := v_sql6||'                                                                     , ';
    v_sql6 := v_sql6||'            CASE ';
    v_sql6 := v_sql6||'               WHEN    COAL (V3.LIMIT_MP, 0) = 0 ';
    v_sql6 := v_sql6||'                    OR COAL (V3.BAL_ADD14, 0) <= 0 ';
    v_sql6 := v_sql6||'               THEN ';
    v_sql6 := v_sql6||'                  0 ';
    v_sql6 := v_sql6||'               WHEN (COAL (V3.BAL_ADD14, 0) + 0) >= COAL (V3.LIMIT_MP, 0) ';
    v_sql6 := v_sql6||'               THEN ';
    v_sql6 := v_sql6||'                  100 ';
    v_sql6 := v_sql6||'               ELSE ';
    v_sql6 := v_sql6||'                  ROUND ( ';
    v_sql6 := v_sql6||'                       COAL (V3.BAL_ADD14, 0) ';
    v_sql6 := v_sql6||'                     / COAL (V3.LIMIT_MP, 0) ';
    v_sql6 := v_sql6||'                     * 100, ';
    v_sql6 := v_sql6||'                     2) ';
    v_sql6 := v_sql6||'            END ';
    v_sql6 := v_sql6||'               AS STMTUTILITY_AVE_L3M                    ';
    v_sql6 := v_sql6||'                                     , ';
    v_sql6 := v_sql6||'            COAL (A3.FLAG_CON_ADD_CASH_CNT, 0) AS STMTCASHINCREASERATIO  ';
    v_sql6 := v_sql6||'                                                                       , ';
    v_sql6 := v_sql6||'            COAL (V3.FLAG_CASH, 0) AS PAST3_GET_CASH_RATIO  ';
    v_sql6 := v_sql6||'                                                              , ';
    v_sql6 := v_sql6||'            CASE ';
    v_sql6 := v_sql6||'               WHEN    COAL (V6.C_LIMIT, 0) = 0 ';
    v_sql6 := v_sql6||'                    OR COAL (V6.POINT_EAR, 0) <= 0 ';
    v_sql6 := v_sql6||'               THEN ';
    v_sql6 := v_sql6||'                  0 ';
    v_sql6 := v_sql6||'               WHEN     COAL (V6.C_LIMIT, 0) > 0 ';
    v_sql6 := v_sql6||'                    AND (COAL(V6.C_LIMIT, 0) + 0) < ';
    v_sql6 := v_sql6||'                           COAL (V6.POINT_EAR, 0) ';
    v_sql6 := v_sql6||'               THEN ';
    v_sql6 := v_sql6||'                  100 ';
    v_sql6 := v_sql6||'               ELSE ';
    v_sql6 := v_sql6||'                  ROUND ( ';
    v_sql6 := v_sql6||'                       COAL (V6.POINT_EAR, 0) ';
    v_sql6 := v_sql6||'                     / COAL (V6.CRED_LIMIT, 0) ';
    v_sql6 := v_sql6||'                     * 100, ';
    v_sql6 := v_sql6||'                     2) ';
    v_sql6 := v_sql6||'            END ';
    v_sql6 := v_sql6||'               AS STMTUTILITY_AVE_L6M                      ';
    v_sql6 := v_sql6||'                                     , ';
    v_sql6 := v_sql6||'            COAL (V3.FLAG_PAYMENT_P10, 0) AS STMTREPAYRATIO10MONTH_L6M  ';
    v_sql6 := v_sql6||'                                                                          , ';
    v_sql6 := v_sql6||'            CASE ';
    v_sql6 := v_sql6||'               WHEN COAL (V6.OPEN_BAL, 0) <= 0 ';
    v_sql6 := v_sql6||'               THEN ';
    v_sql6 := v_sql6||'                  100 ';
    v_sql6 := v_sql6||'               WHEN COAL (V6.OPEN_BAL, 0) <= ';
    v_sql6 := v_sql6||'                       COAL (V6.AVG_PAYMENT, 0) ';
    v_sql6 := v_sql6||'               THEN ';
    v_sql6 := v_sql6||'                  100 ';
    v_sql6 := v_sql6||'               ELSE ';
    v_sql6 := v_sql6||'                  ROUND ( ';
    v_sql6 := v_sql6||'                       COAL (V6.AVG_PAYMENT, 0) ';
    v_sql6 := v_sql6||'                     / (COAL (V6.OPEN_BAL, 0)) ';
    v_sql6 := v_sql6||'                     * 100, ';
    v_sql6 := v_sql6||'                     2) ';
    v_sql6 := v_sql6||'            END ';
    v_sql6 := v_sql6||'               AS STMTREPAYRATIO_L6M                              ';
    v_sql6 := v_sql6||'                                    , ';
    v_sql6 := v_sql6||'            ROUND (COAL (V6.POINT_EAR, 0), 2) AS STMTREWARD_AVE_L6M  ';
    v_sql6 := v_sql6||'            , ';
    v_sql6 := v_sql6||'            ROUND (COAL (V6.TOT_COST, 0), 4) AS STMTINCOME_AVE_L6M  ';
    v_sql6 := v_sql6||'                                                                      , ';
    v_sql6 := v_sql6||'            COAL (V6.FLAG_COST, 0) AS PAST6_FEE_COUNT  ';
    v_sql6 := v_sql6||'                                                         , ';
    v_sql6 := v_sql6||'            COAL (A2.FLAG_CON_ADD_COST_CNT, 0) AS STMTFEEINCREASEMONTH_L6M  ';
    v_sql6 := v_sql6||'                                                                          , ';
    v_sql6 := v_sql6||'            COAL (V6.NBR_CASHAD_NEW, 0) AS STMTSUMCASH_L6M   ';
    v_sql6 := v_sql6||'                                                              , ';
    v_sql6 := v_sql6||'            CASE ';
    v_sql6 := v_sql6||'               WHEN COAL (T1.NBR_CASHAD_NEW, 0) > 0 ';
    v_sql6 := v_sql6||'               THEN ';
    v_sql6 := v_sql6||'                  1 ';
    v_sql6 := v_sql6||'               WHEN     COAL (T2.NBR_CASHAD_NEW, 0) > 0 ';
    v_sql6 := v_sql6||'                    AND COAL (T1.NBR_CASHAD_NEW, 0) = 0 ';
    v_sql6 := v_sql6||'               THEN ';
    v_sql6 := v_sql6||'                  2 ';
    v_sql6 := v_sql6||'               WHEN     COAL (T3.NBR_CASHAD_NEW, 0) > 0 ';
    v_sql6 := v_sql6||'                    AND   COAL (T1.NBR_CASHAD_NEW, 0) ';
    v_sql6 := v_sql6||'                        + COAL (T2.NBR_CASHAD_NEW, 0) = 0 ';
    v_sql6 := v_sql6||'               THEN ';
    v_sql6 := v_sql6||'                  3 ';
    v_sql6 := v_sql6||'               WHEN     COAL (T4.NBR_CASHAD_NEW, 0) > 0 ';
    v_sql6 := v_sql6||'                    AND   COAL (T1.NBR_CASHAD_NEW, 0) ';
    v_sql6 := v_sql6||'                        + COAL (T2.NBR_CASHAD_NEW, 0) ';
    v_sql6 := v_sql6||'                        + COAL (T3.NBR_CASHAD_NEW, 0) = 0 ';
    v_sql6 := v_sql6||'               THEN ';
    v_sql6 := v_sql6||'                  4 ';
    v_sql6 := v_sql6||'               WHEN     COAL (T5.NBR_CASHAD_NEW, 0) > 0 ';
    v_sql6 := v_sql6||'                    AND   COAL (T1.NBR_CASHAD_NEW, 0) ';
    v_sql6 := v_sql6||'                        + COAL (T2.NBR_CASHAD_NEW, 0) ';
    v_sql6 := v_sql6||'                        + COAL (T3.NBR_CASHAD_NEW, 0) ';
    v_sql6 := v_sql6||'                        + COAL (T4.NBR_CASHAD_NEW, 0) = 0 ';
    v_sql6 := v_sql6||'               THEN ';
    v_sql6 := v_sql6||'                  5 ';
    v_sql6 := v_sql6||'               WHEN     COAL (T6.NBR_CASHAD_NEW, 0) > 0 ';
    v_sql6 := v_sql6||'                    AND   COAL (T1.NBR_CASHAD_NEW, 0) ';
    v_sql6 := v_sql6||'                        + COAL (T2.NBR_CASHAD_NEW, 0) ';
    v_sql6 := v_sql6||'                        + COAL (T3.NBR_CASHAD_NEW, 0) ';
    v_sql6 := v_sql6||'                        + COAL (T4.NBR_CASHAD_NEW, 0) ';
    v_sql6 := v_sql6||'                        + COAL (T5.NBR_CASHAD_NEW, 0) = 0 ';
    v_sql6 := v_sql6||'               THEN ';
    v_sql6 := v_sql6||'                  6 ';
    v_sql6 := v_sql6||'               ELSE ';
    v_sql6 := v_sql6||'                  6 ';
    v_sql6 := v_sql6||'            END ';
    v_sql6 := v_sql6||'               AS STMTCASHADVANCEMONTH_L6M                   ';
    v_sql6 := v_sql6||'                                          , ';
    v_sql6 := v_sql6||'            COAL (V6.NBR_PURCH_NEW, 0) AS STMTSUMCONSUME_L6M  ';
    v_sql6 := v_sql6||'                                                                , ';
    v_sql6 := v_sql6||'            COAL (V6.ODUE_MTHS, 0) AS PAST6_DUE_COUNT_MAX    ';
    v_sql6 := v_sql6||'                                                             , ';
    v_sql6 := v_sql6||'            COAL (V12.FLAG_CON_ODUE, 0) AS ARREARINCREASE_L12M  ';
    v_sql6 := v_sql6||'                                                                  , ';
    v_sql6 := v_sql6||'            COAL (T1.PURCHASES, 0) AS LAST_12MON_CONSUME_AMT_1  ';
    v_sql6 := v_sql6||'                                                                  , ';
    v_sql6 := v_sql6||'            COAL (T2.PURCHASES, 0) AS LAST_12MON_CONSUME_AMT_2  ';
    v_sql6 := v_sql6||'                                                                  , ';
    v_sql6 := v_sql6||'            COAL (T3.PURCHASES, 0) AS LAST_12MON_CONSUME_AMT_3  ';
    v_sql6 := v_sql6||'                                                                  , ';
    v_sql6 := v_sql6||'            COAL (T4.PURCHASES, 0) AS LAST_12MON_CONSUME_AMT_4  ';
    v_sql6 := v_sql6||'                                                                  , ';
    v_sql6 := v_sql6||'            COAL (T5.PURCHASES, 0) AS LAST_12MON_CONSUME_AMT_5  ';
    v_sql6 := v_sql6||'                                                                  , ';
    v_sql6 := v_sql6||'            COAL (T6.PURCHASES, 0) AS LAST_12MON_CONSUME_AMT_6  ';
    v_sql6 := v_sql6||'                                                                  , ';
    v_sql6 := v_sql6||'            COAL (T7.PURCHASES, 0) AS LAST_12MON_CONSUME_AMT_7  ';
    v_sql6 := v_sql6||'                                                                  , ';
    v_sql6 := v_sql6||'            COAL (T8.PURCHASES, 0) AS LAST_12MON_CONSUME_AMT_8 ';
    v_sql6 := v_sql6||'                                                                  , ';
    v_sql6 := v_sql6||'            COAL (T9.PURCHASES, 0) AS LAST_12MON_CONSUME_AMT_9 ';
    v_sql6 := v_sql6||'                                                                  , ';
    v_sql6 := v_sql6||'            COAL (T10.PURCHASES, 0) AS LAST_12MON_CONSUME_AMT_10  ';
    v_sql6 := v_sql6||'                                                                    , ';
    v_sql6 := v_sql6||'            COAL (T11.PURCHASES, 0) AS LAST_12MON_CONSUME_AMT_11 ';
    v_sql6 := v_sql6||'                                                                    , ';
    v_sql6 := v_sql6||'            COAL (T12.PURCHASES, 0) AS LAST_12MON_CONSUME_AMT_12 ';
    v_sql6 := v_sql6||'                                                                    , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_RETAIL_AMT_1                 ';
    v_sql6 := v_sql6||'                                        , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_RETAIL_AMT_2                 ';
    v_sql6 := v_sql6||'                                        , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_RETAIL_AMT_3                 ';
    v_sql6 := v_sql6||'                                        , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_RETAIL_AMT_4                 ';
    v_sql6 := v_sql6||'                                        , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_RETAIL_AMT_5                 ';
    v_sql6 := v_sql6||'                                        , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_RETAIL_AMT_6                 ';
    v_sql6 := v_sql6||'                                        , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_RETAIL_AMT_7                 ';
    v_sql6 := v_sql6||'                                        , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_RETAIL_AMT_8                 ';
    v_sql6 := v_sql6||'                                        , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_RETAIL_AMT_9                ';
    v_sql6 := v_sql6||'                                        , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_RETAIL_AMT_10               ';
    v_sql6 := v_sql6||'                                         , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_RETAIL_AMT_11               ';
    v_sql6 := v_sql6||'                                         , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_RETAIL_AMT_12               ';
    v_sql6 := v_sql6||'                                         , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_RETAIL_AMT_13               ';
    v_sql6 := v_sql6||'                                         , ';
    v_sql6 := v_sql6||'            COAL (T1.PAYMENT, 0) AS LAST_13MON_REPAYMENT_1  ';
    v_sql6 := v_sql6||'                                                              , ';
    v_sql6 := v_sql6||'            COAL (T2.PAYMENT, 0) AS LAST_13MON_REPAYMENT_2  ';
    v_sql6 := v_sql6||'                                                              , ';
    v_sql6 := v_sql6||'            COAL (T3.PAYMENT, 0) AS LAST_13MON_REPAYMENT_3  ';
    v_sql6 := v_sql6||'                                                              , ';
    v_sql6 := v_sql6||'            COAL (T4.PAYMENT, 0) AS LAST_13MON_REPAYMENT_4  ';
    v_sql6 := v_sql6||'                                                              , ';
    v_sql6 := v_sql6||'            COAL (T5.PAYMENT, 0) AS LAST_13MON_REPAYMENT_5  ';
    v_sql6 := v_sql6||'                                                              , ';
    v_sql6 := v_sql6||'            COAL (T6.PAYMENT, 0) AS LAST_13MON_REPAYMENT_6  ';
    v_sql6 := v_sql6||'                                                              , ';
    v_sql6 := v_sql6||'            COAL (T7.PAYMENT, 0) AS LAST_13MON_REPAYMENT_7 ';
    v_sql6 := v_sql6||'                                                              , ';
    v_sql6 := v_sql6||'            COAL (T8.PAYMENT, 0) AS LAST_13MON_REPAYMENT_8  ';
    v_sql6 := v_sql6||'                                                              , ';
    v_sql6 := v_sql6||'            COAL (T9.PAYMENT, 0) AS LAST_13MON_REPAYMENT_9  ';
    v_sql6 := v_sql6||'                                                              , ';
    v_sql6 := v_sql6||'            COAL (T10.PAYMENT, 0) AS LAST_13MON_REPAYMENT_10 ';
    v_sql6 := v_sql6||'                                                                , ';
    v_sql6 := v_sql6||'            COAL (T11.PAYMENT, 0) AS LAST_13MON_REPAYMENT_11  ';
    v_sql6 := v_sql6||'                                                                , ';
    v_sql6 := v_sql6||'            COAL (T12.PAYMENT, 0) AS LAST_13MON_REPAYMENT_12  ';
    v_sql6 := v_sql6||'                                                                , ';
    v_sql6 := v_sql6||'            COAL (T13.PAYMENT, 0) AS LAST_13MON_REPAYMENT_13  ';
    v_sql6 := v_sql6||'                                                                , ';
    v_sql6 := v_sql6||'            COAL (T1.CASH_ADVCE, 0) AS LAST_13MON_CASH_1  ';
    v_sql6 := v_sql6||'                                                            , ';
    v_sql6 := v_sql6||'            COAL (T2.CASH_ADVCE, 0) AS LAST_13MON_CASH_2  ';
    v_sql6 := v_sql6||'                                                            , ';
    v_sql6 := v_sql6||'            COAL (T3.CASH_ADVCE, 0) AS LAST_13MON_CASH_3  ';
    v_sql6 := v_sql6||'                                                            , ';
    v_sql6 := v_sql6||'            COAL (T4.CASH_ADVCE, 0) AS LAST_13MON_CASH_4  ';
    v_sql6 := v_sql6||'                                                            , ';
    v_sql6 := v_sql6||'            COAL (T5.CASH_ADVCE, 0) AS LAST_13MON_CASH_5  ';
    v_sql6 := v_sql6||'                                                            , ';
    v_sql6 := v_sql6||'            COAL (T6.CASH_ADVCE, 0) AS LAST_13MON_CASH_6  ';
    v_sql6 := v_sql6||'                                                            , ';
    v_sql6 := v_sql6||'            COAL (T7.CASH_ADVCE, 0) AS LAST_13MON_CASH_7  ';
    v_sql6 := v_sql6||'                                                            , ';
    v_sql6 := v_sql6||'            COAL (T8.CASH_ADVCE, 0) AS LAST_13MON_CASH_8  ';
    v_sql6 := v_sql6||'                                                            , ';
    v_sql6 := v_sql6||'            COAL (T9.CASH_ADVCE, 0) AS LAST_13MON_CASH_9  ';
    v_sql6 := v_sql6||'                                                            , ';
    v_sql6 := v_sql6||'            COAL (T10.CASH_ADVCE, 0) AS LAST_13MON_CASH_10  ';
    v_sql6 := v_sql6||'                                                              , ';
    v_sql6 := v_sql6||'            COAL (T11.CASH_ADVCE, 0) AS LAST_13MON_CASH_11  ';
    v_sql6 := v_sql6||'                                                              , ';
    v_sql6 := v_sql6||'            COAL (T12.CASH_ADVCE, 0) AS LAST_13MON_CASH_12  ';
    v_sql6 := v_sql6||'                                                              , ';
    v_sql6 := v_sql6||'            COAL (T13.CASH_ADVCE, 0) AS LAST_13MON_CASH_13  ';
    v_sql6 := v_sql6||'                                                              , ';
    v_sql6 := v_sql6||'            COAL (T1.CRED_LIMIT, 0) AS LAST_13MON_CREDIT_AMT_1  ';
    v_sql6 := v_sql6||'                                                                  , ';
    v_sql6 := v_sql6||'            COAL (T2.CRED_LIMIT, 0) AS LAST_13MON_CREDIT_AMT_2  ';
    v_sql6 := v_sql6||'                                                                  , ';
    v_sql6 := v_sql6||'            COAL (T3.CRED_LIMIT, 0) AS LAST_13MON_CREDIT_AMT_3  ';
    v_sql6 := v_sql6||'                                                                  , ';
    v_sql6 := v_sql6||'            COAL (T4.CRED_LIMIT, 0) AS LAST_13MON_CREDIT_AMT_4  ';
    v_sql6 := v_sql6||'                                                                  , ';
    v_sql6 := v_sql6||'            COAL (T5.CRED_LIMIT, 0) AS LAST_13MON_CREDIT_AMT_5  ';
    v_sql6 := v_sql6||'                                                                  , ';
    v_sql6 := v_sql6||'            COAL (T6.CRED_LIMIT, 0) AS LAST_13MON_CREDIT_AMT_6  ';
    v_sql6 := v_sql6||'                                                                  , ';
    v_sql6 := v_sql6||'            COAL (T7.CRED_LIMIT, 0) AS LAST_13MON_CREDIT_AMT_7  ';
    v_sql6 := v_sql6||'                                                                  , ';
    v_sql6 := v_sql6||'            COAL (T8.CRED_LIMIT, 0) AS LAST_13MON_CREDIT_AMT_8  ';
    v_sql6 := v_sql6||'                                                                  , ';
    v_sql6 := v_sql6||'            COAL (T9.CRED_LIMIT, 0) AS LAST_13MON_CREDIT_AMT_9  ';
    v_sql6 := v_sql6||'                                                                  , ';
    v_sql6 := v_sql6||'            COAL (T10.CRED_LIMIT, 0) AS LAST_13MON_CREDIT_AMT_10  ';
    v_sql6 := v_sql6||'                                                                    , ';
    v_sql6 := v_sql6||'            COAL (T11.CRED_LIMIT, 0) AS LAST_13MON_CREDIT_AMT_11  ';
    v_sql6 := v_sql6||'                                                                    , ';
    v_sql6 := v_sql6||'            COAL (T12.CRED_LIMIT, 0) AS LAST_13MON_CREDIT_AMT_12  ';
    v_sql6 := v_sql6||'                                                                    , ';
    v_sql6 := v_sql6||'            COAL (T13.CRED_LIMIT, 0) AS LAST_13MON_CREDIT_AMT_13  ';
    v_sql6 := v_sql6||'                                                                    , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_TEMP_AMT_1                       ';
    v_sql6 := v_sql6||'                                      , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_TEMP_AMT_2                       ';
    v_sql6 := v_sql6||'                                      , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_TEMP_AMT_3                      ';
    v_sql6 := v_sql6||'                                      , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_TEMP_AMT_4                       ';
    v_sql6 := v_sql6||'                                      , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_TEMP_AMT_5                       ';
    v_sql6 := v_sql6||'                                      , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_TEMP_AMT_6                       ';
    v_sql6 := v_sql6||'                                      , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_TEMP_AMT_7                       ';
    v_sql6 := v_sql6||'                                      , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_TEMP_AMT_8                       ';
    v_sql6 := v_sql6||'                                      , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_TEMP_AMT_9                       ';
    v_sql6 := v_sql6||'                                      , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_TEMP_AMT_10                     ';
    v_sql6 := v_sql6||'                                       , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_TEMP_AMT_11                     ';
    v_sql6 := v_sql6||'                                       , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_TEMP_AMT_12                     ';
    v_sql6 := v_sql6||'                                       , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_TEMP_AMT_13                     ';
    v_sql6 := v_sql6||'                                       , ';
    v_sql6 := v_sql6||'            COAL (T1.CLOSE_BAL, 0) AS LAST_13MON_BILL_AMT_1  ';
    v_sql6 := v_sql6||'                                                               , ';
    v_sql6 := v_sql6||'            COAL (T2.CLOSE_BAL, 0) AS LAST_13MON_BILL_AMT_2  ';
    v_sql6 := v_sql6||'                                                               , ';
    v_sql6 := v_sql6||'            COAL (T3.CLOSE_BAL, 0) AS LAST_13MON_BILL_AMT_3  ';
    v_sql6 := v_sql6||'                                                               , ';
    v_sql6 := v_sql6||'            COAL (T4.CLOSE_BAL, 0) AS LAST_13MON_BILL_AMT_4  ';
    v_sql6 := v_sql6||'                                                               , ';
    v_sql6 := v_sql6||'            COAL (T5.CLOSE_BAL, 0) AS LAST_13MON_BILL_AMT_5  ';
    v_sql6 := v_sql6||'                                                               , ';
    v_sql6 := v_sql6||'            COAL (T6.CLOSE_BAL, 0) AS LAST_13MON_BILL_AMT_6  ';
    v_sql6 := v_sql6||'                                                               , ';
    v_sql6 := v_sql6||'            COAL (T7.CLOSE_BAL, 0) AS LAST_13MON_BILL_AMT_7  ';
    v_sql6 := v_sql6||'                                                               , ';
    v_sql6 := v_sql6||'            COAL (T8.CLOSE_BAL, 0) AS LAST_13MON_BILL_AMT_8  ';
    v_sql6 := v_sql6||'                                                               , ';
    v_sql6 := v_sql6||'            COAL (T9.CLOSE_BAL, 0) AS LAST_13MON_BILL_AMT_9  ';
    v_sql6 := v_sql6||'                                                               , ';
    v_sql6 := v_sql6||'            COAL (T10.CLOSE_BAL, 0) AS LAST_13MON_BILL_AMT_10  ';
    v_sql6 := v_sql6||'                                                                 , ';
    v_sql6 := v_sql6||'            COAL (T11.CLOSE_BAL, 0) AS LAST_13MON_BILL_AMT_11  ';
    v_sql6 := v_sql6||'                                                                 , ';
    v_sql6 := v_sql6||'            COAL (T12.CLOSE_BAL, 0) AS LAST_13MON_BILL_AMT_12  ';
    v_sql6 := v_sql6||'                                                                 , ';
    v_sql6 := v_sql6||'            COAL (T13.CLOSE_BAL, 0) AS LAST_13MON_BILL_AMT_13  ';
    v_sql6 := v_sql6||'                                                                 , ';
    v_sql6 := v_sql6||'            COAL (T1.MIN_DUE, 0) AS LAST_13MON_LOWEST_REPAY_1  ';
    v_sql6 := v_sql6||'                                                                 , ';
    v_sql6 := v_sql6||'            COAL (T2.MIN_DUE, 0) AS LAST_13MON_LOWEST_REPAY_2  ';
    v_sql6 := v_sql6||'                                                                 , ';
    v_sql6 := v_sql6||'            COAL (T3.MIN_DUE, 0) AS LAST_13MON_LOWEST_REPAY_3  ';
    v_sql6 := v_sql6||'                                                                 , ';
    v_sql6 := v_sql6||'            COAL (T4.MIN_DUE, 0) AS LAST_13MON_LOWEST_REPAY_4  ';
    v_sql6 := v_sql6||'                                                                 , ';
    v_sql6 := v_sql6||'            COAL (T5.MIN_DUE, 0) AS LAST_13MON_LOWEST_REPAY_5  ';
    v_sql6 := v_sql6||'                                                                 , ';
    v_sql6 := v_sql6||'            COAL (T6.MIN_DUE, 0) AS LAST_13MON_LOWEST_REPAY_6  ';
    v_sql6 := v_sql6||'                                                                 , ';
    v_sql6 := v_sql6||'            COAL (T7.MIN_DUE, 0) AS LAST_13MON_LOWEST_REPAY_7  ';
    v_sql6 := v_sql6||'                                                                 , ';
    v_sql6 := v_sql6||'            COAL (T8.MIN_DUE, 0) AS LAST_13MON_LOWEST_REPAY_8  ';
    v_sql6 := v_sql6||'                                                                 , ';
    v_sql6 := v_sql6||'            COAL (T9.MIN_DUE, 0) AS LAST_13MON_LOWEST_REPAY_9  ';
    v_sql6 := v_sql6||'                                                                 , ';
    v_sql6 := v_sql6||'            COAL (T10.MIN_DUE, 0) AS LAST_13MON_LOWEST_REPAY_10  ';
    v_sql6 := v_sql6||'                                                                   , ';
    v_sql6 := v_sql6||'            COAL (T11.MIN_DUE, 0) AS LAST_13MON_LOWEST_REPAY_11  ';
    v_sql6 := v_sql6||'                                                                   , ';
    v_sql6 := v_sql6||'            COAL (T12.MIN_DUE, 0) AS LAST_13MON_LOWEST_REPAY_12 ';
    v_sql6 := v_sql6||'                                                                   , ';
    v_sql6 := v_sql6||'            COAL (T13.MIN_DUE, 0) AS LAST_13MON_LOWEST_REPAY_13  ';
    v_sql6 := v_sql6||'                                                                   , ';
    v_sql6 := v_sql6||'            T0.STM_OLFLAG AS LAST_13MON_ACC_OVERRUN_FLAG_1  ';
    v_sql6 := v_sql6||'                                                          , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_ACC_OVERRUN_FLAG_2             ';
    v_sql6 := v_sql6||'                                              , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_ACC_OVERRUN_FLAG_3             ';
    v_sql6 := v_sql6||'                                              , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_ACC_OVERRUN_FLAG_4             ';
    v_sql6 := v_sql6||'                                              , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_ACC_OVERRUN_FLAG_5             ';
    v_sql6 := v_sql6||'                                              , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_ACC_OVERRUN_FLAG_6             ';
    v_sql6 := v_sql6||'                                              , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_ACC_OVERRUN_FLAG_7             ';
    v_sql6 := v_sql6||'                                              , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_ACC_OVERRUN_FLAG_8             ';
    v_sql6 := v_sql6||'                                              , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_ACC_OVERRUN_FLAG_9             ';
    v_sql6 := v_sql6||'                                              , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_ACC_OVERRUN_FLAG_10           ';
    v_sql6 := v_sql6||'                                               , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_ACC_OVERRUN_FLAG_11           ';
    v_sql6 := v_sql6||'                                               , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_ACC_OVERRUN_FLAG_12           ';
    v_sql6 := v_sql6||'                                               , ';
    v_sql6 := v_sql6||'            0 AS LAST_13MON_ACC_OVERRUN_FLAG_13           ';
    v_sql6 := v_sql6||'                                               , ';
    v_sql6 := v_sql6||'            COAL (V24.FLAG_CON_ODUE, 0) AS ARREARINCREASE_L24M  ';
    v_sql6 := v_sql6||'                                                                  , ';
    v_sql6 := v_sql6||'            COAL (T1.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_1  ';
    v_sql6 := v_sql6||'                                                               , ';
    v_sql6 := v_sql6||'            COAL (T2.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_2  ';
    v_sql6 := v_sql6||'                                                               , ';
    v_sql6 := v_sql6||'            COAL (T3.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_3  ';
    v_sql6 := v_sql6||'                                                               , ';
    v_sql6 := v_sql6||'            COAL (T4.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_4  ';
    v_sql6 := v_sql6||'                                                               , ';
    v_sql6 := v_sql6||'            COAL (T5.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_5  ';
    v_sql6 := v_sql6||'                                                               , ';
    v_sql6 := v_sql6||'            COAL (T6.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_6  ';
    v_sql6 := v_sql6||'                                                               , ';
    v_sql6 := v_sql6||'            COAL (T7.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_7  ';
    v_sql6 := v_sql6||'                                                               , ';
    v_sql6 := v_sql6||'            COAL (T8.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_8  ';
    v_sql6 := v_sql6||'                                                               , ';
    v_sql6 := v_sql6||'            COAL (T9.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_9  ';
    v_sql6 := v_sql6||'                                                               , ';
    v_sql6 := v_sql6||'            COAL (T10.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_10  ';
    v_sql6 := v_sql6||'                                                                 , ';
    v_sql6 := v_sql6||'            COAL (T11.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_11  ';
    v_sql6 := v_sql6||'                                                                 , ';
    v_sql6 := v_sql6||'            COAL (T12.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_12  ';
    v_sql6 := v_sql6||'                                                                 , ';
    v_sql6 := v_sql6||'            COAL (T13.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_13  ';
    v_sql6 := v_sql6||'                                                                 , ';
    v_sql6 := v_sql6||'            COAL (T14.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_14  ';
    v_sql6 := v_sql6||'                                                                 , ';
    v_sql6 := v_sql6||'            COAL (T15.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_15  ';
    v_sql6 := v_sql6||'                                                                 , ';
    v_sql6 := v_sql6||'            COAL (T16.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_16  ';
    v_sql6 := v_sql6||'                                                                 , ';
    v_sql6 := v_sql6||'            COAL (T17.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_17  ';
    v_sql6 := v_sql6||'                                                                 , ';
    v_sql6 := v_sql6||'            COAL (T18.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_18  ';
    v_sql6 := v_sql6||'                                                                 , ';
    v_sql6 := v_sql6||'            COAL (T19.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_19  ';
    v_sql6 := v_sql6||'                                                                 , ';
    v_sql6 := v_sql6||'            COAL (T20.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_20  ';
    v_sql6 := v_sql6||'                                                                 , ';
    v_sql6 := v_sql6||'            COAL (T21.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_21  ';
    v_sql6 := v_sql6||'                                                                 , ';
    v_sql6 := v_sql6||'            COAL (T22.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_22  ';
    v_sql6 := v_sql6||'                                                                 , ';
    v_sql6 := v_sql6||'            COAL (T23.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_23  ';
    v_sql6 := v_sql6||'                                                                 , ';
    v_sql6 := v_sql6||'            COAL (T24.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_24  ';
    v_sql6 := v_sql6||'                                                                 , ';
    v_sql6 := v_sql6||'            CASE ';
    v_sql6 := v_sql6||'               WHEN (T0.LAST_TRDAY + 0) <= '||v_ETL_DATE_HALFYEAR ||' THEN ''0'' ';
    v_sql6 := v_sql6||'               ELSE ''1'' ';
    v_sql6 := v_sql6||'            END ';
    v_sql6 := v_sql6||'               AS LAST_6MON_INACTIVE_FLAG                         ';
    v_sql6 := v_sql6||'                                         , ';
    v_sql6 := v_sql6||'            COAL (V24.FLAG_CON_ODUE, 0)  ';
    v_sql6 := v_sql6||'                                           , ';
    v_sql6 := v_sql6||'            CASE ';
    v_sql6 := v_sql6||'               WHEN     (T0.TLMT_BEG + 0) <= '||v_ETL_DATE_NUM||' ';
    v_sql6 := v_sql6||'                    AND '||v_ETL_DATE_NUM||' < (T0.TLMT_END + 0) ';
    v_sql6 := v_sql6||'               THEN ';
    v_sql6 := v_sql6||'                  T0.TEMP_LIMIT ';
    v_sql6 := v_sql6||'               ELSE ';
    v_sql6 := v_sql6||'                  0 ';
    v_sql6 := v_sql6||'            END ';
    v_sql6 := v_sql6||'               AS TEMP_LIMIT                                            ';
    v_sql6 := v_sql6||'                            , ';
    v_sql6 := v_sql6||'            CASE ';
    v_sql6 := v_sql6||'               WHEN     (T0.TLMT_BEG + 0) <= '||v_ETL_DATE_NUM||' ';
    v_sql6 := v_sql6||'                    AND '||v_ETL_DATE_NUM||' < (T0.TLMT_END + 0) ';
    v_sql6 := v_sql6||'               THEN ';
    v_sql6 := v_sql6||'                  T0.TEMP_LIMIT * T0.CA_PCNT * 0.01 ';
    v_sql6 := v_sql6||'               ELSE ';
    v_sql6 := v_sql6||'                  T0.CRED_LIMIT * T0.CA_PCNT * 0.01 ';
    v_sql6 := v_sql6||'            END ';
    v_sql6 := v_sql6||'               AS ACCTCASHADVANCE                                      ';
    v_sql6 := v_sql6||'                                 , ';
    v_sql6 := v_sql6||'            T0.NBR_CASHAD AS LAST_CYCLEDAY_CASH_TIMES            ';
    v_sql6 := v_sql6||'                                                     , ';
    v_sql6 := v_sql6||'            CASE ';
    v_sql6 := v_sql6||'               WHEN COAL (T0.BANKACCT1, ''0'') = ''0'' THEN ''0'' ';
    v_sql6 := v_sql6||'               ELSE ''1'' ';
    v_sql6 := v_sql6||'            END ';
    v_sql6 := v_sql6||'               AS APP_AUTODEBIT                                  ';
    v_sql6 := v_sql6||'                               , ';
    v_sql6 := v_sql6||'            COAL (T1.ANNUAL_FEE_OVD_FLAG, ''0'') AS ANNUAL_FEE_OVD_FLAG  ';
    v_sql6 := v_sql6||'                                                                         , ';
    v_sql6 := v_sql6||'            CASE ';
    v_sql6 := v_sql6||'               WHEN COAL(T0.CLOSE_CODE,'' '') = '' '' THEN ''0'' ';
    v_sql6 := v_sql6||'               ELSE ''1'' ';
    v_sql6 := v_sql6||'            END ';
    v_sql6 := v_sql6||'               AS PRO_ACCTSTATUS_CC_EXISTING                        ';
    v_sql6 := v_sql6||'                                            , ';
    v_sql6 := v_sql6||'            CASE ';
    v_sql6 := v_sql6||'               WHEN T0.BAL > 300 AND COAL(T0.CLOSE_CODE,'' '') != '' '' ';
    v_sql6 := v_sql6||'               THEN ';
    v_sql6 := v_sql6||'                  ''1'' ';
    v_sql6 := v_sql6||'               ELSE ';
    v_sql6 := v_sql6||'                  ''0'' ';
    v_sql6 := v_sql6||'            END ';
    v_sql6 := v_sql6||'               AS ACCTSTATUS                               ';
    v_sql6 := v_sql6||'                            , ';
    v_sql6 := v_sql6||'            T0.BRANCH AS APP_BRANCH                                      ';
    v_sql6 := v_sql6||'                                   , ';
    v_sql6 := v_sql6||'            T0.CRED_LIMIT AS LIMITCC                                 ';
    v_sql6 := v_sql6||'                                    , ';
    v_sql6 := v_sql6||'            CASE ';
    v_sql6 := v_sql6||'               WHEN COAL(T0.CLOSE_CODE,'' '') = '' '' THEN ''0'' ';
    v_sql6 := v_sql6||'               ELSE ''1'' ';
    v_sql6 := v_sql6||'            END ';
    v_sql6 := v_sql6||'               AS PRO_STATUS_ACCT                                    ';
    v_sql6 := v_sql6||'                                 , ';
    v_sql6 := v_sql6||'            0 AS UTILIZATION                                       ';
    v_sql6 := v_sql6||'                            , ';
    v_sql6 := v_sql6||'            T0.BAL AS BALANCE                                             ';
    v_sql6 := v_sql6||'                             , ';
    v_sql6 := v_sql6||'            T0.AGE AS COLLECTMETHODS ';
    v_sql6 := v_sql6||'            , ';
    v_sql6 := v_sql6||'            T0.MTHS_ODUE AS COLLECTTIMES                                ';
    v_sql6 := v_sql6||'                                        , ';
    v_sql6 := v_sql6||'            0 AS PRO_CCSTATE                                            ';
    v_sql6 := v_sql6||'                            , ';
    v_sql6 := v_sql6||'            0 AS APP_CC_LIMIT_EXISTING                                ';
    v_sql6 := v_sql6||'                                      , ';
    v_sql6 := v_sql6||'            T0.CRED_LIMIT AS LONG_CRED_LIMIT                            ';
    v_sql6 := v_sql6||'                                            , ';
    v_sql6 := v_sql6||'            T0.CRED_LIMIT AS ACCTACCTLIMIT                            ';
    v_sql6 := v_sql6||'                                          , ';
    v_sql6 := v_sql6||'            ''0'' AS BILL_TAG                                             ';
    v_sql6 := v_sql6||'                           , ';
    v_sql6 := v_sql6||'            T0.CYCLE_NBR AS CYCLE_DAY_ONLY                               ';
    v_sql6 := v_sql6||'                                          , ';
    v_sql6 := v_sql6||'            T0.PROD_NBR AS ACCOUNT_LOGO                              ';
    v_sql6 := v_sql6||'                                       , ';
    v_sql6 := v_sql6||'            T0.CLOSE_CODE AS ACC_BLOCK_CODES1   ';
    v_sql6 := v_sql6||'                                             , ';
    v_sql6 := v_sql6||'            T0.WROFF_CODE AS ACC_BLOCK_CODES2   ';
    v_sql6 := v_sql6||'                                             , ';
    v_sql6 := v_sql6||'            CEIL ( ';
    v_sql6 := v_sql6||'               MONTHS_BETWEEN (toDate ('||v_ETL_DATE_NUM||', ''yyyy-mm-dd''), ';
    v_sql6 := v_sql6||'                               toDate (T0.DAY_OPENED, ''yyyy-mm-dd''))) ';
    v_sql6 := v_sql6||'               AS ACCTNUMB                                               ';
    v_sql6 := v_sql6||'                          , ';
    v_sql6 := v_sql6||'            CASE ';
    v_sql6 := v_sql6||'               WHEN     (CASE ';
    v_sql6 := v_sql6||'                            WHEN     (T0.TLMT_BEG + 0) <= '||v_ETL_DATE_NUM||' ';
    v_sql6 := v_sql6||'                                 AND '||v_ETL_DATE_NUM||' < (T0.TLMT_END + 0) ';
    v_sql6 := v_sql6||'                            THEN ';
    v_sql6 := v_sql6||'                               T0.TEMP_LIMIT ';
    v_sql6 := v_sql6||'                            ELSE ';
    v_sql6 := v_sql6||'                               T0.CRED_LIMIT ';
    v_sql6 := v_sql6||'                         END) > 0 ';
    v_sql6 := v_sql6||'                    AND (T0.BAL + 0) > ';
    v_sql6 := v_sql6||'                             (CASE ';
    v_sql6 := v_sql6||'                                 WHEN     (T0.TLMT_BEG + 0) <= '||v_ETL_DATE_NUM||' ';
    v_sql6 := v_sql6||'                                      AND '||v_ETL_DATE_NUM||' < (T0.TLMT_END + 0) ';
    v_sql6 := v_sql6||'                                 THEN ';
    v_sql6 := v_sql6||'                                    T0.TEMP_LIMIT ';
    v_sql6 := v_sql6||'                                 ELSE ';
    v_sql6 := v_sql6||'                                    T0.CRED_LIMIT ';
    v_sql6 := v_sql6||'                              END) ';
    v_sql6 := v_sql6||'                           / 2 ';
    v_sql6 := v_sql6||'               THEN ';
    v_sql6 := v_sql6||'                  1 ';
    v_sql6 := v_sql6||'               ELSE ';
    v_sql6 := v_sql6||'                  0 ';
    v_sql6 := v_sql6||'            END ';
    v_sql6 := v_sql6||'               AS PBOC_ACCTNUMB_UTILIZATION50UP     ';
    v_sql6 := v_sql6||'                                               , ';
    v_sql6 := v_sql6||'            CEIL ( ';
    v_sql6 := v_sql6||'               MONTHS_BETWEEN (toDate ('||v_ETL_DATE_NUM||', ''yyyy-mm-dd''), ';
    v_sql6 := v_sql6||'                               toDate (T0.DAY_OPENED, ''yyyy-mm-dd''))) ';
    v_sql6 := v_sql6||'               AS PBOC_ACCTAGE_HIGHEST                           ';
    v_sql6 := v_sql6||'                                      , ';
    v_sql6 := v_sql6||'            CASE WHEN COAL (T1.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql6 := v_sql6||'               AS LAST_24MON_OVD_TERM_1                  ';
    v_sql6 := v_sql6||'                                       , ';
    v_sql6 := v_sql6||'            CASE WHEN COAL (T2.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql6 := v_sql6||'               AS LAST_24MON_OVD_TERM_2                  ';
    v_sql6 := v_sql6||'                                       , ';
    v_sql6 := v_sql6||'            CASE WHEN COAL (T3.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql6 := v_sql6||'               AS LAST_24MON_OVD_TERM_3                  ';
    v_sql6 := v_sql6||'                                       , ';
    v_sql6 := v_sql6||'            CASE WHEN COAL (T4.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql6 := v_sql6||'               AS LAST_24MON_OVD_TERM_4                  ';
    v_sql6 := v_sql6||'                                       , ';
    v_sql6 := v_sql6||'            CASE WHEN COAL (T5.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql6 := v_sql6||'               AS LAST_24MON_OVD_TERM_5                  ';
    v_sql6 := v_sql6||'                                       , ';
    v_sql6 := v_sql6||'            CASE WHEN COAL (T6.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql6 := v_sql6||'               AS LAST_24MON_OVD_TERM_6                  ';
    v_sql6 := v_sql6||'                                       , ';
    v_sql6 := v_sql6||'            CASE WHEN COAL (T7.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql6 := v_sql6||'               AS LAST_24MON_OVD_TERM_7                  ';
    v_sql6 := v_sql6||'                                       , ';
    v_sql6 := v_sql6||'            CASE WHEN COAL (T8.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql6 := v_sql6||'               AS LAST_24MON_OVD_TERM_8                  ';
    v_sql6 := v_sql6||'                                       , ';
    v_sql6 := v_sql6||'            CASE WHEN COAL (T9.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql6 := v_sql6||'               AS LAST_24MON_OVD_TERM_9                  ';
    v_sql6 := v_sql6||'                                       , ';
    v_sql6 := v_sql6||'            CASE WHEN COAL (T10.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql6 := v_sql6||'               AS LAST_24MON_OVD_TERM_10                ';
    v_sql6 := v_sql6||'                                        , ';
    v_sql6 := v_sql6||'            CASE WHEN COAL (T11.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql6 := v_sql6||'               AS LAST_24MON_OVD_TERM_11                ';
    v_sql6 := v_sql6||'                                        , ';
    v_sql6 := v_sql6||'            CASE WHEN COAL (T12.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql6 := v_sql6||'               AS LAST_24MON_OVD_TERM_12                ';
    v_sql6 := v_sql6||'                                        , ';
    v_sql6 := v_sql6||'            CASE WHEN COAL (T13.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql6 := v_sql6||'               AS LAST_24MON_OVD_TERM_13                ';
    v_sql6 := v_sql6||'                                        , ';
    v_sql6 := v_sql6||'            CASE WHEN COAL (T14.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql6 := v_sql6||'               AS LAST_24MON_OVD_TERM_14                ';
    v_sql6 := v_sql6||'                                        , ';
    v_sql6 := v_sql6||'            CASE WHEN COAL (T15.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql6 := v_sql6||'               AS LAST_24MON_OVD_TERM_15                ';
    v_sql6 := v_sql6||'                                        , ';
    v_sql6 := v_sql6||'            CASE WHEN COAL (T16.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql6 := v_sql6||'               AS LAST_24MON_OVD_TERM_16                ';
    v_sql6 := v_sql6||'                                        , ';
    v_sql6 := v_sql6||'            CASE WHEN COAL (T17.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql6 := v_sql6||'               AS LAST_24MON_OVD_TERM_17                ';
    v_sql6 := v_sql6||'                                        , ';
    v_sql6 := v_sql6||'            CASE WHEN COAL (T18.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql6 := v_sql6||'               AS LAST_24MON_OVD_TERM_18               ';
    v_sql6 := v_sql6||'                                        , ';
    v_sql6 := v_sql6||'            CASE WHEN COAL (T19.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql6 := v_sql6||'               AS LAST_24MON_OVD_TERM_19                ';
    v_sql6 := v_sql6||'                                        , ';
    v_sql6 := v_sql6||'            CASE WHEN COAL (T20.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql6 := v_sql6||'               AS LAST_24MON_OVD_TERM_20                ';
    v_sql6 := v_sql6||'                                        , ';
    v_sql6 := v_sql6||'            CASE WHEN COAL (T21.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql6 := v_sql6||'               AS LAST_24MON_OVD_TERM_21                ';
    v_sql6 := v_sql6||'                                        , ';
    v_sql6 := v_sql6||'            CASE WHEN COAL (T22.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql6 := v_sql6||'               AS LAST_24MON_OVD_TERM_22                ';
    v_sql6 := v_sql6||'                                        , ';
    v_sql6 := v_sql6||'            CASE WHEN COAL (T23.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql6 := v_sql6||'               AS LAST_24MON_OVD_TERM_23                ';
    v_sql6 := v_sql6||'                                        , ';
    v_sql6 := v_sql6||'            CASE WHEN COAL (T24.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql6 := v_sql6||'               AS LAST_24MON_OVD_TERM_24                ';
    v_sql6 := v_sql6||'                                        , ';
    v_sql6 := v_sql6||'            CASE ';
    v_sql6 := v_sql6||'               WHEN COAL (V6.LIMIT, 0) = 0 OR COAL (V6.BAL, 0) <= 0 ';
    v_sql6 := v_sql6||'               THEN ';
    v_sql6 := v_sql6||'                  0 ';
    v_sql6 := v_sql6||'               WHEN (COAL (V6.LIMIT, 0) + 0) <= COAL (V6.BAL, 0) ';
    v_sql6 := v_sql6||'               THEN ';
    v_sql6 := v_sql6||'                  100 ';
    v_sql6 := v_sql6||'               ELSE ';
    v_sql6 := v_sql6||'                  ROUND ( ';
    v_sql6 := v_sql6||'                     COAL (V6.BAL, 0) / COAL (V6.LIMIT, 0) * 100, ';
    v_sql6 := v_sql6||'                     2) ';
    v_sql6 := v_sql6||'            END ';
    v_sql6 := v_sql6||'               AS UTILITY_AVE_L6M                               ';
    v_sql6 := v_sql6||'                                 , ';
    v_sql6 := v_sql6||'            T0.ADD_CHGDAY AS LAST_BILL_ADDRESS_CHANGE            ';
    v_sql6 := v_sql6||'                                                     , ';
    v_sql6 := v_sql6||'            T0.PROD_NBR AS RESULTREASONCODE                              ';
    v_sql6 := v_sql6||'                                           , ';
    v_sql6 := v_sql6||'            T0.PRODUCT AS PRODUCT                                     ';
    v_sql6 := v_sql6||'                                 , ';
    v_sql6 := v_sql6||'            T0.XACCOUNT                                                   ';
    v_sql6 := v_sql6||'            , ';
    v_sql6 := v_sql6||'            COAL ( T1.Close_Bal,0) +  COAL ( T1.Payment ,0 ) - COAL( T1.Open_Bal,0) as new_bal_1,  ';
    v_sql6 := v_sql6||'            COAL ( T2.Close_Bal,0) +  COAL ( T2.Payment ,0 ) - COAL( T2.Open_Bal,0) as new_bal_2, ';
    v_sql6 := v_sql6||'            COAL ( T3.Close_Bal,0) +  COAL ( T3.Payment ,0 ) - COAL( T3.Open_Bal,0) as new_bal_3, ';
    v_sql6 := v_sql6||'            COAL ( T4.Close_Bal,0) +  COAL ( T4.Payment ,0 ) - COAL( T4.Open_Bal,0) as new_bal_4, ';
    v_sql6 := v_sql6||'            COAL ( T5.Close_Bal,0) +  COAL ( T5.Payment ,0 ) - COAL( T5.Open_Bal,0) as new_bal_5, ';
    v_sql6 := v_sql6||'            COAL ( T6.Close_Bal,0) +  COAL ( T6.Payment ,0 ) - COAL( T6.Open_Bal,0) as new_bal_6, ';
    v_sql6 := v_sql6||'            COAL ( T7.Close_Bal,0) +  COAL ( T7.Payment ,0 ) - COAL( T7.Open_Bal,0) as new_bal_7, ';
    v_sql6 := v_sql6||'            COAL ( T8.Close_Bal,0) +  COAL ( T8.Payment ,0 ) - COAL( T8.Open_Bal,0) as new_bal_8, ';
    v_sql6 := v_sql6||'            COAL ( T9.Close_Bal,0) +  COAL ( T9.Payment ,0 ) - COAL( T9.Open_Bal,0) as new_bal_9, ';
    v_sql6 := v_sql6||'            COAL (T10.Close_Bal,0) +  COAL (T10.Payment ,0 ) - COAL(T10.Open_Bal,0) as new_bal_10, ';
    v_sql6 := v_sql6||'            COAL (T11.Close_Bal,0) +  COAL (T11.Payment ,0 ) - COAL(T11.Open_Bal,0) as new_bal_11, ';
    v_sql6 := v_sql6||'            COAL (T12.Close_Bal,0) +  COAL (T12.Payment ,0 ) - COAL(T12.Open_Bal,0) as new_bal_12, ';
    v_sql6 := v_sql6||'                CASE ';
    v_sql6 := v_sql6||'               WHEN   (COAL( T1.Open_Bal,0) + 0)  >   COAL ( T1.Payment ,0 ) ';
    v_sql6 := v_sql6||'                 then ';
    v_sql6 := v_sql6||'                     COAL( T1.Open_Bal,0) - COAL ( T1.Payment ,0 ) ';
    v_sql6 := v_sql6||'                 else ';
    v_sql6 := v_sql6||'                   0 ';
    v_sql6 := v_sql6||'                 end as open_bal_wo_pay_1, ';
    v_sql6 := v_sql6||'                CASE ';
    v_sql6 := v_sql6||'               WHEN   (COAL( T2.Open_Bal,0) + 0)  >   COAL ( T2.Payment ,0 ) ';
    v_sql6 := v_sql6||'                 then ';
    v_sql6 := v_sql6||'                     COAL( T2.Open_Bal,0) - COAL ( T2.Payment ,0 ) ';
    v_sql6 := v_sql6||'                 else ';
    v_sql6 := v_sql6||'                   0 ';
    v_sql6 := v_sql6||'                 end as open_bal_wo_pay_2, ';
    v_sql6 := v_sql6||'               CASE ';
    v_sql6 := v_sql6||'               WHEN   (COAL( T3.Open_Bal,0) + 0)  >   COAL ( T3.Payment ,0 ) ';
    v_sql6 := v_sql6||'                 then ';
    v_sql6 := v_sql6||'                     COAL( T3.Open_Bal,0) - COAL ( T3.Payment ,0 ) ';
    v_sql6 := v_sql6||'                 else ';
    v_sql6 := v_sql6||'                   0 ';
    v_sql6 := v_sql6||'                 end as open_bal_wo_pay_3, ';
    v_sql6 := v_sql6||'               CASE ';
    v_sql6 := v_sql6||'               WHEN   (COAL( T4.Open_Bal,0) + 0)  >   COAL ( T4.Payment ,0 ) ';
    v_sql6 := v_sql6||'                 then ';
    v_sql6 := v_sql6||'                     COAL( T4.Open_Bal,0) - COAL ( T4.Payment ,0 ) ';
    v_sql6 := v_sql6||'                 else ';
    v_sql6 := v_sql6||'                   0 ';
    v_sql6 := v_sql6||'                 end as open_bal_wo_pay_4, ';
    v_sql6 := v_sql6||'               CASE ';
    v_sql6 := v_sql6||'               WHEN   (COAL( T5.Open_Bal,0) + 0)  >   COAL ( T5.Payment ,0 ) ';
    v_sql6 := v_sql6||'                 then ';
    v_sql6 := v_sql6||'                     COAL( T5.Open_Bal,0) - COAL ( T5.Payment ,0 ) ';
    v_sql6 := v_sql6||'                 else ';
    v_sql6 := v_sql6||'                   0 ';
    v_sql6 := v_sql6||'                 end as open_bal_wo_pay_5, ';
    v_sql6 := v_sql6||'               CASE ';
    v_sql6 := v_sql6||'               WHEN   (COAL( T6.Open_Bal,0) + 0)  >   COAL ( T6.Payment ,0 ) ';
    v_sql6 := v_sql6||'                 then ';
    v_sql6 := v_sql6||'                     COAL( T6.Open_Bal,0) - COAL ( T6.Payment ,0 ) ';
    v_sql6 := v_sql6||'                 else ';
    v_sql6 := v_sql6||'                   0 ';
    v_sql6 := v_sql6||'                 end as open_bal_wo_pay_6, ';
    v_sql6 := v_sql6||'               CASE ';
    v_sql6 := v_sql6||'               WHEN   (COAL( T7.Open_Bal,0) + 0)  >   COAL ( T7.Payment ,0 ) ';
    v_sql6 := v_sql6||'                 then ';
    v_sql6 := v_sql6||'                     COAL( T7.Open_Bal,0) - COAL ( T7.Payment ,0 ) ';
    v_sql6 := v_sql6||'                 else ';
    v_sql6 := v_sql6||'                   0 ';
    v_sql6 := v_sql6||'                 end as open_bal_wo_pay_7, ';
    v_sql6 := v_sql6||'               CASE ';
    v_sql6 := v_sql6||'               WHEN   (COAL( T8.Open_Bal,0) + 0)  >   COAL ( T8.Payment ,0 ) ';
    v_sql6 := v_sql6||'                 then ';
    v_sql6 := v_sql6||'                     COAL( T8.Open_Bal,0) - COAL ( T8.Payment ,0 ) ';
    v_sql6 := v_sql6||'                 else ';
    v_sql6 := v_sql6||'                   0 ';
    v_sql6 := v_sql6||'                 end as open_bal_wo_pay_8, ';
    v_sql6 := v_sql6||'               CASE ';
    v_sql6 := v_sql6||'               WHEN   (COAL( T9.Open_Bal,0) + 0)  >   COAL ( T9.Payment ,0 ) ';
    v_sql6 := v_sql6||'                 then ';
    v_sql6 := v_sql6||'                     COAL( T9.Open_Bal,0) - COAL ( T9.Payment ,0 ) ';
    v_sql6 := v_sql6||'                 else ';
    v_sql6 := v_sql6||'                   0 ';
    v_sql6 := v_sql6||'                 end as open_bal_wo_pay_9, ';
    v_sql6 := v_sql6||'               CASE ';
    v_sql6 := v_sql6||'               WHEN   (COAL( T10.Open_Bal,0) + 0)  >   COAL ( T10.Payment ,0 ) ';
    v_sql6 := v_sql6||'                 then ';
    v_sql6 := v_sql6||'                     COAL( T10.Open_Bal,0) - COAL ( T10.Payment ,0 ) ';
    v_sql6 := v_sql6||'                 else ';
    v_sql6 := v_sql6||'                   0 ';
    v_sql6 := v_sql6||'                 end as open_bal_wo_pay_10, ';
    v_sql6 := v_sql6||'               CASE ';
    v_sql6 := v_sql6||'               WHEN   (COAL( T11.Open_Bal,0) + 0)  >   COAL ( T11.Payment ,0 ) ';
    v_sql6 := v_sql6||'                 then ';
    v_sql6 := v_sql6||'                     COAL( T11.Open_Bal,0) - COAL ( T11.Payment ,0 ) ';
    v_sql6 := v_sql6||'                 else ';
    v_sql6 := v_sql6||'                   0 ';
    v_sql6 := v_sql6||'                 end as open_bal_wo_pay_11, ';
    v_sql6 := v_sql6||'               CASE ';
    v_sql6 := v_sql6||'               WHEN   (COAL( T12.Open_Bal,0) + 0)  >   COAL ( T12.Payment ,0 ) ';
    v_sql6 := v_sql6||'                 then ';
    v_sql6 := v_sql6||'                     COAL( T12.Open_Bal,0) - COAL ( T12.Payment ,0 ) ';
    v_sql6 := v_sql6||'                 else ';
    v_sql6 := v_sql6||'                   0 ';
    v_sql6 := v_sql6||'                 end as open_bal_wo_pay_12 ';
    v_sql6 := v_sql6||'       FROM MDM_ACCT_X T0 ';
    v_sql6 := v_sql6||'            LEFT JOIN MDM_STMT_X T1 ';
    v_sql6 := v_sql6||'               ON     T0.XACCOUNT = T1.XACCOUNT ';
    v_sql6 := v_sql6||'                  AND todate(T1.STMT_DATE,''yyyy-mm-dd'') <= SYSDATE()                         ';
    v_sql6 := v_sql6||'                  AND todate(T1.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -1) ';
    v_sql6 := v_sql6||'            LEFT JOIN MDM_STMT_X T2 ';
    v_sql6 := v_sql6||'               ON     T0.XACCOUNT = T2.XACCOUNT ';
    v_sql6 := v_sql6||'                  AND todate(T2.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -1)     ';
    v_sql6 := v_sql6||'                  AND todate(T2.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -2)       ';
    v_sql6 := v_sql6||'            LEFT JOIN MDM_STMT_X T3 ';
    v_sql6 := v_sql6||'               ON     T0.XACCOUNT = T3.XACCOUNT ';
    v_sql6 := v_sql6||'                  AND todate(T3.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -2)      ';
    v_sql6 := v_sql6||'                  AND todate(T3.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -3)       ';
    v_sql6 := v_sql6||'            LEFT JOIN MDM_STMT_X T4 ';
    v_sql6 := v_sql6||'               ON     T0.XACCOUNT = T4.XACCOUNT ';
    v_sql6 := v_sql6||'                  AND todate(T4.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -3)      ';
    v_sql6 := v_sql6||'                  AND todate(T4.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -4)       ';
    v_sql6 := v_sql6||'            LEFT JOIN MDM_STMT_X T5 ';
    v_sql6 := v_sql6||'               ON     T0.XACCOUNT = T5.XACCOUNT ';
    v_sql6 := v_sql6||'                  AND todate(T5.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -4)      ';
    v_sql6 := v_sql6||'                  AND todate(T5.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -5)       ';
    v_sql6 := v_sql6||'            LEFT JOIN MDM_STMT_X T6 ';
    v_sql6 := v_sql6||'               ON     T0.XACCOUNT = T6.XACCOUNT ';
    v_sql6 := v_sql6||'                  AND todate(T6.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -5)      ';
    v_sql6 := v_sql6||'                  AND todate(T6.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -6)       ';
    v_sql6 := v_sql6||'            LEFT JOIN MDM_STMT_X T7 ';
    v_sql6 := v_sql6||'               ON     T0.XACCOUNT = T7.XACCOUNT ';
    v_sql6 := v_sql6||'                  AND todate(T7.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -6)      ';
    v_sql6 := v_sql6||'                  AND todate(T7.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -7)       ';
    v_sql6 := v_sql6||'            LEFT JOIN MDM_STMT_X T8 ';
    v_sql6 := v_sql6||'               ON     T0.XACCOUNT = T8.XACCOUNT ';
    v_sql6 := v_sql6||'                  AND todate(T8.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -7)      ';
    v_sql6 := v_sql6||'                  AND todate(T8.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -8)       ';
    v_sql6 := v_sql6||'            LEFT JOIN MDM_STMT_X T9 ';
    v_sql6 := v_sql6||'               ON     T0.XACCOUNT = T9.XACCOUNT ';
    v_sql6 := v_sql6||'                  AND todate(T9.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -8)      ';
    v_sql6 := v_sql6||'                  AND todate(T9.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -9)       ';
    v_sql6 := v_sql6||'            LEFT JOIN MDM_STMT_X T10 ';
    v_sql6 := v_sql6||'               ON     T0.XACCOUNT = T10.XACCOUNT ';
    v_sql6 := v_sql6||'                  AND todate(T10.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -9)     ';
    v_sql6 := v_sql6||'                  AND todate(T10.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -10)     ';
    v_sql6 := v_sql6||'            LEFT JOIN MDM_STMT_X T11 ';
    v_sql6 := v_sql6||'               ON     T0.XACCOUNT = T11.XACCOUNT ';
    v_sql6 := v_sql6||'                  AND todate(T11.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -10)    ';
    v_sql6 := v_sql6||'                  AND todate(T11.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -11)     ';
    v_sql6 := v_sql6||'            LEFT JOIN MDM_STMT_X T12 ';
    v_sql6 := v_sql6||'               ON     T0.XACCOUNT = T12.XACCOUNT ';
    v_sql6 := v_sql6||'                  AND todate(T12.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -11)    ';
    v_sql6 := v_sql6||'                  AND todate(T12.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -12)     ';
    v_sql6 := v_sql6||'            LEFT JOIN MDM_STMT_X T13 ';
    v_sql6 := v_sql6||'               ON     T0.XACCOUNT = T13.XACCOUNT ';
    v_sql6 := v_sql6||'                  AND todate(T13.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -12)    ';
    v_sql6 := v_sql6||'                  AND todate(T13.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -13)     ';
    v_sql6 := v_sql6||'            LEFT JOIN MDM_STMT_X T14 ';
    v_sql6 := v_sql6||'               ON     T0.XACCOUNT = T14.XACCOUNT ';
    v_sql6 := v_sql6||'                  AND todate(T14.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -13)    ';
    v_sql6 := v_sql6||'                  AND todate(T14.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -14)     ';
    v_sql6 := v_sql6||'            LEFT JOIN MDM_STMT_X T15 ';
    v_sql6 := v_sql6||'               ON     T0.XACCOUNT = T15.XACCOUNT ';
    v_sql6 := v_sql6||'                  AND todate(T15.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -14)    ';
    v_sql6 := v_sql6||'                  AND todate(T15.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -15)     ';
    v_sql6 := v_sql6||'            LEFT JOIN MDM_STMT_X T16 ';
    v_sql6 := v_sql6||'               ON     T0.XACCOUNT = T16.XACCOUNT ';
    v_sql6 := v_sql6||'                  AND todate(T16.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -15)    ';
    v_sql6 := v_sql6||'                  AND todate(T16.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -16)     ';
    v_sql6 := v_sql6||'            LEFT JOIN MDM_STMT_X T17 ';
    v_sql6 := v_sql6||'               ON     T0.XACCOUNT = T17.XACCOUNT ';
    v_sql6 := v_sql6||'                  AND todate(T17.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -16)    ';
    v_sql6 := v_sql6||'                  AND todate(T17.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -17)     ';
    v_sql6 := v_sql6||'            LEFT JOIN MDM_STMT_X T18 ';
    v_sql6 := v_sql6||'               ON     T0.XACCOUNT = T18.XACCOUNT ';
    v_sql6 := v_sql6||'                  AND todate(T18.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -17)    ';
    v_sql6 := v_sql6||'                  AND todate(T18.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -18)     ';
    v_sql6 := v_sql6||'            LEFT JOIN MDM_STMT_X T19 ';
    v_sql6 := v_sql6||'               ON     T0.XACCOUNT = T19.XACCOUNT ';
    v_sql6 := v_sql6||'                  AND todate(T19.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -18)    ';
    v_sql6 := v_sql6||'                  AND todate(T19.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -19)     ';
    v_sql6 := v_sql6||'            LEFT JOIN MDM_STMT_X T20 ';
    v_sql6 := v_sql6||'               ON     T0.XACCOUNT = T20.XACCOUNT ';
    v_sql6 := v_sql6||'                  AND todate(T20.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -19)    ';
    v_sql6 := v_sql6||'                  AND todate(T20.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -20)     ';
    v_sql6 := v_sql6||'            LEFT JOIN MDM_STMT_X T21 ';
    v_sql6 := v_sql6||'               ON     T0.XACCOUNT = T21.XACCOUNT ';
    v_sql6 := v_sql6||'                  AND todate(T21.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -20)    ';
    v_sql6 := v_sql6||'                  AND todate(T21.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -21)     ';
    v_sql6 := v_sql6||'            LEFT JOIN MDM_STMT_X T22 ';
    v_sql6 := v_sql6||'               ON     T0.XACCOUNT = T22.XACCOUNT ';
    v_sql6 := v_sql6||'                  AND todate(T22.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -21)    ';
    v_sql6 := v_sql6||'                  AND todate(T22.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -22)     ';
    v_sql6 := v_sql6||'            LEFT JOIN MDM_STMT_X T23 ';
    v_sql6 := v_sql6||'               ON     T0.XACCOUNT = T23.XACCOUNT ';
    v_sql6 := v_sql6||'                  AND todate(T23.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -22)    ';
    v_sql6 := v_sql6||'                  AND todate(T23.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -23)     ';
    v_sql6 := v_sql6||'            LEFT JOIN MDM_STMT_X T24 ';
    v_sql6 := v_sql6||'               ON     T0.XACCOUNT = T24.XACCOUNT ';
    v_sql6 := v_sql6||'                  AND todate(T24.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -23)    ';
    v_sql6 := v_sql6||'                  AND todate(T24.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -24)     ';
    v_sql6 := v_sql6||'            LEFT JOIN MDM_STMT_X T25 ';
    v_sql6 := v_sql6||'               ON     T0.XACCOUNT = T25.XACCOUNT ';
    v_sql6 := v_sql6||'                  AND todate(T25.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -24)    ';
    v_sql6 := v_sql6||'                  AND todate(T25.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -25)     ';
    v_sql6 := v_sql6||'            LEFT JOIN TEMP_MPUR_H_CINSTL T01 ON T0.XACCOUNT = T01.XACCOUNT ';
    v_sql6 := v_sql6||'             LEFT JOIN TEMP_STMTBALINCREASEMONTH_L12M A1 ON T0.XACCOUNT = A1.ACCTNBR ';
    v_sql6 := v_sql6||'             LEFT JOIN TEMP_STMTFEEINCREASEMONTH_L6M A2 ON T0.XACCOUNT = A2.ACCTNBR ';
    v_sql6 := v_sql6||'             LEFT JOIN TEMP_STMTCASHINCREASERATIO A3 ON T0.XACCOUNT = A3.ACCTNBR ';
    v_sql6 := v_sql6||'            LEFT JOIN (  SELECT XACCOUNT, SUM (FLAG_CON_ODUE) AS FLAG_CON_ODUE ';
    v_sql6 := v_sql6||'                           FROM V_S24_STMT_X_24M ';
    v_sql6 := v_sql6||'                       GROUP BY XACCOUNT) V24 ';
    v_sql6 := v_sql6||'               ON T0.XACCOUNT = V24.XACCOUNT ';
    v_sql6 := v_sql6||'            LEFT JOIN ';
    v_sql6 := v_sql6||'            (  SELECT XACCOUNT, ';
    v_sql6 := v_sql6||'                      ROUND ( ';
    v_sql6 := v_sql6||'                         AVG ( ';
    v_sql6 := v_sql6||'                            CASE ';
    v_sql6 := v_sql6||'                               WHEN BAL <= 0 OR COAL (LIMIT, 0) <= 0 ';
    v_sql6 := v_sql6||'                               THEN ';
    v_sql6 := v_sql6||'                                  0 ';
    v_sql6 := v_sql6||'                               WHEN (BAL + 0) >= LIMIT ';
    v_sql6 := v_sql6||'                               THEN ';
    v_sql6 := v_sql6||'                                  100 ';
    v_sql6 := v_sql6||'                               ELSE ';
    v_sql6 := v_sql6||'                                  BAL / LIMIT * 100 ';
    v_sql6 := v_sql6||'                            END), ';
    v_sql6 := v_sql6||'                         4) ';
    v_sql6 := v_sql6||'                         AS RATIO_CREDIT_USE, ';
    v_sql6 := v_sql6||'                      AVG (PAYMENT_RATIO) AS PAYMENT_RATIO, ';
    v_sql6 := v_sql6||'                      SUM (PAYMENT) AS SUM_PAYMENT, ';
    v_sql6 := v_sql6||'                      SUM (CLOSE_BAL) AS CLOSE_BAL, ';
    v_sql6 := v_sql6||'                      SUM (OPEN_BAL) AS OPEN_BAL, ';
    v_sql6 := v_sql6||'                      SUM (FLAG_COST) AS FLAG_COST, ';
    v_sql6 := v_sql6||'                      SUM (NBR_CASHAD_NEW) AS NBR_CASHAD_NEW, ';
    v_sql6 := v_sql6||'                      SUM (FLAG_CON_AGE) AS FLAG_CON_AGE, ';
    v_sql6 := v_sql6||'                      SUM (FLAG_CON_ODUE) AS FLAG_CON_ODUE, ';
    v_sql6 := v_sql6||'                      AVG (FLAG_CON_ADD_AGE) AS FLAG_CON_ADD_AGE, ';
    v_sql6 := v_sql6||'                      MAX (ODUE_MTHS + 0) AS ODUE_MTHS ';
    v_sql6 := v_sql6||'                 FROM V_S24_STMT_X_12M ';
    v_sql6 := v_sql6||'             GROUP BY XACCOUNT) V12 ';
    v_sql6 := v_sql6||'               ON T0.XACCOUNT = V12.XACCOUNT ';
    v_sql6 := v_sql6||'            LEFT JOIN ';
    v_sql6 := v_sql6||'            (  SELECT XACCOUNT, ';
    v_sql6 := v_sql6||'                      AVG (POINT_EAR) AS POINT_EAR, ';
    v_sql6 := v_sql6||'                      SUM (CLOSE_BAL) AS CLOSE_BAL, ';
    v_sql6 := v_sql6||'                      SUM (OPEN_BAL) AS OPEN_BAL, ';
    v_sql6 := v_sql6||'                      SUM (NBR_PURCH_NEW) AS NBR_PURCH_NEW, ';
    v_sql6 := v_sql6||'                      AVG (PAYMENT) AS AVG_PAYMENT, ';
    v_sql6 := v_sql6||'                      AVG (RATIO_CREDIT_USE_SP) AS RATIO_CREDIT_USE_SP, ';
    v_sql6 := v_sql6||'                      SUM (NBR_CASHAD_NEW) AS NBR_CASHAD_NEW, ';
    v_sql6 := v_sql6||'                      SUM (FLAG_AGE) AS FLAG_AGE, ';
    v_sql6 := v_sql6||'                      SUM (TOT_COST) AS TOT_COST, ';
    v_sql6 := v_sql6||'                      SUM (TOT_INI) AS TOT_INI, ';
    v_sql6 := v_sql6||'                      SUM (CRED_LIMIT) AS CRED_LIMIT, ';
    v_sql6 := v_sql6||'                      SUM (COAL (C_LIMIT, 0)) AS C_LIMIT, ';
    v_sql6 := v_sql6||'                      SUM (FLAG_COST) AS FLAG_COST, ';
    v_sql6 := v_sql6||'                      MAX (ODUE_MTHS + 0) AS ODUE_MTHS, ';
    v_sql6 := v_sql6||'                      SUM (BAL) AS BAL, ';
    v_sql6 := v_sql6||'                      SUM (COAL (LIMIT, 0)) AS LIMIT ';
    v_sql6 := v_sql6||'                 FROM V_S24_STMT_X_6M ';
    v_sql6 := v_sql6||'             GROUP BY XACCOUNT) V6 ';
    v_sql6 := v_sql6||'               ON T0.XACCOUNT = V6.XACCOUNT ';
    v_sql6 := v_sql6||'            LEFT JOIN ';
    v_sql6 := v_sql6||'            (  SELECT XACCOUNT, ';
    v_sql6 := v_sql6||'                      SUM (FLAG_AGE) AS FLAG_AGE, ';
    v_sql6 := v_sql6||'                      ROUND ( ';
    v_sql6 := v_sql6||'                         AVG (  ';
    v_sql6 := v_sql6||'                            CASE ';
    v_sql6 := v_sql6||'                               WHEN BAL <= 0 OR COAL (LIMIT, 0) <= 0 ';
    v_sql6 := v_sql6||'                               THEN ';
    v_sql6 := v_sql6||'                                  0 ';
    v_sql6 := v_sql6||'                               WHEN (BAL + 0) >= LIMIT ';
    v_sql6 := v_sql6||'                               THEN ';
    v_sql6 := v_sql6||'                                  100 ';
    v_sql6 := v_sql6||'                               ELSE ';
    v_sql6 := v_sql6||'                                  BAL / LIMIT * 100 ';
    v_sql6 := v_sql6||'                            END), ';
    v_sql6 := v_sql6||'                         4) ';
    v_sql6 := v_sql6||'                         AS RATIO_CREDIT_USE, ';
    v_sql6 := v_sql6||'                      MAX ( ';
    v_sql6 := v_sql6||'                         CASE ';
    v_sql6 := v_sql6||'                            WHEN BAL_ADD14 <= 0 OR COAL (LIMIT_MP, 0) <= 0  ';
    v_sql6 := v_sql6||'                            THEN ';
    v_sql6 := v_sql6||'                               0 ';
    v_sql6 := v_sql6||'                            WHEN (BAL_ADD14 + 0) >= LIMIT_MP ';
    v_sql6 := v_sql6||'                            THEN ';
    v_sql6 := v_sql6||'                               100 ';
    v_sql6 := v_sql6||'                            ELSE ';
    v_sql6 := v_sql6||'                               ROUND (BAL_ADD14 / LIMIT_MP * 100, 4) ';
    v_sql6 := v_sql6||'                         END) ';
    v_sql6 := v_sql6||'                         AS MAX_RATIO_CREDIT_USE, ';
    v_sql6 := v_sql6||'                      SUM (CRED_LIMIT) AS CRED_LIMIT, ';
    v_sql6 := v_sql6||'                      SUM (BAL_ADD14) AS BAL_ADD14, ';
    v_sql6 := v_sql6||'                      SUM (COAL (LIMIT_MP, 0)) AS LIMIT_MP, ';
    v_sql6 := v_sql6||'                      SUM (CLOSE_BAL) AS CLOSE_BAL, ';
    v_sql6 := v_sql6||'                      SUM (OPEN_BAL) AS OPEN_BAL, ';
    v_sql6 := v_sql6||'                      SUM (FLAG_CASH) AS FLAG_CASH, ';
    v_sql6 := v_sql6||'                      SUM (FLAG_PAYMENT_P10) AS FLAG_PAYMENT_P10 ';
    v_sql6 := v_sql6||'                 FROM V_S24_STMT_X_3M ';
    v_sql6 := v_sql6||'             GROUP BY XACCOUNT) V3 ';
    v_sql6 := v_sql6||'               ON T0.XACCOUNT = V3.XACCOUNT ';
    DBMS_OUTPUT.PUT_LINE(v_sql6);
    DBMS_OUTPUT.PUT_LINE('v_sql6 after:=========');
    EXECUTE IMMEDIATE v_sql6;

    DBMS_OUTPUT.PUT_LINE('START EXECUTE TRUNCATE TABLE MDM_ACCT_INFO_SP');
    DECLARE TRUN_TBL_MDM_ACCT_INFO_SP STRING = 'TRUNCATE TABLE MDM_ACCT_INFO_SP';
    EXECUTE TRUN_TBL_MDM_ACCT_INFO_SP;

    DBMS_OUTPUT.PUT_LINE('START INSERT INTO MDM_ACCT_INFO_SP');
    DBMS_OUTPUT.PUT_LINE('v_sql7 before:=========' || v_sql7);
    v_sql7 := 'INSERT INTO MDM_ACCT_INFO  ';
    v_sql7 := v_sql7||'     SELECT T0.BANK AS BANK                                              ';
    v_sql7 := v_sql7||'                           , ';
    v_sql7 := v_sql7||'            T0.XACCOUNT AS XACCOUNT                                       ';
    v_sql7 := v_sql7||'                                   , ';
    v_sql7 := v_sql7||'            T0.CUSTR_NBR AS CUSTR_NBR                              ';
    v_sql7 := v_sql7||'                                     , ';
    v_sql7 := v_sql7||'             CASE ';
    v_sql7 := v_sql7||'               WHEN  (T0.CYCLE_NBR +0) >  SUBSTR (TRIM('' '||v_ETL_DATE||' ''), 7, 2) ';
    v_sql7 := v_sql7||'                    AND T0.CYCLE_NBR < 10 ';
    v_sql7 := v_sql7||'               THEN ';
    v_sql7 := v_sql7||'                       CONCAT(toDate ( ADD_MONTHS ( TRIM('' '||v_ETL_DATE_MONTH||' ''), -1 ) , ''yyyymm'') ';
    v_sql7 := v_sql7||'                     , ''0'' ';
    v_sql7 := v_sql7||'                     , T0.CYCLE_NBR) ';
    v_sql7 := v_sql7||'               WHEN ';
    v_sql7 := v_sql7||'                     (T0.CYCLE_NBR +0) > SUBSTR (TRIM('' '||v_ETL_DATE||' ''), 7, 2) ';
    v_sql7 := v_sql7||'                     AND T0.CYCLE_NBR >= 10 ';
    v_sql7 := v_sql7||'               THEN ';
    v_sql7 := v_sql7||'                      CONCAT(toDate ( ADD_MONTHS ( TRIM('' '||v_ETL_DATE_MONTH||' '') , -1 ) , ''yyyymm'') ';
    v_sql7 := v_sql7||'                     , T0.CYCLE_NBR) ';
    v_sql7 := v_sql7||'               WHEN ';
    v_sql7 := v_sql7||'                     (T0.CYCLE_NBR +0) <= SUBSTR (TRIM('' '||v_ETL_DATE||' ''), 7, 2) ';
    v_sql7 := v_sql7||'                    AND T0.CYCLE_NBR < 10 ';
    v_sql7 := v_sql7||'               THEN ';
    v_sql7 := v_sql7||'                     CONCAT(SUBSTR (TRIM('' '||v_ETL_DATE||' ''), 1, 6) ';
    v_sql7 := v_sql7||'                     , ''0'' ';
    v_sql7 := v_sql7||'                     , T0.CYCLE_NBR) ';
    v_sql7 := v_sql7||'               WHEN ';
    v_sql7 := v_sql7||'                     (T0.CYCLE_NBR +0) <= SUBSTR (TRIM('' '||v_ETL_DATE||' ''), 7, 2) ';
    v_sql7 := v_sql7||'                    AND T0.CYCLE_NBR >= 10 ';
    v_sql7 := v_sql7||'               THEN ';
    v_sql7 := v_sql7||'                     CONCAT(SUBSTR (TRIM('' '||v_ETL_DATE||' ''), 1, 6) ';
    v_sql7 := v_sql7||'                     , T0.CYCLE_NBR) ';
    v_sql7 := v_sql7||'            END ';
    v_sql7 := v_sql7||'               AS CYCLE_DATE                                           ';
    v_sql7 := v_sql7||'                            , ';
    v_sql7 := v_sql7||'            COAL (T1.MIN_DUE, 0) AS MONTHLYPAYCC           ';
    v_sql7 := v_sql7||'                                                    , ';
    v_sql7 := v_sql7||'            CASE ';
    v_sql7 := v_sql7||'               WHEN T0.MTHS_ODUE IN (0, ';
    v_sql7 := v_sql7||'                                     1, ';
    v_sql7 := v_sql7||'                                     2, ';
    v_sql7 := v_sql7||'                                     3, ';
    v_sql7 := v_sql7||'                                     4) ';
    v_sql7 := v_sql7||'               THEN ';
    v_sql7 := v_sql7||'                  T0.MTHS_ODUE ';
    v_sql7 := v_sql7||'               ELSE ';
    v_sql7 := v_sql7||'                  ''5'' ';
    v_sql7 := v_sql7||'            END ';
    v_sql7 := v_sql7||'               AS CURR_OVD_STATUS                                     ';
    v_sql7 := v_sql7||'                                 , ';
    v_sql7 := v_sql7||'            COAL (T01.MTH_INSTL, 0) AS LINS_CUR_SH_AMT     ';
    v_sql7 := v_sql7||'                                                          , ';
    v_sql7 := v_sql7||'            CASE ';
    v_sql7 := v_sql7||'               WHEN    T0.TEMP_LIMIT = 0 ';
    v_sql7 := v_sql7||'                    OR (T0.TEMP_LIMIT > 0 AND '||v_ETL_DATE_NUM||'>= (T0.TLMT_END +0))  ';
    v_sql7 := v_sql7||'               THEN ';
    v_sql7 := v_sql7||'                  ''1'' ';
    v_sql7 := v_sql7||'               WHEN     T0.TEMP_LIMIT > 0 ';
    v_sql7 := v_sql7||'                    AND (T0.TLMT_BEG +0) <= '||v_ETL_DATE_NUM||' ';
    v_sql7 := v_sql7||'                    AND '||v_ETL_DATE_NUM||' < (T0.TLMT_END +0) ';
    v_sql7 := v_sql7||'               THEN ';
    v_sql7 := v_sql7||'                  ''2'' ';
    v_sql7 := v_sql7||'               ELSE ';
    v_sql7 := v_sql7||'                  ''3'' ';
    v_sql7 := v_sql7||'            END ';
    v_sql7 := v_sql7||'               AS HISTUPDATEDLIMITTYPE                ';
    v_sql7 := v_sql7||'                                       ';
    v_sql7 := v_sql7||'            , ';
    v_sql7 := v_sql7||'            CASE ';
    v_sql7 := v_sql7||'               WHEN T1.BAL <= 0 OR COAL (T1.LIMIT, 0) = 0 THEN 0 ';
    v_sql7 := v_sql7||'               WHEN (T1.BAL + 0) >= COAL (T1.LIMIT, 0) THEN 100 ';
    v_sql7 := v_sql7||'               ELSE ROUND (T1.BAL / T1.LIMIT * 100, 2) ';
    v_sql7 := v_sql7||'            END ';
    v_sql7 := v_sql7||'               AS LIMITUSAGE                                           ';
    v_sql7 := v_sql7||'                            , ';
    v_sql7 := v_sql7||'            CASE WHEN T0.CLOSE_CODE = ''Z'' THEN ''1'' ELSE ''0'' END ';
    v_sql7 := v_sql7||'               AS DEATH_EXCLUDE_FLAG                                ';
    v_sql7 := v_sql7||'                                    , ';
    v_sql7 := v_sql7||'            T0.BRANCH AS BRANCH                                           ';
    v_sql7 := v_sql7||'                               , ';
    v_sql7 := v_sql7||'            ROUND (COAL (V12.RATIO_CREDIT_USE, 0), 4) ';
    v_sql7 := v_sql7||'               AS STMTUTILITY_AVE_L12M                ';
    v_sql7 := v_sql7||'                                      , ';
    v_sql7 := v_sql7||'            ROUND (COAL (V12.PAYMENT_RATIO, 0), 4) ';
    v_sql7 := v_sql7||'               AS STMTREPAYRATIO_L12M                           ';
    v_sql7 := v_sql7||'                                     , ';
    v_sql7 := v_sql7||'            CASE ';
    v_sql7 := v_sql7||'               WHEN    (COAL (V12.SUM_PAYMENT, 0) + 0) >= ';
    v_sql7 := v_sql7||'                          COAL (V12.OPEN_BAL, 0) ';
    v_sql7 := v_sql7||'                    OR COAL (V12.OPEN_BAL, 0) <= 10 ';
    v_sql7 := v_sql7||'               THEN ';
    v_sql7 := v_sql7||'                  100 ';
    v_sql7 := v_sql7||'               ELSE ';
    v_sql7 := v_sql7||'                  ROUND ( ';
    v_sql7 := v_sql7||'                       COAL (V12.SUM_PAYMENT, 0) ';
    v_sql7 := v_sql7||'                     / COAL (V12.OPEN_BAL, 0) ';
    v_sql7 := v_sql7||'                     * 100, ';
    v_sql7 := v_sql7||'                     4) ';
    v_sql7 := v_sql7||'            END ';
    v_sql7 := v_sql7||'               AS PAST12_REPAY_AVG_RATIO                       ';
    v_sql7 := v_sql7||'                                        , ';
    v_sql7 := v_sql7||'            COAL (V12.FLAG_COST, 0) AS STMTFEEACCOUR_L12M  ';
    v_sql7 := v_sql7||'                                                             , ';
    v_sql7 := v_sql7||'            COAL (V12.NBR_CASHAD_NEW, 0) AS PAST12_GET_CASH_COUNT  ';
    v_sql7 := v_sql7||'                                                                     , ';
    v_sql7 := v_sql7||'            ROUND (COAL (V12.FLAG_CON_ADD_AGE, 0) * 100, 2) ';
    v_sql7 := v_sql7||'               AS COLLECTTEMPLATE                       ';
    v_sql7 := v_sql7||'                                 , ';
    v_sql7 := v_sql7||'            COAL (V12.ODUE_MTHS, 0) AS PAST12_MAX_DUE_MTHS                         ';
    v_sql7 := v_sql7||'                                                              , ';
    v_sql7 := v_sql7||'            COAL (A1.FLAG_CON_ADD_BAL_CNT, 0) AS STMTBALINCREASEMONTH_L12M  ';
    v_sql7 := v_sql7||'                                                                           , ';
    v_sql7 := v_sql7||'            COAL (V3.FLAG_AGE, 0) AS PAST3_DUE_COUNT    ';
    v_sql7 := v_sql7||'                                                        , ';
    v_sql7 := v_sql7||'            COAL (V3.RATIO_CREDIT_USE, 0) AS PAST3_CREDIT_USE_RATIO  ';
    v_sql7 := v_sql7||'                                                                       , ';
    v_sql7 := v_sql7||'            COAL (V3.MAX_RATIO_CREDIT_USE, 0) ';
    v_sql7 := v_sql7||'               AS PAST3_CREDIT_USE_RATIO_MAX          ';
    v_sql7 := v_sql7||'                                            , ';
    v_sql7 := v_sql7||'            CASE ';
    v_sql7 := v_sql7||'               WHEN COAL (T1.PAYMENT, 0) > 0 ';
    v_sql7 := v_sql7||'               THEN ';
    v_sql7 := v_sql7||'                  0 ';
    v_sql7 := v_sql7||'               WHEN     COAL (T2.PAYMENT, 0) > 0 ';
    v_sql7 := v_sql7||'                    AND COAL (T1.PAYMENT, 0) = 0 ';
    v_sql7 := v_sql7||'               THEN ';
    v_sql7 := v_sql7||'                  1 ';
    v_sql7 := v_sql7||'               WHEN     COAL (T3.PAYMENT, 0) > 0 ';
    v_sql7 := v_sql7||'                    AND COAL (T1.PAYMENT, 0) + COAL (T2.PAYMENT, 0) = ';
    v_sql7 := v_sql7||'                           0 ';
    v_sql7 := v_sql7||'               THEN ';
    v_sql7 := v_sql7||'                  2 ';
    v_sql7 := v_sql7||'               ELSE ';
    v_sql7 := v_sql7||'                  3 ';
    v_sql7 := v_sql7||'            END ';
    v_sql7 := v_sql7||'               AS PAST3_PAY_AMT_MTHS                         ';
    v_sql7 := v_sql7||'                                    , ';
    v_sql7 := v_sql7||'            COAL (T1.NBR_CASHAD_NEW, 0) AS LAST_3MON_CASH_TIMES_1  ';
    v_sql7 := v_sql7||'                                                                     , ';
    v_sql7 := v_sql7||'            COAL (T2.NBR_CASHAD_NEW, 0) AS LAST_3MON_CASH_TIMES_2  ';
    v_sql7 := v_sql7||'                                                                     , ';
    v_sql7 := v_sql7||'            COAL (T3.NBR_CASHAD_NEW, 0) AS LAST_3MON_CASH_TIMES_3  ';
    v_sql7 := v_sql7||'                                                                     , ';
    v_sql7 := v_sql7||'            CASE ';
    v_sql7 := v_sql7||'               WHEN    COAL (V3.LIMIT_MP, 0) = 0 ';
    v_sql7 := v_sql7||'                    OR COAL (V3.BAL_ADD14, 0) <= 0 ';
    v_sql7 := v_sql7||'               THEN ';
    v_sql7 := v_sql7||'                  0 ';
    v_sql7 := v_sql7||'               WHEN (COAL (V3.BAL_ADD14, 0) + 0) >= COAL (V3.LIMIT_MP, 0) ';
    v_sql7 := v_sql7||'               THEN ';
    v_sql7 := v_sql7||'                  100 ';
    v_sql7 := v_sql7||'               ELSE ';
    v_sql7 := v_sql7||'                  ROUND ( ';
    v_sql7 := v_sql7||'                       COAL (V3.BAL_ADD14, 0) ';
    v_sql7 := v_sql7||'                     / COAL (V3.LIMIT_MP, 0) ';
    v_sql7 := v_sql7||'                     * 100, ';
    v_sql7 := v_sql7||'                     2) ';
    v_sql7 := v_sql7||'            END ';
    v_sql7 := v_sql7||'               AS STMTUTILITY_AVE_L3M                    ';
    v_sql7 := v_sql7||'                                     , ';
    v_sql7 := v_sql7||'            COAL (A3.FLAG_CON_ADD_CASH_CNT, 0) AS STMTCASHINCREASERATIO  ';
    v_sql7 := v_sql7||'                                                                       , ';
    v_sql7 := v_sql7||'            COAL (V3.FLAG_CASH, 0) AS PAST3_GET_CASH_RATIO  ';
    v_sql7 := v_sql7||'                                                              , ';
    v_sql7 := v_sql7||'            CASE ';
    v_sql7 := v_sql7||'               WHEN    COAL (V6.C_LIMIT, 0) = 0 ';
    v_sql7 := v_sql7||'                    OR COAL (V6.POINT_EAR, 0) <= 0 ';
    v_sql7 := v_sql7||'               THEN ';
    v_sql7 := v_sql7||'                  0 ';
    v_sql7 := v_sql7||'               WHEN     COAL (V6.C_LIMIT, 0) > 0 ';
    v_sql7 := v_sql7||'                    AND (COAL (V6.C_LIMIT, 0) + 0) < ';
    v_sql7 := v_sql7||'                           COAL (V6.POINT_EAR, 0) ';
    v_sql7 := v_sql7||'               THEN ';
    v_sql7 := v_sql7||'                  100 ';
    v_sql7 := v_sql7||'               ELSE ';
    v_sql7 := v_sql7||'                  ROUND ( ';
    v_sql7 := v_sql7||'                       COAL (V6.POINT_EAR, 0) ';
    v_sql7 := v_sql7||'                     / COAL (V6.CRED_LIMIT, 0) ';
    v_sql7 := v_sql7||'                     * 100, ';
    v_sql7 := v_sql7||'                     2) ';
    v_sql7 := v_sql7||'            END ';
    v_sql7 := v_sql7||'               AS STMTUTILITY_AVE_L6M                      ';
    v_sql7 := v_sql7||'                                     , ';
    v_sql7 := v_sql7||'            COAL (V3.FLAG_PAYMENT_P10, 0) AS STMTREPAYRATIO10MONTH_L6M  ';
    v_sql7 := v_sql7||'                                                                          , ';
    v_sql7 := v_sql7||'            CASE ';
    v_sql7 := v_sql7||'               WHEN COAL (V6.OPEN_BAL, 0) <= 0 ';
    v_sql7 := v_sql7||'               THEN ';
    v_sql7 := v_sql7||'                  100 ';
    v_sql7 := v_sql7||'               WHEN (COAL(V6.OPEN_BAL, 0) + 0) <= ';
    v_sql7 := v_sql7||'                       COAL (V6.AVG_PAYMENT, 0) ';
    v_sql7 := v_sql7||'               THEN ';
    v_sql7 := v_sql7||'                  100 ';
    v_sql7 := v_sql7||'               ELSE ';
    v_sql7 := v_sql7||'                  ROUND ( ';
    v_sql7 := v_sql7||'                       COAL (V6.AVG_PAYMENT, 0) ';
    v_sql7 := v_sql7||'                     / (COAL (V6.OPEN_BAL, 0)) ';
    v_sql7 := v_sql7||'                     * 100, ';
    v_sql7 := v_sql7||'                     2) ';
    v_sql7 := v_sql7||'            END ';
    v_sql7 := v_sql7||'               AS STMTREPAYRATIO_L6M                              ';
    v_sql7 := v_sql7||'                                    , ';
    v_sql7 := v_sql7||'            ROUND (COAL (V6.POINT_EAR, 0), 2) AS STMTREWARD_AVE_L6M  ';
    v_sql7 := v_sql7||'            , ';
    v_sql7 := v_sql7||'            ROUND (COAL (V6.TOT_COST, 0), 4) AS STMTINCOME_AVE_L6M  ';
    v_sql7 := v_sql7||'                                                                      , ';
    v_sql7 := v_sql7||'            COAL (V6.FLAG_COST, 0) AS PAST6_FEE_COUNT  ';
    v_sql7 := v_sql7||'                                                         , ';
    v_sql7 := v_sql7||'            COAL (A2.FLAG_CON_ADD_COST_CNT, 0) AS STMTFEEINCREASEMONTH_L6M  ';
    v_sql7 := v_sql7||'                                                                          , ';
    v_sql7 := v_sql7||'            COAL (V6.NBR_CASHAD_NEW, 0) AS STMTSUMCASH_L6M   ';
    v_sql7 := v_sql7||'                                                              , ';
    v_sql7 := v_sql7||'            CASE ';
    v_sql7 := v_sql7||'               WHEN COAL (T1.NBR_CASHAD_NEW, 0) > 0 ';
    v_sql7 := v_sql7||'               THEN ';
    v_sql7 := v_sql7||'                  1 ';
    v_sql7 := v_sql7||'               WHEN     COAL (T2.NBR_CASHAD_NEW, 0) > 0 ';
    v_sql7 := v_sql7||'                    AND COAL (T1.NBR_CASHAD_NEW, 0) = 0 ';
    v_sql7 := v_sql7||'               THEN ';
    v_sql7 := v_sql7||'                  2 ';
    v_sql7 := v_sql7||'               WHEN     COAL (T3.NBR_CASHAD_NEW, 0) > 0 ';
    v_sql7 := v_sql7||'                    AND   COAL (T1.NBR_CASHAD_NEW, 0) ';
    v_sql7 := v_sql7||'                        + COAL (T2.NBR_CASHAD_NEW, 0) = 0 ';
    v_sql7 := v_sql7||'               THEN ';
    v_sql7 := v_sql7||'                  3 ';
    v_sql7 := v_sql7||'               WHEN     COAL (T4.NBR_CASHAD_NEW, 0) > 0 ';
    v_sql7 := v_sql7||'                    AND   COAL (T1.NBR_CASHAD_NEW, 0) ';
    v_sql7 := v_sql7||'                        + COAL (T2.NBR_CASHAD_NEW, 0) ';
    v_sql7 := v_sql7||'                        + COAL (T3.NBR_CASHAD_NEW, 0) = 0 ';
    v_sql7 := v_sql7||'               THEN ';
    v_sql7 := v_sql7||'                  4 ';
    v_sql7 := v_sql7||'               WHEN     COAL (T5.NBR_CASHAD_NEW, 0) > 0 ';
    v_sql7 := v_sql7||'                    AND   COAL (T1.NBR_CASHAD_NEW, 0) ';
    v_sql7 := v_sql7||'                        + COAL (T2.NBR_CASHAD_NEW, 0) ';
    v_sql7 := v_sql7||'                        + COAL (T3.NBR_CASHAD_NEW, 0) ';
    v_sql7 := v_sql7||'                        + COAL (T4.NBR_CASHAD_NEW, 0) = 0 ';
    v_sql7 := v_sql7||'               THEN ';
    v_sql7 := v_sql7||'                  5 ';
    v_sql7 := v_sql7||'               WHEN     COAL (T6.NBR_CASHAD_NEW, 0) > 0 ';
    v_sql7 := v_sql7||'                    AND   COAL (T1.NBR_CASHAD_NEW, 0) ';
    v_sql7 := v_sql7||'                        + COAL (T2.NBR_CASHAD_NEW, 0) ';
    v_sql7 := v_sql7||'                        + COAL (T3.NBR_CASHAD_NEW, 0) ';
    v_sql7 := v_sql7||'                        + COAL (T4.NBR_CASHAD_NEW, 0) ';
    v_sql7 := v_sql7||'                        + COAL (T5.NBR_CASHAD_NEW, 0) = 0 ';
    v_sql7 := v_sql7||'               THEN ';
    v_sql7 := v_sql7||'                  6 ';
    v_sql7 := v_sql7||'               ELSE ';
    v_sql7 := v_sql7||'                  6 ';
    v_sql7 := v_sql7||'            END ';
    v_sql7 := v_sql7||'               AS STMTCASHADVANCEMONTH_L6M                   ';
    v_sql7 := v_sql7||'                                          , ';
    v_sql7 := v_sql7||'            COAL (V6.NBR_PURCH_NEW, 0) AS STMTSUMCONSUME_L6M  ';
    v_sql7 := v_sql7||'                                                                , ';
    v_sql7 := v_sql7||'            COAL (V6.ODUE_MTHS, 0) AS PAST6_DUE_COUNT_MAX    ';
    v_sql7 := v_sql7||'                                                             , ';
    v_sql7 := v_sql7||'            COAL (V12.FLAG_CON_ODUE, 0) AS ARREARINCREASE_L12M  ';
    v_sql7 := v_sql7||'                                                                  , ';
    v_sql7 := v_sql7||'            COAL (T1.PURCHASES, 0) AS LAST_12MON_CONSUME_AMT_1  ';
    v_sql7 := v_sql7||'                                                                  , ';
    v_sql7 := v_sql7||'            COAL (T2.PURCHASES, 0) AS LAST_12MON_CONSUME_AMT_2  ';
    v_sql7 := v_sql7||'                                                                  , ';
    v_sql7 := v_sql7||'            COAL (T3.PURCHASES, 0) AS LAST_12MON_CONSUME_AMT_3  ';
    v_sql7 := v_sql7||'                                                                  , ';
    v_sql7 := v_sql7||'            COAL (T4.PURCHASES, 0) AS LAST_12MON_CONSUME_AMT_4  ';
    v_sql7 := v_sql7||'                                                                  , ';
    v_sql7 := v_sql7||'            COAL (T5.PURCHASES, 0) AS LAST_12MON_CONSUME_AMT_5  ';
    v_sql7 := v_sql7||'                                                                  , ';
    v_sql7 := v_sql7||'            COAL (T6.PURCHASES, 0) AS LAST_12MON_CONSUME_AMT_6  ';
    v_sql7 := v_sql7||'                                                                  , ';
    v_sql7 := v_sql7||'            COAL (T7.PURCHASES, 0) AS LAST_12MON_CONSUME_AMT_7  ';
    v_sql7 := v_sql7||'                                                                  , ';
    v_sql7 := v_sql7||'            COAL (T8.PURCHASES, 0) AS LAST_12MON_CONSUME_AMT_8 ';
    v_sql7 := v_sql7||'                                                                  , ';
    v_sql7 := v_sql7||'            COAL (T9.PURCHASES, 0) AS LAST_12MON_CONSUME_AMT_9 ';
    v_sql7 := v_sql7||'                                                                  , ';
    v_sql7 := v_sql7||'            COAL (T10.PURCHASES, 0) AS LAST_12MON_CONSUME_AMT_10  ';
    v_sql7 := v_sql7||'                                                                    , ';
    v_sql7 := v_sql7||'            COAL (T11.PURCHASES, 0) AS LAST_12MON_CONSUME_AMT_11 ';
    v_sql7 := v_sql7||'                                                                    , ';
    v_sql7 := v_sql7||'            COAL (T12.PURCHASES, 0) AS LAST_12MON_CONSUME_AMT_12 ';
    v_sql7 := v_sql7||'                                                                    , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_RETAIL_AMT_1                 ';
    v_sql7 := v_sql7||'                                        , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_RETAIL_AMT_2                 ';
    v_sql7 := v_sql7||'                                        , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_RETAIL_AMT_3                 ';
    v_sql7 := v_sql7||'                                        , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_RETAIL_AMT_4                 ';
    v_sql7 := v_sql7||'                                        , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_RETAIL_AMT_5                 ';
    v_sql7 := v_sql7||'                                        , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_RETAIL_AMT_6                 ';
    v_sql7 := v_sql7||'                                        , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_RETAIL_AMT_7                 ';
    v_sql7 := v_sql7||'                                        , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_RETAIL_AMT_8                 ';
    v_sql7 := v_sql7||'                                        , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_RETAIL_AMT_9                ';
    v_sql7 := v_sql7||'                                        , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_RETAIL_AMT_10               ';
    v_sql7 := v_sql7||'                                         , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_RETAIL_AMT_11               ';
    v_sql7 := v_sql7||'                                         , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_RETAIL_AMT_12               ';
    v_sql7 := v_sql7||'                                         , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_RETAIL_AMT_13               ';
    v_sql7 := v_sql7||'                                         , ';
    v_sql7 := v_sql7||'            COAL (T1.PAYMENT, 0) AS LAST_13MON_REPAYMENT_1  ';
    v_sql7 := v_sql7||'                                                              , ';
    v_sql7 := v_sql7||'            COAL (T2.PAYMENT, 0) AS LAST_13MON_REPAYMENT_2  ';
    v_sql7 := v_sql7||'                                                              , ';
    v_sql7 := v_sql7||'            COAL (T3.PAYMENT, 0) AS LAST_13MON_REPAYMENT_3  ';
    v_sql7 := v_sql7||'                                                              , ';
    v_sql7 := v_sql7||'            COAL (T4.PAYMENT, 0) AS LAST_13MON_REPAYMENT_4  ';
    v_sql7 := v_sql7||'                                                              , ';
    v_sql7 := v_sql7||'            COAL (T5.PAYMENT, 0) AS LAST_13MON_REPAYMENT_5  ';
    v_sql7 := v_sql7||'                                                              , ';
    v_sql7 := v_sql7||'            COAL (T6.PAYMENT, 0) AS LAST_13MON_REPAYMENT_6  ';
    v_sql7 := v_sql7||'                                                              , ';
    v_sql7 := v_sql7||'            COAL (T7.PAYMENT, 0) AS LAST_13MON_REPAYMENT_7 ';
    v_sql7 := v_sql7||'                                                              , ';
    v_sql7 := v_sql7||'            COAL (T8.PAYMENT, 0) AS LAST_13MON_REPAYMENT_8  ';
    v_sql7 := v_sql7||'                                                              , ';
    v_sql7 := v_sql7||'            COAL (T9.PAYMENT, 0) AS LAST_13MON_REPAYMENT_9  ';
    v_sql7 := v_sql7||'                                                              , ';
    v_sql7 := v_sql7||'            COAL (T10.PAYMENT, 0) AS LAST_13MON_REPAYMENT_10 ';
    v_sql7 := v_sql7||'                                                                , ';
    v_sql7 := v_sql7||'            COAL (T11.PAYMENT, 0) AS LAST_13MON_REPAYMENT_11  ';
    v_sql7 := v_sql7||'                                                                , ';
    v_sql7 := v_sql7||'            COAL (T12.PAYMENT, 0) AS LAST_13MON_REPAYMENT_12  ';
    v_sql7 := v_sql7||'                                                                , ';
    v_sql7 := v_sql7||'            COAL (T13.PAYMENT, 0) AS LAST_13MON_REPAYMENT_13  ';
    v_sql7 := v_sql7||'                                                                , ';
    v_sql7 := v_sql7||'            COAL (T1.CASH_ADVCE, 0) AS LAST_13MON_CASH_1  ';
    v_sql7 := v_sql7||'                                                            , ';
    v_sql7 := v_sql7||'            COAL (T2.CASH_ADVCE, 0) AS LAST_13MON_CASH_2  ';
    v_sql7 := v_sql7||'                                                            , ';
    v_sql7 := v_sql7||'            COAL (T3.CASH_ADVCE, 0) AS LAST_13MON_CASH_3  ';
    v_sql7 := v_sql7||'                                                            , ';
    v_sql7 := v_sql7||'            COAL (T4.CASH_ADVCE, 0) AS LAST_13MON_CASH_4  ';
    v_sql7 := v_sql7||'                                                            , ';
    v_sql7 := v_sql7||'            COAL (T5.CASH_ADVCE, 0) AS LAST_13MON_CASH_5  ';
    v_sql7 := v_sql7||'                                                            , ';
    v_sql7 := v_sql7||'            COAL (T6.CASH_ADVCE, 0) AS LAST_13MON_CASH_6  ';
    v_sql7 := v_sql7||'                                                            , ';
    v_sql7 := v_sql7||'            COAL (T7.CASH_ADVCE, 0) AS LAST_13MON_CASH_7  ';
    v_sql7 := v_sql7||'                                                            , ';
    v_sql7 := v_sql7||'            COAL (T8.CASH_ADVCE, 0) AS LAST_13MON_CASH_8  ';
    v_sql7 := v_sql7||'                                                            , ';
    v_sql7 := v_sql7||'            COAL (T9.CASH_ADVCE, 0) AS LAST_13MON_CASH_9  ';
    v_sql7 := v_sql7||'                                                            , ';
    v_sql7 := v_sql7||'            COAL (T10.CASH_ADVCE, 0) AS LAST_13MON_CASH_10  ';
    v_sql7 := v_sql7||'                                                              , ';
    v_sql7 := v_sql7||'            COAL (T11.CASH_ADVCE, 0) AS LAST_13MON_CASH_11  ';
    v_sql7 := v_sql7||'                                                              , ';
    v_sql7 := v_sql7||'            COAL (T12.CASH_ADVCE, 0) AS LAST_13MON_CASH_12  ';
    v_sql7 := v_sql7||'                                                              , ';
    v_sql7 := v_sql7||'            COAL (T13.CASH_ADVCE, 0) AS LAST_13MON_CASH_13  ';
    v_sql7 := v_sql7||'                                                              , ';
    v_sql7 := v_sql7||'            COAL (T1.CRED_LIMIT, 0) AS LAST_13MON_CREDIT_AMT_1  ';
    v_sql7 := v_sql7||'                                                                  , ';
    v_sql7 := v_sql7||'            COAL (T2.CRED_LIMIT, 0) AS LAST_13MON_CREDIT_AMT_2  ';
    v_sql7 := v_sql7||'                                                                  , ';
    v_sql7 := v_sql7||'            COAL (T3.CRED_LIMIT, 0) AS LAST_13MON_CREDIT_AMT_3  ';
    v_sql7 := v_sql7||'                                                                  , ';
    v_sql7 := v_sql7||'            COAL (T4.CRED_LIMIT, 0) AS LAST_13MON_CREDIT_AMT_4  ';
    v_sql7 := v_sql7||'                                                                  , ';
    v_sql7 := v_sql7||'            COAL (T5.CRED_LIMIT, 0) AS LAST_13MON_CREDIT_AMT_5  ';
    v_sql7 := v_sql7||'                                                                  , ';
    v_sql7 := v_sql7||'            COAL (T6.CRED_LIMIT, 0) AS LAST_13MON_CREDIT_AMT_6  ';
    v_sql7 := v_sql7||'                                                                  , ';
    v_sql7 := v_sql7||'            COAL (T7.CRED_LIMIT, 0) AS LAST_13MON_CREDIT_AMT_7  ';
    v_sql7 := v_sql7||'                                                                  , ';
    v_sql7 := v_sql7||'            COAL (T8.CRED_LIMIT, 0) AS LAST_13MON_CREDIT_AMT_8  ';
    v_sql7 := v_sql7||'                                                                  , ';
    v_sql7 := v_sql7||'            COAL (T9.CRED_LIMIT, 0) AS LAST_13MON_CREDIT_AMT_9  ';
    v_sql7 := v_sql7||'                                                                  , ';
    v_sql7 := v_sql7||'            COAL (T10.CRED_LIMIT, 0) AS LAST_13MON_CREDIT_AMT_10  ';
    v_sql7 := v_sql7||'                                                                    , ';
    v_sql7 := v_sql7||'            COAL (T11.CRED_LIMIT, 0) AS LAST_13MON_CREDIT_AMT_11  ';
    v_sql7 := v_sql7||'                                                                    , ';
    v_sql7 := v_sql7||'            COAL (T12.CRED_LIMIT, 0) AS LAST_13MON_CREDIT_AMT_12  ';
    v_sql7 := v_sql7||'                                                                    , ';
    v_sql7 := v_sql7||'            COAL (T13.CRED_LIMIT, 0) AS LAST_13MON_CREDIT_AMT_13  ';
    v_sql7 := v_sql7||'                                                                    , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_TEMP_AMT_1                       ';
    v_sql7 := v_sql7||'                                      , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_TEMP_AMT_2                       ';
    v_sql7 := v_sql7||'                                      , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_TEMP_AMT_3                      ';
    v_sql7 := v_sql7||'                                      , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_TEMP_AMT_4                       ';
    v_sql7 := v_sql7||'                                      , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_TEMP_AMT_5                       ';
    v_sql7 := v_sql7||'                                      , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_TEMP_AMT_6                       ';
    v_sql7 := v_sql7||'                                      , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_TEMP_AMT_7                       ';
    v_sql7 := v_sql7||'                                      , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_TEMP_AMT_8                       ';
    v_sql7 := v_sql7||'                                      , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_TEMP_AMT_9                       ';
    v_sql7 := v_sql7||'                                      , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_TEMP_AMT_10                     ';
    v_sql7 := v_sql7||'                                       , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_TEMP_AMT_11                     ';
    v_sql7 := v_sql7||'                                       , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_TEMP_AMT_12                     ';
    v_sql7 := v_sql7||'                                       , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_TEMP_AMT_13                     ';
    v_sql7 := v_sql7||'                                       , ';
    v_sql7 := v_sql7||'            COAL (T1.CLOSE_BAL, 0) AS LAST_13MON_BILL_AMT_1  ';
    v_sql7 := v_sql7||'                                                               , ';
    v_sql7 := v_sql7||'            COAL (T2.CLOSE_BAL, 0) AS LAST_13MON_BILL_AMT_2  ';
    v_sql7 := v_sql7||'                                                               , ';
    v_sql7 := v_sql7||'            COAL (T3.CLOSE_BAL, 0) AS LAST_13MON_BILL_AMT_3  ';
    v_sql7 := v_sql7||'                                                               , ';
    v_sql7 := v_sql7||'            COAL (T4.CLOSE_BAL, 0) AS LAST_13MON_BILL_AMT_4  ';
    v_sql7 := v_sql7||'                                                               , ';
    v_sql7 := v_sql7||'            COAL (T5.CLOSE_BAL, 0) AS LAST_13MON_BILL_AMT_5  ';
    v_sql7 := v_sql7||'                                                               , ';
    v_sql7 := v_sql7||'            COAL (T6.CLOSE_BAL, 0) AS LAST_13MON_BILL_AMT_6  ';
    v_sql7 := v_sql7||'                                                               , ';
    v_sql7 := v_sql7||'            COAL (T7.CLOSE_BAL, 0) AS LAST_13MON_BILL_AMT_7  ';
    v_sql7 := v_sql7||'                                                               , ';
    v_sql7 := v_sql7||'            COAL (T8.CLOSE_BAL, 0) AS LAST_13MON_BILL_AMT_8  ';
    v_sql7 := v_sql7||'                                                               , ';
    v_sql7 := v_sql7||'            COAL (T9.CLOSE_BAL, 0) AS LAST_13MON_BILL_AMT_9  ';
    v_sql7 := v_sql7||'                                                               , ';
    v_sql7 := v_sql7||'            COAL (T10.CLOSE_BAL, 0) AS LAST_13MON_BILL_AMT_10  ';
    v_sql7 := v_sql7||'                                                                 , ';
    v_sql7 := v_sql7||'            COAL (T11.CLOSE_BAL, 0) AS LAST_13MON_BILL_AMT_11  ';
    v_sql7 := v_sql7||'                                                                 , ';
    v_sql7 := v_sql7||'            COAL (T12.CLOSE_BAL, 0) AS LAST_13MON_BILL_AMT_12  ';
    v_sql7 := v_sql7||'                                                                 , ';
    v_sql7 := v_sql7||'            COAL (T13.CLOSE_BAL, 0) AS LAST_13MON_BILL_AMT_13  ';
    v_sql7 := v_sql7||'                                                                 , ';
    v_sql7 := v_sql7||'            COAL (T1.MIN_DUE, 0) AS LAST_13MON_LOWEST_REPAY_1  ';
    v_sql7 := v_sql7||'                                                                 , ';
    v_sql7 := v_sql7||'            COAL (T2.MIN_DUE, 0) AS LAST_13MON_LOWEST_REPAY_2  ';
    v_sql7 := v_sql7||'                                                                 , ';
    v_sql7 := v_sql7||'            COAL (T3.MIN_DUE, 0) AS LAST_13MON_LOWEST_REPAY_3  ';
    v_sql7 := v_sql7||'                                                                 , ';
    v_sql7 := v_sql7||'            COAL (T4.MIN_DUE, 0) AS LAST_13MON_LOWEST_REPAY_4  ';
    v_sql7 := v_sql7||'                                                                 , ';
    v_sql7 := v_sql7||'            COAL (T5.MIN_DUE, 0) AS LAST_13MON_LOWEST_REPAY_5  ';
    v_sql7 := v_sql7||'                                                                 , ';
    v_sql7 := v_sql7||'            COAL (T6.MIN_DUE, 0) AS LAST_13MON_LOWEST_REPAY_6  ';
    v_sql7 := v_sql7||'                                                                 , ';
    v_sql7 := v_sql7||'            COAL (T7.MIN_DUE, 0) AS LAST_13MON_LOWEST_REPAY_7  ';
    v_sql7 := v_sql7||'                                                                 , ';
    v_sql7 := v_sql7||'            COAL (T8.MIN_DUE, 0) AS LAST_13MON_LOWEST_REPAY_8  ';
    v_sql7 := v_sql7||'                                                                 , ';
    v_sql7 := v_sql7||'            COAL (T9.MIN_DUE, 0) AS LAST_13MON_LOWEST_REPAY_9  ';
    v_sql7 := v_sql7||'                                                                 , ';
    v_sql7 := v_sql7||'            COAL (T10.MIN_DUE, 0) AS LAST_13MON_LOWEST_REPAY_10  ';
    v_sql7 := v_sql7||'                                                                   , ';
    v_sql7 := v_sql7||'            COAL (T11.MIN_DUE, 0) AS LAST_13MON_LOWEST_REPAY_11  ';
    v_sql7 := v_sql7||'                                                                   , ';
    v_sql7 := v_sql7||'            COAL (T12.MIN_DUE, 0) AS LAST_13MON_LOWEST_REPAY_12 ';
    v_sql7 := v_sql7||'                                                                   , ';
    v_sql7 := v_sql7||'            COAL (T13.MIN_DUE, 0) AS LAST_13MON_LOWEST_REPAY_13  ';
    v_sql7 := v_sql7||'                                                                   , ';
    v_sql7 := v_sql7||'            T0.STM_OLFLAG AS LAST_13MON_ACC_OVERRUN_FLAG_1  ';
    v_sql7 := v_sql7||'                                                          , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_ACC_OVERRUN_FLAG_2             ';
    v_sql7 := v_sql7||'                                              , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_ACC_OVERRUN_FLAG_3             ';
    v_sql7 := v_sql7||'                                              , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_ACC_OVERRUN_FLAG_4             ';
    v_sql7 := v_sql7||'                                              , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_ACC_OVERRUN_FLAG_5             ';
    v_sql7 := v_sql7||'                                              , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_ACC_OVERRUN_FLAG_6             ';
    v_sql7 := v_sql7||'                                              , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_ACC_OVERRUN_FLAG_7             ';
    v_sql7 := v_sql7||'                                              , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_ACC_OVERRUN_FLAG_8             ';
    v_sql7 := v_sql7||'                                              , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_ACC_OVERRUN_FLAG_9             ';
    v_sql7 := v_sql7||'                                              , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_ACC_OVERRUN_FLAG_10           ';
    v_sql7 := v_sql7||'                                               , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_ACC_OVERRUN_FLAG_11           ';
    v_sql7 := v_sql7||'                                               , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_ACC_OVERRUN_FLAG_12           ';
    v_sql7 := v_sql7||'                                               , ';
    v_sql7 := v_sql7||'            0 AS LAST_13MON_ACC_OVERRUN_FLAG_13           ';
    v_sql7 := v_sql7||'                                               , ';
    v_sql7 := v_sql7||'            COAL (V24.FLAG_CON_ODUE, 0) AS ARREARINCREASE_L24M  ';
    v_sql7 := v_sql7||'                                                                  , ';
    v_sql7 := v_sql7||'            COAL (T1.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_1  ';
    v_sql7 := v_sql7||'                                                               , ';
    v_sql7 := v_sql7||'            COAL (T2.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_2  ';
    v_sql7 := v_sql7||'                                                               , ';
    v_sql7 := v_sql7||'            COAL (T3.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_3  ';
    v_sql7 := v_sql7||'                                                               , ';
    v_sql7 := v_sql7||'            COAL (T4.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_4  ';
    v_sql7 := v_sql7||'                                                               , ';
    v_sql7 := v_sql7||'            COAL (T5.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_5  ';
    v_sql7 := v_sql7||'                                                               , ';
    v_sql7 := v_sql7||'            COAL (T6.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_6  ';
    v_sql7 := v_sql7||'                                                               , ';
    v_sql7 := v_sql7||'            COAL (T7.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_7  ';
    v_sql7 := v_sql7||'                                                               , ';
    v_sql7 := v_sql7||'            COAL (T8.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_8  ';
    v_sql7 := v_sql7||'                                                               , ';
    v_sql7 := v_sql7||'            COAL (T9.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_9  ';
    v_sql7 := v_sql7||'                                                               , ';
    v_sql7 := v_sql7||'            COAL (T10.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_10  ';
    v_sql7 := v_sql7||'                                                                 , ';
    v_sql7 := v_sql7||'            COAL (T11.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_11  ';
    v_sql7 := v_sql7||'                                                                 , ';
    v_sql7 := v_sql7||'            COAL (T12.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_12  ';
    v_sql7 := v_sql7||'                                                                 , ';
    v_sql7 := v_sql7||'            COAL (T13.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_13  ';
    v_sql7 := v_sql7||'                                                                 , ';
    v_sql7 := v_sql7||'            COAL (T14.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_14  ';
    v_sql7 := v_sql7||'                                                                 , ';
    v_sql7 := v_sql7||'            COAL (T15.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_15  ';
    v_sql7 := v_sql7||'                                                                 , ';
    v_sql7 := v_sql7||'            COAL (T16.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_16  ';
    v_sql7 := v_sql7||'                                                                 , ';
    v_sql7 := v_sql7||'            COAL (T17.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_17  ';
    v_sql7 := v_sql7||'                                                                 , ';
    v_sql7 := v_sql7||'            COAL (T18.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_18  ';
    v_sql7 := v_sql7||'                                                                 , ';
    v_sql7 := v_sql7||'            COAL (T19.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_19  ';
    v_sql7 := v_sql7||'                                                                 , ';
    v_sql7 := v_sql7||'            COAL (T20.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_20  ';
    v_sql7 := v_sql7||'                                                                 , ';
    v_sql7 := v_sql7||'            COAL (T21.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_21  ';
    v_sql7 := v_sql7||'                                                                 , ';
    v_sql7 := v_sql7||'            COAL (T22.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_22  ';
    v_sql7 := v_sql7||'                                                                 , ';
    v_sql7 := v_sql7||'            COAL (T23.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_23  ';
    v_sql7 := v_sql7||'                                                                 , ';
    v_sql7 := v_sql7||'            COAL (T24.ODUE_FLAG, 0) AS LAST_24MON_OVD_FLAG_24  ';
    v_sql7 := v_sql7||'                                                                 , ';
    v_sql7 := v_sql7||'            CASE ';
    v_sql7 := v_sql7||'               WHEN (T0.LAST_TRDAY +0) <= '||v_ETL_DATE_HALFYEAR ||' THEN ''0'' ';
    v_sql7 := v_sql7||'               ELSE ''1'' ';
    v_sql7 := v_sql7||'            END ';
    v_sql7 := v_sql7||'               AS LAST_6MON_INACTIVE_FLAG                         ';
    v_sql7 := v_sql7||'                                         , ';
    v_sql7 := v_sql7||'            COAL (V24.FLAG_CON_ODUE, 0)  ';
    v_sql7 := v_sql7||'                                           , ';
    v_sql7 := v_sql7||'            CASE ';
    v_sql7 := v_sql7||'               WHEN     (T0.TLMT_BEG +0) <= '||v_ETL_DATE_NUM||' ';
    v_sql7 := v_sql7||'                    AND '||v_ETL_DATE_NUM||' < (T0.TLMT_END +0) ';
    v_sql7 := v_sql7||'               THEN ';
    v_sql7 := v_sql7||'                  T0.TEMP_LIMIT ';
    v_sql7 := v_sql7||'               ELSE ';
    v_sql7 := v_sql7||'                  0 ';
    v_sql7 := v_sql7||'            END ';
    v_sql7 := v_sql7||'               AS TEMP_LIMIT                                            ';
    v_sql7 := v_sql7||'                            , ';
    v_sql7 := v_sql7||'            CASE ';
    v_sql7 := v_sql7||'               WHEN     (T0.TLMT_BEG +0) <= '||v_ETL_DATE_NUM||' ';
    v_sql7 := v_sql7||'                    AND '||v_ETL_DATE_NUM||' < (T0.TLMT_END +0) ';
    v_sql7 := v_sql7||'               THEN ';
    v_sql7 := v_sql7||'                  T0.TEMP_LIMIT * T0.CA_PCNT * 0.01 ';
    v_sql7 := v_sql7||'               ELSE ';
    v_sql7 := v_sql7||'                  T0.CRED_LIMIT * T0.CA_PCNT * 0.01 ';
    v_sql7 := v_sql7||'            END ';
    v_sql7 := v_sql7||'               AS ACCTCASHADVANCE                                      ';
    v_sql7 := v_sql7||'                                 , ';
    v_sql7 := v_sql7||'            T0.NBR_CASHAD AS LAST_CYCLEDAY_CASH_TIMES            ';
    v_sql7 := v_sql7||'                                                     , ';
    v_sql7 := v_sql7||'            CASE ';
    v_sql7 := v_sql7||'               WHEN COAL (T0.BANKACCT1, ''0'') = ''0'' THEN ''0'' ';
    v_sql7 := v_sql7||'               ELSE ''1'' ';
    v_sql7 := v_sql7||'            END ';
    v_sql7 := v_sql7||'               AS APP_AUTODEBIT                                  ';
    v_sql7 := v_sql7||'                               , ';
    v_sql7 := v_sql7||'            COAL (T1.ANNUAL_FEE_OVD_FLAG, ''0'') AS ANNUAL_FEE_OVD_FLAG  ';
    v_sql7 := v_sql7||'                                                                         , ';
    v_sql7 := v_sql7||'            CASE ';
    v_sql7 := v_sql7||'               WHEN COAL(T0.CLOSE_CODE,'' '') = '' '' THEN ''0'' ';
    v_sql7 := v_sql7||'               ELSE ''1'' ';
    v_sql7 := v_sql7||'            END ';
    v_sql7 := v_sql7||'               AS PRO_ACCTSTATUS_CC_EXISTING                        ';
    v_sql7 := v_sql7||'                                            , ';
    v_sql7 := v_sql7||'            CASE ';
    v_sql7 := v_sql7||'               WHEN T0.BAL > 300 AND COAL(T0.CLOSE_CODE,'' '') != '' '' ';
    v_sql7 := v_sql7||'               THEN ';
    v_sql7 := v_sql7||'                  ''1'' ';
    v_sql7 := v_sql7||'               ELSE ';
    v_sql7 := v_sql7||'                  ''0'' ';
    v_sql7 := v_sql7||'            END ';
    v_sql7 := v_sql7||'               AS ACCTSTATUS                               ';
    v_sql7 := v_sql7||'                            , ';
    v_sql7 := v_sql7||'            T0.BRANCH AS APP_BRANCH                                      ';
    v_sql7 := v_sql7||'                                   , ';
    v_sql7 := v_sql7||'            T0.CRED_LIMIT AS LIMITCC                                 ';
    v_sql7 := v_sql7||'                                    , ';
    v_sql7 := v_sql7||'            CASE ';
    v_sql7 := v_sql7||'               WHEN COAL(T0.CLOSE_CODE,'' '') = '' '' THEN ''0'' ';
    v_sql7 := v_sql7||'               ELSE ''1'' ';
    v_sql7 := v_sql7||'            END ';
    v_sql7 := v_sql7||'               AS PRO_STATUS_ACCT                                    ';
    v_sql7 := v_sql7||'                                 , ';
    v_sql7 := v_sql7||'            0 AS UTILIZATION                                       ';
    v_sql7 := v_sql7||'                            , ';
    v_sql7 := v_sql7||'            T0.BAL AS BALANCE                                             ';
    v_sql7 := v_sql7||'                             , ';
    v_sql7 := v_sql7||'            T0.AGE AS COLLECTMETHODS ';
    v_sql7 := v_sql7||'            , ';
    v_sql7 := v_sql7||'            T0.MTHS_ODUE AS COLLECTTIMES                                ';
    v_sql7 := v_sql7||'                                        , ';
    v_sql7 := v_sql7||'            0 AS PRO_CCSTATE                                            ';
    v_sql7 := v_sql7||'                            , ';
    v_sql7 := v_sql7||'            0 AS APP_CC_LIMIT_EXISTING                                ';
    v_sql7 := v_sql7||'                                      , ';
    v_sql7 := v_sql7||'            T0.CRED_LIMIT AS LONG_CRED_LIMIT                            ';
    v_sql7 := v_sql7||'                                            , ';
    v_sql7 := v_sql7||'            T0.CRED_LIMIT AS ACCTACCTLIMIT                            ';
    v_sql7 := v_sql7||'                                          , ';
    v_sql7 := v_sql7||'            ''0'' AS BILL_TAG                                             ';
    v_sql7 := v_sql7||'                           , ';
    v_sql7 := v_sql7||'            T0.CYCLE_NBR AS CYCLE_DAY_ONLY                               ';
    v_sql7 := v_sql7||'                                          , ';
    v_sql7 := v_sql7||'            T0.PROD_NBR AS ACCOUNT_LOGO                              ';
    v_sql7 := v_sql7||'                                       , ';
    v_sql7 := v_sql7||'            T0.CLOSE_CODE AS ACC_BLOCK_CODES1   ';
    v_sql7 := v_sql7||'                                             , ';
    v_sql7 := v_sql7||'            T0.WROFF_CODE AS ACC_BLOCK_CODES2   ';
    v_sql7 := v_sql7||'                                             , ';
    v_sql7 := v_sql7||'            CEIL ( ';
    v_sql7 := v_sql7||'               MONTHS_BETWEEN (toDate ('||v_ETL_DATE_NUM||', ''yyyy-mm-dd''), ';
    v_sql7 := v_sql7||'                               toDate (T0.DAY_OPENED, ''yyyy-mm-dd''))) ';
    v_sql7 := v_sql7||'               AS ACCTNUMB                                               ';
    v_sql7 := v_sql7||'                          , ';
    v_sql7 := v_sql7||'            CASE ';
    v_sql7 := v_sql7||'               WHEN     (CASE ';
    v_sql7 := v_sql7||'                            WHEN     (T0.TLMT_BEG + 0) <= '||v_ETL_DATE_NUM||' ';
    v_sql7 := v_sql7||'                                 AND '||v_ETL_DATE_NUM||' < (T0.TLMT_END + 0) ';
    v_sql7 := v_sql7||'                            THEN ';
    v_sql7 := v_sql7||'                               T0.TEMP_LIMIT ';
    v_sql7 := v_sql7||'                            ELSE ';
    v_sql7 := v_sql7||'                               T0.CRED_LIMIT ';
    v_sql7 := v_sql7||'                         END) > 0 ';
    v_sql7 := v_sql7||'                    AND (T0.BAL) > ';
    v_sql7 := v_sql7||'                             (CASE ';
    v_sql7 := v_sql7||'                                 WHEN     (T0.TLMT_BEG + 0) <= '||v_ETL_DATE_NUM||' ';
    v_sql7 := v_sql7||'                                      AND '||v_ETL_DATE_NUM||' < (T0.TLMT_END + 0) ';
    v_sql7 := v_sql7||'                                 THEN ';
    v_sql7 := v_sql7||'                                    T0.TEMP_LIMIT ';
    v_sql7 := v_sql7||'                                 ELSE ';
    v_sql7 := v_sql7||'                                    T0.CRED_LIMIT ';
    v_sql7 := v_sql7||'                              END) ';
    v_sql7 := v_sql7||'                           / 2 ';
    v_sql7 := v_sql7||'               THEN ';
    v_sql7 := v_sql7||'                  1 ';
    v_sql7 := v_sql7||'               ELSE ';
    v_sql7 := v_sql7||'                  0 ';
    v_sql7 := v_sql7||'            END ';
    v_sql7 := v_sql7||'               AS PBOC_ACCTNUMB_UTILIZATION50UP     ';
    v_sql7 := v_sql7||'                                               , ';
    v_sql7 := v_sql7||'            CEIL ( ';
    v_sql7 := v_sql7||'               MONTHS_BETWEEN (toDate ('||v_ETL_DATE_NUM||', ''yyyy-mm-dd''), ';
    v_sql7 := v_sql7||'                               toDate (T0.DAY_OPENED, ''yyyy-mm-dd''))) ';
    v_sql7 := v_sql7||'               AS PBOC_ACCTAGE_HIGHEST                           ';
    v_sql7 := v_sql7||'                                      , ';
    v_sql7 := v_sql7||'            CASE WHEN COAL (T1.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql7 := v_sql7||'               AS LAST_24MON_OVD_TERM_1                  ';
    v_sql7 := v_sql7||'                                       , ';
    v_sql7 := v_sql7||'            CASE WHEN COAL (T2.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql7 := v_sql7||'               AS LAST_24MON_OVD_TERM_2                  ';
    v_sql7 := v_sql7||'                                       , ';
    v_sql7 := v_sql7||'            CASE WHEN COAL (T3.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql7 := v_sql7||'               AS LAST_24MON_OVD_TERM_3                  ';
    v_sql7 := v_sql7||'                                       , ';
    v_sql7 := v_sql7||'            CASE WHEN COAL (T4.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql7 := v_sql7||'               AS LAST_24MON_OVD_TERM_4                  ';
    v_sql7 := v_sql7||'                                       , ';
    v_sql7 := v_sql7||'            CASE WHEN COAL (T5.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql7 := v_sql7||'               AS LAST_24MON_OVD_TERM_5                  ';
    v_sql7 := v_sql7||'                                       , ';
    v_sql7 := v_sql7||'            CASE WHEN COAL (T6.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql7 := v_sql7||'               AS LAST_24MON_OVD_TERM_6                  ';
    v_sql7 := v_sql7||'                                       , ';
    v_sql7 := v_sql7||'            CASE WHEN COAL (T7.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql7 := v_sql7||'               AS LAST_24MON_OVD_TERM_7                  ';
    v_sql7 := v_sql7||'                                       , ';
    v_sql7 := v_sql7||'            CASE WHEN COAL (T8.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql7 := v_sql7||'               AS LAST_24MON_OVD_TERM_8                  ';
    v_sql7 := v_sql7||'                                       , ';
    v_sql7 := v_sql7||'            CASE WHEN COAL (T9.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql7 := v_sql7||'               AS LAST_24MON_OVD_TERM_9                  ';
    v_sql7 := v_sql7||'                                       , ';
    v_sql7 := v_sql7||'            CASE WHEN COAL (T10.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql7 := v_sql7||'               AS LAST_24MON_OVD_TERM_10                ';
    v_sql7 := v_sql7||'                                        , ';
    v_sql7 := v_sql7||'            CASE WHEN COAL (T11.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql7 := v_sql7||'               AS LAST_24MON_OVD_TERM_11                ';
    v_sql7 := v_sql7||'                                        , ';
    v_sql7 := v_sql7||'            CASE WHEN COAL (T12.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql7 := v_sql7||'               AS LAST_24MON_OVD_TERM_12                ';
    v_sql7 := v_sql7||'                                        , ';
    v_sql7 := v_sql7||'            CASE WHEN COAL (T13.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql7 := v_sql7||'               AS LAST_24MON_OVD_TERM_13                ';
    v_sql7 := v_sql7||'                                        , ';
    v_sql7 := v_sql7||'            CASE WHEN COAL (T14.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql7 := v_sql7||'               AS LAST_24MON_OVD_TERM_14                ';
    v_sql7 := v_sql7||'                                        , ';
    v_sql7 := v_sql7||'            CASE WHEN COAL (T15.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql7 := v_sql7||'               AS LAST_24MON_OVD_TERM_15                ';
    v_sql7 := v_sql7||'                                        , ';
    v_sql7 := v_sql7||'            CASE WHEN COAL (T16.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql7 := v_sql7||'               AS LAST_24MON_OVD_TERM_16                ';
    v_sql7 := v_sql7||'                                        , ';
    v_sql7 := v_sql7||'            CASE WHEN COAL (T17.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql7 := v_sql7||'               AS LAST_24MON_OVD_TERM_17                ';
    v_sql7 := v_sql7||'                                        , ';
    v_sql7 := v_sql7||'            CASE WHEN COAL (T18.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql7 := v_sql7||'               AS LAST_24MON_OVD_TERM_18               ';
    v_sql7 := v_sql7||'                                        , ';
    v_sql7 := v_sql7||'            CASE WHEN COAL (T19.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql7 := v_sql7||'               AS LAST_24MON_OVD_TERM_19                ';
    v_sql7 := v_sql7||'                                        , ';
    v_sql7 := v_sql7||'            CASE WHEN COAL (T20.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql7 := v_sql7||'               AS LAST_24MON_OVD_TERM_20                ';
    v_sql7 := v_sql7||'                                        , ';
    v_sql7 := v_sql7||'            CASE WHEN COAL (T21.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql7 := v_sql7||'               AS LAST_24MON_OVD_TERM_21                ';
    v_sql7 := v_sql7||'                                        , ';
    v_sql7 := v_sql7||'            CASE WHEN COAL (T22.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql7 := v_sql7||'               AS LAST_24MON_OVD_TERM_22                ';
    v_sql7 := v_sql7||'                                        , ';
    v_sql7 := v_sql7||'            CASE WHEN COAL (T23.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql7 := v_sql7||'               AS LAST_24MON_OVD_TERM_23                ';
    v_sql7 := v_sql7||'                                        , ';
    v_sql7 := v_sql7||'            CASE WHEN COAL (T24.AGE, 0) > 0 THEN 1 ELSE 0 END ';
    v_sql7 := v_sql7||'               AS LAST_24MON_OVD_TERM_24                ';
    v_sql7 := v_sql7||'                                        , ';
    v_sql7 := v_sql7||'            CASE ';
    v_sql7 := v_sql7||'               WHEN COAL (V6.LIMIT, 0) = 0 OR COAL (V6.BAL, 0) <= 0 ';
    v_sql7 := v_sql7||'               THEN ';
    v_sql7 := v_sql7||'                  0 ';
    v_sql7 := v_sql7||'               WHEN (COAL (V6.LIMIT, 0) + 0) <= COAL (V6.BAL, 0) ';
    v_sql7 := v_sql7||'               THEN ';
    v_sql7 := v_sql7||'                  100 ';
    v_sql7 := v_sql7||'               ELSE ';
    v_sql7 := v_sql7||'                  ROUND ( ';
    v_sql7 := v_sql7||'                     COAL (V6.BAL, 0) / COAL (V6.LIMIT, 0) * 100, ';
    v_sql7 := v_sql7||'                     2) ';
    v_sql7 := v_sql7||'            END ';
    v_sql7 := v_sql7||'               AS UTILITY_AVE_L6M                               ';
    v_sql7 := v_sql7||'                                 , ';
    v_sql7 := v_sql7||'            T0.ADD_CHGDAY AS LAST_BILL_ADDRESS_CHANGE            ';
    v_sql7 := v_sql7||'                                                     , ';
    v_sql7 := v_sql7||'            T0.PROD_NBR AS RESULTREASONCODE                              ';
    v_sql7 := v_sql7||'                                           , ';
    v_sql7 := v_sql7||'            T0.PRODUCT AS PRODUCT                                     ';
    v_sql7 := v_sql7||'                                 , ';
    v_sql7 := v_sql7||'            T0.XACCOUNT                                                   ';
    v_sql7 := v_sql7||'            , ';
    v_sql7 := v_sql7||'            COAL ( T1.Close_Bal,0) +  COAL ( T1.Payment ,0 ) - COAL( T1.Open_Bal,0) as new_bal_1,  ';
    v_sql7 := v_sql7||'            COAL ( T2.Close_Bal,0) +  COAL ( T2.Payment ,0 ) - COAL( T2.Open_Bal,0) as new_bal_2, ';
    v_sql7 := v_sql7||'            COAL ( T3.Close_Bal,0) +  COAL ( T3.Payment ,0 ) - COAL( T3.Open_Bal,0) as new_bal_3, ';
    v_sql7 := v_sql7||'            COAL ( T4.Close_Bal,0) +  COAL ( T4.Payment ,0 ) - COAL( T4.Open_Bal,0) as new_bal_4, ';
    v_sql7 := v_sql7||'            COAL ( T5.Close_Bal,0) +  COAL ( T5.Payment ,0 ) - COAL( T5.Open_Bal,0) as new_bal_5, ';
    v_sql7 := v_sql7||'            COAL ( T6.Close_Bal,0) +  COAL ( T6.Payment ,0 ) - COAL( T6.Open_Bal,0) as new_bal_6, ';
    v_sql7 := v_sql7||'            COAL ( T7.Close_Bal,0) +  COAL ( T7.Payment ,0 ) - COAL( T7.Open_Bal,0) as new_bal_7, ';
    v_sql7 := v_sql7||'            COAL ( T8.Close_Bal,0) +  COAL ( T8.Payment ,0 ) - COAL( T8.Open_Bal,0) as new_bal_8, ';
    v_sql7 := v_sql7||'            COAL ( T9.Close_Bal,0) +  COAL ( T9.Payment ,0 ) - COAL( T9.Open_Bal,0) as new_bal_9, ';
    v_sql7 := v_sql7||'            COAL (T10.Close_Bal,0) +  COAL (T10.Payment ,0 ) - COAL(T10.Open_Bal,0) as new_bal_10, ';
    v_sql7 := v_sql7||'            COAL (T11.Close_Bal,0) +  COAL (T11.Payment ,0 ) - COAL(T11.Open_Bal,0) as new_bal_11, ';
    v_sql7 := v_sql7||'            COAL (T12.Close_Bal,0) +  COAL (T12.Payment ,0 ) - COAL(T12.Open_Bal,0) as new_bal_12, ';
    v_sql7 := v_sql7||'                CASE ';
    v_sql7 := v_sql7||'               WHEN   (COAL( T1.Open_Bal,0) + 0)  >   COAL ( T1.Payment ,0 ) ';
    v_sql7 := v_sql7||'                 then ';
    v_sql7 := v_sql7||'                     COAL( T1.Open_Bal,0) - COAL ( T1.Payment ,0 ) ';
    v_sql7 := v_sql7||'                 else ';
    v_sql7 := v_sql7||'                   0 ';
    v_sql7 := v_sql7||'                 end as open_bal_wo_pay_1, ';
    v_sql7 := v_sql7||'                CASE ';
    v_sql7 := v_sql7||'               WHEN   (COAL( T2.Open_Bal,0) + 0)  >   COAL ( T2.Payment ,0 ) ';
    v_sql7 := v_sql7||'                 then ';
    v_sql7 := v_sql7||'                     COAL( T2.Open_Bal,0) - COAL ( T2.Payment ,0 ) ';
    v_sql7 := v_sql7||'                 else ';
    v_sql7 := v_sql7||'                   0 ';
    v_sql7 := v_sql7||'                 end as open_bal_wo_pay_2, ';
    v_sql7 := v_sql7||'               CASE ';
    v_sql7 := v_sql7||'               WHEN   (COAL( T3.Open_Bal,0) + 0)  >   COAL ( T3.Payment ,0 ) ';
    v_sql7 := v_sql7||'                 then ';
    v_sql7 := v_sql7||'                     COAL( T3.Open_Bal,0) - COAL ( T3.Payment ,0 ) ';
    v_sql7 := v_sql7||'                 else ';
    v_sql7 := v_sql7||'                   0 ';
    v_sql7 := v_sql7||'                 end as open_bal_wo_pay_3, ';
    v_sql7 := v_sql7||'               CASE ';
    v_sql7 := v_sql7||'               WHEN   (COAL( T4.Open_Bal,0) + 0)  >   COAL ( T4.Payment ,0 ) ';
    v_sql7 := v_sql7||'                 then ';
    v_sql7 := v_sql7||'                     COAL( T4.Open_Bal,0) - COAL ( T4.Payment ,0 ) ';
    v_sql7 := v_sql7||'                 else ';
    v_sql7 := v_sql7||'                   0 ';
    v_sql7 := v_sql7||'                 end as open_bal_wo_pay_4, ';
    v_sql7 := v_sql7||'               CASE ';
    v_sql7 := v_sql7||'               WHEN   (COAL( T5.Open_Bal,0) + 0)  >   COAL ( T5.Payment ,0 ) ';
    v_sql7 := v_sql7||'                 then ';
    v_sql7 := v_sql7||'                     COAL( T5.Open_Bal,0) - COAL ( T5.Payment ,0 ) ';
    v_sql7 := v_sql7||'                 else ';
    v_sql7 := v_sql7||'                   0 ';
    v_sql7 := v_sql7||'                 end as open_bal_wo_pay_5, ';
    v_sql7 := v_sql7||'               CASE ';
    v_sql7 := v_sql7||'               WHEN   (COAL( T6.Open_Bal,0) + 0)  >   COAL ( T6.Payment ,0 ) ';
    v_sql7 := v_sql7||'                 then ';
    v_sql7 := v_sql7||'                     COAL( T6.Open_Bal,0) - COAL ( T6.Payment ,0 ) ';
    v_sql7 := v_sql7||'                 else ';
    v_sql7 := v_sql7||'                   0 ';
    v_sql7 := v_sql7||'                 end as open_bal_wo_pay_6, ';
    v_sql7 := v_sql7||'               CASE ';
    v_sql7 := v_sql7||'               WHEN   (COAL( T7.Open_Bal,0) + 0)  >   COAL ( T7.Payment ,0 ) ';
    v_sql7 := v_sql7||'                 then ';
    v_sql7 := v_sql7||'                     COAL( T7.Open_Bal,0) - COAL ( T7.Payment ,0 ) ';
    v_sql7 := v_sql7||'                 else ';
    v_sql7 := v_sql7||'                   0 ';
    v_sql7 := v_sql7||'                 end as open_bal_wo_pay_7, ';
    v_sql7 := v_sql7||'               CASE ';
    v_sql7 := v_sql7||'               WHEN   (COAL( T8.Open_Bal,0) + 0)  >   COAL ( T8.Payment ,0 ) ';
    v_sql7 := v_sql7||'                 then ';
    v_sql7 := v_sql7||'                     COAL( T8.Open_Bal,0) - COAL ( T8.Payment ,0 ) ';
    v_sql7 := v_sql7||'                 else ';
    v_sql7 := v_sql7||'                   0 ';
    v_sql7 := v_sql7||'                 end as open_bal_wo_pay_8, ';
    v_sql7 := v_sql7||'               CASE ';
    v_sql7 := v_sql7||'               WHEN   (COAL( T9.Open_Bal,0) + 0)  >   COAL ( T9.Payment ,0 ) ';
    v_sql7 := v_sql7||'                 then ';
    v_sql7 := v_sql7||'                     COAL( T9.Open_Bal,0) - COAL ( T9.Payment ,0 ) ';
    v_sql7 := v_sql7||'                 else ';
    v_sql7 := v_sql7||'                   0 ';
    v_sql7 := v_sql7||'                 end as open_bal_wo_pay_9, ';
    v_sql7 := v_sql7||'               CASE ';
    v_sql7 := v_sql7||'               WHEN   (COAL( T10.Open_Bal,0) + 0)  >   COAL ( T10.Payment ,0 ) ';
    v_sql7 := v_sql7||'                 then ';
    v_sql7 := v_sql7||'                     COAL( T10.Open_Bal,0) - COAL ( T10.Payment ,0 ) ';
    v_sql7 := v_sql7||'                 else ';
    v_sql7 := v_sql7||'                   0 ';
    v_sql7 := v_sql7||'                 end as open_bal_wo_pay_10, ';
    v_sql7 := v_sql7||'               CASE ';
    v_sql7 := v_sql7||'               WHEN   (COAL( T11.Open_Bal,0) + 0)  >   COAL ( T11.Payment ,0 ) ';
    v_sql7 := v_sql7||'                 then ';
    v_sql7 := v_sql7||'                     COAL( T11.Open_Bal,0) - COAL ( T11.Payment ,0 ) ';
    v_sql7 := v_sql7||'                 else ';
    v_sql7 := v_sql7||'                   0 ';
    v_sql7 := v_sql7||'                 end as open_bal_wo_pay_11, ';
    v_sql7 := v_sql7||'               CASE ';
    v_sql7 := v_sql7||'               WHEN   (COAL( T12.Open_Bal,0) + 0)  >   COAL ( T12.Payment ,0 ) ';
    v_sql7 := v_sql7||'                 then ';
    v_sql7 := v_sql7||'                     COAL( T12.Open_Bal,0) - COAL ( T12.Payment ,0 ) ';
    v_sql7 := v_sql7||'                 else ';
    v_sql7 := v_sql7||'                   0 ';
    v_sql7 := v_sql7||'                 end as open_bal_wo_pay_12 ';
    v_sql7 := v_sql7||'       FROM MDM_ACCT_X_SP T0 ';
    v_sql7 := v_sql7||'            LEFT JOIN MDM_STMT_X T1 ';
    v_sql7 := v_sql7||'               ON     T0.XACCOUNT = T1.XACCOUNT ';
    v_sql7 := v_sql7||'                  AND todate(T1.STMT_DATE,''yyyy-mm-dd'') <= SYSDATE()                         ';
    v_sql7 := v_sql7||'                  AND todate(T1.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -1) ';
    v_sql7 := v_sql7||'            LEFT JOIN MDM_STMT_X T2 ';
    v_sql7 := v_sql7||'               ON     T0.XACCOUNT = T2.XACCOUNT ';
    v_sql7 := v_sql7||'                  AND todate(T2.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -1)     ';
    v_sql7 := v_sql7||'                  AND todate(T2.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -2)       ';
    v_sql7 := v_sql7||'            LEFT JOIN MDM_STMT_X T3 ';
    v_sql7 := v_sql7||'               ON     T0.XACCOUNT = T3.XACCOUNT ';
    v_sql7 := v_sql7||'                  AND todate(T3.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -2)      ';
    v_sql7 := v_sql7||'                  AND todate(T3.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -3)       ';
    v_sql7 := v_sql7||'            LEFT JOIN MDM_STMT_X T4 ';
    v_sql7 := v_sql7||'               ON     T0.XACCOUNT = T4.XACCOUNT ';
    v_sql7 := v_sql7||'                  AND todate(T4.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -3)      ';
    v_sql7 := v_sql7||'                  AND todate(T4.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -4)       ';
    v_sql7 := v_sql7||'            LEFT JOIN MDM_STMT_X T5 ';
    v_sql7 := v_sql7||'               ON     T0.XACCOUNT = T5.XACCOUNT ';
    v_sql7 := v_sql7||'                  AND todate(T5.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -4)      ';
    v_sql7 := v_sql7||'                  AND todate(T5.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -5)       ';
    v_sql7 := v_sql7||'            LEFT JOIN MDM_STMT_X T6 ';
    v_sql7 := v_sql7||'               ON     T0.XACCOUNT = T6.XACCOUNT ';
    v_sql7 := v_sql7||'                  AND todate(T6.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -5)      ';
    v_sql7 := v_sql7||'                  AND todate(T6.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -6)       ';
    v_sql7 := v_sql7||'            LEFT JOIN MDM_STMT_X T7 ';
    v_sql7 := v_sql7||'               ON     T0.XACCOUNT = T7.XACCOUNT ';
    v_sql7 := v_sql7||'                  AND todate(T7.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -6)      ';
    v_sql7 := v_sql7||'                  AND todate(T7.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -7)       ';
    v_sql7 := v_sql7||'            LEFT JOIN MDM_STMT_X T8 ';
    v_sql7 := v_sql7||'               ON     T0.XACCOUNT = T8.XACCOUNT ';
    v_sql7 := v_sql7||'                  AND todate(T8.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -7)      ';
    v_sql7 := v_sql7||'                  AND todate(T8.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -8)       ';
    v_sql7 := v_sql7||'            LEFT JOIN MDM_STMT_X T9 ';
    v_sql7 := v_sql7||'               ON     T0.XACCOUNT = T9.XACCOUNT ';
    v_sql7 := v_sql7||'                  AND todate(T9.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -8)      ';
    v_sql7 := v_sql7||'                  AND todate(T9.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -9)       ';
    v_sql7 := v_sql7||'            LEFT JOIN MDM_STMT_X T10 ';
    v_sql7 := v_sql7||'               ON     T0.XACCOUNT = T10.XACCOUNT ';
    v_sql7 := v_sql7||'                  AND todate(T10.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -9)     ';
    v_sql7 := v_sql7||'                  AND todate(T10.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -10)     ';
    v_sql7 := v_sql7||'            LEFT JOIN MDM_STMT_X T11 ';
    v_sql7 := v_sql7||'               ON     T0.XACCOUNT = T11.XACCOUNT ';
    v_sql7 := v_sql7||'                  AND todate(T11.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -10)    ';
    v_sql7 := v_sql7||'                  AND todate(T11.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -11)     ';
    v_sql7 := v_sql7||'            LEFT JOIN MDM_STMT_X T12 ';
    v_sql7 := v_sql7||'               ON     T0.XACCOUNT = T12.XACCOUNT ';
    v_sql7 := v_sql7||'                  AND todate(T12.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -11)    ';
    v_sql7 := v_sql7||'                  AND todate(T12.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -12)     ';
    v_sql7 := v_sql7||'            LEFT JOIN MDM_STMT_X T13 ';
    v_sql7 := v_sql7||'               ON     T0.XACCOUNT = T13.XACCOUNT ';
    v_sql7 := v_sql7||'                  AND todate(T13.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -12)    ';
    v_sql7 := v_sql7||'                  AND todate(T13.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -13)     ';
    v_sql7 := v_sql7||'            LEFT JOIN MDM_STMT_X T14 ';
    v_sql7 := v_sql7||'               ON     T0.XACCOUNT = T14.XACCOUNT ';
    v_sql7 := v_sql7||'                  AND todate(T14.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -13)    ';
    v_sql7 := v_sql7||'                  AND todate(T14.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -14)     ';
    v_sql7 := v_sql7||'            LEFT JOIN MDM_STMT_X T15 ';
    v_sql7 := v_sql7||'               ON     T0.XACCOUNT = T15.XACCOUNT ';
    v_sql7 := v_sql7||'                  AND todate(T15.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -14)    ';
    v_sql7 := v_sql7||'                  AND todate(T15.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -15)     ';
    v_sql7 := v_sql7||'            LEFT JOIN MDM_STMT_X T16 ';
    v_sql7 := v_sql7||'               ON     T0.XACCOUNT = T16.XACCOUNT ';
    v_sql7 := v_sql7||'                  AND todate(T16.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -15)    ';
    v_sql7 := v_sql7||'                  AND todate(T16.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -16)     ';
    v_sql7 := v_sql7||'            LEFT JOIN MDM_STMT_X T17 ';
    v_sql7 := v_sql7||'               ON     T0.XACCOUNT = T17.XACCOUNT ';
    v_sql7 := v_sql7||'                  AND todate(T17.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -16)    ';
    v_sql7 := v_sql7||'                  AND todate(T17.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -17)     ';
    v_sql7 := v_sql7||'            LEFT JOIN MDM_STMT_X T18 ';
    v_sql7 := v_sql7||'               ON     T0.XACCOUNT = T18.XACCOUNT ';
    v_sql7 := v_sql7||'                  AND todate(T18.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -17)    ';
    v_sql7 := v_sql7||'                  AND todate(T18.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -18)     ';
    v_sql7 := v_sql7||'            LEFT JOIN MDM_STMT_X T19 ';
    v_sql7 := v_sql7||'               ON     T0.XACCOUNT = T19.XACCOUNT ';
    v_sql7 := v_sql7||'                  AND todate(T19.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -18)    ';
    v_sql7 := v_sql7||'                  AND todate(T19.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -19)     ';
    v_sql7 := v_sql7||'            LEFT JOIN MDM_STMT_X T20 ';
    v_sql7 := v_sql7||'               ON     T0.XACCOUNT = T20.XACCOUNT ';
    v_sql7 := v_sql7||'                  AND todate(T20.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -19)    ';
    v_sql7 := v_sql7||'                  AND todate(T20.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -20)     ';
    v_sql7 := v_sql7||'            LEFT JOIN MDM_STMT_X T21 ';
    v_sql7 := v_sql7||'               ON     T0.XACCOUNT = T21.XACCOUNT ';
    v_sql7 := v_sql7||'                  AND todate(T21.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -20)    ';
    v_sql7 := v_sql7||'                  AND todate(T21.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -21)     ';
    v_sql7 := v_sql7||'            LEFT JOIN MDM_STMT_X T22 ';
    v_sql7 := v_sql7||'               ON     T0.XACCOUNT = T22.XACCOUNT ';
    v_sql7 := v_sql7||'                  AND todate(T22.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -21)    ';
    v_sql7 := v_sql7||'                  AND todate(T22.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -22)     ';
    v_sql7 := v_sql7||'            LEFT JOIN MDM_STMT_X T23 ';
    v_sql7 := v_sql7||'               ON     T0.XACCOUNT = T23.XACCOUNT ';
    v_sql7 := v_sql7||'                  AND todate(T23.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -22)    ';
    v_sql7 := v_sql7||'                  AND todate(T23.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -23)     ';
    v_sql7 := v_sql7||'            LEFT JOIN MDM_STMT_X T24 ';
    v_sql7 := v_sql7||'               ON     T0.XACCOUNT = T24.XACCOUNT ';
    v_sql7 := v_sql7||'                  AND todate(T24.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -23)    ';
    v_sql7 := v_sql7||'                  AND todate(T24.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -24)     ';
    v_sql7 := v_sql7||'            LEFT JOIN MDM_STMT_X T25 ';
    v_sql7 := v_sql7||'               ON     T0.XACCOUNT = T25.XACCOUNT ';
    v_sql7 := v_sql7||'                  AND todate(T25.STMT_DATE,''yyyy-mm-dd'') <= ADD_MONTHS (SYSDATE(), -24)    ';
    v_sql7 := v_sql7||'                  AND todate(T25.STMT_DATE,''yyyy-mm-dd'') > ADD_MONTHS (SYSDATE(), -25)     ';
    v_sql7 := v_sql7||'            LEFT JOIN TEMP_MPUR_H_CINSTL T01 ON T0.XACCOUNT = T01.XACCOUNT ';
    v_sql7 := v_sql7||'             LEFT JOIN TEMP_STMTBALINCREASEMONTH_L12M A1 ON T0.XACCOUNT = A1.ACCTNBR ';
    v_sql7 := v_sql7||'             LEFT JOIN TEMP_STMTFEEINCREASEMONTH_L6M A2 ON T0.XACCOUNT = A2.ACCTNBR ';
    v_sql7 := v_sql7||'             LEFT JOIN TEMP_STMTCASHINCREASERATIO A3 ON T0.XACCOUNT = A3.ACCTNBR ';
    v_sql7 := v_sql7||'            LEFT JOIN (  SELECT XACCOUNT, SUM (FLAG_CON_ODUE) AS FLAG_CON_ODUE ';
    v_sql7 := v_sql7||'                           FROM V_S24_STMT_X_24M ';
    v_sql7 := v_sql7||'                       GROUP BY XACCOUNT) V24 ';
    v_sql7 := v_sql7||'               ON T0.XACCOUNT = V24.XACCOUNT ';
    v_sql7 := v_sql7||'            LEFT JOIN ';
    v_sql7 := v_sql7||'            (  SELECT XACCOUNT, ';
    v_sql7 := v_sql7||'                      ROUND ( ';
    v_sql7 := v_sql7||'                         AVG ( ';
    v_sql7 := v_sql7||'                            CASE ';
    v_sql7 := v_sql7||'                               WHEN BAL <= 0 OR COAL (LIMIT, 0) <= 0 ';
    v_sql7 := v_sql7||'                               THEN ';
    v_sql7 := v_sql7||'                                  0 ';
    v_sql7 := v_sql7||'                               WHEN (BAL + 0) >= LIMIT ';
    v_sql7 := v_sql7||'                               THEN ';
    v_sql7 := v_sql7||'                                  100 ';
    v_sql7 := v_sql7||'                               ELSE ';
    v_sql7 := v_sql7||'                                  BAL / LIMIT * 100 ';
    v_sql7 := v_sql7||'                            END), ';
    v_sql7 := v_sql7||'                         4) ';
    v_sql7 := v_sql7||'                         AS RATIO_CREDIT_USE, ';
    v_sql7 := v_sql7||'                      AVG (PAYMENT_RATIO) AS PAYMENT_RATIO, ';
    v_sql7 := v_sql7||'                      SUM (PAYMENT) AS SUM_PAYMENT, ';
    v_sql7 := v_sql7||'                      SUM (CLOSE_BAL) AS CLOSE_BAL, ';
    v_sql7 := v_sql7||'                      SUM (OPEN_BAL) AS OPEN_BAL, ';
    v_sql7 := v_sql7||'                      SUM (FLAG_COST) AS FLAG_COST, ';
    v_sql7 := v_sql7||'                      SUM (NBR_CASHAD_NEW) AS NBR_CASHAD_NEW, ';
    v_sql7 := v_sql7||'                      SUM (FLAG_CON_AGE) AS FLAG_CON_AGE, ';
    v_sql7 := v_sql7||'                      SUM (FLAG_CON_ODUE) AS FLAG_CON_ODUE, ';
    v_sql7 := v_sql7||'                      AVG (FLAG_CON_ADD_AGE) AS FLAG_CON_ADD_AGE, ';
    v_sql7 := v_sql7||'                      MAX (ODUE_MTHS + 0) AS ODUE_MTHS ';
    v_sql7 := v_sql7||'                 FROM V_S24_STMT_X_12M ';
    v_sql7 := v_sql7||'             GROUP BY XACCOUNT) V12 ';
    v_sql7 := v_sql7||'               ON T0.XACCOUNT = V12.XACCOUNT ';
    v_sql7 := v_sql7||'            LEFT JOIN ';
    v_sql7 := v_sql7||'            (  SELECT XACCOUNT, ';
    v_sql7 := v_sql7||'                      AVG (POINT_EAR) AS POINT_EAR, ';
    v_sql7 := v_sql7||'                      SUM (CLOSE_BAL) AS CLOSE_BAL, ';
    v_sql7 := v_sql7||'                      SUM (OPEN_BAL) AS OPEN_BAL, ';
    v_sql7 := v_sql7||'                      SUM (NBR_PURCH_NEW) AS NBR_PURCH_NEW, ';
    v_sql7 := v_sql7||'                      AVG (PAYMENT) AS AVG_PAYMENT, ';
    v_sql7 := v_sql7||'                      AVG (RATIO_CREDIT_USE_SP) AS RATIO_CREDIT_USE_SP, ';
    v_sql7 := v_sql7||'                      SUM (NBR_CASHAD_NEW) AS NBR_CASHAD_NEW, ';
    v_sql7 := v_sql7||'                      SUM (FLAG_AGE) AS FLAG_AGE, ';
    v_sql7 := v_sql7||'                      SUM (TOT_COST) AS TOT_COST, ';
    v_sql7 := v_sql7||'                      SUM (TOT_INI) AS TOT_INI, ';
    v_sql7 := v_sql7||'                      SUM (CRED_LIMIT) AS CRED_LIMIT, ';
    v_sql7 := v_sql7||'                      SUM (COAL (C_LIMIT, 0)) AS C_LIMIT, ';
    v_sql7 := v_sql7||'                      SUM (FLAG_COST) AS FLAG_COST, ';
    v_sql7 := v_sql7||'                      MAX (ODUE_MTHS + 0) AS ODUE_MTHS, ';
    v_sql7 := v_sql7||'                      SUM (BAL) AS BAL, ';
    v_sql7 := v_sql7||'                      SUM (COAL (LIMIT, 0)) AS LIMIT ';
    v_sql7 := v_sql7||'                 FROM V_S24_STMT_X_6M ';
    v_sql7 := v_sql7||'             GROUP BY XACCOUNT) V6 ';
    v_sql7 := v_sql7||'               ON T0.XACCOUNT = V6.XACCOUNT ';
    v_sql7 := v_sql7||'            LEFT JOIN ';
    v_sql7 := v_sql7||'            (  SELECT XACCOUNT, ';
    v_sql7 := v_sql7||'                      SUM (FLAG_AGE) AS FLAG_AGE, ';
    v_sql7 := v_sql7||'                      ROUND ( ';
    v_sql7 := v_sql7||'                         AVG (  ';
    v_sql7 := v_sql7||'                            CASE ';
    v_sql7 := v_sql7||'                               WHEN BAL <= 0 OR COAL (LIMIT, 0) <= 0 ';
    v_sql7 := v_sql7||'                               THEN ';
    v_sql7 := v_sql7||'                                  0 ';
    v_sql7 := v_sql7||'                               WHEN (BAL + 0) >= LIMIT ';
    v_sql7 := v_sql7||'                               THEN ';
    v_sql7 := v_sql7||'                                  100 ';
    v_sql7 := v_sql7||'                               ELSE ';
    v_sql7 := v_sql7||'                                  BAL / LIMIT * 100 ';
    v_sql7 := v_sql7||'                            END), ';
    v_sql7 := v_sql7||'                         4) ';
    v_sql7 := v_sql7||'                         AS RATIO_CREDIT_USE, ';
    v_sql7 := v_sql7||'                      MAX ( ';
    v_sql7 := v_sql7||'                         CASE ';
    v_sql7 := v_sql7||'                            WHEN BAL_ADD14 <= 0 OR COAL (LIMIT_MP, 0) <= 0  ';
    v_sql7 := v_sql7||'                            THEN ';
    v_sql7 := v_sql7||'                               0 ';
    v_sql7 := v_sql7||'                            WHEN (BAL_ADD14 + 0) >= LIMIT_MP ';
    v_sql7 := v_sql7||'                            THEN ';
    v_sql7 := v_sql7||'                               100 ';
    v_sql7 := v_sql7||'                            ELSE ';
    v_sql7 := v_sql7||'                               ROUND (BAL_ADD14 / LIMIT_MP * 100, 4) ';
    v_sql7 := v_sql7||'                         END) ';
    v_sql7 := v_sql7||'                         AS MAX_RATIO_CREDIT_USE, ';
    v_sql7 := v_sql7||'                      SUM (CRED_LIMIT) AS CRED_LIMIT, ';
    v_sql7 := v_sql7||'                      SUM (BAL_ADD14) AS BAL_ADD14, ';
    v_sql7 := v_sql7||'                      SUM (COAL (LIMIT_MP, 0)) AS LIMIT_MP, ';
    v_sql7 := v_sql7||'                      SUM (CLOSE_BAL) AS CLOSE_BAL, ';
    v_sql7 := v_sql7||'                      SUM (OPEN_BAL) AS OPEN_BAL, ';
    v_sql7 := v_sql7||'                      SUM (FLAG_CASH) AS FLAG_CASH, ';
    v_sql7 := v_sql7||'                      SUM (FLAG_PAYMENT_P10) AS FLAG_PAYMENT_P10 ';
    v_sql7 := v_sql7||'                 FROM V_S24_STMT_X_3M ';
    v_sql7 := v_sql7||'             GROUP BY XACCOUNT) V3 ';
    v_sql7 := v_sql7||'               ON T0.XACCOUNT = V3.XACCOUNT ';
    DBMS_OUTPUT.PUT_LINE(v_sql7);
    DBMS_OUTPUT.PUT_LINE('v_sql7 after:=========');
    EXECUTE IMMEDIATE v_sql7;

    DBMS_OUTPUT.PUT_LINE('PRC_MDM_ACCT_INFO END');
    SET RESULT = '1';

END;

DECLARE RESULT_OUT STRING;
DECLARE ETL_DATE STRING = '2015-12-14 00:00:00';
call PRC_MDM_ACCT_INFO(ETL_DATE, RESULT_OUT);
PRING RESULT_OUT;
