use zhgl;


CREATE VIEW if not exists V_FDM_S24_CUR_ACCT_COM AS
SELECT START_DATE,
          XACCOUNT,
          BANK,
          BUSINESS,
          CATEGORY,
          CUSTR_NBR,
          CYCLE_NBR,
          DAY_OPENED,
          ACC_NAME1,
          ACC_TYPE,
          ADD_CHGDAY,
          ADDR_TYPE,
          ADDR_TYPE2,
          AGE1,
          AGE2,
          AGE3,
          AGE4,
          AGE5,
          AGE6,
          APP_SOURCE,
          AUTH_CASH,
          AUTH_OVER,
          AUTHOV_YN,
          AUTHS_AMT,
          BAL_CMPINT,
          BAL_FREE,
          BAL_INT,
          BAL_INTFLAG,
          BAL_NOINT,
          BAL_ORINT,
          BANKACCT1,
          BANKCODE1,
          BANKACCT2,
          BANKCODE2,
          BANKACCT3,
          BANKCODE3,
          BANKACCT4,
          BANKCODE4,
          BRANCH,
          BRANCH_DAY,
          CA_PCNT,
          CARD_FEES,
          CARDS_CANC,
          CARDS_ISSD,
          CASH_1ST,
          CASH_ADFEE,
          CASH_ADVCE,
          CASH_TDAY,
          CASH1STAC,
          CLASS_CHDY,
          CLASS_CODE,
          CLOSE_CHDY,
          CLOSE_CODE,
          COLLS_DAY,
          CRDACT_DAY,
          CRDNXT_DAY,
          CRED_ACTIV,
          CRED_ADJ,
          CRED_CHDAY,
          CRED_LIMIT,
          CRED_VOUCH,
          CREDLIM_X,
          CURR_NUM,
          CUTOFF_DAY,
          CY_CHGCNT,
          CY_CHGDAY,
          CY_EFFDAY,
          CY_YRCNT,
          CYCLE_NEW,
          CYCLE_PRV,
          DEBIT_ADJ,
          DISHNRDAY,
          DUTY_CREDT,
          DUTY_DEBIT,
          EXCH_CODE,
          EXCH_FLAG,
          EXCH_PERC,
          EXCH_RTDT,
          FEE_MONTH,
          FEES_TAXES,
          FIX_EXAMT,
          GUARN_FLAG,
          HI_CASHADV,
          HI_CASMMYY,
          HI_CRDMMYY,
          HI_CREDIT,
          HI_DEBIT,
          HI_DEBMMYY,
          HI_MP_PUR,
          HI_MPMMYY,
          HI_OLIMIT,
          HI_OLIMMYY,
          HI_PURCHSE,
          HI_PURMMYY,
          INT_CASH,
          INT_CHDCMP,
          INT_CHDY,
          INT_CHGD,
          INT_CMPOND,
          INT_CODE,
          INT_CUNOT,
          INT_CURCMP,
          INT_EARNED,
          INT_NOTION,
          INT_PROCDY,
          INT_RATE,
          INT_RATECR,
          INT_UPTODY,
          LANG_CODE,
          LAST_TRDAY,
          LASTAUTHDY,
          LASTNTDATE,
          LASTPAYAMT,
          LASTPAYDAY,
          LOSSES,
          MONTH_NBR,
          MONTR_CHDY,
          MONTR_CODE,
          MP_AM_TDY,
          MP_AUTHS,
          MP_BAL,
          MP_BIL_AMT,
          MP_LIMIT,
          MP_NO_TDY,
          MP_REM_PPL,
          MPLM_CHDAY,
          MTHS_ODUE,
          NBR_CASHAD,
          NBR_FEEDTY,
          NBR_OLIMIT,
          NBR_OTHERS,
          NBR_PAYMNT,
          NBR_PURCH,
          NBR_TRANS,
          OCT_COUNT,
          OCT_DAYIN,
          ODUE_FLAG,
          ODUE_HELD,
          OLFLAG,
          OTHER_FEES,
          PAY_FLAG,
          PAY1ST_IND,
          PAYMT_CLRD,
          PAYMT_TDAY,
          PAYMT_UNCL,
          PEN_CHRG,
          PENCHG_ACC,
          POINT_ADJ,
          PT_ADJFLAG,
          POINT_CLM,
          POINT_CUM,
          PT_CUMFLAG,
          POINT_CUM2,
          POINT_EAR,
          POINT_FREZ,
          POINT_FZDA,
          POST_DD,
          PREV_BRDAY,
          PREV_BRNCH,
          PURCHASES,
          QUERY_AMT,
          QUERY_CODE,
          QUERY_STMT,
          RECLA_CHDY,
          RECLA_CODE,
          RECVRY_AMT,
          REPAY_AMT,
          REPAY_AMTX,
          REPAY_CODE,
          REPAY_CODX,
          REPAY_DAY,
          REPAY_PCT,
          REPAY_PCTX,
          REPY_CHGDY,
          SCORE_PTS,
          STATEMENTS,
          STM_AMT_OL,
          STM_BALFRE,
          STM_BALINT,
          STMBALINTFLAG,
          STM_BALNCE,
          STM_BALFLAG,
          STM_BALORI,
          STM_CLOSDY,
          STM_CODE,
          STM_INSTL,
          STM_MINDUE,
          STM_NOINT,
          STM_OLFLAG,
          STM_OVERDU,
          STM_PAY_UN,
          STM_QRYAMT,
          STM_REPAY,
          STMT_DD,
          STMT_PULL,
          TODAY_AMT,
          TODAY_AMTFLAG,
          TODAY_REL,
          UNCL_PCT,
          WROFF_CHDY,
          WROFF_CODE,
          PROD_LEVEL,
          PROD_NBR,
          ACCT_PRSTS,
          ACCT_STS,
          APP_APQUE,
          POINT_ENC,
          POINT_IMP,
          POINT_EXP,
          PT_EXPFLAG,
          RISK_COUNT,
          RISK_DAYIN,
          BAL_MP,
          BAL_MPFLAG,
          STM_BALMP,
          STM_BMFLAG,
          LMT_RSN,
          POINT_CARD,
          PT_CDFLAG,
          TEMP_LIMIT,
          TLMT_BEG,
          TLMT_END,
          TLMT_NO,
          CANCL_RESN,
          SHADOW_PEN,
          SHADOW_INT,
          SHADOW_CMP,
          BAL_NINT01,
          BAL_NINT02,
          BAL_NINT03,
          BAL_NINT04,
          BAL_NINT05,
          BAL_NINT06,
          BAL_NINT07,
          BAL_NINT08,
          BAL_NINT09,
          BAL_NINT10,
          STM_NINT01,
          STM_NINT02,
          STM_NINT03,
          STM_NINT04,
          STM_NINT05,
          STM_NINT06,
          STM_NINT07,
          STM_NINT08,
          STM_NINT09,
          STM_NINT10,
          CURR_NUM2,
          WROF_FLAG,
          LAYERCODER1,
          LAYERCODER2,
          MCNTRL_YN,
          NCRED_RSN,
          BSC_CRED,
          CUSTR_REF,
          PBC_BRNCH,
          STOPMP_YN,
          CRED_LMT2,
          BAL_CMPFEE
     FROM FDM_S24_CUR_ACCT t
     left join (select C.code_value,C.bank_id from ccam_codes C, tbl_banks B  where B.bankid = C.bank_id and  C.code_type = 'TSZH') ta
     on t.CATEGORY = ta.code_value
     left join (select C.code_value,C.bank_id from ccam_codes C, tbl_banks B  where B.bankid = C.bank_id and  C.code_type = 'TSCP') tb
     on t.PROD_NBR = tb.code_value
     where ta.bank_id is null and tb.bank_id is null;
