use zhgl;

CREATE VIEW if not exists V_FDM_S24_MPUR AS
SELECT END_DATE,
          START_DATE,
          BANK,
          XACCOUNT,
          CARD_NBR,
          CARD_BIN,
          CARDHOLDER,
          MP_NUMBER,
          INP_DAY,
          INP_TIME,
          AUTH_CODE,
          MERCHANT,
          MICRO_REF,
          PRODUCT,
          PURCH_DAY,
          REACT_RESN,
          PROD_ID,
          INT_RATE,
          ACCEL_INT,
          ACCEL_RESN,
          CHECK_DIG,
          ISSUE_NBR,
          FIRST_INT,
          MTH_INSTL,
          INSTL_CNT,
          LST_INSTDY,
          MTH_INT,
          MTH_PPL,
          NBR_MTHS,
          ORIG_PURCH,
          REM_PPL,
          ORIG_INT,
          TOT_INT_CG,
          REM_INT,
          ORIG_FEE,
          REM_FEE,
          TRANS_SRC,
          STATUS_PRE,
          STATUS,
          STATUS_DAY,
          COMM_AMT,
          EMPLOYEE,
          FEE_FLAG,
          APP_SDAY,
          APP_SEQ,
          ADDR_TYPE,
          CREDP_ID,
          MP_TYPE,
          PAUSE_NBRS,
          DELAY_MTH,
          CURR_NUM,
          ADDR1,
          ADDR2,
          ADDR3,
          ADDR4,
          RES_PPL,
          INTER_MTHS,
          PAYCF_DAY
     FROM FDM_S24_MPUR
   UNION ALL
   SELECT from_unixtime(unix_timestamp()),
          p.START_DATE,
          p.BANK,
          p.XACCOUNT,
          p.CARD_NBR,
          p.CARD_BIN,
          p.CARDHOLDER,
          p.MP_NUMBER,
          p.INP_DAY,
          p.INP_TIME,
          p.AUTH_CODE,
          p.MERCHANT,
          p.MICRO_REF,
          p.PRODUCT,
          p.PURCH_DAY,
          p.REACT_RESN,
          p.PROD_ID,
          p.INT_RATE,
          p.ACCEL_INT,
          p.ACCEL_RESN,
          p.CHECK_DIG,
          p.ISSUE_NBR,
          p.FIRST_INT,
          p.MTH_INSTL,
          p.INSTL_CNT,
          p.LST_INSTDY,
          p.MTH_INT,
          p.MTH_PPL,
          p.NBR_MTHS,
          p.ORIG_PURCH,
          p.REM_PPL,
          p.ORIG_INT,
          p.TOT_INT_CG,
          p.REM_INT,
          p.ORIG_FEE,
          p.REM_FEE,
          p.TRANS_SRC,
          p.STATUS_PRE,
          p.STATUS,
          p.STATUS_DAY,
          p.COMM_AMT,
          p.EMPLOYEE,
          p.FEE_FLAG,
          p.APP_SDAY,
          p.APP_SEQ,
          p.ADDR_TYPE,
          p.CREDP_ID,
          p.MP_TYPE,
          p.PAUSE_NBRS,
          p.DELAY_MTH,
          p.CURR_NUM,
          p.ADDR1,
          p.ADDR2,
          p.ADDR3,
          p.ADDR4,
          p.RES_PPL,
          p.INTER_MTHS,
          p.PAYCF_DAY
     FROM FDM_S24_CUR_MPUR p;

