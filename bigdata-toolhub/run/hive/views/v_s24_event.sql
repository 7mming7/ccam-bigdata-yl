use zhgl;

CREATE VIEW if not exists V_S24_EVENT AS
SELECT    E.ACCTNBR,
          E.BANK,
          E.BATCH_DAY,
          E.BATCH_NO,
          E.INP_DATE,
          E.INP_TIME,
          E.MERCHANT,
          E.MICRO_REF,
          E.MONTH_NBR,
          E.ORI_TRANNO,
          E.XTRANNO,
          E.TRANS_TYPE,
          E.VAL_DATE,
          E.ACCT_STYLE,
          E.ACPTOR_ID,
          E.ACQMEMB_ID,
          E.ACTMTH,
          E.ADN_MSGID,
          E.AFFIN_FLAG,
          E.AUTH_CODE,
          E.AUTH_IND,
          E.AUTH_SRCE,
          E.AUTHD_AMT,
          E.AUTHD_RESP,
          E.BANKACCT,
          CASE
              WHEN  E.CURRNCY_CD = '840'
              THEN  E.BILL_AMT / 100 * 6
          ELSE
              E.BILL_AMT / 100
          END
               AS BILL_AMT,
          E.BILL_AMTFLAG,
          E.BRNO,
          E.CAP_ADDR,
          E.CARD_BIN,
          E.CARD_NBR,
          E.CARD_PLAN,
          E.CARDHOLDER,
          E.CASHBACK,
          E.CB_RIGHTS,
          E.CHECK_DIG,
          E.CUR_EXP,
          E.CURRNCY_CD,
          E.CVC_INV,
          E.CWBCRB_IND,
          E.DEP_DAY,
          E.DES_LINE1,
          E.DES_LINE2,
          E.DEST_BIN,
          E.EMPNO,
          E.ERROR_FLAG,
          E.EXPIRY_DTE,
          E.FL_LIM_IND,
          E.ID_METHOD,
          E.INPUT_DATE,
          E.INTLFEEIND,
          E.ISPEC,
          E.ISSUE_NBR,
          E.XLAST_LINE,
          E.M_P_IND,
          E.MARKET_IND,
          E.MATCHDATE,
          E.MC_ICCR_DT,
          E.MCC_ALLOW,
          E.MCC_ANALY,
          E.MCC_CNTRL,
          E.MCLRSEQ_NO,
          E.MCPOS_DATA,
          E.MER_CAT_CD,
          E.MERCH_SEQ,
          E.MERCH_STAT,
          E.MERCH_ZIP,
          E.NBR_MTHS,
          E.NTWK_SERV,
          E.ORGN_AMT,
          E.ORGN_AMTFLAG,
          E.ORGN_CURR,
          E.OTH_AMT / 100 AS OTH_AMT,
          E.PAYFUND_TR,
          E.PCAS_IND,
          E.POINT_CARD,
          E.POINT_MRCH,
          E.POINT_POST,
          E.POS_DATA,
          E.POS_ENTRY,
          E.POS_TERM,
          E.PPAID_CARD,
          E.PRODUCT,
          E.BILL_AMT / 100 AS PROFIT_AMT, --外币交易记录原值
          E.PUR_DATE,
          E.PUR_TIME,
          E.PURCHSE_FM,
          E.PURCHSE_ID,
          E.RECURR_IND,
          E.REIMBURSE,
          E.REQPMTSERV,
          E.RETRV_REF,
          E.REV_IND,
          E.SEC_LVL,
          E.SETTL_AMT,
          E.SETTL_CURR,
          E.SETTL_FLAG,
          E.SETTLE_DAY,
          E.SPEC_COND,
          E.SRC_IND,
          E.SRCE_BIN,
          E.STIP_IND,
          E.TERM_IND,
          E.TERMINALI,
          E.TRAN_CODE,
          E.TRAN_FEE,
          E.TRAN_FEEC,
          E.TRAN_ID,
          E.TRANS_SRC,
          E.VALIDATION,
          E.VISA_DATE,
          E.EMPNO_NEW,
          E.PIPE1
     FROM S24_EVENT E
;

